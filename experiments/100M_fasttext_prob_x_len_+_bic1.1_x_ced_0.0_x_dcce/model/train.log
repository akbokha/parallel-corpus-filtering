[2019-07-10 14:20:24] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-10 14:20:24] [marian] Running on elli as process 29504 with command line:
[2019-07-10 14:20:24] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-10 14:20:24] [config] after-batches: 0
[2019-07-10 14:20:24] [config] after-epochs: 0
[2019-07-10 14:20:24] [config] allow-unk: false
[2019-07-10 14:20:24] [config] beam-size: 12
[2019-07-10 14:20:24] [config] bert-class-symbol: "[CLS]"
[2019-07-10 14:20:24] [config] bert-mask-symbol: "[MASK]"
[2019-07-10 14:20:24] [config] bert-masking-fraction: 0.15
[2019-07-10 14:20:24] [config] bert-sep-symbol: "[SEP]"
[2019-07-10 14:20:24] [config] bert-train-type-embeddings: true
[2019-07-10 14:20:24] [config] bert-type-vocab-size: 2
[2019-07-10 14:20:24] [config] best-deep: false
[2019-07-10 14:20:24] [config] clip-gemm: 0
[2019-07-10 14:20:24] [config] clip-norm: 1
[2019-07-10 14:20:24] [config] cost-type: ce-mean
[2019-07-10 14:20:24] [config] cpu-threads: 0
[2019-07-10 14:20:24] [config] data-weighting: ""
[2019-07-10 14:20:24] [config] data-weighting-type: sentence
[2019-07-10 14:20:24] [config] dec-cell: gru
[2019-07-10 14:20:24] [config] dec-cell-base-depth: 2
[2019-07-10 14:20:24] [config] dec-cell-high-depth: 1
[2019-07-10 14:20:24] [config] dec-depth: 1
[2019-07-10 14:20:24] [config] devices:
[2019-07-10 14:20:24] [config]   - 0
[2019-07-10 14:20:24] [config]   - 1
[2019-07-10 14:20:24] [config] dim-emb: 512
[2019-07-10 14:20:24] [config] dim-rnn: 1024
[2019-07-10 14:20:24] [config] dim-vocabs:
[2019-07-10 14:20:24] [config]   - 50000
[2019-07-10 14:20:24] [config]   - 50000
[2019-07-10 14:20:24] [config] disp-first: 0
[2019-07-10 14:20:24] [config] disp-freq: 2000
[2019-07-10 14:20:24] [config] disp-label-counts: false
[2019-07-10 14:20:24] [config] dropout-rnn: 0.2
[2019-07-10 14:20:24] [config] dropout-src: 0.1
[2019-07-10 14:20:24] [config] dropout-trg: 0.1
[2019-07-10 14:20:24] [config] dump-config: ""
[2019-07-10 14:20:24] [config] early-stopping: 5
[2019-07-10 14:20:24] [config] embedding-fix-src: false
[2019-07-10 14:20:24] [config] embedding-fix-trg: false
[2019-07-10 14:20:24] [config] embedding-normalization: false
[2019-07-10 14:20:24] [config] embedding-vectors:
[2019-07-10 14:20:24] [config]   []
[2019-07-10 14:20:24] [config] enc-cell: gru
[2019-07-10 14:20:24] [config] enc-cell-depth: 1
[2019-07-10 14:20:24] [config] enc-depth: 1
[2019-07-10 14:20:24] [config] enc-type: bidirectional
[2019-07-10 14:20:24] [config] exponential-smoothing: 0.0001
[2019-07-10 14:20:24] [config] grad-dropping-momentum: 0
[2019-07-10 14:20:24] [config] grad-dropping-rate: 0
[2019-07-10 14:20:24] [config] grad-dropping-warmup: 100
[2019-07-10 14:20:24] [config] guided-alignment: none
[2019-07-10 14:20:24] [config] guided-alignment-cost: mse
[2019-07-10 14:20:24] [config] guided-alignment-weight: 0.1
[2019-07-10 14:20:24] [config] ignore-model-config: false
[2019-07-10 14:20:24] [config] input-types:
[2019-07-10 14:20:24] [config]   []
[2019-07-10 14:20:24] [config] interpolate-env-vars: false
[2019-07-10 14:20:24] [config] keep-best: false
[2019-07-10 14:20:24] [config] label-smoothing: 0
[2019-07-10 14:20:24] [config] layer-normalization: true
[2019-07-10 14:20:24] [config] learn-rate: 0.0001
[2019-07-10 14:20:24] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-10 14:20:24] [config] log-level: info
[2019-07-10 14:20:24] [config] log-time-zone: ""
[2019-07-10 14:20:24] [config] lr-decay: 0
[2019-07-10 14:20:24] [config] lr-decay-freq: 50000
[2019-07-10 14:20:24] [config] lr-decay-inv-sqrt:
[2019-07-10 14:20:24] [config]   - 0
[2019-07-10 14:20:24] [config] lr-decay-repeat-warmup: false
[2019-07-10 14:20:24] [config] lr-decay-reset-optimizer: false
[2019-07-10 14:20:24] [config] lr-decay-start:
[2019-07-10 14:20:24] [config]   - 10
[2019-07-10 14:20:24] [config]   - 1
[2019-07-10 14:20:24] [config] lr-decay-strategy: epoch+stalled
[2019-07-10 14:20:24] [config] lr-report: false
[2019-07-10 14:20:24] [config] lr-warmup: 0
[2019-07-10 14:20:24] [config] lr-warmup-at-reload: false
[2019-07-10 14:20:24] [config] lr-warmup-cycle: false
[2019-07-10 14:20:24] [config] lr-warmup-start-rate: 0
[2019-07-10 14:20:24] [config] max-length: 50
[2019-07-10 14:20:24] [config] max-length-crop: false
[2019-07-10 14:20:24] [config] max-length-factor: 3
[2019-07-10 14:20:24] [config] maxi-batch: 100
[2019-07-10 14:20:24] [config] maxi-batch-sort: trg
[2019-07-10 14:20:24] [config] mini-batch: 64
[2019-07-10 14:20:24] [config] mini-batch-fit: true
[2019-07-10 14:20:24] [config] mini-batch-fit-step: 10
[2019-07-10 14:20:24] [config] mini-batch-overstuff: 1
[2019-07-10 14:20:24] [config] mini-batch-track-lr: false
[2019-07-10 14:20:24] [config] mini-batch-understuff: 1
[2019-07-10 14:20:24] [config] mini-batch-warmup: 0
[2019-07-10 14:20:24] [config] mini-batch-words: 0
[2019-07-10 14:20:24] [config] mini-batch-words-ref: 0
[2019-07-10 14:20:24] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-10 14:20:24] [config] multi-loss-type: sum
[2019-07-10 14:20:24] [config] multi-node: false
[2019-07-10 14:20:24] [config] multi-node-overlap: true
[2019-07-10 14:20:24] [config] n-best: false
[2019-07-10 14:20:24] [config] no-nccl: false
[2019-07-10 14:20:24] [config] no-reload: false
[2019-07-10 14:20:24] [config] no-restore-corpus: false
[2019-07-10 14:20:24] [config] no-shuffle: false
[2019-07-10 14:20:24] [config] normalize: 1
[2019-07-10 14:20:24] [config] num-devices: 0
[2019-07-10 14:20:24] [config] optimizer: adam
[2019-07-10 14:20:24] [config] optimizer-delay: 1
[2019-07-10 14:20:24] [config] optimizer-params:
[2019-07-10 14:20:24] [config]   []
[2019-07-10 14:20:24] [config] overwrite: false
[2019-07-10 14:20:24] [config] pretrained-model: ""
[2019-07-10 14:20:24] [config] quiet: false
[2019-07-10 14:20:24] [config] quiet-translation: true
[2019-07-10 14:20:24] [config] relative-paths: false
[2019-07-10 14:20:24] [config] right-left: false
[2019-07-10 14:20:24] [config] save-freq: 20000
[2019-07-10 14:20:24] [config] seed: 1111
[2019-07-10 14:20:24] [config] shuffle-in-ram: false
[2019-07-10 14:20:24] [config] skip: false
[2019-07-10 14:20:24] [config] sqlite: ""
[2019-07-10 14:20:24] [config] sqlite-drop: false
[2019-07-10 14:20:24] [config] sync-sgd: true
[2019-07-10 14:20:24] [config] tempdir: .
[2019-07-10 14:20:24] [config] tied-embeddings: false
[2019-07-10 14:20:24] [config] tied-embeddings-all: false
[2019-07-10 14:20:24] [config] tied-embeddings-src: false
[2019-07-10 14:20:24] [config] train-sets:
[2019-07-10 14:20:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-10 14:20:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-10 14:20:24] [config] transformer-aan-activation: swish
[2019-07-10 14:20:24] [config] transformer-aan-depth: 2
[2019-07-10 14:20:24] [config] transformer-aan-nogate: false
[2019-07-10 14:20:24] [config] transformer-decoder-autoreg: self-attention
[2019-07-10 14:20:24] [config] transformer-dim-aan: 2048
[2019-07-10 14:20:24] [config] transformer-dim-ffn: 2048
[2019-07-10 14:20:24] [config] transformer-dropout: 0
[2019-07-10 14:20:24] [config] transformer-dropout-attention: 0
[2019-07-10 14:20:24] [config] transformer-dropout-ffn: 0
[2019-07-10 14:20:24] [config] transformer-ffn-activation: swish
[2019-07-10 14:20:24] [config] transformer-ffn-depth: 2
[2019-07-10 14:20:24] [config] transformer-guided-alignment-layer: last
[2019-07-10 14:20:24] [config] transformer-heads: 8
[2019-07-10 14:20:24] [config] transformer-no-projection: false
[2019-07-10 14:20:24] [config] transformer-postprocess: dan
[2019-07-10 14:20:24] [config] transformer-postprocess-emb: d
[2019-07-10 14:20:24] [config] transformer-preprocess: ""
[2019-07-10 14:20:24] [config] transformer-tied-layers:
[2019-07-10 14:20:24] [config]   []
[2019-07-10 14:20:24] [config] transformer-train-position-embeddings: false
[2019-07-10 14:20:24] [config] type: amun
[2019-07-10 14:20:24] [config] ulr: false
[2019-07-10 14:20:24] [config] ulr-dim-emb: 0
[2019-07-10 14:20:24] [config] ulr-dropout: 0
[2019-07-10 14:20:24] [config] ulr-keys-vectors: ""
[2019-07-10 14:20:24] [config] ulr-query-vectors: ""
[2019-07-10 14:20:24] [config] ulr-softmax-temperature: 1
[2019-07-10 14:20:24] [config] ulr-trainable-transformation: false
[2019-07-10 14:20:24] [config] valid-freq: 20000
[2019-07-10 14:20:24] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-10 14:20:24] [config] valid-max-length: 1000
[2019-07-10 14:20:24] [config] valid-metrics:
[2019-07-10 14:20:24] [config]   - cross-entropy
[2019-07-10 14:20:24] [config]   - perplexity
[2019-07-10 14:20:24] [config]   - translation
[2019-07-10 14:20:24] [config] valid-mini-batch: 8
[2019-07-10 14:20:24] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-10 14:20:24] [config] valid-sets:
[2019-07-10 14:20:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-10 14:20:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-10 14:20:24] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-10 14:20:24] [config] vocabs:
[2019-07-10 14:20:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-10 14:20:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-10 14:20:24] [config] word-penalty: 0
[2019-07-10 14:20:24] [config] workspace: 6000
[2019-07-10 14:20:24] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-10 14:20:24] Using synchronous training
[2019-07-10 14:20:24] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-10 14:20:24] [data] Using unused word id eos for 0
[2019-07-10 14:20:24] [data] Using unused word id UNK for 1
[2019-07-10 14:20:24] [data] Setting vocabulary size for input 0 to 50000
[2019-07-10 14:20:24] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-10 14:20:25] [data] Using unused word id eos for 0
[2019-07-10 14:20:25] [data] Using unused word id UNK for 1
[2019-07-10 14:20:25] [data] Setting vocabulary size for input 1 to 50000
[2019-07-10 14:20:25] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-10 14:20:25] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-10 14:20:26] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-10 14:20:27] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-10 14:20:27] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-10 14:20:27] [comm] NCCLCommunicator constructed successfully.
[2019-07-10 14:20:27] [training] Using 2 GPUs
[2019-07-10 14:20:27] [memory] Reserving 422 MB, device gpu0
[2019-07-10 14:20:27] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-10 14:20:27] [memory] Reserving 422 MB, device gpu0
[2019-07-10 14:20:38] [batching] Done. Typical MB size is 16192 target words
[2019-07-10 14:20:38] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-10 14:20:38] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-10 14:20:38] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-10 14:20:38] [comm] NCCLCommunicator constructed successfully.
[2019-07-10 14:20:38] [training] Using 2 GPUs
[2019-07-10 14:20:38] Training started
[2019-07-10 14:20:38] [data] Shuffling data
[2019-07-10 14:20:41] [data] Done reading 4355038 sentences
[2019-07-10 14:21:00] [data] Done shuffling 4355038 sentences to temp files
[2019-07-10 14:21:06] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-10 14:21:06] [memory] Reserving 422 MB, device gpu1
[2019-07-10 14:21:06] [memory] Reserving 422 MB, device gpu0
[2019-07-10 14:21:06] [memory] Reserving 422 MB, device gpu0
[2019-07-10 14:21:06] [memory] Reserving 422 MB, device gpu1
[2019-07-10 14:21:06] [memory] Reserving 211 MB, device gpu0
[2019-07-10 14:21:06] [memory] Reserving 211 MB, device gpu1
[2019-07-10 14:21:07] [memory] Reserving 422 MB, device gpu0
[2019-07-10 14:21:07] [memory] Reserving 422 MB, device gpu1
[2019-07-10 14:44:07] Ep. 1 : Up. 2000 : Sen. 706,710 : Cost 140.54325867 : Time 1422.30s : 12301.35 words/s
[2019-07-10 15:09:40] Ep. 1 : Up. 4000 : Sen. 1,411,646 : Cost 107.21521759 : Time 1532.76s : 11405.91 words/s
[2019-07-10 15:35:02] Ep. 1 : Up. 6000 : Sen. 2,119,036 : Cost 91.90224457 : Time 1521.89s : 11507.43 words/s
[2019-07-10 16:00:34] Ep. 1 : Up. 8000 : Sen. 2,825,399 : Cost 83.52672577 : Time 1532.39s : 11408.94 words/s
[2019-07-10 16:26:09] Ep. 1 : Up. 10000 : Sen. 3,532,031 : Cost 78.10641479 : Time 1534.59s : 11394.49 words/s
[2019-07-10 16:26:10] Seen 3532755 samples
[2019-07-10 16:26:10] Starting epoch 2
[2019-07-10 16:26:10] [data] Shuffling data
[2019-07-10 16:26:13] [data] Done reading 4355038 sentences
[2019-07-10 16:26:32] [data] Done shuffling 4355038 sentences to temp files
[2019-07-10 16:51:59] Ep. 2 : Up. 12000 : Sen. 705,658 : Cost 73.95146179 : Time 1550.24s : 11278.50 words/s
[2019-07-10 17:17:49] Ep. 2 : Up. 14000 : Sen. 1,413,446 : Cost 71.39065552 : Time 1550.51s : 11307.25 words/s
[2019-07-10 17:43:18] Ep. 2 : Up. 16000 : Sen. 2,119,672 : Cost 69.64056396 : Time 1528.47s : 11451.18 words/s
[2019-07-10 18:08:28] Ep. 2 : Up. 18000 : Sen. 2,825,224 : Cost 67.84838867 : Time 1510.56s : 11560.47 words/s
[2019-07-10 18:33:39] Ep. 2 : Up. 20000 : Sen. 3,531,801 : Cost 66.37926483 : Time 1510.76s : 11567.73 words/s
[2019-07-10 18:33:39] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-10 18:33:50] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter20000.npz
[2019-07-10 18:33:57] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-10 18:34:06] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-10 18:34:28] [valid] Ep. 2 : Up. 20000 : cross-entropy : 61.4633 : new best
[2019-07-10 18:34:32] [valid] Ep. 2 : Up. 20000 : perplexity : 11.3213 : new best
[2019-07-10 18:35:11] [valid] Ep. 2 : Up. 20000 : translation : 26.31 : new best
[2019-07-10 18:35:16] Seen 3532755 samples
[2019-07-10 18:35:16] Starting epoch 3
[2019-07-10 18:35:16] [data] Shuffling data
[2019-07-10 18:35:19] [data] Done reading 4355038 sentences
[2019-07-10 18:35:37] [data] Done shuffling 4355038 sentences to temp files
[2019-07-10 19:00:24] Ep. 3 : Up. 22000 : Sen. 704,000 : Cost 64.72074127 : Time 1604.81s : 10886.29 words/s
[2019-07-10 19:25:41] Ep. 3 : Up. 24000 : Sen. 1,408,318 : Cost 63.69949341 : Time 1517.23s : 11488.88 words/s
[2019-07-10 19:51:04] Ep. 3 : Up. 26000 : Sen. 2,110,728 : Cost 62.88278198 : Time 1522.44s : 11429.98 words/s
[2019-07-10 20:16:36] Ep. 3 : Up. 28000 : Sen. 2,815,682 : Cost 62.20013046 : Time 1532.07s : 11391.26 words/s
[2019-07-10 20:42:20] Ep. 3 : Up. 30000 : Sen. 3,521,034 : Cost 61.48756790 : Time 1544.16s : 11318.59 words/s
[2019-07-10 20:42:46] Seen 3532755 samples
[2019-07-10 20:42:46] Starting epoch 4
[2019-07-10 20:42:46] [data] Shuffling data
[2019-07-10 20:42:49] [data] Done reading 4355038 sentences
[2019-07-10 20:43:09] [data] Done shuffling 4355038 sentences to temp files
[2019-07-10 21:08:23] Ep. 4 : Up. 32000 : Sen. 692,621 : Cost 59.98522949 : Time 1563.54s : 11154.57 words/s
[2019-07-10 21:34:16] Ep. 4 : Up. 34000 : Sen. 1,397,514 : Cost 59.48811340 : Time 1552.20s : 11253.01 words/s
[2019-07-10 22:00:18] Ep. 4 : Up. 36000 : Sen. 2,101,964 : Cost 59.39533615 : Time 1562.37s : 11173.33 words/s
[2019-07-10 22:26:14] Ep. 4 : Up. 38000 : Sen. 2,803,836 : Cost 58.75608063 : Time 1556.21s : 11148.10 words/s
[2019-07-10 22:52:09] Ep. 4 : Up. 40000 : Sen. 3,509,108 : Cost 58.43595505 : Time 1555.25s : 11229.58 words/s
[2019-07-10 22:52:09] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-10 22:52:23] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter40000.npz
[2019-07-10 22:52:32] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-10 22:52:45] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-10 22:53:12] [valid] Ep. 4 : Up. 40000 : cross-entropy : 53.765 : new best
[2019-07-10 22:53:16] [valid] Ep. 4 : Up. 40000 : perplexity : 8.35401 : new best
[2019-07-10 22:54:12] [valid] Ep. 4 : Up. 40000 : translation : 28.95 : new best
[2019-07-10 22:54:55] Seen 3532755 samples
[2019-07-10 22:54:55] Starting epoch 5
[2019-07-10 22:54:55] [data] Shuffling data
[2019-07-10 22:55:10] [data] Done reading 4355038 sentences
[2019-07-10 22:55:45] [data] Done shuffling 4355038 sentences to temp files
[2019-07-10 23:20:33] Ep. 5 : Up. 42000 : Sen. 680,143 : Cost 57.30257034 : Time 1703.36s : 10228.60 words/s
[2019-07-10 23:46:52] Ep. 5 : Up. 44000 : Sen. 1,387,122 : Cost 57.12177658 : Time 1579.43s : 11083.96 words/s
[2019-07-11 00:13:06] Ep. 5 : Up. 46000 : Sen. 2,090,804 : Cost 56.86688995 : Time 1573.28s : 11076.12 words/s
[2019-07-11 00:39:45] Ep. 5 : Up. 48000 : Sen. 2,796,800 : Cost 56.60940933 : Time 1599.62s : 10925.76 words/s
[2019-07-11 01:06:40] Ep. 5 : Up. 50000 : Sen. 3,503,422 : Cost 56.43680954 : Time 1614.96s : 10833.35 words/s
[2019-07-11 01:07:48] Seen 3532755 samples
[2019-07-11 01:07:48] Starting epoch 6
[2019-07-11 01:07:48] [data] Shuffling data
[2019-07-11 01:08:01] [data] Done reading 4355038 sentences
[2019-07-11 01:08:30] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 01:34:02] Ep. 6 : Up. 52000 : Sen. 675,362 : Cost 55.26585388 : Time 1641.64s : 10628.77 words/s
[2019-07-11 02:01:06] Ep. 6 : Up. 54000 : Sen. 1,380,404 : Cost 55.33554459 : Time 1623.76s : 10748.66 words/s
[2019-07-11 02:28:08] Ep. 6 : Up. 56000 : Sen. 2,083,592 : Cost 55.35504150 : Time 1622.94s : 10746.68 words/s
[2019-07-11 02:55:08] Ep. 6 : Up. 58000 : Sen. 2,788,272 : Cost 54.92811584 : Time 1619.91s : 10756.11 words/s
[2019-07-11 03:22:16] Ep. 6 : Up. 60000 : Sen. 3,493,764 : Cost 54.85738754 : Time 1627.13s : 10743.02 words/s
[2019-07-11 03:22:16] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-11 03:22:27] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter60000.npz
[2019-07-11 03:22:36] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-11 03:22:47] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-11 03:23:13] [valid] Ep. 6 : Up. 60000 : cross-entropy : 50.8198 : new best
[2019-07-11 03:23:17] [valid] Ep. 6 : Up. 60000 : perplexity : 7.43693 : new best
[2019-07-11 03:24:02] [valid] Ep. 6 : Up. 60000 : translation : 30.05 : new best
[2019-07-11 03:25:15] Seen 3532755 samples
[2019-07-11 03:25:15] Starting epoch 7
[2019-07-11 03:25:15] [data] Shuffling data
[2019-07-11 03:25:29] [data] Done reading 4355038 sentences
[2019-07-11 03:26:02] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 03:50:53] Ep. 7 : Up. 62000 : Sen. 665,222 : Cost 53.96801376 : Time 1717.72s : 10158.73 words/s
[2019-07-11 04:17:46] Ep. 7 : Up. 64000 : Sen. 1,368,772 : Cost 53.86186218 : Time 1613.03s : 10801.49 words/s
[2019-07-11 04:44:44] Ep. 7 : Up. 66000 : Sen. 2,075,092 : Cost 53.80506897 : Time 1618.06s : 10799.19 words/s
[2019-07-11 05:11:44] Ep. 7 : Up. 68000 : Sen. 2,782,102 : Cost 53.82645798 : Time 1620.14s : 10814.87 words/s
[2019-07-11 05:38:44] Ep. 7 : Up. 70000 : Sen. 3,484,830 : Cost 53.58827972 : Time 1619.70s : 10731.42 words/s
[2019-07-11 05:40:34] Seen 3532755 samples
[2019-07-11 05:40:34] Starting epoch 8
[2019-07-11 05:40:34] [data] Shuffling data
[2019-07-11 05:40:37] [data] Done reading 4355038 sentences
[2019-07-11 05:41:04] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 06:05:47] Ep. 8 : Up. 72000 : Sen. 657,522 : Cost 52.75279999 : Time 1622.86s : 10770.07 words/s
[2019-07-11 06:32:40] Ep. 8 : Up. 74000 : Sen. 1,363,518 : Cost 52.72169876 : Time 1613.29s : 10832.95 words/s
[2019-07-11 06:59:27] Ep. 8 : Up. 76000 : Sen. 2,067,042 : Cost 52.89436722 : Time 1606.65s : 10846.19 words/s
[2019-07-11 07:26:14] Ep. 8 : Up. 78000 : Sen. 2,770,564 : Cost 52.57017517 : Time 1606.82s : 10831.54 words/s
[2019-07-11 07:53:04] Ep. 8 : Up. 80000 : Sen. 3,471,624 : Cost 52.82067108 : Time 1609.78s : 10795.53 words/s
[2019-07-11 07:53:04] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-11 07:53:13] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter80000.npz
[2019-07-11 07:53:21] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-11 07:53:31] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-11 07:53:54] [valid] Ep. 8 : Up. 80000 : cross-entropy : 49.3033 : new best
[2019-07-11 07:53:57] [valid] Ep. 8 : Up. 80000 : perplexity : 7.00471 : new best
[2019-07-11 07:54:39] [valid] Ep. 8 : Up. 80000 : translation : 30.52 : new best
[2019-07-11 07:56:37] Seen 3532755 samples
[2019-07-11 07:56:37] Starting epoch 9
[2019-07-11 07:56:37] [data] Shuffling data
[2019-07-11 07:56:40] [data] Done reading 4355038 sentences
[2019-07-11 07:56:58] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 08:21:14] Ep. 9 : Up. 82000 : Sen. 645,040 : Cost 51.77196503 : Time 1690.40s : 10340.25 words/s
[2019-07-11 08:48:23] Ep. 9 : Up. 84000 : Sen. 1,351,036 : Cost 51.88011932 : Time 1628.84s : 10741.10 words/s
[2019-07-11 09:15:47] Ep. 9 : Up. 86000 : Sen. 2,058,486 : Cost 51.75460052 : Time 1644.44s : 10640.56 words/s
[2019-07-11 09:43:02] Ep. 9 : Up. 88000 : Sen. 2,760,396 : Cost 51.85226440 : Time 1635.18s : 10641.27 words/s
[2019-07-11 10:09:56] Ep. 9 : Up. 90000 : Sen. 3,465,561 : Cost 51.90021133 : Time 1613.72s : 10811.62 words/s
[2019-07-11 10:12:32] Seen 3532755 samples
[2019-07-11 10:12:32] Starting epoch 10
[2019-07-11 10:12:32] [data] Shuffling data
[2019-07-11 10:12:35] [data] Done reading 4355038 sentences
[2019-07-11 10:12:56] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 10:37:21] Ep. 10 : Up. 92000 : Sen. 638,508 : Cost 51.11341476 : Time 1645.27s : 10622.52 words/s
[2019-07-11 11:05:03] Ep. 10 : Up. 94000 : Sen. 1,344,318 : Cost 51.07828903 : Time 1661.97s : 10516.05 words/s
[2019-07-11 11:32:40] Ep. 10 : Up. 96000 : Sen. 2,048,758 : Cost 51.00491333 : Time 1656.38s : 10526.58 words/s
[2019-07-11 12:00:27] Ep. 10 : Up. 98000 : Sen. 2,753,464 : Cost 51.19540405 : Time 1666.90s : 10470.08 words/s
[2019-07-11 12:28:36] Ep. 10 : Up. 100000 : Sen. 3,458,314 : Cost 51.24115372 : Time 1689.65s : 10341.69 words/s
[2019-07-11 12:28:36] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-11 12:28:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter100000.npz
[2019-07-11 12:28:57] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-11 12:29:09] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-11 12:29:36] [valid] Ep. 10 : Up. 100000 : cross-entropy : 48.3377 : new best
[2019-07-11 12:29:41] [valid] Ep. 10 : Up. 100000 : perplexity : 6.74271 : new best
[2019-07-11 12:30:32] [valid] Ep. 10 : Up. 100000 : translation : 31 : new best
[2019-07-11 12:33:03] Seen 3532755 samples
[2019-07-11 12:33:03] Starting epoch 11
[2019-07-11 12:33:03] [data] Shuffling data
[2019-07-11 12:33:06] [data] Done reading 4355038 sentences
[2019-07-11 12:33:37] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 12:58:37] Ep. 11 : Up. 102000 : Sen. 631,500 : Cost 50.41044998 : Time 1800.21s : 9702.85 words/s
[2019-07-11 13:27:49] Ep. 11 : Up. 104000 : Sen. 1,338,324 : Cost 50.28616333 : Time 1751.40s : 9987.73 words/s
[2019-07-11 13:57:02] Ep. 11 : Up. 106000 : Sen. 2,041,918 : Cost 50.31773376 : Time 1752.35s : 9935.87 words/s
[2019-07-11 14:26:33] Ep. 11 : Up. 108000 : Sen. 2,746,236 : Cost 50.43516541 : Time 1771.90s : 9839.44 words/s
[2019-07-11 14:56:27] Ep. 11 : Up. 110000 : Sen. 3,452,168 : Cost 50.59950256 : Time 1793.63s : 9750.10 words/s
[2019-07-11 14:59:54] Seen 3532755 samples
[2019-07-11 14:59:54] Starting epoch 12
[2019-07-11 14:59:54] [data] Shuffling data
[2019-07-11 14:59:59] [data] Done reading 4355038 sentences
[2019-07-11 15:00:32] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 15:26:04] Ep. 12 : Up. 112000 : Sen. 622,900 : Cost 49.83078766 : Time 1776.44s : 9813.57 words/s
[2019-07-11 15:55:16] Ep. 12 : Up. 114000 : Sen. 1,329,204 : Cost 49.87133408 : Time 1752.02s : 9982.03 words/s
[2019-07-11 16:24:30] Ep. 12 : Up. 116000 : Sen. 2,035,886 : Cost 49.77471161 : Time 1754.15s : 9970.30 words/s
[2019-07-11 16:53:49] Ep. 12 : Up. 118000 : Sen. 2,738,345 : Cost 50.10092926 : Time 1759.13s : 9900.16 words/s
[2019-07-11 17:22:49] Ep. 12 : Up. 120000 : Sen. 3,441,550 : Cost 50.09255600 : Time 1740.28s : 10002.15 words/s
[2019-07-11 17:22:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-11 17:23:01] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter120000.npz
[2019-07-11 17:23:12] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-11 17:23:26] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-11 17:23:56] [valid] Ep. 12 : Up. 120000 : cross-entropy : 47.7266 : new best
[2019-07-11 17:24:01] [valid] Ep. 12 : Up. 120000 : perplexity : 6.58197 : new best
[2019-07-11 17:24:47] [valid] Ep. 12 : Up. 120000 : translation : 31.27 : new best
[2019-07-11 17:28:07] Seen 3532755 samples
[2019-07-11 17:28:07] Starting epoch 13
[2019-07-11 17:28:07] [data] Shuffling data
[2019-07-11 17:28:15] [data] Done reading 4355038 sentences
[2019-07-11 17:28:51] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 17:53:42] Ep. 13 : Up. 122000 : Sen. 615,848 : Cost 49.18818665 : Time 1853.07s : 9450.70 words/s
[2019-07-11 18:22:33] Ep. 13 : Up. 124000 : Sen. 1,320,456 : Cost 49.29695892 : Time 1730.62s : 10079.81 words/s
[2019-07-11 18:51:22] Ep. 13 : Up. 126000 : Sen. 2,028,482 : Cost 49.43901062 : Time 1728.85s : 10132.41 words/s
[2019-07-11 19:19:45] Ep. 13 : Up. 128000 : Sen. 2,733,118 : Cost 49.51351929 : Time 1703.60s : 10248.46 words/s
[2019-07-11 19:47:56] Ep. 13 : Up. 130000 : Sen. 3,439,466 : Cost 49.60929871 : Time 1690.38s : 10342.66 words/s
[2019-07-11 19:51:40] Seen 3532755 samples
[2019-07-11 19:51:40] Starting epoch 14
[2019-07-11 19:51:40] [data] Shuffling data
[2019-07-11 19:51:52] [data] Done reading 4355038 sentences
[2019-07-11 19:52:17] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 20:16:01] Ep. 14 : Up. 132000 : Sen. 611,400 : Cost 49.00278473 : Time 1685.77s : 10367.54 words/s
[2019-07-11 20:43:51] Ep. 14 : Up. 134000 : Sen. 1,318,400 : Cost 48.68498611 : Time 1669.27s : 10476.83 words/s
[2019-07-11 21:11:02] Ep. 14 : Up. 136000 : Sen. 2,022,718 : Cost 49.02658081 : Time 1631.17s : 10694.23 words/s
[2019-07-11 21:37:34] Ep. 14 : Up. 138000 : Sen. 2,729,586 : Cost 48.98379517 : Time 1592.60s : 10995.95 words/s
[2019-07-11 22:03:48] Ep. 14 : Up. 140000 : Sen. 3,435,308 : Cost 49.00634384 : Time 1573.79s : 11100.98 words/s
[2019-07-11 22:03:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-11 22:04:00] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter140000.npz
[2019-07-11 22:04:08] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-11 22:04:19] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-11 22:04:45] [valid] Ep. 14 : Up. 140000 : cross-entropy : 47.2822 : new best
[2019-07-11 22:04:49] [valid] Ep. 14 : Up. 140000 : perplexity : 6.4675 : new best
[2019-07-11 22:05:34] [valid] Ep. 14 : Up. 140000 : translation : 31.44 : new best
[2019-07-11 22:08:49] Seen 3532755 samples
[2019-07-11 22:08:49] Starting epoch 15
[2019-07-11 22:08:49] [data] Shuffling data
[2019-07-11 22:08:54] [data] Done reading 4355038 sentences
[2019-07-11 22:09:20] [data] Done shuffling 4355038 sentences to temp files
[2019-07-11 22:31:43] Ep. 15 : Up. 142000 : Sen. 605,595 : Cost 48.35351562 : Time 1674.53s : 10403.62 words/s
[2019-07-11 22:58:09] Ep. 15 : Up. 144000 : Sen. 1,313,492 : Cost 48.37037659 : Time 1586.71s : 11025.02 words/s
[2019-07-11 23:24:14] Ep. 15 : Up. 146000 : Sen. 2,015,364 : Cost 48.45403290 : Time 1564.31s : 11099.07 words/s
[2019-07-11 23:50:29] Ep. 15 : Up. 148000 : Sen. 2,720,318 : Cost 48.64746857 : Time 1575.54s : 11096.30 words/s
[2019-07-12 00:16:23] Ep. 15 : Up. 150000 : Sen. 3,424,636 : Cost 48.72613907 : Time 1554.03s : 11233.02 words/s
[2019-07-12 00:20:20] Seen 3532755 samples
[2019-07-12 00:20:20] Starting epoch 16
[2019-07-12 00:20:20] [data] Shuffling data
[2019-07-12 00:20:32] [data] Done reading 4355038 sentences
[2019-07-12 00:20:57] [data] Done shuffling 4355038 sentences to temp files
[2019-07-12 00:42:16] Ep. 16 : Up. 152000 : Sen. 598,342 : Cost 47.86155701 : Time 1553.02s : 11250.13 words/s
[2019-07-12 01:07:55] Ep. 16 : Up. 154000 : Sen. 1,304,646 : Cost 47.99771118 : Time 1538.36s : 11369.54 words/s
[2019-07-12 01:33:35] Ep. 16 : Up. 156000 : Sen. 2,010,554 : Cost 48.21686554 : Time 1540.71s : 11346.33 words/s
[2019-07-12 01:59:19] Ep. 16 : Up. 158000 : Sen. 2,713,600 : Cost 48.26197433 : Time 1543.25s : 11294.16 words/s
[2019-07-12 02:25:15] Ep. 16 : Up. 160000 : Sen. 3,419,410 : Cost 48.26852417 : Time 1555.88s : 11228.16 words/s
[2019-07-12 02:25:15] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-12 02:25:25] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter160000.npz
[2019-07-12 02:25:33] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-12 02:25:43] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-12 02:26:06] [valid] Ep. 16 : Up. 160000 : cross-entropy : 47.0433 : new best
[2019-07-12 02:26:10] [valid] Ep. 16 : Up. 160000 : perplexity : 6.40677 : new best
[2019-07-12 02:26:49] [valid] Ep. 16 : Up. 160000 : translation : 31.59 : new best
[2019-07-12 02:30:39] Seen 3532755 samples
[2019-07-12 02:30:39] Starting epoch 17
[2019-07-12 02:30:39] [data] Shuffling data
[2019-07-12 02:30:50] [data] Done reading 4355038 sentences
[2019-07-12 02:31:15] [data] Done shuffling 4355038 sentences to temp files
[2019-07-12 02:52:25] Ep. 17 : Up. 162000 : Sen. 588,482 : Cost 47.61938095 : Time 1630.72s : 10658.46 words/s
[2019-07-12 03:18:12] Ep. 17 : Up. 164000 : Sen. 1,292,394 : Cost 47.70472336 : Time 1546.30s : 11269.87 words/s
[2019-07-12 03:44:01] Ep. 17 : Up. 166000 : Sen. 2,000,118 : Cost 47.87534714 : Time 1549.01s : 11310.75 words/s
[2019-07-12 04:09:38] Ep. 17 : Up. 168000 : Sen. 2,705,505 : Cost 47.79835129 : Time 1537.28s : 11362.00 words/s
[2019-07-12 04:35:18] Ep. 17 : Up. 170000 : Sen. 3,409,928 : Cost 48.08860397 : Time 1540.46s : 11321.91 words/s
[2019-07-12 04:39:47] Seen 3532755 samples
[2019-07-12 04:39:47] Starting epoch 18
[2019-07-12 04:39:47] [data] Shuffling data
[2019-07-12 04:39:50] [data] Done reading 4355038 sentences
[2019-07-12 04:40:12] [data] Done shuffling 4355038 sentences to temp files
[2019-07-12 05:01:11] Ep. 18 : Up. 172000 : Sen. 582,082 : Cost 47.29248047 : Time 1552.42s : 11244.87 words/s
[2019-07-12 05:26:53] Ep. 18 : Up. 174000 : Sen. 1,288,626 : Cost 47.31282806 : Time 1541.90s : 11344.16 words/s
[2019-07-12 05:52:16] Ep. 18 : Up. 176000 : Sen. 1,990,718 : Cost 47.60432053 : Time 1523.76s : 11413.48 words/s
[2019-07-12 06:17:43] Ep. 18 : Up. 178000 : Sen. 2,697,658 : Cost 47.76479340 : Time 1526.14s : 11474.55 words/s
[2019-07-12 06:42:52] Ep. 18 : Up. 180000 : Sen. 3,402,398 : Cost 47.73379517 : Time 1509.73s : 11548.34 words/s
[2019-07-12 06:42:52] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-12 06:43:03] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter180000.npz
[2019-07-12 06:43:10] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-12 06:43:21] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-12 06:43:44] [valid] Ep. 18 : Up. 180000 : cross-entropy : 46.8232 : new best
[2019-07-12 06:43:48] [valid] Ep. 18 : Up. 180000 : perplexity : 6.35133 : new best
[2019-07-12 06:44:10] Error: Unknown word id: 49990
[2019-07-12 06:44:11] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7fa632c47a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7fa632767c80]                                                       + 0xb8c80
[0x7fa632c406ba]                                                       + 0x76ba
[0x7fa631ecd41d]    clone                                              + 0x6d

[2019-07-13 17:46:13] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 17:46:13] [marian] Running on hretha as process 10683 with command line:
[2019-07-13 17:46:13] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 2 3 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-13 17:46:14] [config] after-batches: 0
[2019-07-13 17:46:14] [config] after-epochs: 0
[2019-07-13 17:46:14] [config] allow-unk: false
[2019-07-13 17:46:14] [config] beam-size: 12
[2019-07-13 17:46:14] [config] bert-class-symbol: "[CLS]"
[2019-07-13 17:46:14] [config] bert-mask-symbol: "[MASK]"
[2019-07-13 17:46:14] [config] bert-masking-fraction: 0.15
[2019-07-13 17:46:14] [config] bert-sep-symbol: "[SEP]"
[2019-07-13 17:46:14] [config] bert-train-type-embeddings: true
[2019-07-13 17:46:14] [config] bert-type-vocab-size: 2
[2019-07-13 17:46:14] [config] best-deep: false
[2019-07-13 17:46:14] [config] clip-gemm: 0
[2019-07-13 17:46:14] [config] clip-norm: 1
[2019-07-13 17:46:14] [config] cost-type: ce-mean
[2019-07-13 17:46:14] [config] cpu-threads: 0
[2019-07-13 17:46:14] [config] data-weighting: ""
[2019-07-13 17:46:14] [config] data-weighting-type: sentence
[2019-07-13 17:46:14] [config] dec-cell: gru
[2019-07-13 17:46:14] [config] dec-cell-base-depth: 2
[2019-07-13 17:46:14] [config] dec-cell-high-depth: 1
[2019-07-13 17:46:14] [config] dec-depth: 1
[2019-07-13 17:46:14] [config] devices:
[2019-07-13 17:46:14] [config]   - 2
[2019-07-13 17:46:14] [config]   - 3
[2019-07-13 17:46:14] [config] dim-emb: 512
[2019-07-13 17:46:14] [config] dim-rnn: 1024
[2019-07-13 17:46:14] [config] dim-vocabs:
[2019-07-13 17:46:14] [config]   - 50000
[2019-07-13 17:46:14] [config]   - 50000
[2019-07-13 17:46:14] [config] disp-first: 0
[2019-07-13 17:46:14] [config] disp-freq: 2000
[2019-07-13 17:46:14] [config] disp-label-counts: false
[2019-07-13 17:46:14] [config] dropout-rnn: 0.2
[2019-07-13 17:46:14] [config] dropout-src: 0.1
[2019-07-13 17:46:14] [config] dropout-trg: 0.1
[2019-07-13 17:46:14] [config] dump-config: ""
[2019-07-13 17:46:14] [config] early-stopping: 5
[2019-07-13 17:46:14] [config] embedding-fix-src: false
[2019-07-13 17:46:14] [config] embedding-fix-trg: false
[2019-07-13 17:46:14] [config] embedding-normalization: false
[2019-07-13 17:46:14] [config] embedding-vectors:
[2019-07-13 17:46:14] [config]   []
[2019-07-13 17:46:14] [config] enc-cell: gru
[2019-07-13 17:46:14] [config] enc-cell-depth: 1
[2019-07-13 17:46:14] [config] enc-depth: 1
[2019-07-13 17:46:14] [config] enc-type: bidirectional
[2019-07-13 17:46:14] [config] exponential-smoothing: 0.0001
[2019-07-13 17:46:14] [config] grad-dropping-momentum: 0
[2019-07-13 17:46:14] [config] grad-dropping-rate: 0
[2019-07-13 17:46:14] [config] grad-dropping-warmup: 100
[2019-07-13 17:46:14] [config] guided-alignment: none
[2019-07-13 17:46:14] [config] guided-alignment-cost: mse
[2019-07-13 17:46:14] [config] guided-alignment-weight: 0.1
[2019-07-13 17:46:14] [config] ignore-model-config: false
[2019-07-13 17:46:14] [config] input-types:
[2019-07-13 17:46:14] [config]   []
[2019-07-13 17:46:14] [config] interpolate-env-vars: false
[2019-07-13 17:46:14] [config] keep-best: false
[2019-07-13 17:46:14] [config] label-smoothing: 0
[2019-07-13 17:46:14] [config] layer-normalization: true
[2019-07-13 17:46:14] [config] learn-rate: 0.0001
[2019-07-13 17:46:14] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-13 17:46:14] [config] log-level: info
[2019-07-13 17:46:14] [config] log-time-zone: ""
[2019-07-13 17:46:14] [config] lr-decay: 0
[2019-07-13 17:46:14] [config] lr-decay-freq: 50000
[2019-07-13 17:46:14] [config] lr-decay-inv-sqrt:
[2019-07-13 17:46:14] [config]   - 0
[2019-07-13 17:46:14] [config] lr-decay-repeat-warmup: false
[2019-07-13 17:46:14] [config] lr-decay-reset-optimizer: false
[2019-07-13 17:46:14] [config] lr-decay-start:
[2019-07-13 17:46:14] [config]   - 10
[2019-07-13 17:46:14] [config]   - 1
[2019-07-13 17:46:14] [config] lr-decay-strategy: epoch+stalled
[2019-07-13 17:46:14] [config] lr-report: false
[2019-07-13 17:46:14] [config] lr-warmup: 0
[2019-07-13 17:46:14] [config] lr-warmup-at-reload: false
[2019-07-13 17:46:14] [config] lr-warmup-cycle: false
[2019-07-13 17:46:14] [config] lr-warmup-start-rate: 0
[2019-07-13 17:46:14] [config] max-length: 50
[2019-07-13 17:46:14] [config] max-length-crop: false
[2019-07-13 17:46:14] [config] max-length-factor: 3
[2019-07-13 17:46:14] [config] maxi-batch: 100
[2019-07-13 17:46:14] [config] maxi-batch-sort: trg
[2019-07-13 17:46:14] [config] mini-batch: 64
[2019-07-13 17:46:14] [config] mini-batch-fit: true
[2019-07-13 17:46:14] [config] mini-batch-fit-step: 10
[2019-07-13 17:46:14] [config] mini-batch-overstuff: 1
[2019-07-13 17:46:14] [config] mini-batch-track-lr: false
[2019-07-13 17:46:14] [config] mini-batch-understuff: 1
[2019-07-13 17:46:14] [config] mini-batch-warmup: 0
[2019-07-13 17:46:14] [config] mini-batch-words: 0
[2019-07-13 17:46:14] [config] mini-batch-words-ref: 0
[2019-07-13 17:46:14] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-13 17:46:14] [config] multi-loss-type: sum
[2019-07-13 17:46:14] [config] multi-node: false
[2019-07-13 17:46:14] [config] multi-node-overlap: true
[2019-07-13 17:46:14] [config] n-best: false
[2019-07-13 17:46:14] [config] no-nccl: false
[2019-07-13 17:46:14] [config] no-reload: false
[2019-07-13 17:46:14] [config] no-restore-corpus: false
[2019-07-13 17:46:14] [config] no-shuffle: false
[2019-07-13 17:46:14] [config] normalize: 1
[2019-07-13 17:46:14] [config] num-devices: 0
[2019-07-13 17:46:14] [config] optimizer: adam
[2019-07-13 17:46:14] [config] optimizer-delay: 1
[2019-07-13 17:46:14] [config] optimizer-params:
[2019-07-13 17:46:14] [config]   []
[2019-07-13 17:46:14] [config] overwrite: false
[2019-07-13 17:46:14] [config] pretrained-model: ""
[2019-07-13 17:46:14] [config] quiet: false
[2019-07-13 17:46:14] [config] quiet-translation: true
[2019-07-13 17:46:14] [config] relative-paths: false
[2019-07-13 17:46:14] [config] right-left: false
[2019-07-13 17:46:14] [config] save-freq: 20000
[2019-07-13 17:46:14] [config] seed: 1111
[2019-07-13 17:46:14] [config] shuffle-in-ram: false
[2019-07-13 17:46:14] [config] skip: false
[2019-07-13 17:46:14] [config] sqlite: ""
[2019-07-13 17:46:14] [config] sqlite-drop: false
[2019-07-13 17:46:14] [config] sync-sgd: true
[2019-07-13 17:46:14] [config] tempdir: .
[2019-07-13 17:46:14] [config] tied-embeddings: false
[2019-07-13 17:46:14] [config] tied-embeddings-all: false
[2019-07-13 17:46:14] [config] tied-embeddings-src: false
[2019-07-13 17:46:14] [config] train-sets:
[2019-07-13 17:46:14] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-13 17:46:14] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-13 17:46:14] [config] transformer-aan-activation: swish
[2019-07-13 17:46:14] [config] transformer-aan-depth: 2
[2019-07-13 17:46:14] [config] transformer-aan-nogate: false
[2019-07-13 17:46:14] [config] transformer-decoder-autoreg: self-attention
[2019-07-13 17:46:14] [config] transformer-dim-aan: 2048
[2019-07-13 17:46:14] [config] transformer-dim-ffn: 2048
[2019-07-13 17:46:14] [config] transformer-dropout: 0
[2019-07-13 17:46:14] [config] transformer-dropout-attention: 0
[2019-07-13 17:46:14] [config] transformer-dropout-ffn: 0
[2019-07-13 17:46:14] [config] transformer-ffn-activation: swish
[2019-07-13 17:46:14] [config] transformer-ffn-depth: 2
[2019-07-13 17:46:14] [config] transformer-guided-alignment-layer: last
[2019-07-13 17:46:14] [config] transformer-heads: 8
[2019-07-13 17:46:14] [config] transformer-no-projection: false
[2019-07-13 17:46:14] [config] transformer-postprocess: dan
[2019-07-13 17:46:14] [config] transformer-postprocess-emb: d
[2019-07-13 17:46:14] [config] transformer-preprocess: ""
[2019-07-13 17:46:14] [config] transformer-tied-layers:
[2019-07-13 17:46:14] [config]   []
[2019-07-13 17:46:14] [config] transformer-train-position-embeddings: false
[2019-07-13 17:46:14] [config] type: amun
[2019-07-13 17:46:14] [config] ulr: false
[2019-07-13 17:46:14] [config] ulr-dim-emb: 0
[2019-07-13 17:46:14] [config] ulr-dropout: 0
[2019-07-13 17:46:14] [config] ulr-keys-vectors: ""
[2019-07-13 17:46:14] [config] ulr-query-vectors: ""
[2019-07-13 17:46:14] [config] ulr-softmax-temperature: 1
[2019-07-13 17:46:14] [config] ulr-trainable-transformation: false
[2019-07-13 17:46:14] [config] valid-freq: 20000
[2019-07-13 17:46:14] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-13 17:46:14] [config] valid-max-length: 1000
[2019-07-13 17:46:14] [config] valid-metrics:
[2019-07-13 17:46:14] [config]   - cross-entropy
[2019-07-13 17:46:14] [config]   - perplexity
[2019-07-13 17:46:14] [config]   - translation
[2019-07-13 17:46:14] [config] valid-mini-batch: 8
[2019-07-13 17:46:14] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-13 17:46:14] [config] valid-sets:
[2019-07-13 17:46:14] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-13 17:46:14] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-13 17:46:14] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-13 17:46:14] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 17:46:14] [config] vocabs:
[2019-07-13 17:46:14] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-13 17:46:14] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-13 17:46:14] [config] word-penalty: 0
[2019-07-13 17:46:14] [config] workspace: 5000
[2019-07-13 17:46:14] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 17:46:14] Using synchronous training
[2019-07-13 17:46:14] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-13 17:46:15] [data] Using unused word id eos for 0
[2019-07-13 17:46:15] [data] Using unused word id UNK for 1
[2019-07-13 17:46:15] [data] Setting vocabulary size for input 0 to 50000
[2019-07-13 17:46:15] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-13 17:46:15] [data] Using unused word id eos for 0
[2019-07-13 17:46:15] [data] Using unused word id UNK for 1
[2019-07-13 17:46:15] [data] Setting vocabulary size for input 1 to 50000
[2019-07-13 17:46:15] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-13 17:46:15] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-13 17:46:16] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-13 17:46:16] [memory] Extending reserved space to 5120 MB (device gpu3)
[2019-07-13 17:46:17] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-13 17:46:17] [comm] NCCLCommunicator constructed successfully.
[2019-07-13 17:46:17] [training] Using 2 GPUs
[2019-07-13 17:46:17] [memory] Reserving 422 MB, device gpu2
[2019-07-13 17:46:17] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-13 17:46:17] [memory] Reserving 422 MB, device gpu2
[2019-07-13 17:46:26] [batching] Done. Typical MB size is 13760 target words
[2019-07-13 17:46:26] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-13 17:46:26] [memory] Extending reserved space to 5120 MB (device gpu3)
[2019-07-13 17:46:26] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-13 17:46:26] [comm] NCCLCommunicator constructed successfully.
[2019-07-13 17:46:26] [training] Using 2 GPUs
[2019-07-13 17:46:26] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-13 17:46:33] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-13 17:46:35] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-13 17:46:49] [memory] Reserving 422 MB, device gpu2
[2019-07-13 17:46:49] [memory] Reserving 422 MB, device gpu3
[2019-07-13 17:46:50] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-13 17:46:50] [data] Restoring the corpus state to epoch 18, batch 180000
[2019-07-13 17:46:50] [data] Shuffling data
[2019-07-13 17:47:04] [data] Done reading 4355038 sentences
[2019-07-13 17:47:24] [data] Done shuffling 4355038 sentences to temp files
[2019-07-13 17:49:07] Training started
[2019-07-13 17:49:07] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-13 17:49:07] [memory] Reserving 422 MB, device gpu3
[2019-07-13 17:49:07] [memory] Reserving 422 MB, device gpu2
[2019-07-13 17:49:08] [memory] Reserving 422 MB, device gpu3
[2019-07-13 17:49:08] [memory] Reserving 422 MB, device gpu2
[2019-07-13 17:49:08] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-13 17:49:14] [memory] Reserving 422 MB, device cpu0
[2019-07-13 17:49:15] [memory] Reserving 211 MB, device gpu2
[2019-07-13 17:49:15] [memory] Reserving 211 MB, device gpu3
[2019-07-13 18:05:59] Ep. 18 : Up. 182000 : Sen. 3,998,978 : Cost 46.65022659 : Time 1183.87s : 12473.20 words/s
[2019-07-13 18:07:40] Seen 4059009 samples
[2019-07-13 18:07:40] Starting epoch 19
[2019-07-13 18:07:40] [data] Shuffling data
[2019-07-13 18:07:43] [data] Done reading 4355038 sentences
[2019-07-13 18:08:02] [data] Done shuffling 4355038 sentences to temp files
[2019-07-13 18:23:09] Ep. 19 : Up. 184000 : Sen. 535,024 : Cost 47.11231995 : Time 1030.54s : 14310.33 words/s
[2019-07-13 18:39:59] Ep. 19 : Up. 186000 : Sen. 1,132,188 : Cost 47.11458588 : Time 1009.92s : 14647.29 words/s
[2019-07-13 18:56:48] Ep. 19 : Up. 188000 : Sen. 1,728,264 : Cost 47.22515106 : Time 1009.11s : 14614.43 words/s
[2019-07-13 19:13:34] Ep. 19 : Up. 190000 : Sen. 2,321,712 : Cost 47.33529663 : Time 1005.48s : 14595.46 words/s
[2019-07-13 19:30:22] Ep. 19 : Up. 192000 : Sen. 2,917,736 : Cost 47.43929291 : Time 1008.33s : 14639.05 words/s
[2019-07-13 19:47:13] Ep. 19 : Up. 194000 : Sen. 3,513,864 : Cost 47.45305252 : Time 1010.41s : 14612.38 words/s
[2019-07-13 19:47:45] Seen 3532755 samples
[2019-07-13 19:47:45] Starting epoch 20
[2019-07-13 19:47:45] [data] Shuffling data
[2019-07-13 19:47:48] [data] Done reading 4355038 sentences
[2019-07-13 19:48:05] [data] Done shuffling 4355038 sentences to temp files
[2019-07-13 20:04:26] Ep. 20 : Up. 196000 : Sen. 575,276 : Cost 46.57925415 : Time 1033.16s : 14255.65 words/s
[2019-07-13 20:21:15] Ep. 20 : Up. 198000 : Sen. 1,169,712 : Cost 46.83003998 : Time 1009.55s : 14588.99 words/s
[2019-07-13 20:38:05] Ep. 20 : Up. 200000 : Sen. 1,766,136 : Cost 46.93296051 : Time 1009.27s : 14621.84 words/s
[2019-07-13 20:38:05] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-13 20:38:14] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter200000.npz
[2019-07-13 20:38:21] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-13 20:38:31] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-13 20:38:51] [valid] Ep. 20 : Up. 200000 : cross-entropy : 46.7889 : new best
[2019-07-13 20:38:55] [valid] Ep. 20 : Up. 200000 : perplexity : 6.34273 : new best
[2019-07-13 20:39:21] Error: Unknown word id: 49990
[2019-07-13 20:39:21] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f01f51bea99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f01f4cdec80]                                                       + 0xb8c80
[0x7f01f51b76ba]                                                       + 0x76ba
[0x7f01f444441d]    clone                                              + 0x6d

[2019-07-14 16:33:22] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 16:33:22] [marian] Running on hretha as process 19378 with command line:
[2019-07-14 16:33:22] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 2 3 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-14 16:33:22] [config] after-batches: 0
[2019-07-14 16:33:22] [config] after-epochs: 0
[2019-07-14 16:33:22] [config] allow-unk: false
[2019-07-14 16:33:22] [config] beam-size: 12
[2019-07-14 16:33:22] [config] bert-class-symbol: "[CLS]"
[2019-07-14 16:33:22] [config] bert-mask-symbol: "[MASK]"
[2019-07-14 16:33:22] [config] bert-masking-fraction: 0.15
[2019-07-14 16:33:22] [config] bert-sep-symbol: "[SEP]"
[2019-07-14 16:33:22] [config] bert-train-type-embeddings: true
[2019-07-14 16:33:22] [config] bert-type-vocab-size: 2
[2019-07-14 16:33:22] [config] best-deep: false
[2019-07-14 16:33:22] [config] clip-gemm: 0
[2019-07-14 16:33:22] [config] clip-norm: 1
[2019-07-14 16:33:22] [config] cost-type: ce-mean
[2019-07-14 16:33:22] [config] cpu-threads: 0
[2019-07-14 16:33:22] [config] data-weighting: ""
[2019-07-14 16:33:22] [config] data-weighting-type: sentence
[2019-07-14 16:33:22] [config] dec-cell: gru
[2019-07-14 16:33:22] [config] dec-cell-base-depth: 2
[2019-07-14 16:33:22] [config] dec-cell-high-depth: 1
[2019-07-14 16:33:22] [config] dec-depth: 1
[2019-07-14 16:33:22] [config] devices:
[2019-07-14 16:33:22] [config]   - 2
[2019-07-14 16:33:22] [config]   - 3
[2019-07-14 16:33:22] [config] dim-emb: 512
[2019-07-14 16:33:22] [config] dim-rnn: 1024
[2019-07-14 16:33:22] [config] dim-vocabs:
[2019-07-14 16:33:22] [config]   - 50000
[2019-07-14 16:33:22] [config]   - 50000
[2019-07-14 16:33:22] [config] disp-first: 0
[2019-07-14 16:33:22] [config] disp-freq: 2000
[2019-07-14 16:33:22] [config] disp-label-counts: false
[2019-07-14 16:33:22] [config] dropout-rnn: 0.2
[2019-07-14 16:33:22] [config] dropout-src: 0.1
[2019-07-14 16:33:22] [config] dropout-trg: 0.1
[2019-07-14 16:33:22] [config] dump-config: ""
[2019-07-14 16:33:22] [config] early-stopping: 5
[2019-07-14 16:33:22] [config] embedding-fix-src: false
[2019-07-14 16:33:22] [config] embedding-fix-trg: false
[2019-07-14 16:33:22] [config] embedding-normalization: false
[2019-07-14 16:33:22] [config] embedding-vectors:
[2019-07-14 16:33:22] [config]   []
[2019-07-14 16:33:22] [config] enc-cell: gru
[2019-07-14 16:33:22] [config] enc-cell-depth: 1
[2019-07-14 16:33:22] [config] enc-depth: 1
[2019-07-14 16:33:22] [config] enc-type: bidirectional
[2019-07-14 16:33:22] [config] exponential-smoothing: 0.0001
[2019-07-14 16:33:22] [config] grad-dropping-momentum: 0
[2019-07-14 16:33:22] [config] grad-dropping-rate: 0
[2019-07-14 16:33:22] [config] grad-dropping-warmup: 100
[2019-07-14 16:33:22] [config] guided-alignment: none
[2019-07-14 16:33:22] [config] guided-alignment-cost: mse
[2019-07-14 16:33:22] [config] guided-alignment-weight: 0.1
[2019-07-14 16:33:22] [config] ignore-model-config: false
[2019-07-14 16:33:22] [config] input-types:
[2019-07-14 16:33:22] [config]   []
[2019-07-14 16:33:22] [config] interpolate-env-vars: false
[2019-07-14 16:33:22] [config] keep-best: false
[2019-07-14 16:33:22] [config] label-smoothing: 0
[2019-07-14 16:33:22] [config] layer-normalization: true
[2019-07-14 16:33:22] [config] learn-rate: 0.0001
[2019-07-14 16:33:22] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-14 16:33:22] [config] log-level: info
[2019-07-14 16:33:22] [config] log-time-zone: ""
[2019-07-14 16:33:22] [config] lr-decay: 0
[2019-07-14 16:33:22] [config] lr-decay-freq: 50000
[2019-07-14 16:33:22] [config] lr-decay-inv-sqrt:
[2019-07-14 16:33:22] [config]   - 0
[2019-07-14 16:33:22] [config] lr-decay-repeat-warmup: false
[2019-07-14 16:33:22] [config] lr-decay-reset-optimizer: false
[2019-07-14 16:33:22] [config] lr-decay-start:
[2019-07-14 16:33:22] [config]   - 10
[2019-07-14 16:33:22] [config]   - 1
[2019-07-14 16:33:22] [config] lr-decay-strategy: epoch+stalled
[2019-07-14 16:33:22] [config] lr-report: false
[2019-07-14 16:33:22] [config] lr-warmup: 0
[2019-07-14 16:33:22] [config] lr-warmup-at-reload: false
[2019-07-14 16:33:22] [config] lr-warmup-cycle: false
[2019-07-14 16:33:22] [config] lr-warmup-start-rate: 0
[2019-07-14 16:33:22] [config] max-length: 50
[2019-07-14 16:33:22] [config] max-length-crop: false
[2019-07-14 16:33:22] [config] max-length-factor: 3
[2019-07-14 16:33:22] [config] maxi-batch: 100
[2019-07-14 16:33:22] [config] maxi-batch-sort: trg
[2019-07-14 16:33:22] [config] mini-batch: 64
[2019-07-14 16:33:22] [config] mini-batch-fit: true
[2019-07-14 16:33:22] [config] mini-batch-fit-step: 10
[2019-07-14 16:33:22] [config] mini-batch-overstuff: 1
[2019-07-14 16:33:22] [config] mini-batch-track-lr: false
[2019-07-14 16:33:22] [config] mini-batch-understuff: 1
[2019-07-14 16:33:22] [config] mini-batch-warmup: 0
[2019-07-14 16:33:22] [config] mini-batch-words: 0
[2019-07-14 16:33:22] [config] mini-batch-words-ref: 0
[2019-07-14 16:33:22] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 16:33:22] [config] multi-loss-type: sum
[2019-07-14 16:33:22] [config] multi-node: false
[2019-07-14 16:33:22] [config] multi-node-overlap: true
[2019-07-14 16:33:22] [config] n-best: false
[2019-07-14 16:33:22] [config] no-nccl: false
[2019-07-14 16:33:22] [config] no-reload: false
[2019-07-14 16:33:22] [config] no-restore-corpus: false
[2019-07-14 16:33:22] [config] no-shuffle: false
[2019-07-14 16:33:22] [config] normalize: 1
[2019-07-14 16:33:22] [config] num-devices: 0
[2019-07-14 16:33:22] [config] optimizer: adam
[2019-07-14 16:33:22] [config] optimizer-delay: 1
[2019-07-14 16:33:22] [config] optimizer-params:
[2019-07-14 16:33:22] [config]   []
[2019-07-14 16:33:22] [config] overwrite: false
[2019-07-14 16:33:22] [config] pretrained-model: ""
[2019-07-14 16:33:22] [config] quiet: false
[2019-07-14 16:33:22] [config] quiet-translation: true
[2019-07-14 16:33:22] [config] relative-paths: false
[2019-07-14 16:33:22] [config] right-left: false
[2019-07-14 16:33:22] [config] save-freq: 20000
[2019-07-14 16:33:22] [config] seed: 1111
[2019-07-14 16:33:22] [config] shuffle-in-ram: false
[2019-07-14 16:33:22] [config] skip: false
[2019-07-14 16:33:22] [config] sqlite: ""
[2019-07-14 16:33:22] [config] sqlite-drop: false
[2019-07-14 16:33:22] [config] sync-sgd: true
[2019-07-14 16:33:22] [config] tempdir: .
[2019-07-14 16:33:22] [config] tied-embeddings: false
[2019-07-14 16:33:22] [config] tied-embeddings-all: false
[2019-07-14 16:33:22] [config] tied-embeddings-src: false
[2019-07-14 16:33:22] [config] train-sets:
[2019-07-14 16:33:22] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-14 16:33:22] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-14 16:33:22] [config] transformer-aan-activation: swish
[2019-07-14 16:33:22] [config] transformer-aan-depth: 2
[2019-07-14 16:33:22] [config] transformer-aan-nogate: false
[2019-07-14 16:33:22] [config] transformer-decoder-autoreg: self-attention
[2019-07-14 16:33:22] [config] transformer-dim-aan: 2048
[2019-07-14 16:33:22] [config] transformer-dim-ffn: 2048
[2019-07-14 16:33:22] [config] transformer-dropout: 0
[2019-07-14 16:33:22] [config] transformer-dropout-attention: 0
[2019-07-14 16:33:22] [config] transformer-dropout-ffn: 0
[2019-07-14 16:33:22] [config] transformer-ffn-activation: swish
[2019-07-14 16:33:22] [config] transformer-ffn-depth: 2
[2019-07-14 16:33:22] [config] transformer-guided-alignment-layer: last
[2019-07-14 16:33:22] [config] transformer-heads: 8
[2019-07-14 16:33:22] [config] transformer-no-projection: false
[2019-07-14 16:33:22] [config] transformer-postprocess: dan
[2019-07-14 16:33:22] [config] transformer-postprocess-emb: d
[2019-07-14 16:33:22] [config] transformer-preprocess: ""
[2019-07-14 16:33:22] [config] transformer-tied-layers:
[2019-07-14 16:33:22] [config]   []
[2019-07-14 16:33:22] [config] transformer-train-position-embeddings: false
[2019-07-14 16:33:22] [config] type: amun
[2019-07-14 16:33:22] [config] ulr: false
[2019-07-14 16:33:22] [config] ulr-dim-emb: 0
[2019-07-14 16:33:22] [config] ulr-dropout: 0
[2019-07-14 16:33:22] [config] ulr-keys-vectors: ""
[2019-07-14 16:33:22] [config] ulr-query-vectors: ""
[2019-07-14 16:33:22] [config] ulr-softmax-temperature: 1
[2019-07-14 16:33:22] [config] ulr-trainable-transformation: false
[2019-07-14 16:33:22] [config] valid-freq: 20000
[2019-07-14 16:33:22] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-14 16:33:22] [config] valid-max-length: 1000
[2019-07-14 16:33:22] [config] valid-metrics:
[2019-07-14 16:33:22] [config]   - cross-entropy
[2019-07-14 16:33:22] [config]   - perplexity
[2019-07-14 16:33:22] [config]   - translation
[2019-07-14 16:33:22] [config] valid-mini-batch: 8
[2019-07-14 16:33:22] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-14 16:33:22] [config] valid-sets:
[2019-07-14 16:33:22] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-14 16:33:22] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-14 16:33:22] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-14 16:33:22] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 16:33:22] [config] vocabs:
[2019-07-14 16:33:22] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-14 16:33:22] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-14 16:33:22] [config] word-penalty: 0
[2019-07-14 16:33:22] [config] workspace: 5000
[2019-07-14 16:33:22] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 16:33:22] Using synchronous training
[2019-07-14 16:33:22] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-14 16:33:23] [data] Using unused word id eos for 0
[2019-07-14 16:33:23] [data] Using unused word id UNK for 1
[2019-07-14 16:33:23] [data] Setting vocabulary size for input 0 to 50000
[2019-07-14 16:33:23] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-14 16:33:23] [data] Using unused word id eos for 0
[2019-07-14 16:33:23] [data] Using unused word id UNK for 1
[2019-07-14 16:33:23] [data] Setting vocabulary size for input 1 to 50000
[2019-07-14 16:33:23] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-14 16:33:23] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-14 16:33:24] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-14 16:33:25] [memory] Extending reserved space to 5120 MB (device gpu3)
[2019-07-14 16:33:25] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 16:33:26] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 16:33:26] [training] Using 2 GPUs
[2019-07-14 16:33:26] [memory] Reserving 422 MB, device gpu2
[2019-07-14 16:33:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-14 16:33:26] [memory] Reserving 422 MB, device gpu2
[2019-07-14 16:33:34] [batching] Done. Typical MB size is 13760 target words
[2019-07-14 16:33:35] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-14 16:33:35] [memory] Extending reserved space to 5120 MB (device gpu3)
[2019-07-14 16:33:35] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 16:33:35] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 16:33:35] [training] Using 2 GPUs
[2019-07-14 16:33:35] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-14 16:33:41] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-14 16:33:44] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-14 16:33:54] [memory] Reserving 422 MB, device gpu2
[2019-07-14 16:33:55] [memory] Reserving 422 MB, device gpu3
[2019-07-14 16:33:55] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 16:33:55] [data] Restoring the corpus state to epoch 20, batch 200000
[2019-07-14 16:33:55] [data] Shuffling data
[2019-07-14 16:33:59] [data] Done reading 4355038 sentences
[2019-07-14 16:34:19] [data] Done shuffling 4355038 sentences to temp files
[2019-07-14 16:35:27] Training started
[2019-07-14 16:35:27] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-14 16:35:27] [memory] Reserving 422 MB, device gpu2
[2019-07-14 16:35:27] [memory] Reserving 422 MB, device gpu3
[2019-07-14 16:35:27] [memory] Reserving 422 MB, device gpu3
[2019-07-14 16:35:27] [memory] Reserving 422 MB, device gpu2
[2019-07-14 16:35:27] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 16:35:34] [memory] Reserving 422 MB, device cpu0
[2019-07-14 16:35:34] [memory] Reserving 211 MB, device gpu2
[2019-07-14 16:35:34] [memory] Reserving 211 MB, device gpu3
[2019-07-14 16:52:31] Ep. 20 : Up. 202000 : Sen. 2,363,859 : Cost 47.11468124 : Time 1147.58s : 12880.56 words/s
[2019-07-14 17:09:27] Ep. 20 : Up. 204000 : Sen. 2,956,800 : Cost 47.16001511 : Time 1016.16s : 14450.22 words/s
[2019-07-14 17:25:53] Seen 3532755 samples
[2019-07-14 17:25:53] Starting epoch 21
[2019-07-14 17:25:53] [data] Shuffling data
[2019-07-14 17:25:56] [data] Done reading 4355038 sentences
[2019-07-14 17:26:17] [data] Done shuffling 4355038 sentences to temp files
[2019-07-14 17:26:51] Ep. 21 : Up. 206000 : Sen. 19,464 : Cost 47.27551270 : Time 1044.58s : 14126.12 words/s
[2019-07-14 17:43:51] Ep. 21 : Up. 208000 : Sen. 614,664 : Cost 46.27383041 : Time 1019.97s : 14441.35 words/s
[2019-07-14 18:00:51] Ep. 21 : Up. 210000 : Sen. 1,210,324 : Cost 46.78553391 : Time 1019.95s : 14477.58 words/s
[2019-07-14 18:17:50] Ep. 21 : Up. 212000 : Sen. 1,805,412 : Cost 46.64014816 : Time 1019.04s : 14452.52 words/s
[2019-07-14 18:34:50] Ep. 21 : Up. 214000 : Sen. 2,401,591 : Cost 46.85500336 : Time 1019.60s : 14479.91 words/s
[2019-07-14 18:51:46] Ep. 21 : Up. 216000 : Sen. 2,994,212 : Cost 46.96601486 : Time 1015.85s : 14445.09 words/s
[2019-07-14 19:07:08] Seen 3532755 samples
[2019-07-14 19:07:08] Starting epoch 22
[2019-07-14 19:07:08] [data] Shuffling data
[2019-07-14 19:07:10] [data] Done reading 4355038 sentences
[2019-07-14 19:07:29] [data] Done shuffling 4355038 sentences to temp files
[2019-07-14 19:09:11] Ep. 22 : Up. 218000 : Sen. 59,027 : Cost 46.98560715 : Time 1045.53s : 14160.50 words/s
[2019-07-14 19:26:06] Ep. 22 : Up. 220000 : Sen. 651,284 : Cost 46.17454910 : Time 1014.93s : 14439.06 words/s
[2019-07-14 19:26:06] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-14 19:26:16] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter220000.npz
[2019-07-14 19:26:24] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 19:26:34] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-14 19:26:55] [valid] Ep. 22 : Up. 220000 : cross-entropy : 46.5945 : new best
[2019-07-14 19:26:59] [valid] Ep. 22 : Up. 220000 : perplexity : 6.29426 : new best
[2019-07-14 19:27:24] Error: Unknown word id: 49990
[2019-07-14 19:27:24] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f5888b06a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f5888626c80]                                                       + 0xb8c80
[0x7f5888aff6ba]                                                       + 0x76ba
[0x7f5887d8c41d]    clone                                              + 0x6d

[2019-07-14 23:42:29] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 23:42:29] [marian] Running on hretha as process 7414 with command line:
[2019-07-14 23:42:29] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-14 23:42:30] [config] after-batches: 0
[2019-07-14 23:42:30] [config] after-epochs: 0
[2019-07-14 23:42:30] [config] allow-unk: false
[2019-07-14 23:42:30] [config] beam-size: 12
[2019-07-14 23:42:30] [config] bert-class-symbol: "[CLS]"
[2019-07-14 23:42:30] [config] bert-mask-symbol: "[MASK]"
[2019-07-14 23:42:30] [config] bert-masking-fraction: 0.15
[2019-07-14 23:42:30] [config] bert-sep-symbol: "[SEP]"
[2019-07-14 23:42:30] [config] bert-train-type-embeddings: true
[2019-07-14 23:42:30] [config] bert-type-vocab-size: 2
[2019-07-14 23:42:30] [config] best-deep: false
[2019-07-14 23:42:30] [config] clip-gemm: 0
[2019-07-14 23:42:30] [config] clip-norm: 1
[2019-07-14 23:42:30] [config] cost-type: ce-mean
[2019-07-14 23:42:30] [config] cpu-threads: 0
[2019-07-14 23:42:30] [config] data-weighting: ""
[2019-07-14 23:42:30] [config] data-weighting-type: sentence
[2019-07-14 23:42:30] [config] dec-cell: gru
[2019-07-14 23:42:30] [config] dec-cell-base-depth: 2
[2019-07-14 23:42:30] [config] dec-cell-high-depth: 1
[2019-07-14 23:42:30] [config] dec-depth: 1
[2019-07-14 23:42:30] [config] devices:
[2019-07-14 23:42:30] [config]   - 0
[2019-07-14 23:42:30] [config]   - 1
[2019-07-14 23:42:30] [config] dim-emb: 512
[2019-07-14 23:42:30] [config] dim-rnn: 1024
[2019-07-14 23:42:30] [config] dim-vocabs:
[2019-07-14 23:42:30] [config]   - 50000
[2019-07-14 23:42:30] [config]   - 50000
[2019-07-14 23:42:30] [config] disp-first: 0
[2019-07-14 23:42:30] [config] disp-freq: 2000
[2019-07-14 23:42:30] [config] disp-label-counts: false
[2019-07-14 23:42:30] [config] dropout-rnn: 0.2
[2019-07-14 23:42:30] [config] dropout-src: 0.1
[2019-07-14 23:42:30] [config] dropout-trg: 0.1
[2019-07-14 23:42:30] [config] dump-config: ""
[2019-07-14 23:42:30] [config] early-stopping: 5
[2019-07-14 23:42:30] [config] embedding-fix-src: false
[2019-07-14 23:42:30] [config] embedding-fix-trg: false
[2019-07-14 23:42:30] [config] embedding-normalization: false
[2019-07-14 23:42:30] [config] embedding-vectors:
[2019-07-14 23:42:30] [config]   []
[2019-07-14 23:42:30] [config] enc-cell: gru
[2019-07-14 23:42:30] [config] enc-cell-depth: 1
[2019-07-14 23:42:30] [config] enc-depth: 1
[2019-07-14 23:42:30] [config] enc-type: bidirectional
[2019-07-14 23:42:30] [config] exponential-smoothing: 0.0001
[2019-07-14 23:42:30] [config] grad-dropping-momentum: 0
[2019-07-14 23:42:30] [config] grad-dropping-rate: 0
[2019-07-14 23:42:30] [config] grad-dropping-warmup: 100
[2019-07-14 23:42:30] [config] guided-alignment: none
[2019-07-14 23:42:30] [config] guided-alignment-cost: mse
[2019-07-14 23:42:30] [config] guided-alignment-weight: 0.1
[2019-07-14 23:42:30] [config] ignore-model-config: false
[2019-07-14 23:42:30] [config] input-types:
[2019-07-14 23:42:30] [config]   []
[2019-07-14 23:42:30] [config] interpolate-env-vars: false
[2019-07-14 23:42:30] [config] keep-best: false
[2019-07-14 23:42:30] [config] label-smoothing: 0
[2019-07-14 23:42:30] [config] layer-normalization: true
[2019-07-14 23:42:30] [config] learn-rate: 0.0001
[2019-07-14 23:42:30] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-14 23:42:30] [config] log-level: info
[2019-07-14 23:42:30] [config] log-time-zone: ""
[2019-07-14 23:42:30] [config] lr-decay: 0
[2019-07-14 23:42:30] [config] lr-decay-freq: 50000
[2019-07-14 23:42:30] [config] lr-decay-inv-sqrt:
[2019-07-14 23:42:30] [config]   - 0
[2019-07-14 23:42:30] [config] lr-decay-repeat-warmup: false
[2019-07-14 23:42:30] [config] lr-decay-reset-optimizer: false
[2019-07-14 23:42:30] [config] lr-decay-start:
[2019-07-14 23:42:30] [config]   - 10
[2019-07-14 23:42:30] [config]   - 1
[2019-07-14 23:42:30] [config] lr-decay-strategy: epoch+stalled
[2019-07-14 23:42:30] [config] lr-report: false
[2019-07-14 23:42:30] [config] lr-warmup: 0
[2019-07-14 23:42:30] [config] lr-warmup-at-reload: false
[2019-07-14 23:42:30] [config] lr-warmup-cycle: false
[2019-07-14 23:42:30] [config] lr-warmup-start-rate: 0
[2019-07-14 23:42:30] [config] max-length: 50
[2019-07-14 23:42:30] [config] max-length-crop: false
[2019-07-14 23:42:30] [config] max-length-factor: 3
[2019-07-14 23:42:30] [config] maxi-batch: 100
[2019-07-14 23:42:30] [config] maxi-batch-sort: trg
[2019-07-14 23:42:30] [config] mini-batch: 64
[2019-07-14 23:42:30] [config] mini-batch-fit: true
[2019-07-14 23:42:30] [config] mini-batch-fit-step: 10
[2019-07-14 23:42:30] [config] mini-batch-overstuff: 1
[2019-07-14 23:42:30] [config] mini-batch-track-lr: false
[2019-07-14 23:42:30] [config] mini-batch-understuff: 1
[2019-07-14 23:42:30] [config] mini-batch-warmup: 0
[2019-07-14 23:42:30] [config] mini-batch-words: 0
[2019-07-14 23:42:30] [config] mini-batch-words-ref: 0
[2019-07-14 23:42:30] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 23:42:30] [config] multi-loss-type: sum
[2019-07-14 23:42:30] [config] multi-node: false
[2019-07-14 23:42:30] [config] multi-node-overlap: true
[2019-07-14 23:42:30] [config] n-best: false
[2019-07-14 23:42:30] [config] no-nccl: false
[2019-07-14 23:42:30] [config] no-reload: false
[2019-07-14 23:42:30] [config] no-restore-corpus: false
[2019-07-14 23:42:30] [config] no-shuffle: false
[2019-07-14 23:42:30] [config] normalize: 1
[2019-07-14 23:42:30] [config] num-devices: 0
[2019-07-14 23:42:30] [config] optimizer: adam
[2019-07-14 23:42:30] [config] optimizer-delay: 1
[2019-07-14 23:42:30] [config] optimizer-params:
[2019-07-14 23:42:30] [config]   []
[2019-07-14 23:42:30] [config] overwrite: false
[2019-07-14 23:42:30] [config] pretrained-model: ""
[2019-07-14 23:42:30] [config] quiet: false
[2019-07-14 23:42:30] [config] quiet-translation: true
[2019-07-14 23:42:30] [config] relative-paths: false
[2019-07-14 23:42:30] [config] right-left: false
[2019-07-14 23:42:30] [config] save-freq: 20000
[2019-07-14 23:42:30] [config] seed: 1111
[2019-07-14 23:42:30] [config] shuffle-in-ram: false
[2019-07-14 23:42:30] [config] skip: false
[2019-07-14 23:42:30] [config] sqlite: ""
[2019-07-14 23:42:30] [config] sqlite-drop: false
[2019-07-14 23:42:30] [config] sync-sgd: true
[2019-07-14 23:42:30] [config] tempdir: .
[2019-07-14 23:42:30] [config] tied-embeddings: false
[2019-07-14 23:42:30] [config] tied-embeddings-all: false
[2019-07-14 23:42:30] [config] tied-embeddings-src: false
[2019-07-14 23:42:30] [config] train-sets:
[2019-07-14 23:42:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-14 23:42:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-14 23:42:30] [config] transformer-aan-activation: swish
[2019-07-14 23:42:30] [config] transformer-aan-depth: 2
[2019-07-14 23:42:30] [config] transformer-aan-nogate: false
[2019-07-14 23:42:30] [config] transformer-decoder-autoreg: self-attention
[2019-07-14 23:42:30] [config] transformer-dim-aan: 2048
[2019-07-14 23:42:30] [config] transformer-dim-ffn: 2048
[2019-07-14 23:42:30] [config] transformer-dropout: 0
[2019-07-14 23:42:30] [config] transformer-dropout-attention: 0
[2019-07-14 23:42:30] [config] transformer-dropout-ffn: 0
[2019-07-14 23:42:30] [config] transformer-ffn-activation: swish
[2019-07-14 23:42:30] [config] transformer-ffn-depth: 2
[2019-07-14 23:42:30] [config] transformer-guided-alignment-layer: last
[2019-07-14 23:42:30] [config] transformer-heads: 8
[2019-07-14 23:42:30] [config] transformer-no-projection: false
[2019-07-14 23:42:30] [config] transformer-postprocess: dan
[2019-07-14 23:42:30] [config] transformer-postprocess-emb: d
[2019-07-14 23:42:30] [config] transformer-preprocess: ""
[2019-07-14 23:42:30] [config] transformer-tied-layers:
[2019-07-14 23:42:30] [config]   []
[2019-07-14 23:42:30] [config] transformer-train-position-embeddings: false
[2019-07-14 23:42:30] [config] type: amun
[2019-07-14 23:42:30] [config] ulr: false
[2019-07-14 23:42:30] [config] ulr-dim-emb: 0
[2019-07-14 23:42:30] [config] ulr-dropout: 0
[2019-07-14 23:42:30] [config] ulr-keys-vectors: ""
[2019-07-14 23:42:30] [config] ulr-query-vectors: ""
[2019-07-14 23:42:30] [config] ulr-softmax-temperature: 1
[2019-07-14 23:42:30] [config] ulr-trainable-transformation: false
[2019-07-14 23:42:30] [config] valid-freq: 20000
[2019-07-14 23:42:30] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-14 23:42:30] [config] valid-max-length: 1000
[2019-07-14 23:42:30] [config] valid-metrics:
[2019-07-14 23:42:30] [config]   - cross-entropy
[2019-07-14 23:42:30] [config]   - perplexity
[2019-07-14 23:42:30] [config]   - translation
[2019-07-14 23:42:30] [config] valid-mini-batch: 8
[2019-07-14 23:42:30] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-14 23:42:30] [config] valid-sets:
[2019-07-14 23:42:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-14 23:42:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-14 23:42:30] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-14 23:42:30] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 23:42:30] [config] vocabs:
[2019-07-14 23:42:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-14 23:42:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-14 23:42:30] [config] word-penalty: 0
[2019-07-14 23:42:30] [config] workspace: 5000
[2019-07-14 23:42:30] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 23:42:30] Using synchronous training
[2019-07-14 23:42:30] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-14 23:42:30] [data] Using unused word id eos for 0
[2019-07-14 23:42:30] [data] Using unused word id UNK for 1
[2019-07-14 23:42:30] [data] Setting vocabulary size for input 0 to 50000
[2019-07-14 23:42:30] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-14 23:42:30] [data] Using unused word id eos for 0
[2019-07-14 23:42:30] [data] Using unused word id UNK for 1
[2019-07-14 23:42:30] [data] Setting vocabulary size for input 1 to 50000
[2019-07-14 23:42:30] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-14 23:42:30] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-14 23:42:31] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-14 23:42:32] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-14 23:42:33] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 23:42:33] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 23:42:33] [training] Using 2 GPUs
[2019-07-14 23:42:33] [memory] Reserving 422 MB, device gpu0
[2019-07-14 23:42:33] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-14 23:42:33] [memory] Reserving 422 MB, device gpu0
[2019-07-14 23:42:41] [batching] Done. Typical MB size is 13760 target words
[2019-07-14 23:42:41] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-14 23:42:42] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-14 23:42:42] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 23:42:42] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 23:42:42] [training] Using 2 GPUs
[2019-07-14 23:42:42] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-14 23:42:48] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-14 23:42:51] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-14 23:43:03] [memory] Reserving 422 MB, device gpu0
[2019-07-14 23:43:03] [memory] Reserving 422 MB, device gpu1
[2019-07-14 23:43:04] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 23:43:04] [data] Restoring the corpus state to epoch 22, batch 220000
[2019-07-14 23:43:04] [data] Shuffling data
[2019-07-14 23:43:07] [data] Done reading 4355038 sentences
[2019-07-14 23:43:27] [data] Done shuffling 4355038 sentences to temp files
[2019-07-14 23:44:01] Training started
[2019-07-14 23:44:01] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-14 23:44:01] [memory] Reserving 422 MB, device gpu0
[2019-07-14 23:44:01] [memory] Reserving 422 MB, device gpu1
[2019-07-14 23:44:01] [memory] Reserving 422 MB, device gpu0
[2019-07-14 23:44:01] [memory] Reserving 422 MB, device gpu1
[2019-07-14 23:44:01] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-14 23:44:08] [memory] Reserving 422 MB, device cpu0
[2019-07-14 23:44:08] [memory] Reserving 211 MB, device gpu0
[2019-07-14 23:44:08] [memory] Reserving 211 MB, device gpu1
[2019-07-15 00:00:38] Ep. 22 : Up. 222000 : Sen. 1,245,080 : Cost 46.35921097 : Time 1087.61s : 13508.23 words/s
[2019-07-15 00:17:13] Ep. 22 : Up. 224000 : Sen. 1,840,946 : Cost 46.54380035 : Time 994.91s : 14836.64 words/s
[2019-07-15 00:33:48] Ep. 22 : Up. 226000 : Sen. 2,435,880 : Cost 46.66353989 : Time 994.63s : 14818.58 words/s
[2019-07-15 00:50:26] Ep. 22 : Up. 228000 : Sen. 3,032,196 : Cost 46.88158798 : Time 997.92s : 14806.32 words/s
[2019-07-15 01:04:20] Seen 3532755 samples
[2019-07-15 01:04:20] Starting epoch 23
[2019-07-15 01:04:20] [data] Shuffling data
[2019-07-15 01:04:23] [data] Done reading 4355038 sentences
[2019-07-15 01:04:43] [data] Done shuffling 4355038 sentences to temp files
[2019-07-15 01:07:25] Ep. 23 : Up. 230000 : Sen. 96,894 : Cost 46.46009064 : Time 1019.89s : 14482.83 words/s
[2019-07-15 01:23:58] Ep. 23 : Up. 232000 : Sen. 691,200 : Cost 46.00424194 : Time 992.60s : 14827.50 words/s
[2019-07-15 01:40:33] Ep. 23 : Up. 234000 : Sen. 1,288,640 : Cost 46.27093887 : Time 994.52s : 14876.00 words/s
[2019-07-15 01:57:05] Ep. 23 : Up. 236000 : Sen. 1,883,184 : Cost 46.38196945 : Time 992.26s : 14854.84 words/s
[2019-07-15 02:13:36] Ep. 23 : Up. 238000 : Sen. 2,477,592 : Cost 46.47039795 : Time 990.89s : 14856.89 words/s
[2019-07-15 02:30:08] Ep. 23 : Up. 240000 : Sen. 3,073,812 : Cost 46.67760468 : Time 991.84s : 14870.78 words/s
[2019-07-15 02:30:08] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-15 02:30:17] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter240000.npz
[2019-07-15 02:30:24] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 02:30:34] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-15 02:30:55] [valid] Ep. 23 : Up. 240000 : cross-entropy : 46.4905 : new best
[2019-07-15 02:30:59] [valid] Ep. 23 : Up. 240000 : perplexity : 6.26846 : new best
[2019-07-15 02:31:23] Error: Unknown word id: 49990
[2019-07-15 02:31:23] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f15acd77a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f15ac897c80]                                                       + 0xb8c80
[0x7f15acd706ba]                                                       + 0x76ba
[0x7f15abffd41d]    clone                                              + 0x6d

[2019-07-15 15:41:04] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-15 15:41:04] [marian] Running on hretha as process 21172 with command line:
[2019-07-15 15:41:04] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 2 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-15 15:41:04] [config] after-batches: 0
[2019-07-15 15:41:04] [config] after-epochs: 0
[2019-07-15 15:41:04] [config] allow-unk: false
[2019-07-15 15:41:04] [config] beam-size: 12
[2019-07-15 15:41:04] [config] bert-class-symbol: "[CLS]"
[2019-07-15 15:41:04] [config] bert-mask-symbol: "[MASK]"
[2019-07-15 15:41:04] [config] bert-masking-fraction: 0.15
[2019-07-15 15:41:04] [config] bert-sep-symbol: "[SEP]"
[2019-07-15 15:41:04] [config] bert-train-type-embeddings: true
[2019-07-15 15:41:04] [config] bert-type-vocab-size: 2
[2019-07-15 15:41:04] [config] best-deep: false
[2019-07-15 15:41:04] [config] clip-gemm: 0
[2019-07-15 15:41:04] [config] clip-norm: 1
[2019-07-15 15:41:04] [config] cost-type: ce-mean
[2019-07-15 15:41:04] [config] cpu-threads: 0
[2019-07-15 15:41:04] [config] data-weighting: ""
[2019-07-15 15:41:04] [config] data-weighting-type: sentence
[2019-07-15 15:41:04] [config] dec-cell: gru
[2019-07-15 15:41:04] [config] dec-cell-base-depth: 2
[2019-07-15 15:41:04] [config] dec-cell-high-depth: 1
[2019-07-15 15:41:04] [config] dec-depth: 1
[2019-07-15 15:41:04] [config] devices:
[2019-07-15 15:41:04] [config]   - 2
[2019-07-15 15:41:04] [config] dim-emb: 512
[2019-07-15 15:41:04] [config] dim-rnn: 1024
[2019-07-15 15:41:04] [config] dim-vocabs:
[2019-07-15 15:41:04] [config]   - 50000
[2019-07-15 15:41:04] [config]   - 50000
[2019-07-15 15:41:04] [config] disp-first: 0
[2019-07-15 15:41:04] [config] disp-freq: 2000
[2019-07-15 15:41:04] [config] disp-label-counts: false
[2019-07-15 15:41:04] [config] dropout-rnn: 0.2
[2019-07-15 15:41:04] [config] dropout-src: 0.1
[2019-07-15 15:41:04] [config] dropout-trg: 0.1
[2019-07-15 15:41:04] [config] dump-config: ""
[2019-07-15 15:41:04] [config] early-stopping: 5
[2019-07-15 15:41:04] [config] embedding-fix-src: false
[2019-07-15 15:41:04] [config] embedding-fix-trg: false
[2019-07-15 15:41:04] [config] embedding-normalization: false
[2019-07-15 15:41:04] [config] embedding-vectors:
[2019-07-15 15:41:04] [config]   []
[2019-07-15 15:41:04] [config] enc-cell: gru
[2019-07-15 15:41:04] [config] enc-cell-depth: 1
[2019-07-15 15:41:04] [config] enc-depth: 1
[2019-07-15 15:41:04] [config] enc-type: bidirectional
[2019-07-15 15:41:04] [config] exponential-smoothing: 0.0001
[2019-07-15 15:41:04] [config] grad-dropping-momentum: 0
[2019-07-15 15:41:04] [config] grad-dropping-rate: 0
[2019-07-15 15:41:04] [config] grad-dropping-warmup: 100
[2019-07-15 15:41:04] [config] guided-alignment: none
[2019-07-15 15:41:04] [config] guided-alignment-cost: mse
[2019-07-15 15:41:04] [config] guided-alignment-weight: 0.1
[2019-07-15 15:41:04] [config] ignore-model-config: false
[2019-07-15 15:41:04] [config] input-types:
[2019-07-15 15:41:04] [config]   []
[2019-07-15 15:41:04] [config] interpolate-env-vars: false
[2019-07-15 15:41:04] [config] keep-best: false
[2019-07-15 15:41:04] [config] label-smoothing: 0
[2019-07-15 15:41:04] [config] layer-normalization: true
[2019-07-15 15:41:04] [config] learn-rate: 0.0001
[2019-07-15 15:41:04] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-15 15:41:04] [config] log-level: info
[2019-07-15 15:41:04] [config] log-time-zone: ""
[2019-07-15 15:41:04] [config] lr-decay: 0
[2019-07-15 15:41:04] [config] lr-decay-freq: 50000
[2019-07-15 15:41:04] [config] lr-decay-inv-sqrt:
[2019-07-15 15:41:04] [config]   - 0
[2019-07-15 15:41:04] [config] lr-decay-repeat-warmup: false
[2019-07-15 15:41:04] [config] lr-decay-reset-optimizer: false
[2019-07-15 15:41:04] [config] lr-decay-start:
[2019-07-15 15:41:04] [config]   - 10
[2019-07-15 15:41:04] [config]   - 1
[2019-07-15 15:41:04] [config] lr-decay-strategy: epoch+stalled
[2019-07-15 15:41:04] [config] lr-report: false
[2019-07-15 15:41:04] [config] lr-warmup: 0
[2019-07-15 15:41:04] [config] lr-warmup-at-reload: false
[2019-07-15 15:41:04] [config] lr-warmup-cycle: false
[2019-07-15 15:41:04] [config] lr-warmup-start-rate: 0
[2019-07-15 15:41:04] [config] max-length: 50
[2019-07-15 15:41:04] [config] max-length-crop: false
[2019-07-15 15:41:04] [config] max-length-factor: 3
[2019-07-15 15:41:04] [config] maxi-batch: 100
[2019-07-15 15:41:04] [config] maxi-batch-sort: trg
[2019-07-15 15:41:04] [config] mini-batch: 64
[2019-07-15 15:41:04] [config] mini-batch-fit: true
[2019-07-15 15:41:04] [config] mini-batch-fit-step: 10
[2019-07-15 15:41:04] [config] mini-batch-overstuff: 1
[2019-07-15 15:41:04] [config] mini-batch-track-lr: false
[2019-07-15 15:41:04] [config] mini-batch-understuff: 1
[2019-07-15 15:41:04] [config] mini-batch-warmup: 0
[2019-07-15 15:41:04] [config] mini-batch-words: 0
[2019-07-15 15:41:04] [config] mini-batch-words-ref: 0
[2019-07-15 15:41:04] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 15:41:04] [config] multi-loss-type: sum
[2019-07-15 15:41:04] [config] multi-node: false
[2019-07-15 15:41:04] [config] multi-node-overlap: true
[2019-07-15 15:41:04] [config] n-best: false
[2019-07-15 15:41:04] [config] no-nccl: false
[2019-07-15 15:41:04] [config] no-reload: false
[2019-07-15 15:41:04] [config] no-restore-corpus: false
[2019-07-15 15:41:04] [config] no-shuffle: false
[2019-07-15 15:41:04] [config] normalize: 1
[2019-07-15 15:41:04] [config] num-devices: 0
[2019-07-15 15:41:04] [config] optimizer: adam
[2019-07-15 15:41:04] [config] optimizer-delay: 1
[2019-07-15 15:41:04] [config] optimizer-params:
[2019-07-15 15:41:04] [config]   []
[2019-07-15 15:41:04] [config] overwrite: false
[2019-07-15 15:41:04] [config] pretrained-model: ""
[2019-07-15 15:41:04] [config] quiet: false
[2019-07-15 15:41:04] [config] quiet-translation: true
[2019-07-15 15:41:04] [config] relative-paths: false
[2019-07-15 15:41:04] [config] right-left: false
[2019-07-15 15:41:04] [config] save-freq: 20000
[2019-07-15 15:41:04] [config] seed: 1111
[2019-07-15 15:41:04] [config] shuffle-in-ram: false
[2019-07-15 15:41:04] [config] skip: false
[2019-07-15 15:41:04] [config] sqlite: ""
[2019-07-15 15:41:04] [config] sqlite-drop: false
[2019-07-15 15:41:04] [config] sync-sgd: true
[2019-07-15 15:41:04] [config] tempdir: .
[2019-07-15 15:41:04] [config] tied-embeddings: false
[2019-07-15 15:41:04] [config] tied-embeddings-all: false
[2019-07-15 15:41:04] [config] tied-embeddings-src: false
[2019-07-15 15:41:04] [config] train-sets:
[2019-07-15 15:41:04] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-15 15:41:04] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-15 15:41:04] [config] transformer-aan-activation: swish
[2019-07-15 15:41:04] [config] transformer-aan-depth: 2
[2019-07-15 15:41:04] [config] transformer-aan-nogate: false
[2019-07-15 15:41:04] [config] transformer-decoder-autoreg: self-attention
[2019-07-15 15:41:04] [config] transformer-dim-aan: 2048
[2019-07-15 15:41:04] [config] transformer-dim-ffn: 2048
[2019-07-15 15:41:04] [config] transformer-dropout: 0
[2019-07-15 15:41:04] [config] transformer-dropout-attention: 0
[2019-07-15 15:41:04] [config] transformer-dropout-ffn: 0
[2019-07-15 15:41:04] [config] transformer-ffn-activation: swish
[2019-07-15 15:41:04] [config] transformer-ffn-depth: 2
[2019-07-15 15:41:04] [config] transformer-guided-alignment-layer: last
[2019-07-15 15:41:04] [config] transformer-heads: 8
[2019-07-15 15:41:04] [config] transformer-no-projection: false
[2019-07-15 15:41:04] [config] transformer-postprocess: dan
[2019-07-15 15:41:04] [config] transformer-postprocess-emb: d
[2019-07-15 15:41:04] [config] transformer-preprocess: ""
[2019-07-15 15:41:04] [config] transformer-tied-layers:
[2019-07-15 15:41:04] [config]   []
[2019-07-15 15:41:04] [config] transformer-train-position-embeddings: false
[2019-07-15 15:41:04] [config] type: amun
[2019-07-15 15:41:04] [config] ulr: false
[2019-07-15 15:41:04] [config] ulr-dim-emb: 0
[2019-07-15 15:41:04] [config] ulr-dropout: 0
[2019-07-15 15:41:04] [config] ulr-keys-vectors: ""
[2019-07-15 15:41:04] [config] ulr-query-vectors: ""
[2019-07-15 15:41:04] [config] ulr-softmax-temperature: 1
[2019-07-15 15:41:04] [config] ulr-trainable-transformation: false
[2019-07-15 15:41:04] [config] valid-freq: 20000
[2019-07-15 15:41:04] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-15 15:41:04] [config] valid-max-length: 1000
[2019-07-15 15:41:04] [config] valid-metrics:
[2019-07-15 15:41:04] [config]   - cross-entropy
[2019-07-15 15:41:04] [config]   - perplexity
[2019-07-15 15:41:04] [config]   - translation
[2019-07-15 15:41:04] [config] valid-mini-batch: 8
[2019-07-15 15:41:04] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-15 15:41:04] [config] valid-sets:
[2019-07-15 15:41:04] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-15 15:41:04] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-15 15:41:04] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-15 15:41:04] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-15 15:41:04] [config] vocabs:
[2019-07-15 15:41:04] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-15 15:41:04] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-15 15:41:04] [config] word-penalty: 0
[2019-07-15 15:41:04] [config] workspace: 5000
[2019-07-15 15:41:04] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-15 15:41:04] Using synchronous training
[2019-07-15 15:41:04] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-15 15:41:05] [data] Using unused word id eos for 0
[2019-07-15 15:41:05] [data] Using unused word id UNK for 1
[2019-07-15 15:41:05] [data] Setting vocabulary size for input 0 to 50000
[2019-07-15 15:41:05] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-15 15:41:05] [data] Using unused word id eos for 0
[2019-07-15 15:41:05] [data] Using unused word id UNK for 1
[2019-07-15 15:41:05] [data] Setting vocabulary size for input 1 to 50000
[2019-07-15 15:41:05] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-15 15:41:05] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-15 15:41:06] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-15 15:41:06] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-15 15:41:06] [comm] NCCLCommunicator constructed successfully.
[2019-07-15 15:41:06] [training] Using 1 GPUs
[2019-07-15 15:41:06] [memory] Reserving 422 MB, device gpu2
[2019-07-15 15:41:06] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-15 15:41:06] [memory] Reserving 422 MB, device gpu2
[2019-07-15 15:41:15] [batching] Done. Typical MB size is 6880 target words
[2019-07-15 15:41:15] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-15 15:41:15] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-15 15:41:15] [comm] NCCLCommunicator constructed successfully.
[2019-07-15 15:41:15] [training] Using 1 GPUs
[2019-07-15 15:41:15] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-15 15:41:22] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-15 15:41:32] [memory] Reserving 844 MB, device gpu2
[2019-07-15 15:41:33] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 15:41:33] [data] Restoring the corpus state to epoch 23, batch 240000
[2019-07-15 15:41:33] [data] Shuffling data
[2019-07-15 15:41:36] [data] Done reading 4355038 sentences
[2019-07-15 15:41:56] [data] Done shuffling 4355038 sentences to temp files
[2019-07-15 15:42:59] Training started
[2019-07-15 15:42:59] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-15 15:42:59] [memory] Reserving 422 MB, device gpu2
[2019-07-15 15:43:00] [memory] Reserving 422 MB, device gpu2
[2019-07-15 15:43:00] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 15:43:06] [memory] Reserving 422 MB, device cpu0
[2019-07-15 15:43:07] [memory] Reserving 422 MB, device gpu2
[2019-07-15 15:58:00] Ep. 23 : Up. 242000 : Sen. 3,385,126 : Cost 45.86261749 : Time 1014.29s : 7618.52 words/s
[2019-07-15 16:12:57] Ep. 23 : Up. 244000 : Sen. 3,696,848 : Cost 45.81392288 : Time 897.47s : 8588.15 words/s
[2019-07-15 16:27:54] Ep. 23 : Up. 246000 : Sen. 4,007,697 : Cost 46.20447922 : Time 896.54s : 8596.53 words/s
[2019-07-15 16:42:55] Ep. 23 : Up. 248000 : Sen. 4,320,471 : Cost 46.19155502 : Time 901.30s : 8582.77 words/s
[2019-07-15 16:57:58] Ep. 23 : Up. 250000 : Sen. 4,631,911 : Cost 46.81156158 : Time 902.70s : 8547.20 words/s
[2019-07-15 17:13:06] Ep. 23 : Up. 252000 : Sen. 4,944,146 : Cost 47.28259659 : Time 908.42s : 8501.65 words/s
[2019-07-15 17:15:37] Seen 4996267 samples
[2019-07-15 17:15:37] Starting epoch 24
[2019-07-15 17:15:37] [data] Shuffling data
[2019-07-15 17:15:41] [data] Done reading 4355038 sentences
[2019-07-15 17:16:16] [data] Done shuffling 4355038 sentences to temp files
[2019-07-15 17:28:52] Ep. 24 : Up. 254000 : Sen. 259,425 : Cost 46.35892105 : Time 945.75s : 8175.27 words/s
[2019-07-15 17:43:56] Ep. 24 : Up. 256000 : Sen. 570,766 : Cost 46.17262268 : Time 903.90s : 8524.81 words/s
[2019-07-15 17:59:00] Ep. 24 : Up. 258000 : Sen. 882,565 : Cost 46.20080566 : Time 904.11s : 8541.13 words/s
[2019-07-15 18:14:07] Ep. 24 : Up. 260000 : Sen. 1,194,825 : Cost 46.29779816 : Time 906.84s : 8523.27 words/s
[2019-07-15 18:14:07] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-15 18:14:19] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter260000.npz
[2019-07-15 18:14:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 18:14:41] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-15 18:15:05] [valid] Ep. 24 : Up. 260000 : cross-entropy : 46.5096 : new best
[2019-07-15 18:15:13] [valid] Ep. 24 : Up. 260000 : perplexity : 6.27318 : new best
[2019-07-15 18:16:18] [valid] Ep. 24 : Up. 260000 : translation : 31.8 : new best
[2019-07-15 18:31:22] Ep. 24 : Up. 262000 : Sen. 1,506,042 : Cost 46.49840546 : Time 1035.61s : 7433.60 words/s
[2019-07-15 18:46:28] Ep. 24 : Up. 264000 : Sen. 1,818,400 : Cost 46.58887863 : Time 906.02s : 8543.78 words/s
[2019-07-15 19:01:34] Ep. 24 : Up. 266000 : Sen. 2,130,400 : Cost 46.68986130 : Time 905.77s : 8537.66 words/s
[2019-07-15 19:16:39] Ep. 24 : Up. 268000 : Sen. 2,442,415 : Cost 46.57963181 : Time 904.89s : 8529.74 words/s
[2019-07-15 19:31:47] Ep. 24 : Up. 270000 : Sen. 2,754,685 : Cost 46.77763367 : Time 907.65s : 8531.86 words/s
[2019-07-15 19:46:50] Ep. 24 : Up. 272000 : Sen. 3,066,299 : Cost 46.61542130 : Time 903.38s : 8521.95 words/s
[2019-07-15 20:01:56] Ep. 24 : Up. 274000 : Sen. 3,377,667 : Cost 47.01434326 : Time 906.05s : 8511.89 words/s
[2019-07-15 20:09:25] Seen 3532755 samples
[2019-07-15 20:09:25] Starting epoch 25
[2019-07-15 20:09:25] [data] Shuffling data
[2019-07-15 20:09:28] [data] Done reading 4355038 sentences
[2019-07-15 20:09:49] [data] Done shuffling 4355038 sentences to temp files
[2019-07-15 20:17:29] Ep. 25 : Up. 276000 : Sen. 157,301 : Cost 46.10889053 : Time 933.29s : 8285.07 words/s
[2019-07-15 20:32:39] Ep. 25 : Up. 278000 : Sen. 469,867 : Cost 45.93689346 : Time 909.72s : 8516.16 words/s
[2019-07-15 20:47:43] Ep. 25 : Up. 280000 : Sen. 780,362 : Cost 46.06464386 : Time 904.30s : 8501.47 words/s
[2019-07-15 20:47:43] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-15 20:47:52] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter280000.npz
[2019-07-15 20:47:59] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 20:48:09] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-15 20:48:33] [valid] Ep. 25 : Up. 280000 : cross-entropy : 46.5156 : stalled 1 times (last best: 46.5096)
[2019-07-15 20:48:41] [valid] Ep. 25 : Up. 280000 : perplexity : 6.27467 : stalled 1 times (last best: 6.27318)
[2019-07-15 20:49:45] [valid] Ep. 25 : Up. 280000 : translation : 31.8 : stalled 1 times (last best: 31.8)
[2019-07-15 21:04:53] Ep. 25 : Up. 282000 : Sen. 1,092,722 : Cost 46.02740097 : Time 1029.93s : 7501.97 words/s
[2019-07-15 21:20:01] Ep. 25 : Up. 284000 : Sen. 1,405,076 : Cost 46.18932343 : Time 907.88s : 8520.44 words/s
[2019-07-15 21:35:04] Ep. 25 : Up. 286000 : Sen. 1,715,332 : Cost 46.30452728 : Time 902.47s : 8526.41 words/s
[2019-07-15 21:50:09] Ep. 25 : Up. 288000 : Sen. 2,026,596 : Cost 46.28424072 : Time 905.06s : 8516.43 words/s
[2019-07-15 22:05:12] Ep. 25 : Up. 290000 : Sen. 2,339,221 : Cost 46.50324631 : Time 903.70s : 8556.71 words/s
[2019-07-15 22:20:18] Ep. 25 : Up. 292000 : Sen. 2,651,506 : Cost 46.33785629 : Time 905.68s : 8536.31 words/s
[2019-07-15 22:35:24] Ep. 25 : Up. 294000 : Sen. 2,963,464 : Cost 46.22045135 : Time 906.18s : 8518.31 words/s
[2019-07-15 22:50:29] Ep. 25 : Up. 296000 : Sen. 3,275,430 : Cost 46.76683807 : Time 904.63s : 8547.69 words/s
[2019-07-15 23:02:57] Seen 3532755 samples
[2019-07-15 23:02:57] Starting epoch 26
[2019-07-15 23:02:57] [data] Shuffling data
[2019-07-15 23:03:00] [data] Done reading 4355038 sentences
[2019-07-15 23:03:20] [data] Done shuffling 4355038 sentences to temp files
[2019-07-15 23:06:04] Ep. 26 : Up. 298000 : Sen. 53,907 : Cost 46.62837219 : Time 935.36s : 8251.60 words/s
[2019-07-15 23:21:08] Ep. 26 : Up. 300000 : Sen. 366,691 : Cost 45.51264954 : Time 904.23s : 8563.29 words/s
[2019-07-15 23:21:08] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-15 23:21:18] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter300000.npz
[2019-07-15 23:21:26] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-15 23:21:37] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-15 23:22:10] [valid] Ep. 26 : Up. 300000 : cross-entropy : 46.4288 : new best
[2019-07-15 23:22:18] [valid] Ep. 26 : Up. 300000 : perplexity : 6.25321 : new best
[2019-07-15 23:23:22] [valid] Ep. 26 : Up. 300000 : translation : 31.77 : stalled 2 times (last best: 31.8)
[2019-07-15 23:38:26] Ep. 26 : Up. 302000 : Sen. 678,532 : Cost 45.65553665 : Time 1037.15s : 7433.02 words/s
[2019-07-15 23:53:28] Ep. 26 : Up. 304000 : Sen. 990,032 : Cost 46.04808807 : Time 902.62s : 8546.25 words/s
[2019-07-16 00:08:28] Ep. 26 : Up. 306000 : Sen. 1,301,233 : Cost 45.67484283 : Time 900.18s : 8544.18 words/s
[2019-07-16 00:23:35] Ep. 26 : Up. 308000 : Sen. 1,612,932 : Cost 46.33595657 : Time 906.73s : 8526.15 words/s
[2019-07-16 00:38:42] Ep. 26 : Up. 310000 : Sen. 1,924,855 : Cost 46.28527069 : Time 907.41s : 8515.64 words/s
[2019-07-16 00:53:48] Ep. 26 : Up. 312000 : Sen. 2,236,936 : Cost 46.08855438 : Time 905.46s : 8528.59 words/s
[2019-07-16 01:08:53] Ep. 26 : Up. 314000 : Sen. 2,547,944 : Cost 46.29472733 : Time 904.60s : 8520.14 words/s
[2019-07-16 01:23:59] Ep. 26 : Up. 316000 : Sen. 2,860,320 : Cost 46.21928787 : Time 906.15s : 8534.33 words/s
[2019-07-16 01:39:03] Ep. 26 : Up. 318000 : Sen. 3,171,804 : Cost 46.29173660 : Time 904.63s : 8522.72 words/s
[2019-07-16 01:54:09] Ep. 26 : Up. 320000 : Sen. 3,483,471 : Cost 46.68131638 : Time 905.63s : 8540.45 words/s
[2019-07-16 01:54:09] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-16 01:54:22] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter320000.npz
[2019-07-16 01:54:29] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 01:54:41] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-16 01:55:06] [valid] Ep. 26 : Up. 320000 : cross-entropy : 46.3431 : new best
[2019-07-16 01:55:13] [valid] Ep. 26 : Up. 320000 : perplexity : 6.23208 : new best
[2019-07-16 01:55:53] Error: Unknown word id: 49990
[2019-07-16 01:55:53] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f18856eaa99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f188520ac80]                                                       + 0xb8c80
[0x7f18856e36ba]                                                       + 0x76ba
[0x7f188497041d]    clone                                              + 0x6d

[2019-07-16 10:52:53] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 10:52:53] [marian] Running on hretha as process 16348 with command line:
[2019-07-16 10:52:53] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 2 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-16 10:52:54] [config] after-batches: 0
[2019-07-16 10:52:54] [config] after-epochs: 0
[2019-07-16 10:52:54] [config] allow-unk: false
[2019-07-16 10:52:54] [config] beam-size: 12
[2019-07-16 10:52:54] [config] bert-class-symbol: "[CLS]"
[2019-07-16 10:52:54] [config] bert-mask-symbol: "[MASK]"
[2019-07-16 10:52:54] [config] bert-masking-fraction: 0.15
[2019-07-16 10:52:54] [config] bert-sep-symbol: "[SEP]"
[2019-07-16 10:52:54] [config] bert-train-type-embeddings: true
[2019-07-16 10:52:54] [config] bert-type-vocab-size: 2
[2019-07-16 10:52:54] [config] best-deep: false
[2019-07-16 10:52:54] [config] clip-gemm: 0
[2019-07-16 10:52:54] [config] clip-norm: 1
[2019-07-16 10:52:54] [config] cost-type: ce-mean
[2019-07-16 10:52:54] [config] cpu-threads: 0
[2019-07-16 10:52:54] [config] data-weighting: ""
[2019-07-16 10:52:54] [config] data-weighting-type: sentence
[2019-07-16 10:52:54] [config] dec-cell: gru
[2019-07-16 10:52:54] [config] dec-cell-base-depth: 2
[2019-07-16 10:52:54] [config] dec-cell-high-depth: 1
[2019-07-16 10:52:54] [config] dec-depth: 1
[2019-07-16 10:52:54] [config] devices:
[2019-07-16 10:52:54] [config]   - 2
[2019-07-16 10:52:54] [config] dim-emb: 512
[2019-07-16 10:52:54] [config] dim-rnn: 1024
[2019-07-16 10:52:54] [config] dim-vocabs:
[2019-07-16 10:52:54] [config]   - 50000
[2019-07-16 10:52:54] [config]   - 50000
[2019-07-16 10:52:54] [config] disp-first: 0
[2019-07-16 10:52:54] [config] disp-freq: 2000
[2019-07-16 10:52:54] [config] disp-label-counts: false
[2019-07-16 10:52:54] [config] dropout-rnn: 0.2
[2019-07-16 10:52:54] [config] dropout-src: 0.1
[2019-07-16 10:52:54] [config] dropout-trg: 0.1
[2019-07-16 10:52:54] [config] dump-config: ""
[2019-07-16 10:52:54] [config] early-stopping: 5
[2019-07-16 10:52:54] [config] embedding-fix-src: false
[2019-07-16 10:52:54] [config] embedding-fix-trg: false
[2019-07-16 10:52:54] [config] embedding-normalization: false
[2019-07-16 10:52:54] [config] embedding-vectors:
[2019-07-16 10:52:54] [config]   []
[2019-07-16 10:52:54] [config] enc-cell: gru
[2019-07-16 10:52:54] [config] enc-cell-depth: 1
[2019-07-16 10:52:54] [config] enc-depth: 1
[2019-07-16 10:52:54] [config] enc-type: bidirectional
[2019-07-16 10:52:54] [config] exponential-smoothing: 0.0001
[2019-07-16 10:52:54] [config] grad-dropping-momentum: 0
[2019-07-16 10:52:54] [config] grad-dropping-rate: 0
[2019-07-16 10:52:54] [config] grad-dropping-warmup: 100
[2019-07-16 10:52:54] [config] guided-alignment: none
[2019-07-16 10:52:54] [config] guided-alignment-cost: mse
[2019-07-16 10:52:54] [config] guided-alignment-weight: 0.1
[2019-07-16 10:52:54] [config] ignore-model-config: false
[2019-07-16 10:52:54] [config] input-types:
[2019-07-16 10:52:54] [config]   []
[2019-07-16 10:52:54] [config] interpolate-env-vars: false
[2019-07-16 10:52:54] [config] keep-best: false
[2019-07-16 10:52:54] [config] label-smoothing: 0
[2019-07-16 10:52:54] [config] layer-normalization: true
[2019-07-16 10:52:54] [config] learn-rate: 0.0001
[2019-07-16 10:52:54] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-16 10:52:54] [config] log-level: info
[2019-07-16 10:52:54] [config] log-time-zone: ""
[2019-07-16 10:52:54] [config] lr-decay: 0
[2019-07-16 10:52:54] [config] lr-decay-freq: 50000
[2019-07-16 10:52:54] [config] lr-decay-inv-sqrt:
[2019-07-16 10:52:54] [config]   - 0
[2019-07-16 10:52:54] [config] lr-decay-repeat-warmup: false
[2019-07-16 10:52:54] [config] lr-decay-reset-optimizer: false
[2019-07-16 10:52:54] [config] lr-decay-start:
[2019-07-16 10:52:54] [config]   - 10
[2019-07-16 10:52:54] [config]   - 1
[2019-07-16 10:52:54] [config] lr-decay-strategy: epoch+stalled
[2019-07-16 10:52:54] [config] lr-report: false
[2019-07-16 10:52:54] [config] lr-warmup: 0
[2019-07-16 10:52:54] [config] lr-warmup-at-reload: false
[2019-07-16 10:52:54] [config] lr-warmup-cycle: false
[2019-07-16 10:52:54] [config] lr-warmup-start-rate: 0
[2019-07-16 10:52:54] [config] max-length: 50
[2019-07-16 10:52:54] [config] max-length-crop: false
[2019-07-16 10:52:54] [config] max-length-factor: 3
[2019-07-16 10:52:54] [config] maxi-batch: 100
[2019-07-16 10:52:54] [config] maxi-batch-sort: trg
[2019-07-16 10:52:54] [config] mini-batch: 64
[2019-07-16 10:52:54] [config] mini-batch-fit: true
[2019-07-16 10:52:54] [config] mini-batch-fit-step: 10
[2019-07-16 10:52:54] [config] mini-batch-overstuff: 1
[2019-07-16 10:52:54] [config] mini-batch-track-lr: false
[2019-07-16 10:52:54] [config] mini-batch-understuff: 1
[2019-07-16 10:52:54] [config] mini-batch-warmup: 0
[2019-07-16 10:52:54] [config] mini-batch-words: 0
[2019-07-16 10:52:54] [config] mini-batch-words-ref: 0
[2019-07-16 10:52:54] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 10:52:54] [config] multi-loss-type: sum
[2019-07-16 10:52:54] [config] multi-node: false
[2019-07-16 10:52:54] [config] multi-node-overlap: true
[2019-07-16 10:52:54] [config] n-best: false
[2019-07-16 10:52:54] [config] no-nccl: false
[2019-07-16 10:52:54] [config] no-reload: false
[2019-07-16 10:52:54] [config] no-restore-corpus: false
[2019-07-16 10:52:54] [config] no-shuffle: false
[2019-07-16 10:52:54] [config] normalize: 1
[2019-07-16 10:52:54] [config] num-devices: 0
[2019-07-16 10:52:54] [config] optimizer: adam
[2019-07-16 10:52:54] [config] optimizer-delay: 1
[2019-07-16 10:52:54] [config] optimizer-params:
[2019-07-16 10:52:54] [config]   []
[2019-07-16 10:52:54] [config] overwrite: false
[2019-07-16 10:52:54] [config] pretrained-model: ""
[2019-07-16 10:52:54] [config] quiet: false
[2019-07-16 10:52:54] [config] quiet-translation: true
[2019-07-16 10:52:54] [config] relative-paths: false
[2019-07-16 10:52:54] [config] right-left: false
[2019-07-16 10:52:54] [config] save-freq: 20000
[2019-07-16 10:52:54] [config] seed: 1111
[2019-07-16 10:52:54] [config] shuffle-in-ram: false
[2019-07-16 10:52:54] [config] skip: false
[2019-07-16 10:52:54] [config] sqlite: ""
[2019-07-16 10:52:54] [config] sqlite-drop: false
[2019-07-16 10:52:54] [config] sync-sgd: true
[2019-07-16 10:52:54] [config] tempdir: .
[2019-07-16 10:52:54] [config] tied-embeddings: false
[2019-07-16 10:52:54] [config] tied-embeddings-all: false
[2019-07-16 10:52:54] [config] tied-embeddings-src: false
[2019-07-16 10:52:54] [config] train-sets:
[2019-07-16 10:52:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-16 10:52:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-16 10:52:54] [config] transformer-aan-activation: swish
[2019-07-16 10:52:54] [config] transformer-aan-depth: 2
[2019-07-16 10:52:54] [config] transformer-aan-nogate: false
[2019-07-16 10:52:54] [config] transformer-decoder-autoreg: self-attention
[2019-07-16 10:52:54] [config] transformer-dim-aan: 2048
[2019-07-16 10:52:54] [config] transformer-dim-ffn: 2048
[2019-07-16 10:52:54] [config] transformer-dropout: 0
[2019-07-16 10:52:54] [config] transformer-dropout-attention: 0
[2019-07-16 10:52:54] [config] transformer-dropout-ffn: 0
[2019-07-16 10:52:54] [config] transformer-ffn-activation: swish
[2019-07-16 10:52:54] [config] transformer-ffn-depth: 2
[2019-07-16 10:52:54] [config] transformer-guided-alignment-layer: last
[2019-07-16 10:52:54] [config] transformer-heads: 8
[2019-07-16 10:52:54] [config] transformer-no-projection: false
[2019-07-16 10:52:54] [config] transformer-postprocess: dan
[2019-07-16 10:52:54] [config] transformer-postprocess-emb: d
[2019-07-16 10:52:54] [config] transformer-preprocess: ""
[2019-07-16 10:52:54] [config] transformer-tied-layers:
[2019-07-16 10:52:54] [config]   []
[2019-07-16 10:52:54] [config] transformer-train-position-embeddings: false
[2019-07-16 10:52:54] [config] type: amun
[2019-07-16 10:52:54] [config] ulr: false
[2019-07-16 10:52:54] [config] ulr-dim-emb: 0
[2019-07-16 10:52:54] [config] ulr-dropout: 0
[2019-07-16 10:52:54] [config] ulr-keys-vectors: ""
[2019-07-16 10:52:54] [config] ulr-query-vectors: ""
[2019-07-16 10:52:54] [config] ulr-softmax-temperature: 1
[2019-07-16 10:52:54] [config] ulr-trainable-transformation: false
[2019-07-16 10:52:54] [config] valid-freq: 20000
[2019-07-16 10:52:54] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-16 10:52:54] [config] valid-max-length: 1000
[2019-07-16 10:52:54] [config] valid-metrics:
[2019-07-16 10:52:54] [config]   - cross-entropy
[2019-07-16 10:52:54] [config]   - perplexity
[2019-07-16 10:52:54] [config]   - translation
[2019-07-16 10:52:54] [config] valid-mini-batch: 8
[2019-07-16 10:52:54] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-16 10:52:54] [config] valid-sets:
[2019-07-16 10:52:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-16 10:52:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-16 10:52:54] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-16 10:52:54] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 10:52:54] [config] vocabs:
[2019-07-16 10:52:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-16 10:52:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-16 10:52:54] [config] word-penalty: 0
[2019-07-16 10:52:54] [config] workspace: 5000
[2019-07-16 10:52:54] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 10:52:54] Using synchronous training
[2019-07-16 10:52:54] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-16 10:52:54] [data] Using unused word id eos for 0
[2019-07-16 10:52:54] [data] Using unused word id UNK for 1
[2019-07-16 10:52:54] [data] Setting vocabulary size for input 0 to 50000
[2019-07-16 10:52:54] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-16 10:52:54] [data] Using unused word id eos for 0
[2019-07-16 10:52:54] [data] Using unused word id UNK for 1
[2019-07-16 10:52:54] [data] Setting vocabulary size for input 1 to 50000
[2019-07-16 10:52:54] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-16 10:52:54] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-16 10:52:55] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-16 10:52:56] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 10:52:56] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 10:52:56] [training] Using 1 GPUs
[2019-07-16 10:52:56] [memory] Reserving 422 MB, device gpu2
[2019-07-16 10:52:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-16 10:52:56] [memory] Reserving 422 MB, device gpu2
[2019-07-16 10:53:05] [batching] Done. Typical MB size is 6880 target words
[2019-07-16 10:53:05] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-16 10:53:05] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 10:53:05] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 10:53:05] [training] Using 1 GPUs
[2019-07-16 10:53:05] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-16 10:53:11] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-16 10:53:22] [memory] Reserving 844 MB, device gpu2
[2019-07-16 10:53:23] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 10:53:23] [data] Restoring the corpus state to epoch 26, batch 320000
[2019-07-16 10:53:23] [data] Shuffling data
[2019-07-16 10:53:26] [data] Done reading 4355038 sentences
[2019-07-16 10:53:48] [data] Done shuffling 4355038 sentences to temp files
[2019-07-16 10:55:54] Training started
[2019-07-16 10:55:54] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-16 10:55:54] [memory] Reserving 422 MB, device gpu2
[2019-07-16 10:55:55] [memory] Reserving 422 MB, device gpu2
[2019-07-16 10:55:55] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 10:56:02] [memory] Reserving 422 MB, device cpu0
[2019-07-16 10:56:02] [memory] Reserving 422 MB, device gpu2
[2019-07-16 10:58:19] Seen 3532755 samples
[2019-07-16 10:58:19] Starting epoch 27
[2019-07-16 10:58:19] [data] Shuffling data
[2019-07-16 10:58:21] [data] Done reading 4355038 sentences
[2019-07-16 10:58:39] [data] Done shuffling 4355038 sentences to temp files
[2019-07-16 11:11:20] Ep. 27 : Up. 322000 : Sen. 262,094 : Cost 45.52894211 : Time 1105.89s : 6972.18 words/s
[2019-07-16 11:26:18] Ep. 27 : Up. 324000 : Sen. 573,960 : Cost 45.25062180 : Time 897.50s : 8606.05 words/s
[2019-07-16 11:41:15] Ep. 27 : Up. 326000 : Sen. 885,555 : Cost 45.41823196 : Time 897.30s : 8602.52 words/s
[2019-07-16 11:56:15] Ep. 27 : Up. 328000 : Sen. 1,197,064 : Cost 45.60353088 : Time 899.53s : 8565.78 words/s
[2019-07-16 12:11:14] Ep. 27 : Up. 330000 : Sen. 1,508,956 : Cost 45.90105438 : Time 898.90s : 8605.00 words/s
[2019-07-16 12:26:13] Ep. 27 : Up. 332000 : Sen. 1,820,218 : Cost 45.83719635 : Time 899.24s : 8560.62 words/s
[2019-07-16 12:41:14] Ep. 27 : Up. 334000 : Sen. 2,132,119 : Cost 45.83576584 : Time 900.93s : 8568.27 words/s
[2019-07-16 12:56:17] Ep. 27 : Up. 336000 : Sen. 2,443,316 : Cost 46.16143417 : Time 903.14s : 8542.35 words/s
[2019-07-16 13:11:20] Ep. 27 : Up. 338000 : Sen. 2,756,545 : Cost 45.87820816 : Time 903.33s : 8580.71 words/s
[2019-07-16 13:26:23] Ep. 27 : Up. 340000 : Sen. 3,068,805 : Cost 46.14078522 : Time 903.10s : 8557.06 words/s
[2019-07-16 13:26:23] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-16 13:26:32] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter340000.npz
[2019-07-16 13:26:39] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 13:26:49] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-16 13:27:25] [valid] Ep. 27 : Up. 340000 : cross-entropy : 46.404 : new best
[2019-07-16 13:27:32] [valid] Ep. 27 : Up. 340000 : perplexity : 6.24708 : new best
[2019-07-16 13:28:10] Error: Unknown word id: 49990
[2019-07-16 13:28:10] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7ffb9bc90a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7ffb9b7b0c80]                                                       + 0xb8c80
[0x7ffb9bc896ba]                                                       + 0x76ba
[0x7ffb9af1641d]    clone                                              + 0x6d

[2019-07-16 16:22:22] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 16:22:22] [marian] Running on hretha as process 1065 with command line:
[2019-07-16 16:22:22] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 2 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-16 16:22:23] [config] after-batches: 0
[2019-07-16 16:22:23] [config] after-epochs: 0
[2019-07-16 16:22:23] [config] allow-unk: false
[2019-07-16 16:22:23] [config] beam-size: 12
[2019-07-16 16:22:23] [config] bert-class-symbol: "[CLS]"
[2019-07-16 16:22:23] [config] bert-mask-symbol: "[MASK]"
[2019-07-16 16:22:23] [config] bert-masking-fraction: 0.15
[2019-07-16 16:22:23] [config] bert-sep-symbol: "[SEP]"
[2019-07-16 16:22:23] [config] bert-train-type-embeddings: true
[2019-07-16 16:22:23] [config] bert-type-vocab-size: 2
[2019-07-16 16:22:23] [config] best-deep: false
[2019-07-16 16:22:23] [config] clip-gemm: 0
[2019-07-16 16:22:23] [config] clip-norm: 1
[2019-07-16 16:22:23] [config] cost-type: ce-mean
[2019-07-16 16:22:23] [config] cpu-threads: 0
[2019-07-16 16:22:23] [config] data-weighting: ""
[2019-07-16 16:22:23] [config] data-weighting-type: sentence
[2019-07-16 16:22:23] [config] dec-cell: gru
[2019-07-16 16:22:23] [config] dec-cell-base-depth: 2
[2019-07-16 16:22:23] [config] dec-cell-high-depth: 1
[2019-07-16 16:22:23] [config] dec-depth: 1
[2019-07-16 16:22:23] [config] devices:
[2019-07-16 16:22:23] [config]   - 2
[2019-07-16 16:22:23] [config] dim-emb: 512
[2019-07-16 16:22:23] [config] dim-rnn: 1024
[2019-07-16 16:22:23] [config] dim-vocabs:
[2019-07-16 16:22:23] [config]   - 50000
[2019-07-16 16:22:23] [config]   - 50000
[2019-07-16 16:22:23] [config] disp-first: 0
[2019-07-16 16:22:23] [config] disp-freq: 2000
[2019-07-16 16:22:23] [config] disp-label-counts: false
[2019-07-16 16:22:23] [config] dropout-rnn: 0.2
[2019-07-16 16:22:23] [config] dropout-src: 0.1
[2019-07-16 16:22:23] [config] dropout-trg: 0.1
[2019-07-16 16:22:23] [config] dump-config: ""
[2019-07-16 16:22:23] [config] early-stopping: 5
[2019-07-16 16:22:23] [config] embedding-fix-src: false
[2019-07-16 16:22:23] [config] embedding-fix-trg: false
[2019-07-16 16:22:23] [config] embedding-normalization: false
[2019-07-16 16:22:23] [config] embedding-vectors:
[2019-07-16 16:22:23] [config]   []
[2019-07-16 16:22:23] [config] enc-cell: gru
[2019-07-16 16:22:23] [config] enc-cell-depth: 1
[2019-07-16 16:22:23] [config] enc-depth: 1
[2019-07-16 16:22:23] [config] enc-type: bidirectional
[2019-07-16 16:22:23] [config] exponential-smoothing: 0.0001
[2019-07-16 16:22:23] [config] grad-dropping-momentum: 0
[2019-07-16 16:22:23] [config] grad-dropping-rate: 0
[2019-07-16 16:22:23] [config] grad-dropping-warmup: 100
[2019-07-16 16:22:23] [config] guided-alignment: none
[2019-07-16 16:22:23] [config] guided-alignment-cost: mse
[2019-07-16 16:22:23] [config] guided-alignment-weight: 0.1
[2019-07-16 16:22:23] [config] ignore-model-config: false
[2019-07-16 16:22:23] [config] input-types:
[2019-07-16 16:22:23] [config]   []
[2019-07-16 16:22:23] [config] interpolate-env-vars: false
[2019-07-16 16:22:23] [config] keep-best: false
[2019-07-16 16:22:23] [config] label-smoothing: 0
[2019-07-16 16:22:23] [config] layer-normalization: true
[2019-07-16 16:22:23] [config] learn-rate: 0.0001
[2019-07-16 16:22:23] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-16 16:22:23] [config] log-level: info
[2019-07-16 16:22:23] [config] log-time-zone: ""
[2019-07-16 16:22:23] [config] lr-decay: 0
[2019-07-16 16:22:23] [config] lr-decay-freq: 50000
[2019-07-16 16:22:23] [config] lr-decay-inv-sqrt:
[2019-07-16 16:22:23] [config]   - 0
[2019-07-16 16:22:23] [config] lr-decay-repeat-warmup: false
[2019-07-16 16:22:23] [config] lr-decay-reset-optimizer: false
[2019-07-16 16:22:23] [config] lr-decay-start:
[2019-07-16 16:22:23] [config]   - 10
[2019-07-16 16:22:23] [config]   - 1
[2019-07-16 16:22:23] [config] lr-decay-strategy: epoch+stalled
[2019-07-16 16:22:23] [config] lr-report: false
[2019-07-16 16:22:23] [config] lr-warmup: 0
[2019-07-16 16:22:23] [config] lr-warmup-at-reload: false
[2019-07-16 16:22:23] [config] lr-warmup-cycle: false
[2019-07-16 16:22:23] [config] lr-warmup-start-rate: 0
[2019-07-16 16:22:23] [config] max-length: 50
[2019-07-16 16:22:23] [config] max-length-crop: false
[2019-07-16 16:22:23] [config] max-length-factor: 3
[2019-07-16 16:22:23] [config] maxi-batch: 100
[2019-07-16 16:22:23] [config] maxi-batch-sort: trg
[2019-07-16 16:22:23] [config] mini-batch: 64
[2019-07-16 16:22:23] [config] mini-batch-fit: true
[2019-07-16 16:22:23] [config] mini-batch-fit-step: 10
[2019-07-16 16:22:23] [config] mini-batch-overstuff: 1
[2019-07-16 16:22:23] [config] mini-batch-track-lr: false
[2019-07-16 16:22:23] [config] mini-batch-understuff: 1
[2019-07-16 16:22:23] [config] mini-batch-warmup: 0
[2019-07-16 16:22:23] [config] mini-batch-words: 0
[2019-07-16 16:22:23] [config] mini-batch-words-ref: 0
[2019-07-16 16:22:23] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 16:22:23] [config] multi-loss-type: sum
[2019-07-16 16:22:23] [config] multi-node: false
[2019-07-16 16:22:23] [config] multi-node-overlap: true
[2019-07-16 16:22:23] [config] n-best: false
[2019-07-16 16:22:23] [config] no-nccl: false
[2019-07-16 16:22:23] [config] no-reload: false
[2019-07-16 16:22:23] [config] no-restore-corpus: false
[2019-07-16 16:22:23] [config] no-shuffle: false
[2019-07-16 16:22:23] [config] normalize: 1
[2019-07-16 16:22:23] [config] num-devices: 0
[2019-07-16 16:22:23] [config] optimizer: adam
[2019-07-16 16:22:23] [config] optimizer-delay: 1
[2019-07-16 16:22:23] [config] optimizer-params:
[2019-07-16 16:22:23] [config]   []
[2019-07-16 16:22:23] [config] overwrite: false
[2019-07-16 16:22:23] [config] pretrained-model: ""
[2019-07-16 16:22:23] [config] quiet: false
[2019-07-16 16:22:23] [config] quiet-translation: true
[2019-07-16 16:22:23] [config] relative-paths: false
[2019-07-16 16:22:23] [config] right-left: false
[2019-07-16 16:22:23] [config] save-freq: 20000
[2019-07-16 16:22:23] [config] seed: 1111
[2019-07-16 16:22:23] [config] shuffle-in-ram: false
[2019-07-16 16:22:23] [config] skip: false
[2019-07-16 16:22:23] [config] sqlite: ""
[2019-07-16 16:22:23] [config] sqlite-drop: false
[2019-07-16 16:22:23] [config] sync-sgd: true
[2019-07-16 16:22:23] [config] tempdir: .
[2019-07-16 16:22:23] [config] tied-embeddings: false
[2019-07-16 16:22:23] [config] tied-embeddings-all: false
[2019-07-16 16:22:23] [config] tied-embeddings-src: false
[2019-07-16 16:22:23] [config] train-sets:
[2019-07-16 16:22:23] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-16 16:22:23] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-16 16:22:23] [config] transformer-aan-activation: swish
[2019-07-16 16:22:23] [config] transformer-aan-depth: 2
[2019-07-16 16:22:23] [config] transformer-aan-nogate: false
[2019-07-16 16:22:23] [config] transformer-decoder-autoreg: self-attention
[2019-07-16 16:22:23] [config] transformer-dim-aan: 2048
[2019-07-16 16:22:23] [config] transformer-dim-ffn: 2048
[2019-07-16 16:22:23] [config] transformer-dropout: 0
[2019-07-16 16:22:23] [config] transformer-dropout-attention: 0
[2019-07-16 16:22:23] [config] transformer-dropout-ffn: 0
[2019-07-16 16:22:23] [config] transformer-ffn-activation: swish
[2019-07-16 16:22:23] [config] transformer-ffn-depth: 2
[2019-07-16 16:22:23] [config] transformer-guided-alignment-layer: last
[2019-07-16 16:22:23] [config] transformer-heads: 8
[2019-07-16 16:22:23] [config] transformer-no-projection: false
[2019-07-16 16:22:23] [config] transformer-postprocess: dan
[2019-07-16 16:22:23] [config] transformer-postprocess-emb: d
[2019-07-16 16:22:23] [config] transformer-preprocess: ""
[2019-07-16 16:22:23] [config] transformer-tied-layers:
[2019-07-16 16:22:23] [config]   []
[2019-07-16 16:22:23] [config] transformer-train-position-embeddings: false
[2019-07-16 16:22:23] [config] type: amun
[2019-07-16 16:22:23] [config] ulr: false
[2019-07-16 16:22:23] [config] ulr-dim-emb: 0
[2019-07-16 16:22:23] [config] ulr-dropout: 0
[2019-07-16 16:22:23] [config] ulr-keys-vectors: ""
[2019-07-16 16:22:23] [config] ulr-query-vectors: ""
[2019-07-16 16:22:23] [config] ulr-softmax-temperature: 1
[2019-07-16 16:22:23] [config] ulr-trainable-transformation: false
[2019-07-16 16:22:23] [config] valid-freq: 20000
[2019-07-16 16:22:23] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-16 16:22:23] [config] valid-max-length: 1000
[2019-07-16 16:22:23] [config] valid-metrics:
[2019-07-16 16:22:23] [config]   - cross-entropy
[2019-07-16 16:22:23] [config]   - perplexity
[2019-07-16 16:22:23] [config]   - translation
[2019-07-16 16:22:23] [config] valid-mini-batch: 8
[2019-07-16 16:22:23] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-16 16:22:23] [config] valid-sets:
[2019-07-16 16:22:23] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-16 16:22:23] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-16 16:22:23] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-16 16:22:23] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 16:22:23] [config] vocabs:
[2019-07-16 16:22:23] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-16 16:22:23] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-16 16:22:23] [config] word-penalty: 0
[2019-07-16 16:22:23] [config] workspace: 6000
[2019-07-16 16:22:23] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 16:22:23] Using synchronous training
[2019-07-16 16:22:23] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-16 16:22:23] [data] Using unused word id eos for 0
[2019-07-16 16:22:23] [data] Using unused word id UNK for 1
[2019-07-16 16:22:23] [data] Setting vocabulary size for input 0 to 50000
[2019-07-16 16:22:23] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-16 16:22:24] [data] Using unused word id eos for 0
[2019-07-16 16:22:24] [data] Using unused word id UNK for 1
[2019-07-16 16:22:24] [data] Setting vocabulary size for input 1 to 50000
[2019-07-16 16:22:24] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-16 16:22:24] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-16 16:22:25] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-16 16:22:25] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 16:22:25] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 16:22:25] [training] Using 1 GPUs
[2019-07-16 16:22:25] [memory] Reserving 422 MB, device gpu2
[2019-07-16 16:22:25] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-16 16:22:25] [memory] Reserving 422 MB, device gpu2
[2019-07-16 16:22:36] [batching] Done. Typical MB size is 8096 target words
[2019-07-16 16:22:36] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-16 16:22:36] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 16:22:36] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 16:22:36] [training] Using 1 GPUs
[2019-07-16 16:22:36] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-16 16:22:42] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-16 16:22:53] [memory] Reserving 844 MB, device gpu2
[2019-07-16 16:22:54] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 16:22:54] [data] Restoring the corpus state to epoch 27, batch 340000
[2019-07-16 16:22:54] [data] Shuffling data
[2019-07-16 16:22:57] [data] Done reading 4355038 sentences
[2019-07-16 16:23:18] [data] Done shuffling 4355038 sentences to temp files
[2019-07-16 16:25:36] Error: attempted to wait for futureBufferedBatches_ when none pending
[2019-07-16 16:25:36] Error: Aborted from marian::data::BatchGenerator<DataSet>::BatchPtr marian::data::BatchGenerator<DataSet>::next() [with DataSet = marian::data::CorpusBase; marian::data::BatchGenerator<DataSet>::BatchPtr = std::shared_ptr<marian::data::CorpusBatch>] in /fs/bil0/abdel/marian-dev/src/data/batch_generator.h:236

[CALL STACK]
[0x627611]          marian::data::BatchGenerator<marian::data::CorpusBase>::  next  () + 0x631
[0x63f87c]          marian::data::BatchGenerator<marian::data::CorpusBase>::  restore  (std::shared_ptr<marian::TrainingState>,  bool) + 0x27c
[0x670192]          marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x12a2
[0x5a13aa]          mainTrainer  (int,  char**)                        + 0x2ca
[0x57dd1a]          main                                               + 0x8a
[0x7f3c55e34830]    __libc_start_main                                  + 0xf0
[0x59edc9]          _start                                             + 0x29

[2019-07-16 17:57:58] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 17:57:58] [marian] Running on hretha as process 5163 with command line:
[2019-07-16 17:57:58] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 2 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-16 17:57:58] [config] after-batches: 0
[2019-07-16 17:57:58] [config] after-epochs: 0
[2019-07-16 17:57:58] [config] allow-unk: false
[2019-07-16 17:57:58] [config] beam-size: 12
[2019-07-16 17:57:58] [config] bert-class-symbol: "[CLS]"
[2019-07-16 17:57:58] [config] bert-mask-symbol: "[MASK]"
[2019-07-16 17:57:58] [config] bert-masking-fraction: 0.15
[2019-07-16 17:57:58] [config] bert-sep-symbol: "[SEP]"
[2019-07-16 17:57:58] [config] bert-train-type-embeddings: true
[2019-07-16 17:57:58] [config] bert-type-vocab-size: 2
[2019-07-16 17:57:58] [config] best-deep: false
[2019-07-16 17:57:58] [config] clip-gemm: 0
[2019-07-16 17:57:58] [config] clip-norm: 1
[2019-07-16 17:57:58] [config] cost-type: ce-mean
[2019-07-16 17:57:58] [config] cpu-threads: 0
[2019-07-16 17:57:58] [config] data-weighting: ""
[2019-07-16 17:57:58] [config] data-weighting-type: sentence
[2019-07-16 17:57:58] [config] dec-cell: gru
[2019-07-16 17:57:58] [config] dec-cell-base-depth: 2
[2019-07-16 17:57:58] [config] dec-cell-high-depth: 1
[2019-07-16 17:57:58] [config] dec-depth: 1
[2019-07-16 17:57:58] [config] devices:
[2019-07-16 17:57:58] [config]   - 2
[2019-07-16 17:57:58] [config] dim-emb: 512
[2019-07-16 17:57:58] [config] dim-rnn: 1024
[2019-07-16 17:57:58] [config] dim-vocabs:
[2019-07-16 17:57:58] [config]   - 50000
[2019-07-16 17:57:58] [config]   - 50000
[2019-07-16 17:57:58] [config] disp-first: 0
[2019-07-16 17:57:58] [config] disp-freq: 2000
[2019-07-16 17:57:58] [config] disp-label-counts: false
[2019-07-16 17:57:58] [config] dropout-rnn: 0.2
[2019-07-16 17:57:58] [config] dropout-src: 0.1
[2019-07-16 17:57:58] [config] dropout-trg: 0.1
[2019-07-16 17:57:58] [config] dump-config: ""
[2019-07-16 17:57:58] [config] early-stopping: 5
[2019-07-16 17:57:58] [config] embedding-fix-src: false
[2019-07-16 17:57:58] [config] embedding-fix-trg: false
[2019-07-16 17:57:58] [config] embedding-normalization: false
[2019-07-16 17:57:58] [config] embedding-vectors:
[2019-07-16 17:57:58] [config]   []
[2019-07-16 17:57:58] [config] enc-cell: gru
[2019-07-16 17:57:58] [config] enc-cell-depth: 1
[2019-07-16 17:57:58] [config] enc-depth: 1
[2019-07-16 17:57:58] [config] enc-type: bidirectional
[2019-07-16 17:57:58] [config] exponential-smoothing: 0.0001
[2019-07-16 17:57:58] [config] grad-dropping-momentum: 0
[2019-07-16 17:57:58] [config] grad-dropping-rate: 0
[2019-07-16 17:57:58] [config] grad-dropping-warmup: 100
[2019-07-16 17:57:58] [config] guided-alignment: none
[2019-07-16 17:57:58] [config] guided-alignment-cost: mse
[2019-07-16 17:57:58] [config] guided-alignment-weight: 0.1
[2019-07-16 17:57:58] [config] ignore-model-config: false
[2019-07-16 17:57:58] [config] input-types:
[2019-07-16 17:57:58] [config]   []
[2019-07-16 17:57:58] [config] interpolate-env-vars: false
[2019-07-16 17:57:58] [config] keep-best: false
[2019-07-16 17:57:58] [config] label-smoothing: 0
[2019-07-16 17:57:58] [config] layer-normalization: true
[2019-07-16 17:57:58] [config] learn-rate: 0.0001
[2019-07-16 17:57:58] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-16 17:57:58] [config] log-level: info
[2019-07-16 17:57:58] [config] log-time-zone: ""
[2019-07-16 17:57:58] [config] lr-decay: 0
[2019-07-16 17:57:58] [config] lr-decay-freq: 50000
[2019-07-16 17:57:58] [config] lr-decay-inv-sqrt:
[2019-07-16 17:57:58] [config]   - 0
[2019-07-16 17:57:58] [config] lr-decay-repeat-warmup: false
[2019-07-16 17:57:58] [config] lr-decay-reset-optimizer: false
[2019-07-16 17:57:58] [config] lr-decay-start:
[2019-07-16 17:57:58] [config]   - 10
[2019-07-16 17:57:58] [config]   - 1
[2019-07-16 17:57:58] [config] lr-decay-strategy: epoch+stalled
[2019-07-16 17:57:58] [config] lr-report: false
[2019-07-16 17:57:58] [config] lr-warmup: 0
[2019-07-16 17:57:58] [config] lr-warmup-at-reload: false
[2019-07-16 17:57:58] [config] lr-warmup-cycle: false
[2019-07-16 17:57:58] [config] lr-warmup-start-rate: 0
[2019-07-16 17:57:58] [config] max-length: 50
[2019-07-16 17:57:58] [config] max-length-crop: false
[2019-07-16 17:57:58] [config] max-length-factor: 3
[2019-07-16 17:57:58] [config] maxi-batch: 100
[2019-07-16 17:57:58] [config] maxi-batch-sort: trg
[2019-07-16 17:57:58] [config] mini-batch: 64
[2019-07-16 17:57:58] [config] mini-batch-fit: true
[2019-07-16 17:57:58] [config] mini-batch-fit-step: 10
[2019-07-16 17:57:58] [config] mini-batch-overstuff: 1
[2019-07-16 17:57:58] [config] mini-batch-track-lr: false
[2019-07-16 17:57:58] [config] mini-batch-understuff: 1
[2019-07-16 17:57:58] [config] mini-batch-warmup: 0
[2019-07-16 17:57:58] [config] mini-batch-words: 0
[2019-07-16 17:57:58] [config] mini-batch-words-ref: 0
[2019-07-16 17:57:58] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 17:57:58] [config] multi-loss-type: sum
[2019-07-16 17:57:58] [config] multi-node: false
[2019-07-16 17:57:58] [config] multi-node-overlap: true
[2019-07-16 17:57:58] [config] n-best: false
[2019-07-16 17:57:58] [config] no-nccl: false
[2019-07-16 17:57:58] [config] no-reload: false
[2019-07-16 17:57:58] [config] no-restore-corpus: false
[2019-07-16 17:57:58] [config] no-shuffle: false
[2019-07-16 17:57:58] [config] normalize: 1
[2019-07-16 17:57:58] [config] num-devices: 0
[2019-07-16 17:57:58] [config] optimizer: adam
[2019-07-16 17:57:58] [config] optimizer-delay: 1
[2019-07-16 17:57:58] [config] optimizer-params:
[2019-07-16 17:57:58] [config]   []
[2019-07-16 17:57:58] [config] overwrite: false
[2019-07-16 17:57:58] [config] pretrained-model: ""
[2019-07-16 17:57:58] [config] quiet: false
[2019-07-16 17:57:58] [config] quiet-translation: true
[2019-07-16 17:57:58] [config] relative-paths: false
[2019-07-16 17:57:58] [config] right-left: false
[2019-07-16 17:57:58] [config] save-freq: 20000
[2019-07-16 17:57:58] [config] seed: 1111
[2019-07-16 17:57:58] [config] shuffle-in-ram: false
[2019-07-16 17:57:58] [config] skip: false
[2019-07-16 17:57:58] [config] sqlite: ""
[2019-07-16 17:57:58] [config] sqlite-drop: false
[2019-07-16 17:57:58] [config] sync-sgd: true
[2019-07-16 17:57:58] [config] tempdir: .
[2019-07-16 17:57:58] [config] tied-embeddings: false
[2019-07-16 17:57:58] [config] tied-embeddings-all: false
[2019-07-16 17:57:58] [config] tied-embeddings-src: false
[2019-07-16 17:57:58] [config] train-sets:
[2019-07-16 17:57:58] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-16 17:57:58] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-16 17:57:58] [config] transformer-aan-activation: swish
[2019-07-16 17:57:58] [config] transformer-aan-depth: 2
[2019-07-16 17:57:58] [config] transformer-aan-nogate: false
[2019-07-16 17:57:58] [config] transformer-decoder-autoreg: self-attention
[2019-07-16 17:57:58] [config] transformer-dim-aan: 2048
[2019-07-16 17:57:58] [config] transformer-dim-ffn: 2048
[2019-07-16 17:57:58] [config] transformer-dropout: 0
[2019-07-16 17:57:58] [config] transformer-dropout-attention: 0
[2019-07-16 17:57:58] [config] transformer-dropout-ffn: 0
[2019-07-16 17:57:58] [config] transformer-ffn-activation: swish
[2019-07-16 17:57:58] [config] transformer-ffn-depth: 2
[2019-07-16 17:57:58] [config] transformer-guided-alignment-layer: last
[2019-07-16 17:57:58] [config] transformer-heads: 8
[2019-07-16 17:57:58] [config] transformer-no-projection: false
[2019-07-16 17:57:58] [config] transformer-postprocess: dan
[2019-07-16 17:57:58] [config] transformer-postprocess-emb: d
[2019-07-16 17:57:58] [config] transformer-preprocess: ""
[2019-07-16 17:57:58] [config] transformer-tied-layers:
[2019-07-16 17:57:58] [config]   []
[2019-07-16 17:57:58] [config] transformer-train-position-embeddings: false
[2019-07-16 17:57:58] [config] type: amun
[2019-07-16 17:57:58] [config] ulr: false
[2019-07-16 17:57:58] [config] ulr-dim-emb: 0
[2019-07-16 17:57:58] [config] ulr-dropout: 0
[2019-07-16 17:57:58] [config] ulr-keys-vectors: ""
[2019-07-16 17:57:58] [config] ulr-query-vectors: ""
[2019-07-16 17:57:58] [config] ulr-softmax-temperature: 1
[2019-07-16 17:57:58] [config] ulr-trainable-transformation: false
[2019-07-16 17:57:58] [config] valid-freq: 20000
[2019-07-16 17:57:58] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-16 17:57:58] [config] valid-max-length: 1000
[2019-07-16 17:57:58] [config] valid-metrics:
[2019-07-16 17:57:58] [config]   - cross-entropy
[2019-07-16 17:57:58] [config]   - perplexity
[2019-07-16 17:57:58] [config]   - translation
[2019-07-16 17:57:58] [config] valid-mini-batch: 8
[2019-07-16 17:57:58] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-16 17:57:58] [config] valid-sets:
[2019-07-16 17:57:58] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-16 17:57:58] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-16 17:57:58] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-16 17:57:58] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 17:57:58] [config] vocabs:
[2019-07-16 17:57:58] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-16 17:57:58] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-16 17:57:58] [config] word-penalty: 0
[2019-07-16 17:57:58] [config] workspace: 5000
[2019-07-16 17:57:58] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 17:57:58] Using synchronous training
[2019-07-16 17:57:58] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-16 17:57:58] [data] Using unused word id eos for 0
[2019-07-16 17:57:58] [data] Using unused word id UNK for 1
[2019-07-16 17:57:58] [data] Setting vocabulary size for input 0 to 50000
[2019-07-16 17:57:58] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-16 17:57:59] [data] Using unused word id eos for 0
[2019-07-16 17:57:59] [data] Using unused word id UNK for 1
[2019-07-16 17:57:59] [data] Setting vocabulary size for input 1 to 50000
[2019-07-16 17:57:59] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-16 17:57:59] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-16 17:58:00] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-16 17:58:00] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 17:58:00] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 17:58:00] [training] Using 1 GPUs
[2019-07-16 17:58:00] [memory] Reserving 422 MB, device gpu2
[2019-07-16 17:58:00] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-16 17:58:00] [memory] Reserving 422 MB, device gpu2
[2019-07-16 17:58:09] [batching] Done. Typical MB size is 6880 target words
[2019-07-16 17:58:09] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-16 17:58:09] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 17:58:09] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 17:58:09] [training] Using 1 GPUs
[2019-07-16 17:58:09] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-16 17:58:11] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-16 17:58:14] [memory] Reserving 844 MB, device gpu2
[2019-07-16 17:58:14] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 17:58:14] [data] Restoring the corpus state to epoch 27, batch 340000
[2019-07-16 17:58:14] [data] Shuffling data
[2019-07-16 17:58:17] [data] Done reading 4355038 sentences
[2019-07-16 17:58:38] [data] Done shuffling 4355038 sentences to temp files
[2019-07-16 18:00:44] Training started
[2019-07-16 18:00:44] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-16 18:00:44] [memory] Reserving 422 MB, device gpu2
[2019-07-16 18:00:45] [memory] Reserving 422 MB, device gpu2
[2019-07-16 18:00:45] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 18:00:51] [memory] Reserving 422 MB, device cpu0
[2019-07-16 18:00:51] [memory] Reserving 422 MB, device gpu2
[2019-07-16 18:15:45] Ep. 27 : Up. 342000 : Sen. 3,380,188 : Cost 46.03466034 : Time 1065.99s : 7227.70 words/s
[2019-07-16 18:23:06] Seen 3532755 samples
[2019-07-16 18:23:06] Starting epoch 28
[2019-07-16 18:23:06] [data] Shuffling data
[2019-07-16 18:23:09] [data] Done reading 4355038 sentences
[2019-07-16 18:23:29] [data] Done shuffling 4355038 sentences to temp files
[2019-07-16 18:31:17] Ep. 28 : Up. 344000 : Sen. 160,132 : Cost 45.39050674 : Time 932.50s : 8296.97 words/s
[2019-07-16 18:46:21] Ep. 28 : Up. 346000 : Sen. 471,279 : Cost 44.97571182 : Time 903.46s : 8510.78 words/s
[2019-07-16 19:01:24] Ep. 28 : Up. 348000 : Sen. 782,462 : Cost 45.08223343 : Time 903.03s : 8533.95 words/s
[2019-07-16 19:16:25] Ep. 28 : Up. 350000 : Sen. 1,093,170 : Cost 45.45858765 : Time 901.13s : 8544.24 words/s
[2019-07-16 19:31:28] Ep. 28 : Up. 352000 : Sen. 1,405,261 : Cost 45.49742508 : Time 902.84s : 8561.36 words/s
[2019-07-16 19:46:26] Ep. 28 : Up. 354000 : Sen. 1,715,705 : Cost 45.59910965 : Time 898.80s : 8537.95 words/s
[2019-07-16 20:01:31] Ep. 28 : Up. 356000 : Sen. 2,028,404 : Cost 45.70937729 : Time 904.82s : 8564.61 words/s
[2019-07-16 20:16:36] Ep. 28 : Up. 358000 : Sen. 2,339,991 : Cost 45.82878876 : Time 905.12s : 8512.06 words/s
[2019-07-16 20:31:46] Ep. 28 : Up. 360000 : Sen. 2,652,272 : Cost 45.96432877 : Time 910.11s : 8521.48 words/s
[2019-07-16 20:31:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-16 20:31:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter360000.npz
[2019-07-16 20:32:02] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-16 20:32:12] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-16 20:32:36] [valid] Ep. 28 : Up. 360000 : cross-entropy : 46.4598 : stalled 1 times (last best: 46.4288)
[2019-07-16 20:32:44] [valid] Ep. 28 : Up. 360000 : perplexity : 6.26086 : stalled 1 times (last best: 6.25321)
[2019-07-16 20:33:25] Error: Unknown word id: 49990
[2019-07-16 20:33:25] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f56358bfa99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f56353dfc80]                                                       + 0xb8c80
[0x7f56358b86ba]                                                       + 0x76ba
[0x7f5634b4541d]    clone                                              + 0x6d

[2019-07-17 08:34:54] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-17 08:34:54] [marian] Running on hodor as process 171051 with command line:
[2019-07-17 08:34:54] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz -T . --devices 0 --train-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-17 08:34:54] [config] after-batches: 0
[2019-07-17 08:34:54] [config] after-epochs: 0
[2019-07-17 08:34:54] [config] allow-unk: false
[2019-07-17 08:34:54] [config] beam-size: 12
[2019-07-17 08:34:54] [config] bert-class-symbol: "[CLS]"
[2019-07-17 08:34:54] [config] bert-mask-symbol: "[MASK]"
[2019-07-17 08:34:54] [config] bert-masking-fraction: 0.15
[2019-07-17 08:34:54] [config] bert-sep-symbol: "[SEP]"
[2019-07-17 08:34:54] [config] bert-train-type-embeddings: true
[2019-07-17 08:34:54] [config] bert-type-vocab-size: 2
[2019-07-17 08:34:54] [config] best-deep: false
[2019-07-17 08:34:54] [config] clip-gemm: 0
[2019-07-17 08:34:54] [config] clip-norm: 1
[2019-07-17 08:34:54] [config] cost-type: ce-mean
[2019-07-17 08:34:54] [config] cpu-threads: 0
[2019-07-17 08:34:54] [config] data-weighting: ""
[2019-07-17 08:34:54] [config] data-weighting-type: sentence
[2019-07-17 08:34:54] [config] dec-cell: gru
[2019-07-17 08:34:54] [config] dec-cell-base-depth: 2
[2019-07-17 08:34:54] [config] dec-cell-high-depth: 1
[2019-07-17 08:34:54] [config] dec-depth: 1
[2019-07-17 08:34:54] [config] devices:
[2019-07-17 08:34:54] [config]   - 0
[2019-07-17 08:34:54] [config] dim-emb: 512
[2019-07-17 08:34:54] [config] dim-rnn: 1024
[2019-07-17 08:34:54] [config] dim-vocabs:
[2019-07-17 08:34:54] [config]   - 50000
[2019-07-17 08:34:54] [config]   - 50000
[2019-07-17 08:34:54] [config] disp-first: 0
[2019-07-17 08:34:54] [config] disp-freq: 2000
[2019-07-17 08:34:54] [config] disp-label-counts: false
[2019-07-17 08:34:54] [config] dropout-rnn: 0.2
[2019-07-17 08:34:54] [config] dropout-src: 0.1
[2019-07-17 08:34:54] [config] dropout-trg: 0.1
[2019-07-17 08:34:54] [config] dump-config: ""
[2019-07-17 08:34:54] [config] early-stopping: 5
[2019-07-17 08:34:54] [config] embedding-fix-src: false
[2019-07-17 08:34:54] [config] embedding-fix-trg: false
[2019-07-17 08:34:54] [config] embedding-normalization: false
[2019-07-17 08:34:54] [config] embedding-vectors:
[2019-07-17 08:34:54] [config]   []
[2019-07-17 08:34:54] [config] enc-cell: gru
[2019-07-17 08:34:54] [config] enc-cell-depth: 1
[2019-07-17 08:34:54] [config] enc-depth: 1
[2019-07-17 08:34:54] [config] enc-type: bidirectional
[2019-07-17 08:34:54] [config] exponential-smoothing: 0.0001
[2019-07-17 08:34:54] [config] grad-dropping-momentum: 0
[2019-07-17 08:34:54] [config] grad-dropping-rate: 0
[2019-07-17 08:34:54] [config] grad-dropping-warmup: 100
[2019-07-17 08:34:54] [config] guided-alignment: none
[2019-07-17 08:34:54] [config] guided-alignment-cost: mse
[2019-07-17 08:34:54] [config] guided-alignment-weight: 0.1
[2019-07-17 08:34:54] [config] ignore-model-config: false
[2019-07-17 08:34:54] [config] input-types:
[2019-07-17 08:34:54] [config]   []
[2019-07-17 08:34:54] [config] interpolate-env-vars: false
[2019-07-17 08:34:54] [config] keep-best: false
[2019-07-17 08:34:54] [config] label-smoothing: 0
[2019-07-17 08:34:54] [config] layer-normalization: true
[2019-07-17 08:34:54] [config] learn-rate: 0.0001
[2019-07-17 08:34:54] [config] log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/train.log
[2019-07-17 08:34:54] [config] log-level: info
[2019-07-17 08:34:54] [config] log-time-zone: ""
[2019-07-17 08:34:54] [config] lr-decay: 0
[2019-07-17 08:34:54] [config] lr-decay-freq: 50000
[2019-07-17 08:34:54] [config] lr-decay-inv-sqrt:
[2019-07-17 08:34:54] [config]   - 0
[2019-07-17 08:34:54] [config] lr-decay-repeat-warmup: false
[2019-07-17 08:34:54] [config] lr-decay-reset-optimizer: false
[2019-07-17 08:34:54] [config] lr-decay-start:
[2019-07-17 08:34:54] [config]   - 10
[2019-07-17 08:34:54] [config]   - 1
[2019-07-17 08:34:54] [config] lr-decay-strategy: epoch+stalled
[2019-07-17 08:34:54] [config] lr-report: false
[2019-07-17 08:34:54] [config] lr-warmup: 0
[2019-07-17 08:34:54] [config] lr-warmup-at-reload: false
[2019-07-17 08:34:54] [config] lr-warmup-cycle: false
[2019-07-17 08:34:54] [config] lr-warmup-start-rate: 0
[2019-07-17 08:34:54] [config] max-length: 50
[2019-07-17 08:34:54] [config] max-length-crop: false
[2019-07-17 08:34:54] [config] max-length-factor: 3
[2019-07-17 08:34:54] [config] maxi-batch: 100
[2019-07-17 08:34:54] [config] maxi-batch-sort: trg
[2019-07-17 08:34:54] [config] mini-batch: 64
[2019-07-17 08:34:54] [config] mini-batch-fit: true
[2019-07-17 08:34:54] [config] mini-batch-fit-step: 10
[2019-07-17 08:34:54] [config] mini-batch-overstuff: 1
[2019-07-17 08:34:54] [config] mini-batch-track-lr: false
[2019-07-17 08:34:54] [config] mini-batch-understuff: 1
[2019-07-17 08:34:54] [config] mini-batch-warmup: 0
[2019-07-17 08:34:54] [config] mini-batch-words: 0
[2019-07-17 08:34:54] [config] mini-batch-words-ref: 0
[2019-07-17 08:34:54] [config] model: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 08:34:54] [config] multi-loss-type: sum
[2019-07-17 08:34:54] [config] multi-node: false
[2019-07-17 08:34:54] [config] multi-node-overlap: true
[2019-07-17 08:34:54] [config] n-best: false
[2019-07-17 08:34:54] [config] no-nccl: false
[2019-07-17 08:34:54] [config] no-reload: false
[2019-07-17 08:34:54] [config] no-restore-corpus: false
[2019-07-17 08:34:54] [config] no-shuffle: false
[2019-07-17 08:34:54] [config] normalize: 1
[2019-07-17 08:34:54] [config] num-devices: 0
[2019-07-17 08:34:54] [config] optimizer: adam
[2019-07-17 08:34:54] [config] optimizer-delay: 1
[2019-07-17 08:34:54] [config] optimizer-params:
[2019-07-17 08:34:54] [config]   []
[2019-07-17 08:34:54] [config] overwrite: false
[2019-07-17 08:34:54] [config] pretrained-model: ""
[2019-07-17 08:34:54] [config] quiet: false
[2019-07-17 08:34:54] [config] quiet-translation: true
[2019-07-17 08:34:54] [config] relative-paths: false
[2019-07-17 08:34:54] [config] right-left: false
[2019-07-17 08:34:54] [config] save-freq: 20000
[2019-07-17 08:34:54] [config] seed: 1111
[2019-07-17 08:34:54] [config] shuffle-in-ram: false
[2019-07-17 08:34:54] [config] skip: false
[2019-07-17 08:34:54] [config] sqlite: ""
[2019-07-17 08:34:54] [config] sqlite-drop: false
[2019-07-17 08:34:54] [config] sync-sgd: true
[2019-07-17 08:34:54] [config] tempdir: .
[2019-07-17 08:34:54] [config] tied-embeddings: false
[2019-07-17 08:34:54] [config] tied-embeddings-all: false
[2019-07-17 08:34:54] [config] tied-embeddings-src: false
[2019-07-17 08:34:54] [config] train-sets:
[2019-07-17 08:34:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de
[2019-07-17 08:34:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en
[2019-07-17 08:34:54] [config] transformer-aan-activation: swish
[2019-07-17 08:34:54] [config] transformer-aan-depth: 2
[2019-07-17 08:34:54] [config] transformer-aan-nogate: false
[2019-07-17 08:34:54] [config] transformer-decoder-autoreg: self-attention
[2019-07-17 08:34:54] [config] transformer-dim-aan: 2048
[2019-07-17 08:34:54] [config] transformer-dim-ffn: 2048
[2019-07-17 08:34:54] [config] transformer-dropout: 0
[2019-07-17 08:34:54] [config] transformer-dropout-attention: 0
[2019-07-17 08:34:54] [config] transformer-dropout-ffn: 0
[2019-07-17 08:34:54] [config] transformer-ffn-activation: swish
[2019-07-17 08:34:54] [config] transformer-ffn-depth: 2
[2019-07-17 08:34:54] [config] transformer-guided-alignment-layer: last
[2019-07-17 08:34:54] [config] transformer-heads: 8
[2019-07-17 08:34:54] [config] transformer-no-projection: false
[2019-07-17 08:34:54] [config] transformer-postprocess: dan
[2019-07-17 08:34:54] [config] transformer-postprocess-emb: d
[2019-07-17 08:34:54] [config] transformer-preprocess: ""
[2019-07-17 08:34:54] [config] transformer-tied-layers:
[2019-07-17 08:34:54] [config]   []
[2019-07-17 08:34:54] [config] transformer-train-position-embeddings: false
[2019-07-17 08:34:54] [config] type: amun
[2019-07-17 08:34:54] [config] ulr: false
[2019-07-17 08:34:54] [config] ulr-dim-emb: 0
[2019-07-17 08:34:54] [config] ulr-dropout: 0
[2019-07-17 08:34:54] [config] ulr-keys-vectors: ""
[2019-07-17 08:34:54] [config] ulr-query-vectors: ""
[2019-07-17 08:34:54] [config] ulr-softmax-temperature: 1
[2019-07-17 08:34:54] [config] ulr-trainable-transformation: false
[2019-07-17 08:34:54] [config] valid-freq: 20000
[2019-07-17 08:34:54] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/valid.log
[2019-07-17 08:34:54] [config] valid-max-length: 1000
[2019-07-17 08:34:54] [config] valid-metrics:
[2019-07-17 08:34:54] [config]   - cross-entropy
[2019-07-17 08:34:54] [config]   - perplexity
[2019-07-17 08:34:54] [config]   - translation
[2019-07-17 08:34:54] [config] valid-mini-batch: 8
[2019-07-17 08:34:54] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/score-dev.sh
[2019-07-17 08:34:54] [config] valid-sets:
[2019-07-17 08:34:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.de
[2019-07-17 08:34:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/dev.bpe.en
[2019-07-17 08:34:54] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/dev.out
[2019-07-17 08:34:54] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-17 08:34:54] [config] vocabs:
[2019-07-17 08:34:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-17 08:34:54] [config]   - ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-17 08:34:54] [config] word-penalty: 0
[2019-07-17 08:34:54] [config] workspace: 5000
[2019-07-17 08:34:54] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-17 08:34:54] Using synchronous training
[2019-07-17 08:34:54] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.de.json
[2019-07-17 08:34:54] [data] Using unused word id eos for 0
[2019-07-17 08:34:54] [data] Using unused word id UNK for 1
[2019-07-17 08:34:54] [data] Setting vocabulary size for input 0 to 50000
[2019-07-17 08:34:54] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/data/train.bpe.en.json
[2019-07-17 08:34:55] [data] Using unused word id eos for 0
[2019-07-17 08:34:55] [data] Using unused word id UNK for 1
[2019-07-17 08:34:55] [data] Setting vocabulary size for input 1 to 50000
[2019-07-17 08:34:55] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-17 08:34:55] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-17 08:34:56] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-17 08:34:56] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-17 08:34:56] [comm] NCCLCommunicator constructed successfully.
[2019-07-17 08:34:56] [training] Using 1 GPUs
[2019-07-17 08:34:56] [memory] Reserving 422 MB, device gpu0
[2019-07-17 08:34:56] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-17 08:34:56] [memory] Reserving 422 MB, device gpu0
[2019-07-17 08:35:05] [batching] Done. Typical MB size is 6880 target words
[2019-07-17 08:35:05] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-17 08:35:05] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-17 08:35:05] [comm] NCCLCommunicator constructed successfully.
[2019-07-17 08:35:05] [training] Using 1 GPUs
[2019-07-17 08:35:05] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 08:35:12] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-17 08:35:23] [memory] Reserving 844 MB, device gpu0
[2019-07-17 08:35:24] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 08:35:24] [data] Restoring the corpus state to epoch 28, batch 360000
[2019-07-17 08:35:24] [data] Shuffling data
[2019-07-17 08:35:37] [data] Done reading 4355038 sentences
[2019-07-17 08:35:58] [data] Done shuffling 4355038 sentences to temp files
[2019-07-17 08:37:29] Training started
[2019-07-17 08:37:29] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-17 08:37:29] [memory] Reserving 422 MB, device gpu0
[2019-07-17 08:37:30] [memory] Reserving 422 MB, device gpu0
[2019-07-17 08:37:30] Loading model from ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 08:37:36] [memory] Reserving 422 MB, device cpu0
[2019-07-17 08:37:37] [memory] Reserving 422 MB, device gpu0
[2019-07-17 08:52:24] Ep. 28 : Up. 362000 : Sen. 2,964,381 : Cost 45.77367020 : Time 1049.33s : 7362.83 words/s
[2019-07-17 09:07:21] Ep. 28 : Up. 364000 : Sen. 3,276,132 : Cost 46.10732651 : Time 896.92s : 8618.07 words/s
[2019-07-17 09:19:38] Seen 3532755 samples
[2019-07-17 09:19:38] Starting epoch 29
[2019-07-17 09:19:38] [data] Shuffling data
[2019-07-17 09:19:40] [data] Done reading 4355038 sentences
[2019-07-17 09:19:59] [data] Done shuffling 4355038 sentences to temp files
[2019-07-17 09:22:43] Ep. 29 : Up. 366000 : Sen. 55,157 : Cost 45.79405212 : Time 922.34s : 8374.99 words/s
[2019-07-17 09:37:41] Ep. 29 : Up. 368000 : Sen. 368,040 : Cost 44.62941360 : Time 897.96s : 8604.93 words/s
[2019-07-17 09:52:37] Ep. 29 : Up. 370000 : Sen. 679,534 : Cost 45.13928604 : Time 895.10s : 8617.64 words/s
[2019-07-17 10:07:34] Ep. 29 : Up. 372000 : Sen. 991,157 : Cost 45.44365311 : Time 897.29s : 8609.45 words/s
[2019-07-17 10:22:34] Ep. 29 : Up. 374000 : Sen. 1,303,324 : Cost 45.17004395 : Time 899.75s : 8594.61 words/s
[2019-07-17 10:37:27] Ep. 29 : Up. 376000 : Sen. 1,614,550 : Cost 45.41467667 : Time 893.55s : 8626.79 words/s
[2019-07-17 10:52:25] Ep. 29 : Up. 378000 : Sen. 1,926,630 : Cost 45.50913239 : Time 897.98s : 8607.82 words/s
[2019-07-17 11:07:21] Ep. 29 : Up. 380000 : Sen. 2,237,648 : Cost 45.58784485 : Time 895.99s : 8602.78 words/s
[2019-07-17 11:07:21] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 11:07:30] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter380000.npz
[2019-07-17 11:07:37] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 11:07:46] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-17 11:08:11] [valid] Ep. 29 : Up. 380000 : cross-entropy : 46.4364 : stalled 1 times (last best: 46.4288)
[2019-07-17 11:08:19] [valid] Ep. 29 : Up. 380000 : perplexity : 6.25509 : stalled 1 times (last best: 6.25321)
[2019-07-17 11:09:20] [valid] Ep. 29 : Up. 380000 : translation : 31.69 : stalled 3 times (last best: 31.8)
[2019-07-17 11:24:23] Ep. 29 : Up. 382000 : Sen. 2,550,336 : Cost 45.64732742 : Time 1021.82s : 7574.73 words/s
[2019-07-17 11:39:24] Ep. 29 : Up. 384000 : Sen. 2,861,636 : Cost 45.80971527 : Time 901.44s : 8561.37 words/s
[2019-07-17 11:54:23] Ep. 29 : Up. 386000 : Sen. 3,173,831 : Cost 45.70352554 : Time 898.56s : 8593.11 words/s
[2019-07-17 12:09:21] Ep. 29 : Up. 388000 : Sen. 3,485,050 : Cost 45.68399048 : Time 897.78s : 8581.03 words/s
[2019-07-17 12:11:39] Seen 3532755 samples
[2019-07-17 12:11:39] Starting epoch 30
[2019-07-17 12:11:39] [data] Shuffling data
[2019-07-17 12:11:42] [data] Done reading 4355038 sentences
[2019-07-17 12:12:06] [data] Done shuffling 4355038 sentences to temp files
[2019-07-17 12:24:49] Ep. 30 : Up. 390000 : Sen. 262,971 : Cost 44.91466904 : Time 928.45s : 8294.81 words/s
[2019-07-17 12:39:51] Ep. 30 : Up. 392000 : Sen. 575,102 : Cost 44.84955215 : Time 902.29s : 8568.43 words/s
[2019-07-17 12:54:50] Ep. 30 : Up. 394000 : Sen. 887,081 : Cost 44.95844650 : Time 898.84s : 8590.83 words/s
[2019-07-17 13:09:52] Ep. 30 : Up. 396000 : Sen. 1,199,213 : Cost 45.07734299 : Time 901.77s : 8570.40 words/s
[2019-07-17 13:24:51] Ep. 30 : Up. 398000 : Sen. 1,511,283 : Cost 45.25640869 : Time 898.48s : 8596.35 words/s
[2019-07-17 13:39:49] Ep. 30 : Up. 400000 : Sen. 1,822,938 : Cost 45.35712433 : Time 898.90s : 8578.34 words/s
[2019-07-17 13:39:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 13:39:58] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter400000.npz
[2019-07-17 13:40:05] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 13:40:15] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-17 13:40:38] [valid] Ep. 30 : Up. 400000 : cross-entropy : 46.4907 : stalled 2 times (last best: 46.4288)
[2019-07-17 13:40:46] [valid] Ep. 30 : Up. 400000 : perplexity : 6.26851 : stalled 2 times (last best: 6.25321)
[2019-07-17 13:41:47] [valid] Ep. 30 : Up. 400000 : translation : 31.89 : new best
[2019-07-17 13:56:49] Ep. 30 : Up. 402000 : Sen. 2,135,523 : Cost 45.23442078 : Time 1019.79s : 7586.20 words/s
[2019-07-17 14:11:51] Ep. 30 : Up. 404000 : Sen. 2,448,385 : Cost 45.33521652 : Time 901.93s : 8567.05 words/s
[2019-07-17 14:26:53] Ep. 30 : Up. 406000 : Sen. 2,759,836 : Cost 45.42819977 : Time 901.89s : 8566.06 words/s
[2019-07-17 14:41:54] Ep. 30 : Up. 408000 : Sen. 3,071,599 : Cost 45.54363251 : Time 901.22s : 8579.40 words/s
[2019-07-17 14:56:54] Ep. 30 : Up. 410000 : Sen. 3,383,957 : Cost 45.52248383 : Time 899.58s : 8584.97 words/s
[2019-07-17 15:04:06] Seen 3532755 samples
[2019-07-17 15:04:06] Starting epoch 31
[2019-07-17 15:04:06] [data] Shuffling data
[2019-07-17 15:04:08] [data] Done reading 4355038 sentences
[2019-07-17 15:04:28] [data] Done shuffling 4355038 sentences to temp files
[2019-07-17 15:12:25] Ep. 31 : Up. 412000 : Sen. 161,995 : Cost 45.32472992 : Time 930.86s : 8291.74 words/s
[2019-07-17 15:27:29] Ep. 31 : Up. 414000 : Sen. 475,238 : Cost 44.54150772 : Time 903.93s : 8586.66 words/s
[2019-07-17 15:42:30] Ep. 31 : Up. 416000 : Sen. 787,596 : Cost 44.57207870 : Time 901.46s : 8562.28 words/s
[2019-07-17 15:57:28] Ep. 31 : Up. 418000 : Sen. 1,098,657 : Cost 44.66220474 : Time 897.57s : 8577.18 words/s
[2019-07-17 16:12:28] Ep. 31 : Up. 420000 : Sen. 1,410,123 : Cost 44.82843781 : Time 900.40s : 8563.19 words/s
[2019-07-17 16:12:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 16:12:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter420000.npz
[2019-07-17 16:12:45] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 16:12:55] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-17 16:13:20] [valid] Ep. 31 : Up. 420000 : cross-entropy : 46.4449 : stalled 3 times (last best: 46.4288)
[2019-07-17 16:13:28] [valid] Ep. 31 : Up. 420000 : perplexity : 6.25717 : stalled 3 times (last best: 6.25321)
[2019-07-17 16:14:28] [valid] Ep. 31 : Up. 420000 : translation : 31.8 : stalled 1 times (last best: 31.89)
[2019-07-17 16:29:31] Ep. 31 : Up. 422000 : Sen. 1,721,600 : Cost 44.92993546 : Time 1022.57s : 7547.88 words/s
[2019-07-17 16:44:29] Ep. 31 : Up. 424000 : Sen. 2,032,282 : Cost 45.24264526 : Time 898.50s : 8566.70 words/s
[2019-07-17 16:59:31] Ep. 31 : Up. 426000 : Sen. 2,344,208 : Cost 45.28231430 : Time 901.42s : 8583.40 words/s
[2019-07-17 17:14:34] Ep. 31 : Up. 428000 : Sen. 2,657,029 : Cost 45.36923218 : Time 903.77s : 8567.67 words/s
[2019-07-17 17:29:33] Ep. 31 : Up. 430000 : Sen. 2,968,668 : Cost 45.27929688 : Time 898.36s : 8588.47 words/s
[2019-07-17 17:44:33] Ep. 31 : Up. 432000 : Sen. 3,279,776 : Cost 45.37998962 : Time 900.33s : 8550.14 words/s
[2019-07-17 17:56:45] Seen 3532755 samples
[2019-07-17 17:56:45] Starting epoch 32
[2019-07-17 17:56:45] [data] Shuffling data
[2019-07-17 17:56:48] [data] Done reading 4355038 sentences
[2019-07-17 17:57:06] [data] Done shuffling 4355038 sentences to temp files
[2019-07-17 17:59:57] Ep. 32 : Up. 434000 : Sen. 58,302 : Cost 45.22863770 : Time 923.81s : 8342.50 words/s
[2019-07-17 18:14:54] Ep. 32 : Up. 436000 : Sen. 369,349 : Cost 44.34605789 : Time 896.94s : 8598.06 words/s
[2019-07-17 18:29:54] Ep. 32 : Up. 438000 : Sen. 681,631 : Cost 44.27233505 : Time 900.19s : 8570.47 words/s
[2019-07-17 18:44:59] Ep. 32 : Up. 440000 : Sen. 993,774 : Cost 44.94682693 : Time 904.63s : 8557.91 words/s
[2019-07-17 18:44:59] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 18:45:11] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter440000.npz
[2019-07-17 18:45:22] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 18:45:32] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-17 18:46:01] [valid] Ep. 32 : Up. 440000 : cross-entropy : 46.5241 : stalled 4 times (last best: 46.4288)
[2019-07-17 18:46:08] [valid] Ep. 32 : Up. 440000 : perplexity : 6.27677 : stalled 4 times (last best: 6.25321)
[2019-07-17 18:47:09] [valid] Ep. 32 : Up. 440000 : translation : 31.76 : stalled 2 times (last best: 31.89)
[2019-07-17 19:02:12] Ep. 32 : Up. 442000 : Sen. 1,306,330 : Cost 44.89747620 : Time 1033.18s : 7495.21 words/s
[2019-07-17 19:17:15] Ep. 32 : Up. 444000 : Sen. 1,618,664 : Cost 44.69516754 : Time 902.78s : 8564.61 words/s
[2019-07-17 19:32:15] Ep. 32 : Up. 446000 : Sen. 1,929,933 : Cost 45.12606812 : Time 900.57s : 8569.97 words/s
[2019-07-17 19:47:14] Ep. 32 : Up. 448000 : Sen. 2,241,661 : Cost 44.84865189 : Time 898.89s : 8558.93 words/s
[2019-07-17 20:02:20] Ep. 32 : Up. 450000 : Sen. 2,555,107 : Cost 45.30913925 : Time 906.31s : 8569.58 words/s
[2019-07-17 20:17:19] Ep. 32 : Up. 452000 : Sen. 2,866,027 : Cost 45.25685120 : Time 898.85s : 8582.94 words/s
[2019-07-17 20:32:19] Ep. 32 : Up. 454000 : Sen. 3,178,017 : Cost 45.04420471 : Time 899.31s : 8577.45 words/s
[2019-07-17 20:47:16] Ep. 32 : Up. 456000 : Sen. 3,490,316 : Cost 45.19815826 : Time 897.37s : 8607.37 words/s
[2019-07-17 20:49:19] Seen 3532755 samples
[2019-07-17 20:49:19] Starting epoch 33
[2019-07-17 20:49:19] [data] Shuffling data
[2019-07-17 20:49:22] [data] Done reading 4355038 sentences
[2019-07-17 20:49:42] [data] Done shuffling 4355038 sentences to temp files
[2019-07-17 21:02:40] Ep. 33 : Up. 458000 : Sen. 268,536 : Cost 44.20694733 : Time 923.91s : 8336.66 words/s
[2019-07-17 21:17:37] Ep. 33 : Up. 460000 : Sen. 579,255 : Cost 44.38603592 : Time 897.53s : 8566.40 words/s
[2019-07-17 21:17:37] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 21:17:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.iter460000.npz
[2019-07-17 21:17:53] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 21:18:02] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
[2019-07-17 21:18:26] [valid] Ep. 33 : Up. 460000 : cross-entropy : 46.4496 : stalled 5 times (last best: 46.4288)
[2019-07-17 21:18:33] [valid] Ep. 33 : Up. 460000 : perplexity : 6.25835 : stalled 5 times (last best: 6.25321)
[2019-07-17 21:19:37] [valid] Ep. 33 : Up. 460000 : translation : 31.75 : stalled 3 times (last best: 31.89)
[2019-07-17 21:19:39] Training finished
[2019-07-17 21:19:43] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.orig.npz
[2019-07-17 21:19:52] Saving model to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz
[2019-07-17 21:20:01] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_bic1.1_x_ced_0.0_x_dcce/model/model.npz.optimizer.npz
