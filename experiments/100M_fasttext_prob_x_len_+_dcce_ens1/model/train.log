[2019-07-11 18:36:52] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 18:36:52] [marian] Running on dagr as process 162805 with command line:
[2019-07-11 18:36:52] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/valid.log
[2019-07-11 18:36:52] [config] after-batches: 0
[2019-07-11 18:36:52] [config] after-epochs: 0
[2019-07-11 18:36:52] [config] allow-unk: false
[2019-07-11 18:36:52] [config] beam-size: 12
[2019-07-11 18:36:52] [config] bert-class-symbol: "[CLS]"
[2019-07-11 18:36:52] [config] bert-mask-symbol: "[MASK]"
[2019-07-11 18:36:52] [config] bert-masking-fraction: 0.15
[2019-07-11 18:36:52] [config] bert-sep-symbol: "[SEP]"
[2019-07-11 18:36:52] [config] bert-train-type-embeddings: true
[2019-07-11 18:36:52] [config] bert-type-vocab-size: 2
[2019-07-11 18:36:52] [config] best-deep: false
[2019-07-11 18:36:52] [config] clip-gemm: 0
[2019-07-11 18:36:52] [config] clip-norm: 1
[2019-07-11 18:36:52] [config] cost-type: ce-mean
[2019-07-11 18:36:52] [config] cpu-threads: 0
[2019-07-11 18:36:52] [config] data-weighting: ""
[2019-07-11 18:36:52] [config] data-weighting-type: sentence
[2019-07-11 18:36:52] [config] dec-cell: gru
[2019-07-11 18:36:52] [config] dec-cell-base-depth: 2
[2019-07-11 18:36:52] [config] dec-cell-high-depth: 1
[2019-07-11 18:36:52] [config] dec-depth: 1
[2019-07-11 18:36:52] [config] devices:
[2019-07-11 18:36:52] [config]   - 0
[2019-07-11 18:36:52] [config]   - 1
[2019-07-11 18:36:52] [config] dim-emb: 512
[2019-07-11 18:36:52] [config] dim-rnn: 1024
[2019-07-11 18:36:52] [config] dim-vocabs:
[2019-07-11 18:36:52] [config]   - 50000
[2019-07-11 18:36:52] [config]   - 50000
[2019-07-11 18:36:52] [config] disp-first: 0
[2019-07-11 18:36:52] [config] disp-freq: 2000
[2019-07-11 18:36:52] [config] disp-label-counts: false
[2019-07-11 18:36:52] [config] dropout-rnn: 0.2
[2019-07-11 18:36:52] [config] dropout-src: 0.1
[2019-07-11 18:36:52] [config] dropout-trg: 0.1
[2019-07-11 18:36:52] [config] dump-config: ""
[2019-07-11 18:36:52] [config] early-stopping: 5
[2019-07-11 18:36:52] [config] embedding-fix-src: false
[2019-07-11 18:36:52] [config] embedding-fix-trg: false
[2019-07-11 18:36:52] [config] embedding-normalization: false
[2019-07-11 18:36:52] [config] embedding-vectors:
[2019-07-11 18:36:52] [config]   []
[2019-07-11 18:36:52] [config] enc-cell: gru
[2019-07-11 18:36:52] [config] enc-cell-depth: 1
[2019-07-11 18:36:52] [config] enc-depth: 1
[2019-07-11 18:36:52] [config] enc-type: bidirectional
[2019-07-11 18:36:52] [config] exponential-smoothing: 0.0001
[2019-07-11 18:36:52] [config] grad-dropping-momentum: 0
[2019-07-11 18:36:52] [config] grad-dropping-rate: 0
[2019-07-11 18:36:52] [config] grad-dropping-warmup: 100
[2019-07-11 18:36:52] [config] guided-alignment: none
[2019-07-11 18:36:52] [config] guided-alignment-cost: mse
[2019-07-11 18:36:52] [config] guided-alignment-weight: 0.1
[2019-07-11 18:36:52] [config] ignore-model-config: false
[2019-07-11 18:36:52] [config] input-types:
[2019-07-11 18:36:52] [config]   []
[2019-07-11 18:36:52] [config] interpolate-env-vars: false
[2019-07-11 18:36:52] [config] keep-best: false
[2019-07-11 18:36:52] [config] label-smoothing: 0
[2019-07-11 18:36:52] [config] layer-normalization: true
[2019-07-11 18:36:52] [config] learn-rate: 0.0001
[2019-07-11 18:36:52] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/train.log
[2019-07-11 18:36:52] [config] log-level: info
[2019-07-11 18:36:52] [config] log-time-zone: ""
[2019-07-11 18:36:52] [config] lr-decay: 0
[2019-07-11 18:36:52] [config] lr-decay-freq: 50000
[2019-07-11 18:36:52] [config] lr-decay-inv-sqrt:
[2019-07-11 18:36:52] [config]   - 0
[2019-07-11 18:36:52] [config] lr-decay-repeat-warmup: false
[2019-07-11 18:36:52] [config] lr-decay-reset-optimizer: false
[2019-07-11 18:36:52] [config] lr-decay-start:
[2019-07-11 18:36:52] [config]   - 10
[2019-07-11 18:36:52] [config]   - 1
[2019-07-11 18:36:52] [config] lr-decay-strategy: epoch+stalled
[2019-07-11 18:36:52] [config] lr-report: false
[2019-07-11 18:36:52] [config] lr-warmup: 0
[2019-07-11 18:36:52] [config] lr-warmup-at-reload: false
[2019-07-11 18:36:52] [config] lr-warmup-cycle: false
[2019-07-11 18:36:52] [config] lr-warmup-start-rate: 0
[2019-07-11 18:36:52] [config] max-length: 50
[2019-07-11 18:36:52] [config] max-length-crop: false
[2019-07-11 18:36:52] [config] max-length-factor: 3
[2019-07-11 18:36:52] [config] maxi-batch: 100
[2019-07-11 18:36:52] [config] maxi-batch-sort: trg
[2019-07-11 18:36:52] [config] mini-batch: 64
[2019-07-11 18:36:52] [config] mini-batch-fit: true
[2019-07-11 18:36:52] [config] mini-batch-fit-step: 10
[2019-07-11 18:36:52] [config] mini-batch-overstuff: 1
[2019-07-11 18:36:52] [config] mini-batch-track-lr: false
[2019-07-11 18:36:52] [config] mini-batch-understuff: 1
[2019-07-11 18:36:52] [config] mini-batch-warmup: 0
[2019-07-11 18:36:52] [config] mini-batch-words: 0
[2019-07-11 18:36:52] [config] mini-batch-words-ref: 0
[2019-07-11 18:36:52] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-11 18:36:52] [config] multi-loss-type: sum
[2019-07-11 18:36:52] [config] multi-node: false
[2019-07-11 18:36:52] [config] multi-node-overlap: true
[2019-07-11 18:36:52] [config] n-best: false
[2019-07-11 18:36:52] [config] no-nccl: false
[2019-07-11 18:36:52] [config] no-reload: false
[2019-07-11 18:36:52] [config] no-restore-corpus: false
[2019-07-11 18:36:52] [config] no-shuffle: false
[2019-07-11 18:36:52] [config] normalize: 1
[2019-07-11 18:36:52] [config] num-devices: 0
[2019-07-11 18:36:52] [config] optimizer: adam
[2019-07-11 18:36:52] [config] optimizer-delay: 1
[2019-07-11 18:36:52] [config] optimizer-params:
[2019-07-11 18:36:52] [config]   []
[2019-07-11 18:36:52] [config] overwrite: false
[2019-07-11 18:36:52] [config] pretrained-model: ""
[2019-07-11 18:36:52] [config] quiet: false
[2019-07-11 18:36:52] [config] quiet-translation: true
[2019-07-11 18:36:52] [config] relative-paths: false
[2019-07-11 18:36:52] [config] right-left: false
[2019-07-11 18:36:52] [config] save-freq: 20000
[2019-07-11 18:36:52] [config] seed: 1111
[2019-07-11 18:36:52] [config] shuffle-in-ram: false
[2019-07-11 18:36:52] [config] skip: false
[2019-07-11 18:36:52] [config] sqlite: ""
[2019-07-11 18:36:52] [config] sqlite-drop: false
[2019-07-11 18:36:52] [config] sync-sgd: true
[2019-07-11 18:36:52] [config] tempdir: .
[2019-07-11 18:36:52] [config] tied-embeddings: false
[2019-07-11 18:36:52] [config] tied-embeddings-all: false
[2019-07-11 18:36:52] [config] tied-embeddings-src: false
[2019-07-11 18:36:52] [config] train-sets:
[2019-07-11 18:36:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de
[2019-07-11 18:36:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en
[2019-07-11 18:36:52] [config] transformer-aan-activation: swish
[2019-07-11 18:36:52] [config] transformer-aan-depth: 2
[2019-07-11 18:36:52] [config] transformer-aan-nogate: false
[2019-07-11 18:36:52] [config] transformer-decoder-autoreg: self-attention
[2019-07-11 18:36:52] [config] transformer-dim-aan: 2048
[2019-07-11 18:36:52] [config] transformer-dim-ffn: 2048
[2019-07-11 18:36:52] [config] transformer-dropout: 0
[2019-07-11 18:36:52] [config] transformer-dropout-attention: 0
[2019-07-11 18:36:52] [config] transformer-dropout-ffn: 0
[2019-07-11 18:36:52] [config] transformer-ffn-activation: swish
[2019-07-11 18:36:52] [config] transformer-ffn-depth: 2
[2019-07-11 18:36:52] [config] transformer-guided-alignment-layer: last
[2019-07-11 18:36:52] [config] transformer-heads: 8
[2019-07-11 18:36:52] [config] transformer-no-projection: false
[2019-07-11 18:36:52] [config] transformer-postprocess: dan
[2019-07-11 18:36:52] [config] transformer-postprocess-emb: d
[2019-07-11 18:36:52] [config] transformer-preprocess: ""
[2019-07-11 18:36:52] [config] transformer-tied-layers:
[2019-07-11 18:36:52] [config]   []
[2019-07-11 18:36:52] [config] transformer-train-position-embeddings: false
[2019-07-11 18:36:52] [config] type: amun
[2019-07-11 18:36:52] [config] ulr: false
[2019-07-11 18:36:52] [config] ulr-dim-emb: 0
[2019-07-11 18:36:52] [config] ulr-dropout: 0
[2019-07-11 18:36:52] [config] ulr-keys-vectors: ""
[2019-07-11 18:36:52] [config] ulr-query-vectors: ""
[2019-07-11 18:36:52] [config] ulr-softmax-temperature: 1
[2019-07-11 18:36:52] [config] ulr-trainable-transformation: false
[2019-07-11 18:36:52] [config] valid-freq: 20000
[2019-07-11 18:36:52] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/valid.log
[2019-07-11 18:36:52] [config] valid-max-length: 1000
[2019-07-11 18:36:52] [config] valid-metrics:
[2019-07-11 18:36:52] [config]   - cross-entropy
[2019-07-11 18:36:52] [config]   - perplexity
[2019-07-11 18:36:52] [config]   - translation
[2019-07-11 18:36:52] [config] valid-mini-batch: 8
[2019-07-11 18:36:52] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/score-dev.sh
[2019-07-11 18:36:52] [config] valid-sets:
[2019-07-11 18:36:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.de
[2019-07-11 18:36:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.en
[2019-07-11 18:36:52] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/dev.out
[2019-07-11 18:36:52] [config] vocabs:
[2019-07-11 18:36:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json
[2019-07-11 18:36:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json
[2019-07-11 18:36:52] [config] word-penalty: 0
[2019-07-11 18:36:52] [config] workspace: 6000
[2019-07-11 18:36:52] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 18:36:52] Using synchronous training
[2019-07-11 18:36:52] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json
[2019-07-11 18:36:53] [data] Using unused word id eos for 0
[2019-07-11 18:36:53] [data] Using unused word id UNK for 1
[2019-07-11 18:36:53] [data] Setting vocabulary size for input 0 to 50000
[2019-07-11 18:36:53] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json
[2019-07-11 18:36:53] [data] Using unused word id eos for 0
[2019-07-11 18:36:53] [data] Using unused word id UNK for 1
[2019-07-11 18:36:53] [data] Setting vocabulary size for input 1 to 50000
[2019-07-11 18:36:53] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-11 18:36:53] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-11 18:36:54] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-11 18:36:55] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-11 18:36:55] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-11 18:36:55] [comm] NCCLCommunicator constructed successfully.
[2019-07-11 18:36:55] [training] Using 2 GPUs
[2019-07-11 18:36:55] [memory] Reserving 422 MB, device gpu0
[2019-07-11 18:36:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-11 18:36:55] [memory] Reserving 422 MB, device gpu0
[2019-07-11 18:37:06] [batching] Done. Typical MB size is 16192 target words
[2019-07-11 18:37:06] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-11 18:37:06] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-11 18:37:06] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-11 18:37:06] [comm] NCCLCommunicator constructed successfully.
[2019-07-11 18:37:06] [training] Using 2 GPUs
[2019-07-11 18:37:06] Training started
[2019-07-11 18:37:06] [data] Shuffling data
[2019-07-11 18:37:09] [data] Done reading 5511754 sentences
[2019-07-11 18:37:31] [data] Done shuffling 5511754 sentences to temp files
[2019-07-11 18:37:35] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-11 18:37:35] [memory] Reserving 422 MB, device gpu1
[2019-07-11 18:37:35] [memory] Reserving 422 MB, device gpu0
[2019-07-11 18:37:36] [memory] Reserving 422 MB, device gpu0
[2019-07-11 18:37:36] [memory] Reserving 422 MB, device gpu1
[2019-07-11 18:37:36] [memory] Reserving 211 MB, device gpu0
[2019-07-11 18:37:36] [memory] Reserving 211 MB, device gpu1
[2019-07-11 18:37:36] [memory] Reserving 422 MB, device gpu0
[2019-07-11 18:37:36] [memory] Reserving 422 MB, device gpu1
[2019-07-11 18:54:05] Ep. 1 : Up. 2000 : Sen. 691,518 : Cost 114.73760986 : Time 1032.18s : 13574.54 words/s
[2019-07-11 19:10:36] Ep. 1 : Up. 4000 : Sen. 1,380,898 : Cost 85.50225830 : Time 990.77s : 14105.83 words/s
[2019-07-11 19:27:06] Ep. 1 : Up. 6000 : Sen. 2,069,794 : Cost 72.70494080 : Time 990.04s : 14100.08 words/s
[2019-07-11 19:43:35] Ep. 1 : Up. 8000 : Sen. 2,759,980 : Cost 65.66769409 : Time 989.10s : 14128.92 words/s
[2019-07-11 20:00:07] Ep. 1 : Up. 10000 : Sen. 3,449,600 : Cost 61.18430328 : Time 992.03s : 14106.35 words/s
[2019-07-11 20:16:38] Ep. 1 : Up. 12000 : Sen. 4,140,394 : Cost 57.99851608 : Time 991.14s : 14121.81 words/s
[2019-07-11 20:30:48] Seen 4731350 samples
[2019-07-11 20:30:48] Starting epoch 2
[2019-07-11 20:30:48] [data] Shuffling data
[2019-07-11 20:30:51] [data] Done reading 5511754 sentences
[2019-07-11 20:31:12] [data] Done shuffling 5511754 sentences to temp files
[2019-07-11 20:33:36] Ep. 2 : Up. 14000 : Sen. 96,863 : Cost 55.52926636 : Time 1017.43s : 13684.10 words/s
[2019-07-11 20:50:06] Ep. 2 : Up. 16000 : Sen. 786,564 : Cost 53.23204041 : Time 990.54s : 14098.75 words/s
[2019-07-11 21:06:38] Ep. 2 : Up. 18000 : Sen. 1,477,994 : Cost 51.96652222 : Time 991.26s : 14148.46 words/s
[2019-07-11 21:23:07] Ep. 2 : Up. 20000 : Sen. 2,170,554 : Cost 50.61918259 : Time 989.35s : 14172.56 words/s
[2019-07-11 21:23:07] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-11 21:23:17] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter20000.npz
[2019-07-11 21:23:24] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-11 21:23:34] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-11 21:23:56] [valid] Ep. 2 : Up. 20000 : cross-entropy : 67.7172 : new best
[2019-07-11 21:24:00] [valid] Ep. 2 : Up. 20000 : perplexity : 14.3024 : new best
[2019-07-11 21:24:37] [valid] Ep. 2 : Up. 20000 : translation : 24.25 : new best
[2019-07-11 21:41:05] Ep. 2 : Up. 22000 : Sen. 2,858,354 : Cost 49.62565231 : Time 1077.78s : 12931.64 words/s
[2019-07-11 21:57:31] Ep. 2 : Up. 24000 : Sen. 3,547,063 : Cost 48.98063660 : Time 986.36s : 14180.61 words/s
[2019-07-11 22:13:54] Ep. 2 : Up. 26000 : Sen. 4,235,528 : Cost 47.94665909 : Time 983.24s : 14162.85 words/s
[2019-07-11 22:25:46] Seen 4731350 samples
[2019-07-11 22:25:46] Starting epoch 3
[2019-07-11 22:25:46] [data] Shuffling data
[2019-07-11 22:25:49] [data] Done reading 5511754 sentences
[2019-07-11 22:26:10] [data] Done shuffling 5511754 sentences to temp files
[2019-07-11 22:30:52] Ep. 3 : Up. 28000 : Sen. 193,678 : Cost 47.20697021 : Time 1017.94s : 13732.41 words/s
[2019-07-11 22:47:17] Ep. 3 : Up. 30000 : Sen. 879,290 : Cost 46.10535812 : Time 985.16s : 14104.09 words/s
[2019-07-11 23:03:47] Ep. 3 : Up. 32000 : Sen. 1,571,680 : Cost 45.76895523 : Time 989.07s : 14179.72 words/s
[2019-07-11 23:20:12] Ep. 3 : Up. 34000 : Sen. 2,261,750 : Cost 45.25968170 : Time 985.19s : 14205.61 words/s
[2019-07-11 23:36:39] Ep. 3 : Up. 36000 : Sen. 2,954,805 : Cost 44.91915131 : Time 987.60s : 14232.47 words/s
[2019-07-11 23:53:06] Ep. 3 : Up. 38000 : Sen. 3,647,364 : Cost 44.43327713 : Time 986.51s : 14222.32 words/s
[2019-07-12 00:09:33] Ep. 3 : Up. 40000 : Sen. 4,336,486 : Cost 44.04271317 : Time 986.77s : 14150.36 words/s
[2019-07-12 00:09:33] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 00:09:42] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter40000.npz
[2019-07-12 00:09:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 00:10:00] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 00:10:22] [valid] Ep. 3 : Up. 40000 : cross-entropy : 58.636 : new best
[2019-07-12 00:10:26] [valid] Ep. 3 : Up. 40000 : perplexity : 10.0107 : new best
[2019-07-12 00:11:02] [valid] Ep. 3 : Up. 40000 : translation : 27.01 : new best
[2019-07-12 00:20:31] Seen 4731350 samples
[2019-07-12 00:20:31] Starting epoch 4
[2019-07-12 00:20:31] [data] Shuffling data
[2019-07-12 00:20:34] [data] Done reading 5511754 sentences
[2019-07-12 00:21:06] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 00:28:12] Ep. 4 : Up. 42000 : Sen. 295,036 : Cost 43.37813187 : Time 1119.58s : 12493.52 words/s
[2019-07-12 00:44:37] Ep. 4 : Up. 44000 : Sen. 984,646 : Cost 42.78459930 : Time 985.23s : 14183.43 words/s
[2019-07-12 01:01:03] Ep. 4 : Up. 46000 : Sen. 1,673,032 : Cost 42.74533844 : Time 985.60s : 14160.89 words/s
[2019-07-12 01:17:30] Ep. 4 : Up. 48000 : Sen. 2,364,711 : Cost 42.39206696 : Time 987.50s : 14183.16 words/s
[2019-07-12 01:33:57] Ep. 4 : Up. 50000 : Sen. 3,056,216 : Cost 42.13924026 : Time 986.26s : 14190.28 words/s
[2019-07-12 01:50:25] Ep. 4 : Up. 52000 : Sen. 3,745,146 : Cost 41.84487152 : Time 988.37s : 14134.64 words/s
[2019-07-12 02:06:56] Ep. 4 : Up. 54000 : Sen. 4,435,836 : Cost 41.74517059 : Time 990.96s : 14130.82 words/s
[2019-07-12 02:13:59] Seen 4731350 samples
[2019-07-12 02:13:59] Starting epoch 5
[2019-07-12 02:13:59] [data] Shuffling data
[2019-07-12 02:14:02] [data] Done reading 5511754 sentences
[2019-07-12 02:14:27] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 02:23:53] Ep. 5 : Up. 56000 : Sen. 392,506 : Cost 41.08063889 : Time 1017.26s : 13688.99 words/s
[2019-07-12 02:40:23] Ep. 5 : Up. 58000 : Sen. 1,081,918 : Cost 40.70787430 : Time 989.46s : 14132.55 words/s
[2019-07-12 02:56:49] Ep. 5 : Up. 60000 : Sen. 1,773,206 : Cost 40.49941254 : Time 986.50s : 14187.78 words/s
[2019-07-12 02:56:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 02:56:59] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter60000.npz
[2019-07-12 02:57:08] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 02:57:22] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 02:57:46] [valid] Ep. 5 : Up. 60000 : cross-entropy : 54.9833 : new best
[2019-07-12 02:57:50] [valid] Ep. 5 : Up. 60000 : perplexity : 8.67241 : new best
[2019-07-12 02:58:26] [valid] Ep. 5 : Up. 60000 : translation : 28.44 : new best
[2019-07-12 03:15:02] Ep. 5 : Up. 62000 : Sen. 2,466,097 : Cost 40.45438385 : Time 1092.44s : 12862.33 words/s
[2019-07-12 03:31:29] Ep. 5 : Up. 64000 : Sen. 3,157,836 : Cost 40.32403564 : Time 987.38s : 14173.34 words/s
[2019-07-12 03:47:57] Ep. 5 : Up. 66000 : Sen. 3,849,120 : Cost 40.34099579 : Time 988.22s : 14199.74 words/s
[2019-07-12 04:04:21] Ep. 5 : Up. 68000 : Sen. 4,537,918 : Cost 40.21159363 : Time 983.48s : 14186.47 words/s
[2019-07-12 04:08:57] Seen 4731350 samples
[2019-07-12 04:08:57] Starting epoch 6
[2019-07-12 04:08:57] [data] Shuffling data
[2019-07-12 04:09:00] [data] Done reading 5511754 sentences
[2019-07-12 04:09:22] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 04:21:19] Ep. 6 : Up. 70000 : Sen. 498,476 : Cost 39.46835709 : Time 1018.60s : 13768.63 words/s
[2019-07-12 04:37:45] Ep. 6 : Up. 72000 : Sen. 1,189,257 : Cost 39.10913467 : Time 985.64s : 14188.17 words/s
[2019-07-12 04:54:08] Ep. 6 : Up. 74000 : Sen. 1,877,548 : Cost 39.32019806 : Time 982.78s : 14208.43 words/s
[2019-07-12 05:10:35] Ep. 6 : Up. 76000 : Sen. 2,569,120 : Cost 39.23678207 : Time 987.13s : 14194.73 words/s
[2019-07-12 05:27:00] Ep. 6 : Up. 78000 : Sen. 3,258,236 : Cost 39.08852386 : Time 984.80s : 14189.10 words/s
[2019-07-12 05:43:27] Ep. 6 : Up. 80000 : Sen. 3,948,800 : Cost 38.97621536 : Time 986.77s : 14183.27 words/s
[2019-07-12 05:43:27] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 05:43:37] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter80000.npz
[2019-07-12 05:43:44] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 05:43:54] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 05:44:17] [valid] Ep. 6 : Up. 80000 : cross-entropy : 52.9774 : new best
[2019-07-12 05:44:21] [valid] Ep. 6 : Up. 80000 : perplexity : 8.01521 : new best
[2019-07-12 05:44:57] [valid] Ep. 6 : Up. 80000 : translation : 28.86 : new best
[2019-07-12 06:01:24] Ep. 6 : Up. 82000 : Sen. 4,636,742 : Cost 39.06609344 : Time 1077.56s : 12928.57 words/s
[2019-07-12 06:03:40] Seen 4731350 samples
[2019-07-12 06:03:40] Starting epoch 7
[2019-07-12 06:03:40] [data] Shuffling data
[2019-07-12 06:03:42] [data] Done reading 5511754 sentences
[2019-07-12 06:04:04] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 06:18:18] Ep. 7 : Up. 84000 : Sen. 593,610 : Cost 38.18347931 : Time 1013.56s : 13764.62 words/s
[2019-07-12 06:34:38] Ep. 7 : Up. 86000 : Sen. 1,280,724 : Cost 38.27800369 : Time 980.44s : 14200.95 words/s
[2019-07-12 06:50:57] Ep. 7 : Up. 88000 : Sen. 1,966,610 : Cost 38.20095062 : Time 978.46s : 14195.61 words/s
[2019-07-12 07:07:20] Ep. 7 : Up. 90000 : Sen. 2,658,754 : Cost 38.08966827 : Time 983.57s : 14245.77 words/s
[2019-07-12 07:23:46] Ep. 7 : Up. 92000 : Sen. 3,351,592 : Cost 38.17508698 : Time 985.86s : 14238.53 words/s
[2019-07-12 07:40:11] Ep. 7 : Up. 94000 : Sen. 4,041,224 : Cost 38.20779419 : Time 985.15s : 14212.59 words/s
[2019-07-12 07:56:32] Ep. 7 : Up. 96000 : Sen. 4,729,182 : Cost 38.08158875 : Time 980.57s : 14216.03 words/s
[2019-07-12 07:56:35] Seen 4731350 samples
[2019-07-12 07:56:35] Starting epoch 8
[2019-07-12 07:56:35] [data] Shuffling data
[2019-07-12 07:56:38] [data] Done reading 5511754 sentences
[2019-07-12 07:56:59] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 08:13:29] Ep. 8 : Up. 98000 : Sen. 686,610 : Cost 37.31228256 : Time 1016.83s : 13729.87 words/s
[2019-07-12 08:29:53] Ep. 8 : Up. 100000 : Sen. 1,376,856 : Cost 37.46963120 : Time 984.90s : 14196.01 words/s
[2019-07-12 08:29:53] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 08:30:03] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter100000.npz
[2019-07-12 08:30:10] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 08:30:20] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 08:30:42] [valid] Ep. 8 : Up. 100000 : cross-entropy : 51.7231 : new best
[2019-07-12 08:30:46] [valid] Ep. 8 : Up. 100000 : perplexity : 7.62981 : new best
[2019-07-12 08:31:21] [valid] Ep. 8 : Up. 100000 : translation : 29.55 : new best
[2019-07-12 08:47:49] Ep. 8 : Up. 102000 : Sen. 2,067,518 : Cost 37.47985077 : Time 1075.62s : 13013.92 words/s
[2019-07-12 09:04:10] Ep. 8 : Up. 104000 : Sen. 2,758,082 : Cost 37.38820648 : Time 980.57s : 14254.73 words/s
[2019-07-12 09:20:33] Ep. 8 : Up. 106000 : Sen. 3,449,194 : Cost 37.37447739 : Time 983.70s : 14246.47 words/s
[2019-07-12 09:36:54] Ep. 8 : Up. 108000 : Sen. 4,137,718 : Cost 37.32013702 : Time 980.52s : 14209.95 words/s
[2019-07-12 09:51:01] Seen 4731350 samples
[2019-07-12 09:51:01] Starting epoch 9
[2019-07-12 09:51:01] [data] Shuffling data
[2019-07-12 09:51:04] [data] Done reading 5511754 sentences
[2019-07-12 09:51:26] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 09:53:45] Ep. 9 : Up. 110000 : Sen. 94,322 : Cost 37.13560867 : Time 1010.75s : 13799.72 words/s
[2019-07-12 10:10:13] Ep. 9 : Up. 112000 : Sen. 786,026 : Cost 36.61477280 : Time 988.77s : 14195.66 words/s
[2019-07-12 10:26:36] Ep. 9 : Up. 114000 : Sen. 1,477,128 : Cost 36.71271896 : Time 982.57s : 14249.56 words/s
[2019-07-12 10:42:59] Ep. 9 : Up. 116000 : Sen. 2,166,688 : Cost 36.84000397 : Time 983.31s : 14237.95 words/s
[2019-07-12 10:59:22] Ep. 9 : Up. 118000 : Sen. 2,857,120 : Cost 36.65049744 : Time 982.71s : 14219.85 words/s
[2019-07-12 11:15:45] Ep. 9 : Up. 120000 : Sen. 3,550,322 : Cost 36.73068619 : Time 983.05s : 14262.82 words/s
[2019-07-12 11:15:45] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 11:15:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter120000.npz
[2019-07-12 11:16:02] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 11:16:12] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 11:16:34] [valid] Ep. 9 : Up. 120000 : cross-entropy : 50.7532 : new best
[2019-07-12 11:16:38] [valid] Ep. 9 : Up. 120000 : perplexity : 7.34455 : new best
[2019-07-12 11:17:14] [valid] Ep. 9 : Up. 120000 : translation : 29.81 : new best
[2019-07-12 11:33:42] Ep. 9 : Up. 122000 : Sen. 4,239,177 : Cost 36.76813507 : Time 1076.61s : 12971.26 words/s
[2019-07-12 11:45:23] Seen 4731350 samples
[2019-07-12 11:45:23] Starting epoch 10
[2019-07-12 11:45:23] [data] Shuffling data
[2019-07-12 11:45:26] [data] Done reading 5511754 sentences
[2019-07-12 11:45:48] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 11:50:35] Ep. 10 : Up. 124000 : Sen. 198,400 : Cost 36.54037094 : Time 1013.33s : 13812.88 words/s
[2019-07-12 12:07:00] Ep. 10 : Up. 126000 : Sen. 890,554 : Cost 36.00576782 : Time 985.12s : 14233.33 words/s
[2019-07-12 12:23:23] Ep. 10 : Up. 128000 : Sen. 1,581,436 : Cost 36.18128586 : Time 983.23s : 14251.58 words/s
[2019-07-12 12:39:48] Ep. 10 : Up. 130000 : Sen. 2,273,042 : Cost 36.16097641 : Time 984.55s : 14231.14 words/s
[2019-07-12 12:56:12] Ep. 10 : Up. 132000 : Sen. 2,962,794 : Cost 36.24022675 : Time 984.02s : 14211.15 words/s
[2019-07-12 13:12:36] Ep. 10 : Up. 134000 : Sen. 3,651,346 : Cost 36.12294388 : Time 984.37s : 14169.15 words/s
[2019-07-12 13:29:05] Ep. 10 : Up. 136000 : Sen. 4,339,836 : Cost 36.18458176 : Time 988.89s : 14117.34 words/s
[2019-07-12 13:38:28] Seen 4731350 samples
[2019-07-12 13:38:28] Starting epoch 11
[2019-07-12 13:38:28] [data] Shuffling data
[2019-07-12 13:38:31] [data] Done reading 5511754 sentences
[2019-07-12 13:38:52] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 13:46:09] Ep. 11 : Up. 138000 : Sen. 300,164 : Cost 35.88867188 : Time 1023.75s : 13696.12 words/s
[2019-07-12 14:02:38] Ep. 11 : Up. 140000 : Sen. 990,508 : Cost 35.42015839 : Time 989.23s : 14119.43 words/s
[2019-07-12 14:02:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 14:02:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter140000.npz
[2019-07-12 14:02:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 14:03:06] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 14:03:28] [valid] Ep. 11 : Up. 140000 : cross-entropy : 50.114 : new best
[2019-07-12 14:03:32] [valid] Ep. 11 : Up. 140000 : perplexity : 7.16241 : new best
[2019-07-12 14:04:09] [valid] Ep. 11 : Up. 140000 : translation : 30.11 : new best
[2019-07-12 14:20:47] Ep. 11 : Up. 142000 : Sen. 1,678,984 : Cost 35.68106461 : Time 1088.63s : 12835.63 words/s
[2019-07-12 14:37:16] Ep. 11 : Up. 144000 : Sen. 2,367,682 : Cost 35.60178375 : Time 989.66s : 14088.15 words/s
[2019-07-12 14:53:51] Ep. 11 : Up. 146000 : Sen. 3,064,426 : Cost 35.81982040 : Time 994.78s : 14205.76 words/s
[2019-07-12 15:12:53] Ep. 11 : Up. 148000 : Sen. 3,757,118 : Cost 35.84918976 : Time 1141.56s : 12294.56 words/s
[2019-07-12 15:33:34] Ep. 11 : Up. 150000 : Sen. 4,449,678 : Cost 35.70009995 : Time 1241.26s : 11298.12 words/s
[2019-07-12 15:42:04] Seen 4731350 samples
[2019-07-12 15:42:04] Starting epoch 12
[2019-07-12 15:42:04] [data] Shuffling data
[2019-07-12 15:42:07] [data] Done reading 5511754 sentences
[2019-07-12 15:42:33] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 15:54:38] Ep. 12 : Up. 152000 : Sen. 405,832 : Cost 35.31556702 : Time 1263.52s : 11030.90 words/s
[2019-07-12 16:15:18] Ep. 12 : Up. 154000 : Sen. 1,094,400 : Cost 35.10344315 : Time 1240.23s : 11250.53 words/s
[2019-07-12 16:34:00] Ep. 12 : Up. 156000 : Sen. 1,784,964 : Cost 35.23860931 : Time 1122.59s : 12465.94 words/s
[2019-07-12 16:50:31] Ep. 12 : Up. 158000 : Sen. 2,474,486 : Cost 35.29504013 : Time 990.95s : 14104.12 words/s
[2019-07-12 17:06:58] Ep. 12 : Up. 160000 : Sen. 3,165,774 : Cost 35.27458572 : Time 986.92s : 14176.64 words/s
[2019-07-12 17:06:58] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 17:07:07] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter160000.npz
[2019-07-12 17:07:14] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 17:07:24] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 17:07:46] [valid] Ep. 12 : Up. 160000 : cross-entropy : 49.6942 : new best
[2019-07-12 17:07:50] [valid] Ep. 12 : Up. 160000 : perplexity : 7.04525 : new best
[2019-07-12 17:08:29] [valid] Ep. 12 : Up. 160000 : translation : 30.23 : new best
[2019-07-12 17:24:59] Ep. 12 : Up. 162000 : Sen. 3,856,480 : Cost 35.38328552 : Time 1080.89s : 12943.05 words/s
[2019-07-12 17:41:25] Ep. 12 : Up. 164000 : Sen. 4,544,636 : Cost 35.34319305 : Time 986.32s : 14153.79 words/s
[2019-07-12 17:45:53] Seen 4731350 samples
[2019-07-12 17:45:53] Starting epoch 13
[2019-07-12 17:45:53] [data] Shuffling data
[2019-07-12 17:45:56] [data] Done reading 5511754 sentences
[2019-07-12 17:46:21] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 17:58:27] Ep. 13 : Up. 166000 : Sen. 507,278 : Cost 34.91981125 : Time 1021.19s : 13776.23 words/s
[2019-07-12 18:14:52] Ep. 13 : Up. 168000 : Sen. 1,194,814 : Cost 34.72781754 : Time 985.66s : 14150.88 words/s
[2019-07-12 18:31:21] Ep. 13 : Up. 170000 : Sen. 1,886,410 : Cost 34.72309494 : Time 988.37s : 14152.19 words/s
[2019-07-12 18:47:51] Ep. 13 : Up. 172000 : Sen. 2,577,144 : Cost 35.06695938 : Time 990.39s : 14172.47 words/s
[2019-07-12 19:04:17] Ep. 13 : Up. 174000 : Sen. 3,265,678 : Cost 34.96426773 : Time 986.39s : 14141.87 words/s
[2019-07-12 19:20:45] Ep. 13 : Up. 176000 : Sen. 3,956,116 : Cost 34.90300751 : Time 987.50s : 14152.91 words/s
[2019-07-12 19:37:12] Ep. 13 : Up. 178000 : Sen. 4,644,258 : Cost 35.08349228 : Time 987.13s : 14132.04 words/s
[2019-07-12 19:39:17] Seen 4731350 samples
[2019-07-12 19:39:17] Starting epoch 14
[2019-07-12 19:39:17] [data] Shuffling data
[2019-07-12 19:39:20] [data] Done reading 5511754 sentences
[2019-07-12 19:39:41] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 19:54:12] Ep. 14 : Up. 180000 : Sen. 603,092 : Cost 34.41802979 : Time 1019.78s : 13705.81 words/s
[2019-07-12 19:54:12] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 19:54:22] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter180000.npz
[2019-07-12 19:54:29] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 19:54:39] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 19:55:01] [valid] Ep. 14 : Up. 180000 : cross-entropy : 49.3674 : new best
[2019-07-12 19:55:05] [valid] Ep. 14 : Up. 180000 : perplexity : 6.95537 : new best
[2019-07-12 19:55:45] [valid] Ep. 14 : Up. 180000 : translation : 30.26 : new best
[2019-07-12 20:12:16] Ep. 14 : Up. 182000 : Sen. 1,292,394 : Cost 34.51834869 : Time 1083.78s : 12897.62 words/s
[2019-07-12 20:28:40] Ep. 14 : Up. 184000 : Sen. 1,979,863 : Cost 34.48114014 : Time 984.30s : 14156.91 words/s
[2019-07-12 20:45:10] Ep. 14 : Up. 186000 : Sen. 2,671,970 : Cost 34.60782242 : Time 989.90s : 14163.20 words/s
[2019-07-12 21:01:36] Ep. 14 : Up. 188000 : Sen. 3,361,678 : Cost 34.56470490 : Time 986.27s : 14141.96 words/s
[2019-07-12 21:18:08] Ep. 14 : Up. 190000 : Sen. 4,053,597 : Cost 34.63412476 : Time 991.81s : 14143.46 words/s
[2019-07-12 21:34:19] Seen 4731350 samples
[2019-07-12 21:34:19] Starting epoch 15
[2019-07-12 21:34:19] [data] Shuffling data
[2019-07-12 21:34:23] [data] Done reading 5511754 sentences
[2019-07-12 21:34:48] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 21:35:16] Ep. 15 : Up. 192000 : Sen. 15,984 : Cost 34.69930649 : Time 1027.56s : 13679.81 words/s
[2019-07-12 21:51:46] Ep. 15 : Up. 194000 : Sen. 704,812 : Cost 33.95195389 : Time 990.63s : 14093.13 words/s
[2019-07-12 22:08:24] Ep. 15 : Up. 196000 : Sen. 1,396,410 : Cost 34.20751572 : Time 998.26s : 14033.02 words/s
[2019-07-12 22:25:00] Ep. 15 : Up. 198000 : Sen. 2,087,256 : Cost 34.19509125 : Time 995.29s : 14068.36 words/s
[2019-07-12 22:41:32] Ep. 15 : Up. 200000 : Sen. 2,777,918 : Cost 34.26383972 : Time 992.55s : 14101.43 words/s
[2019-07-12 22:41:32] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-12 22:41:42] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter200000.npz
[2019-07-12 22:41:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-12 22:41:58] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-12 22:42:20] [valid] Ep. 15 : Up. 200000 : cross-entropy : 49.1641 : new best
[2019-07-12 22:42:23] [valid] Ep. 15 : Up. 200000 : perplexity : 6.90003 : new best
[2019-07-12 22:43:03] [valid] Ep. 15 : Up. 200000 : translation : 30.36 : new best
[2019-07-12 22:59:37] Ep. 15 : Up. 202000 : Sen. 3,468,076 : Cost 34.38300323 : Time 1084.35s : 12902.82 words/s
[2019-07-12 23:16:08] Ep. 15 : Up. 204000 : Sen. 4,160,000 : Cost 34.38008118 : Time 991.88s : 14137.15 words/s
[2019-07-12 23:29:49] Seen 4731350 samples
[2019-07-12 23:29:49] Starting epoch 16
[2019-07-12 23:29:49] [data] Shuffling data
[2019-07-12 23:29:52] [data] Done reading 5511754 sentences
[2019-07-12 23:30:12] [data] Done shuffling 5511754 sentences to temp files
[2019-07-12 23:33:14] Ep. 16 : Up. 206000 : Sen. 122,544 : Cost 34.33165741 : Time 1025.56s : 13702.60 words/s
[2019-07-12 23:49:46] Ep. 16 : Up. 208000 : Sen. 812,800 : Cost 33.78480148 : Time 991.50s : 14114.84 words/s
[2019-07-13 00:06:20] Ep. 16 : Up. 210000 : Sen. 1,504,769 : Cost 33.88879395 : Time 994.51s : 14099.44 words/s
[2019-07-13 00:22:51] Ep. 16 : Up. 212000 : Sen. 2,192,348 : Cost 33.95259094 : Time 990.81s : 14064.17 words/s
[2019-07-13 00:39:21] Ep. 16 : Up. 214000 : Sen. 2,881,678 : Cost 34.07549667 : Time 990.52s : 14102.92 words/s
[2019-07-13 00:55:50] Ep. 16 : Up. 216000 : Sen. 3,573,098 : Cost 34.24484253 : Time 988.44s : 14179.08 words/s
[2019-07-13 01:12:17] Ep. 16 : Up. 218000 : Sen. 4,262,400 : Cost 34.07299805 : Time 986.67s : 14150.98 words/s
[2019-07-13 01:23:28] Seen 4731350 samples
[2019-07-13 01:23:28] Starting epoch 17
[2019-07-13 01:23:28] [data] Shuffling data
[2019-07-13 01:23:31] [data] Done reading 5511754 sentences
[2019-07-13 01:23:51] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 01:29:15] Ep. 17 : Up. 220000 : Sen. 223,364 : Cost 33.87878799 : Time 1018.46s : 13781.36 words/s
[2019-07-13 01:29:15] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 01:29:25] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter220000.npz
[2019-07-13 01:29:31] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 01:29:42] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 01:30:08] [valid] Ep. 17 : Up. 220000 : cross-entropy : 48.9949 : new best
[2019-07-13 01:30:11] [valid] Ep. 17 : Up. 220000 : perplexity : 6.85431 : new best
[2019-07-13 01:30:50] [valid] Ep. 17 : Up. 220000 : translation : 30.47 : new best
[2019-07-13 01:47:21] Ep. 17 : Up. 222000 : Sen. 910,536 : Cost 33.72822952 : Time 1085.77s : 12843.63 words/s
[2019-07-13 02:03:49] Ep. 17 : Up. 224000 : Sen. 1,600,406 : Cost 33.65592194 : Time 988.48s : 14122.80 words/s
[2019-07-13 02:20:18] Ep. 17 : Up. 226000 : Sen. 2,291,200 : Cost 33.69707489 : Time 989.25s : 14142.54 words/s
[2019-07-13 02:36:44] Ep. 17 : Up. 228000 : Sen. 2,980,940 : Cost 33.96420288 : Time 985.78s : 14183.58 words/s
[2019-07-13 02:53:09] Ep. 17 : Up. 230000 : Sen. 3,669,866 : Cost 33.79925156 : Time 984.49s : 14151.90 words/s
[2019-07-13 03:09:37] Ep. 17 : Up. 232000 : Sen. 4,361,630 : Cost 34.00712204 : Time 988.66s : 14199.18 words/s
[2019-07-13 03:18:26] Seen 4731350 samples
[2019-07-13 03:18:26] Starting epoch 18
[2019-07-13 03:18:26] [data] Shuffling data
[2019-07-13 03:18:28] [data] Done reading 5511754 sentences
[2019-07-13 03:18:52] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 03:26:32] Ep. 18 : Up. 234000 : Sen. 320,724 : Cost 33.64182663 : Time 1014.36s : 13798.09 words/s
[2019-07-13 03:42:57] Ep. 18 : Up. 236000 : Sen. 1,010,017 : Cost 33.52264023 : Time 984.93s : 14195.63 words/s
[2019-07-13 03:59:21] Ep. 18 : Up. 238000 : Sen. 1,698,940 : Cost 33.37192917 : Time 984.43s : 14160.49 words/s
[2019-07-13 04:15:47] Ep. 18 : Up. 240000 : Sen. 2,388,154 : Cost 33.70344543 : Time 985.41s : 14191.28 words/s
[2019-07-13 04:15:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 04:15:56] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter240000.npz
[2019-07-13 04:16:03] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 04:16:12] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 04:16:33] [valid] Ep. 18 : Up. 240000 : cross-entropy : 48.8808 : new best
[2019-07-13 04:16:37] [valid] Ep. 18 : Up. 240000 : perplexity : 6.82367 : new best
[2019-07-13 04:17:16] [valid] Ep. 18 : Up. 240000 : translation : 30.6 : new best
[2019-07-13 04:33:46] Ep. 18 : Up. 242000 : Sen. 3,079,124 : Cost 33.63325119 : Time 1079.83s : 12960.30 words/s
[2019-07-13 04:50:12] Ep. 18 : Up. 244000 : Sen. 3,768,558 : Cost 33.67884827 : Time 985.77s : 14171.78 words/s
[2019-07-13 05:06:37] Ep. 18 : Up. 246000 : Sen. 4,457,564 : Cost 33.75431442 : Time 984.92s : 14178.73 words/s
[2019-07-13 05:13:09] Seen 4731350 samples
[2019-07-13 05:13:09] Starting epoch 19
[2019-07-13 05:13:09] [data] Shuffling data
[2019-07-13 05:13:12] [data] Done reading 5511754 sentences
[2019-07-13 05:13:34] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 05:23:32] Ep. 19 : Up. 248000 : Sen. 416,724 : Cost 33.32619858 : Time 1015.31s : 13780.60 words/s
[2019-07-13 05:39:57] Ep. 19 : Up. 250000 : Sen. 1,106,158 : Cost 33.11373901 : Time 984.45s : 14194.78 words/s
[2019-07-13 05:56:22] Ep. 19 : Up. 252000 : Sen. 1,797,040 : Cost 33.19177628 : Time 985.10s : 14202.97 words/s
[2019-07-13 06:12:49] Ep. 19 : Up. 254000 : Sen. 2,488,240 : Cost 33.47747040 : Time 987.34s : 14204.33 words/s
[2019-07-13 06:29:15] Ep. 19 : Up. 256000 : Sen. 3,180,482 : Cost 33.32287979 : Time 986.15s : 14200.87 words/s
[2019-07-13 06:45:41] Ep. 19 : Up. 258000 : Sen. 3,870,420 : Cost 33.55126953 : Time 985.51s : 14188.73 words/s
[2019-07-13 07:02:06] Ep. 19 : Up. 260000 : Sen. 4,559,608 : Cost 33.57850266 : Time 985.34s : 14172.16 words/s
[2019-07-13 07:02:06] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 07:02:16] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter260000.npz
[2019-07-13 07:02:23] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 07:02:33] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 07:02:55] [valid] Ep. 19 : Up. 260000 : cross-entropy : 48.7291 : new best
[2019-07-13 07:02:59] [valid] Ep. 19 : Up. 260000 : perplexity : 6.78312 : new best
[2019-07-13 07:03:40] [valid] Ep. 19 : Up. 260000 : translation : 30.58 : stalled 1 times (last best: 30.6)
[2019-07-13 07:07:50] Seen 4731350 samples
[2019-07-13 07:07:50] Starting epoch 20
[2019-07-13 07:07:50] [data] Shuffling data
[2019-07-13 07:07:52] [data] Done reading 5511754 sentences
[2019-07-13 07:08:14] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 07:20:39] Ep. 20 : Up. 262000 : Sen. 517,446 : Cost 33.00678253 : Time 1112.64s : 12552.46 words/s
[2019-07-13 07:37:04] Ep. 20 : Up. 264000 : Sen. 1,206,200 : Cost 33.10444641 : Time 985.41s : 14178.19 words/s
[2019-07-13 07:53:30] Ep. 20 : Up. 266000 : Sen. 1,896,981 : Cost 33.06538773 : Time 986.03s : 14189.15 words/s
[2019-07-13 08:09:48] Ep. 20 : Up. 268000 : Sen. 2,584,558 : Cost 33.12066650 : Time 977.42s : 14253.30 words/s
[2019-07-13 08:26:08] Ep. 20 : Up. 270000 : Sen. 3,276,482 : Cost 33.23796082 : Time 980.50s : 14301.67 words/s
[2019-07-13 08:42:30] Ep. 20 : Up. 272000 : Sen. 3,968,000 : Cost 33.25273514 : Time 982.03s : 14270.47 words/s
[2019-07-13 08:58:50] Ep. 20 : Up. 274000 : Sen. 4,657,620 : Cost 33.39627075 : Time 979.32s : 14282.41 words/s
[2019-07-13 09:00:34] Seen 4731350 samples
[2019-07-13 09:00:34] Starting epoch 21
[2019-07-13 09:00:34] [data] Shuffling data
[2019-07-13 09:00:37] [data] Done reading 5511754 sentences
[2019-07-13 09:01:01] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 09:15:42] Ep. 21 : Up. 276000 : Sen. 619,352 : Cost 32.68016052 : Time 1012.16s : 13860.51 words/s
[2019-07-13 09:32:01] Ep. 21 : Up. 278000 : Sen. 1,308,742 : Cost 32.80010605 : Time 979.67s : 14269.74 words/s
[2019-07-13 09:48:19] Ep. 21 : Up. 280000 : Sen. 1,998,796 : Cost 32.92700195 : Time 977.67s : 14296.88 words/s
[2019-07-13 09:48:19] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 09:48:29] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter280000.npz
[2019-07-13 09:48:37] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 09:48:47] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 09:49:11] [valid] Ep. 21 : Up. 280000 : cross-entropy : 48.6961 : new best
[2019-07-13 09:49:15] [valid] Ep. 21 : Up. 280000 : perplexity : 6.77433 : new best
[2019-07-13 09:49:17] Error: Unknown word id: 49998
[2019-07-13 09:49:17] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7fe0f4848a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7fe0f4368c80]                                                       + 0xb8c80
[0x7fe0f48416ba]                                                       + 0x76ba
[0x7fe0f3ace41d]    clone                                              + 0x6d

[2019-07-13 17:44:38] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 17:44:38] [marian] Running on hretha as process 10569 with command line:
[2019-07-13 17:44:38] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/valid.log
[2019-07-13 17:44:38] [config] after-batches: 0
[2019-07-13 17:44:38] [config] after-epochs: 0
[2019-07-13 17:44:38] [config] allow-unk: false
[2019-07-13 17:44:38] [config] beam-size: 12
[2019-07-13 17:44:38] [config] bert-class-symbol: "[CLS]"
[2019-07-13 17:44:38] [config] bert-mask-symbol: "[MASK]"
[2019-07-13 17:44:38] [config] bert-masking-fraction: 0.15
[2019-07-13 17:44:38] [config] bert-sep-symbol: "[SEP]"
[2019-07-13 17:44:38] [config] bert-train-type-embeddings: true
[2019-07-13 17:44:38] [config] bert-type-vocab-size: 2
[2019-07-13 17:44:38] [config] best-deep: false
[2019-07-13 17:44:38] [config] clip-gemm: 0
[2019-07-13 17:44:38] [config] clip-norm: 1
[2019-07-13 17:44:38] [config] cost-type: ce-mean
[2019-07-13 17:44:38] [config] cpu-threads: 0
[2019-07-13 17:44:38] [config] data-weighting: ""
[2019-07-13 17:44:38] [config] data-weighting-type: sentence
[2019-07-13 17:44:38] [config] dec-cell: gru
[2019-07-13 17:44:38] [config] dec-cell-base-depth: 2
[2019-07-13 17:44:38] [config] dec-cell-high-depth: 1
[2019-07-13 17:44:38] [config] dec-depth: 1
[2019-07-13 17:44:38] [config] devices:
[2019-07-13 17:44:38] [config]   - 0
[2019-07-13 17:44:38] [config]   - 1
[2019-07-13 17:44:38] [config] dim-emb: 512
[2019-07-13 17:44:38] [config] dim-rnn: 1024
[2019-07-13 17:44:38] [config] dim-vocabs:
[2019-07-13 17:44:38] [config]   - 50000
[2019-07-13 17:44:38] [config]   - 50000
[2019-07-13 17:44:38] [config] disp-first: 0
[2019-07-13 17:44:38] [config] disp-freq: 2000
[2019-07-13 17:44:38] [config] disp-label-counts: false
[2019-07-13 17:44:38] [config] dropout-rnn: 0.2
[2019-07-13 17:44:38] [config] dropout-src: 0.1
[2019-07-13 17:44:38] [config] dropout-trg: 0.1
[2019-07-13 17:44:38] [config] dump-config: ""
[2019-07-13 17:44:38] [config] early-stopping: 5
[2019-07-13 17:44:38] [config] embedding-fix-src: false
[2019-07-13 17:44:38] [config] embedding-fix-trg: false
[2019-07-13 17:44:38] [config] embedding-normalization: false
[2019-07-13 17:44:38] [config] embedding-vectors:
[2019-07-13 17:44:38] [config]   []
[2019-07-13 17:44:38] [config] enc-cell: gru
[2019-07-13 17:44:38] [config] enc-cell-depth: 1
[2019-07-13 17:44:38] [config] enc-depth: 1
[2019-07-13 17:44:38] [config] enc-type: bidirectional
[2019-07-13 17:44:38] [config] exponential-smoothing: 0.0001
[2019-07-13 17:44:38] [config] grad-dropping-momentum: 0
[2019-07-13 17:44:38] [config] grad-dropping-rate: 0
[2019-07-13 17:44:38] [config] grad-dropping-warmup: 100
[2019-07-13 17:44:38] [config] guided-alignment: none
[2019-07-13 17:44:38] [config] guided-alignment-cost: mse
[2019-07-13 17:44:38] [config] guided-alignment-weight: 0.1
[2019-07-13 17:44:38] [config] ignore-model-config: false
[2019-07-13 17:44:38] [config] input-types:
[2019-07-13 17:44:38] [config]   []
[2019-07-13 17:44:38] [config] interpolate-env-vars: false
[2019-07-13 17:44:38] [config] keep-best: false
[2019-07-13 17:44:38] [config] label-smoothing: 0
[2019-07-13 17:44:38] [config] layer-normalization: true
[2019-07-13 17:44:38] [config] learn-rate: 0.0001
[2019-07-13 17:44:38] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/train.log
[2019-07-13 17:44:38] [config] log-level: info
[2019-07-13 17:44:38] [config] log-time-zone: ""
[2019-07-13 17:44:38] [config] lr-decay: 0
[2019-07-13 17:44:38] [config] lr-decay-freq: 50000
[2019-07-13 17:44:38] [config] lr-decay-inv-sqrt:
[2019-07-13 17:44:38] [config]   - 0
[2019-07-13 17:44:38] [config] lr-decay-repeat-warmup: false
[2019-07-13 17:44:38] [config] lr-decay-reset-optimizer: false
[2019-07-13 17:44:38] [config] lr-decay-start:
[2019-07-13 17:44:38] [config]   - 10
[2019-07-13 17:44:38] [config]   - 1
[2019-07-13 17:44:38] [config] lr-decay-strategy: epoch+stalled
[2019-07-13 17:44:38] [config] lr-report: false
[2019-07-13 17:44:38] [config] lr-warmup: 0
[2019-07-13 17:44:38] [config] lr-warmup-at-reload: false
[2019-07-13 17:44:38] [config] lr-warmup-cycle: false
[2019-07-13 17:44:38] [config] lr-warmup-start-rate: 0
[2019-07-13 17:44:38] [config] max-length: 50
[2019-07-13 17:44:38] [config] max-length-crop: false
[2019-07-13 17:44:38] [config] max-length-factor: 3
[2019-07-13 17:44:38] [config] maxi-batch: 100
[2019-07-13 17:44:38] [config] maxi-batch-sort: trg
[2019-07-13 17:44:38] [config] mini-batch: 64
[2019-07-13 17:44:38] [config] mini-batch-fit: true
[2019-07-13 17:44:38] [config] mini-batch-fit-step: 10
[2019-07-13 17:44:38] [config] mini-batch-overstuff: 1
[2019-07-13 17:44:38] [config] mini-batch-track-lr: false
[2019-07-13 17:44:38] [config] mini-batch-understuff: 1
[2019-07-13 17:44:38] [config] mini-batch-warmup: 0
[2019-07-13 17:44:38] [config] mini-batch-words: 0
[2019-07-13 17:44:38] [config] mini-batch-words-ref: 0
[2019-07-13 17:44:38] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 17:44:38] [config] multi-loss-type: sum
[2019-07-13 17:44:38] [config] multi-node: false
[2019-07-13 17:44:38] [config] multi-node-overlap: true
[2019-07-13 17:44:38] [config] n-best: false
[2019-07-13 17:44:38] [config] no-nccl: false
[2019-07-13 17:44:38] [config] no-reload: false
[2019-07-13 17:44:38] [config] no-restore-corpus: false
[2019-07-13 17:44:38] [config] no-shuffle: false
[2019-07-13 17:44:38] [config] normalize: 1
[2019-07-13 17:44:38] [config] num-devices: 0
[2019-07-13 17:44:38] [config] optimizer: adam
[2019-07-13 17:44:38] [config] optimizer-delay: 1
[2019-07-13 17:44:38] [config] optimizer-params:
[2019-07-13 17:44:38] [config]   []
[2019-07-13 17:44:38] [config] overwrite: false
[2019-07-13 17:44:38] [config] pretrained-model: ""
[2019-07-13 17:44:38] [config] quiet: false
[2019-07-13 17:44:38] [config] quiet-translation: true
[2019-07-13 17:44:38] [config] relative-paths: false
[2019-07-13 17:44:38] [config] right-left: false
[2019-07-13 17:44:38] [config] save-freq: 20000
[2019-07-13 17:44:38] [config] seed: 1111
[2019-07-13 17:44:38] [config] shuffle-in-ram: false
[2019-07-13 17:44:38] [config] skip: false
[2019-07-13 17:44:38] [config] sqlite: ""
[2019-07-13 17:44:38] [config] sqlite-drop: false
[2019-07-13 17:44:38] [config] sync-sgd: true
[2019-07-13 17:44:38] [config] tempdir: .
[2019-07-13 17:44:38] [config] tied-embeddings: false
[2019-07-13 17:44:38] [config] tied-embeddings-all: false
[2019-07-13 17:44:38] [config] tied-embeddings-src: false
[2019-07-13 17:44:38] [config] train-sets:
[2019-07-13 17:44:38] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de
[2019-07-13 17:44:38] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en
[2019-07-13 17:44:38] [config] transformer-aan-activation: swish
[2019-07-13 17:44:38] [config] transformer-aan-depth: 2
[2019-07-13 17:44:38] [config] transformer-aan-nogate: false
[2019-07-13 17:44:38] [config] transformer-decoder-autoreg: self-attention
[2019-07-13 17:44:38] [config] transformer-dim-aan: 2048
[2019-07-13 17:44:38] [config] transformer-dim-ffn: 2048
[2019-07-13 17:44:38] [config] transformer-dropout: 0
[2019-07-13 17:44:38] [config] transformer-dropout-attention: 0
[2019-07-13 17:44:38] [config] transformer-dropout-ffn: 0
[2019-07-13 17:44:38] [config] transformer-ffn-activation: swish
[2019-07-13 17:44:38] [config] transformer-ffn-depth: 2
[2019-07-13 17:44:38] [config] transformer-guided-alignment-layer: last
[2019-07-13 17:44:38] [config] transformer-heads: 8
[2019-07-13 17:44:38] [config] transformer-no-projection: false
[2019-07-13 17:44:38] [config] transformer-postprocess: dan
[2019-07-13 17:44:38] [config] transformer-postprocess-emb: d
[2019-07-13 17:44:38] [config] transformer-preprocess: ""
[2019-07-13 17:44:38] [config] transformer-tied-layers:
[2019-07-13 17:44:38] [config]   []
[2019-07-13 17:44:38] [config] transformer-train-position-embeddings: false
[2019-07-13 17:44:38] [config] type: amun
[2019-07-13 17:44:38] [config] ulr: false
[2019-07-13 17:44:38] [config] ulr-dim-emb: 0
[2019-07-13 17:44:38] [config] ulr-dropout: 0
[2019-07-13 17:44:38] [config] ulr-keys-vectors: ""
[2019-07-13 17:44:38] [config] ulr-query-vectors: ""
[2019-07-13 17:44:38] [config] ulr-softmax-temperature: 1
[2019-07-13 17:44:38] [config] ulr-trainable-transformation: false
[2019-07-13 17:44:38] [config] valid-freq: 20000
[2019-07-13 17:44:38] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/valid.log
[2019-07-13 17:44:38] [config] valid-max-length: 1000
[2019-07-13 17:44:38] [config] valid-metrics:
[2019-07-13 17:44:38] [config]   - cross-entropy
[2019-07-13 17:44:38] [config]   - perplexity
[2019-07-13 17:44:38] [config]   - translation
[2019-07-13 17:44:38] [config] valid-mini-batch: 8
[2019-07-13 17:44:38] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/score-dev.sh
[2019-07-13 17:44:38] [config] valid-sets:
[2019-07-13 17:44:38] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.de
[2019-07-13 17:44:38] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.en
[2019-07-13 17:44:38] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/dev.out
[2019-07-13 17:44:38] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 17:44:38] [config] vocabs:
[2019-07-13 17:44:38] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json
[2019-07-13 17:44:38] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json
[2019-07-13 17:44:38] [config] word-penalty: 0
[2019-07-13 17:44:38] [config] workspace: 5000
[2019-07-13 17:44:38] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 17:44:38] Using synchronous training
[2019-07-13 17:44:38] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json
[2019-07-13 17:44:38] [data] Using unused word id eos for 0
[2019-07-13 17:44:38] [data] Using unused word id UNK for 1
[2019-07-13 17:44:38] [data] Setting vocabulary size for input 0 to 50000
[2019-07-13 17:44:38] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json
[2019-07-13 17:44:39] [data] Using unused word id eos for 0
[2019-07-13 17:44:39] [data] Using unused word id UNK for 1
[2019-07-13 17:44:39] [data] Setting vocabulary size for input 1 to 50000
[2019-07-13 17:44:39] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-13 17:44:39] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-13 17:44:40] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-13 17:44:41] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-13 17:44:41] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-13 17:44:41] [comm] NCCLCommunicator constructed successfully.
[2019-07-13 17:44:41] [training] Using 2 GPUs
[2019-07-13 17:44:41] [memory] Reserving 422 MB, device gpu0
[2019-07-13 17:44:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-13 17:44:42] [memory] Reserving 422 MB, device gpu0
[2019-07-13 17:44:50] [batching] Done. Typical MB size is 13760 target words
[2019-07-13 17:44:50] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-13 17:44:50] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-13 17:44:50] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-13 17:44:50] [comm] NCCLCommunicator constructed successfully.
[2019-07-13 17:44:50] [training] Using 2 GPUs
[2019-07-13 17:44:50] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 17:44:57] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 17:44:59] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 17:45:08] [memory] Reserving 422 MB, device gpu0
[2019-07-13 17:45:08] [memory] Reserving 422 MB, device gpu1
[2019-07-13 17:45:09] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 17:45:09] [data] Restoring the corpus state to epoch 21, batch 280000
[2019-07-13 17:45:09] [data] Shuffling data
[2019-07-13 17:45:23] [data] Done reading 5511754 sentences
[2019-07-13 17:45:45] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 17:46:40] Training started
[2019-07-13 17:46:40] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-13 17:46:40] [memory] Reserving 422 MB, device gpu1
[2019-07-13 17:46:40] [memory] Reserving 422 MB, device gpu0
[2019-07-13 17:46:41] [memory] Reserving 422 MB, device gpu1
[2019-07-13 17:46:41] [memory] Reserving 422 MB, device gpu0
[2019-07-13 17:46:41] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 17:46:50] [memory] Reserving 422 MB, device cpu0
[2019-07-13 17:46:50] [memory] Reserving 211 MB, device gpu0
[2019-07-13 17:46:50] [memory] Reserving 211 MB, device gpu1
[2019-07-13 18:01:22] Ep. 21 : Up. 282000 : Sen. 2,587,788 : Cost 32.39219284 : Time 1002.62s : 11901.63 words/s
[2019-07-13 18:15:56] Ep. 21 : Up. 284000 : Sen. 3,175,492 : Cost 33.05754089 : Time 874.37s : 13611.22 words/s
[2019-07-13 18:30:26] Ep. 21 : Up. 286000 : Sen. 3,760,479 : Cost 33.23901367 : Time 870.04s : 13630.75 words/s
[2019-07-13 18:44:57] Ep. 21 : Up. 288000 : Sen. 4,346,904 : Cost 33.12518692 : Time 870.63s : 13642.17 words/s
[2019-07-13 18:59:26] Ep. 21 : Up. 290000 : Sen. 4,930,937 : Cost 33.19445801 : Time 869.56s : 13619.59 words/s
[2019-07-13 19:01:55] Seen 5030834 samples
[2019-07-13 19:01:55] Starting epoch 22
[2019-07-13 19:01:55] [data] Shuffling data
[2019-07-13 19:01:57] [data] Done reading 5511754 sentences
[2019-07-13 19:02:23] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 19:14:35] Ep. 22 : Up. 292000 : Sen. 486,928 : Cost 32.63732147 : Time 909.29s : 13091.62 words/s
[2019-07-13 19:29:08] Ep. 22 : Up. 294000 : Sen. 1,074,212 : Cost 32.61580658 : Time 872.58s : 13635.43 words/s
[2019-07-13 19:43:41] Ep. 22 : Up. 296000 : Sen. 1,660,732 : Cost 32.73313141 : Time 872.51s : 13598.84 words/s
[2019-07-13 19:58:14] Ep. 22 : Up. 298000 : Sen. 2,245,827 : Cost 32.94278336 : Time 873.44s : 13592.98 words/s
[2019-07-13 20:12:48] Ep. 22 : Up. 300000 : Sen. 2,832,476 : Cost 32.86955261 : Time 873.95s : 13600.03 words/s
[2019-07-13 20:12:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 20:12:57] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter300000.npz
[2019-07-13 20:13:03] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 20:13:13] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 20:13:33] [valid] Ep. 22 : Up. 300000 : cross-entropy : 48.5905 : new best
[2019-07-13 20:13:37] [valid] Ep. 22 : Up. 300000 : perplexity : 6.74628 : new best
[2019-07-13 20:14:19] [valid] Ep. 22 : Up. 300000 : translation : 30.64 : new best
[2019-07-13 20:28:56] Ep. 22 : Up. 302000 : Sen. 3,422,657 : Cost 33.11761093 : Time 968.07s : 12374.10 words/s
[2019-07-13 20:43:32] Ep. 22 : Up. 304000 : Sen. 4,009,108 : Cost 33.08230972 : Time 876.02s : 13548.53 words/s
[2019-07-13 20:58:15] Ep. 22 : Up. 306000 : Sen. 4,596,868 : Cost 33.11136246 : Time 882.59s : 13491.58 words/s
[2019-07-13 21:01:36] Seen 4731350 samples
[2019-07-13 21:01:36] Starting epoch 23
[2019-07-13 21:01:36] [data] Shuffling data
[2019-07-13 21:01:39] [data] Done reading 5511754 sentences
[2019-07-13 21:02:01] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 21:13:27] Ep. 23 : Up. 308000 : Sen. 454,052 : Cost 32.60619354 : Time 912.69s : 13056.08 words/s
[2019-07-13 21:28:06] Ep. 23 : Up. 310000 : Sen. 1,038,921 : Cost 32.52533340 : Time 878.44s : 13489.84 words/s
[2019-07-13 21:42:47] Ep. 23 : Up. 312000 : Sen. 1,624,808 : Cost 32.70820999 : Time 881.46s : 13460.57 words/s
[2019-07-13 21:57:27] Ep. 23 : Up. 314000 : Sen. 2,209,296 : Cost 32.84566498 : Time 879.75s : 13461.55 words/s
[2019-07-13 22:12:08] Ep. 23 : Up. 316000 : Sen. 2,796,800 : Cost 32.82937622 : Time 881.15s : 13506.78 words/s
[2019-07-13 22:26:50] Ep. 23 : Up. 318000 : Sen. 3,383,990 : Cost 32.86170197 : Time 881.94s : 13495.67 words/s
[2019-07-13 22:41:29] Ep. 23 : Up. 320000 : Sen. 3,970,016 : Cost 33.10876465 : Time 878.58s : 13534.17 words/s
[2019-07-13 22:41:29] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-13 22:41:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter320000.npz
[2019-07-13 22:41:45] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-13 22:41:54] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-13 22:42:16] [valid] Ep. 23 : Up. 320000 : cross-entropy : 48.4892 : new best
[2019-07-13 22:42:20] [valid] Ep. 23 : Up. 320000 : perplexity : 6.7195 : new best
[2019-07-13 22:42:58] [valid] Ep. 23 : Up. 320000 : translation : 30.85 : new best
[2019-07-13 22:57:41] Ep. 23 : Up. 322000 : Sen. 4,557,524 : Cost 32.87982559 : Time 972.32s : 12238.46 words/s
[2019-07-13 23:02:03] Seen 4731350 samples
[2019-07-13 23:02:03] Starting epoch 24
[2019-07-13 23:02:03] [data] Shuffling data
[2019-07-13 23:02:06] [data] Done reading 5511754 sentences
[2019-07-13 23:02:35] [data] Done shuffling 5511754 sentences to temp files
[2019-07-13 23:12:52] Ep. 24 : Up. 324000 : Sen. 410,128 : Cost 32.44766617 : Time 911.48s : 12968.99 words/s
[2019-07-13 23:27:33] Ep. 24 : Up. 326000 : Sen. 996,552 : Cost 32.48692703 : Time 880.43s : 13499.35 words/s
[2019-07-13 23:42:15] Ep. 24 : Up. 328000 : Sen. 1,583,804 : Cost 32.55466080 : Time 882.41s : 13503.93 words/s
[2019-07-13 23:56:54] Ep. 24 : Up. 330000 : Sen. 2,169,072 : Cost 32.61928558 : Time 878.89s : 13477.74 words/s
[2019-07-14 00:11:38] Ep. 24 : Up. 332000 : Sen. 2,757,872 : Cost 32.59344864 : Time 883.94s : 13497.97 words/s
[2019-07-14 00:26:20] Ep. 24 : Up. 334000 : Sen. 3,343,360 : Cost 32.71169281 : Time 882.14s : 13459.12 words/s
[2019-07-14 00:41:01] Ep. 24 : Up. 336000 : Sen. 3,929,072 : Cost 32.83535004 : Time 880.89s : 13494.47 words/s
[2019-07-14 00:55:43] Ep. 24 : Up. 338000 : Sen. 4,516,658 : Cost 32.83765030 : Time 881.63s : 13493.89 words/s
[2019-07-14 01:01:05] Seen 4731350 samples
[2019-07-14 01:01:05] Starting epoch 25
[2019-07-14 01:01:05] [data] Shuffling data
[2019-07-14 01:01:08] [data] Done reading 5511754 sentences
[2019-07-14 01:01:34] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 01:10:55] Ep. 25 : Up. 340000 : Sen. 373,872 : Cost 32.36724091 : Time 911.92s : 13073.14 words/s
[2019-07-14 01:10:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 01:11:04] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter340000.npz
[2019-07-14 01:11:11] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 01:11:21] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 01:11:42] [valid] Ep. 25 : Up. 340000 : cross-entropy : 48.4241 : new best
[2019-07-14 01:11:46] [valid] Ep. 25 : Up. 340000 : perplexity : 6.70233 : new best
[2019-07-14 01:12:23] [valid] Ep. 25 : Up. 340000 : translation : 30.76 : stalled 1 times (last best: 30.85)
[2019-07-14 01:27:07] Ep. 25 : Up. 342000 : Sen. 959,208 : Cost 32.17462540 : Time 972.05s : 12214.06 words/s
[2019-07-14 01:41:49] Ep. 25 : Up. 344000 : Sen. 1,545,948 : Cost 32.38096619 : Time 882.71s : 13489.65 words/s
[2019-07-14 01:56:29] Ep. 25 : Up. 346000 : Sen. 2,131,992 : Cost 32.48233795 : Time 879.66s : 13505.45 words/s
[2019-07-14 02:11:10] Ep. 25 : Up. 348000 : Sen. 2,719,736 : Cost 32.63269806 : Time 881.39s : 13507.40 words/s
[2019-07-14 02:25:48] Ep. 25 : Up. 350000 : Sen. 3,307,600 : Cost 32.62173462 : Time 877.13s : 13575.17 words/s
[2019-07-14 02:40:24] Ep. 25 : Up. 352000 : Sen. 3,895,140 : Cost 32.58414078 : Time 876.85s : 13534.07 words/s
[2019-07-14 02:55:06] Ep. 25 : Up. 354000 : Sen. 4,481,420 : Cost 32.70522690 : Time 881.36s : 13487.55 words/s
[2019-07-14 03:01:21] Seen 4731350 samples
[2019-07-14 03:01:21] Starting epoch 26
[2019-07-14 03:01:21] [data] Shuffling data
[2019-07-14 03:01:25] [data] Done reading 5511754 sentences
[2019-07-14 03:01:46] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 03:10:17] Ep. 26 : Up. 356000 : Sen. 336,068 : Cost 32.47696304 : Time 911.10s : 13059.62 words/s
[2019-07-14 03:24:59] Ep. 26 : Up. 358000 : Sen. 924,922 : Cost 32.03264999 : Time 882.23s : 13516.46 words/s
[2019-07-14 03:39:40] Ep. 26 : Up. 360000 : Sen. 1,509,524 : Cost 32.13140106 : Time 880.48s : 13459.67 words/s
[2019-07-14 03:39:40] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 03:39:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter360000.npz
[2019-07-14 03:39:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 03:40:05] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 03:40:27] [valid] Ep. 26 : Up. 360000 : cross-entropy : 48.4041 : new best
[2019-07-14 03:40:31] [valid] Ep. 26 : Up. 360000 : perplexity : 6.69705 : new best
[2019-07-14 03:41:09] [valid] Ep. 26 : Up. 360000 : translation : 30.82 : stalled 2 times (last best: 30.85)
[2019-07-14 03:55:54] Ep. 26 : Up. 362000 : Sen. 2,094,804 : Cost 32.44106674 : Time 974.27s : 12199.56 words/s
[2019-07-14 04:10:36] Ep. 26 : Up. 364000 : Sen. 2,685,577 : Cost 32.36867905 : Time 882.08s : 13530.59 words/s
[2019-07-14 04:25:19] Ep. 26 : Up. 366000 : Sen. 3,271,804 : Cost 32.60299683 : Time 883.34s : 13470.99 words/s
[2019-07-14 04:40:02] Ep. 26 : Up. 368000 : Sen. 3,859,464 : Cost 32.51497650 : Time 882.55s : 13483.11 words/s
[2019-07-14 04:54:42] Ep. 26 : Up. 370000 : Sen. 4,447,208 : Cost 32.54825211 : Time 880.55s : 13516.07 words/s
[2019-07-14 05:01:49] Seen 4731350 samples
[2019-07-14 05:01:49] Starting epoch 27
[2019-07-14 05:01:49] [data] Shuffling data
[2019-07-14 05:01:53] [data] Done reading 5511754 sentences
[2019-07-14 05:02:17] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 05:09:58] Ep. 27 : Up. 372000 : Sen. 301,692 : Cost 32.27161789 : Time 915.17s : 12968.28 words/s
[2019-07-14 05:24:39] Ep. 27 : Up. 374000 : Sen. 888,808 : Cost 32.04208755 : Time 881.70s : 13487.08 words/s
[2019-07-14 05:39:23] Ep. 27 : Up. 376000 : Sen. 1,477,872 : Cost 32.23244858 : Time 883.88s : 13523.55 words/s
[2019-07-14 05:54:05] Ep. 27 : Up. 378000 : Sen. 2,064,836 : Cost 32.16003036 : Time 882.18s : 13487.17 words/s
[2019-07-14 06:08:45] Ep. 27 : Up. 380000 : Sen. 2,650,661 : Cost 32.32190704 : Time 879.68s : 13486.23 words/s
[2019-07-14 06:08:45] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 06:08:54] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter380000.npz
[2019-07-14 06:09:01] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 06:09:11] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 06:09:32] [valid] Ep. 27 : Up. 380000 : cross-entropy : 48.4236 : stalled 1 times (last best: 48.4041)
[2019-07-14 06:09:36] [valid] Ep. 27 : Up. 380000 : perplexity : 6.70218 : stalled 1 times (last best: 6.69705)
[2019-07-14 06:10:13] [valid] Ep. 27 : Up. 380000 : translation : 30.91 : new best
[2019-07-14 06:24:54] Ep. 27 : Up. 382000 : Sen. 3,234,144 : Cost 32.46613693 : Time 969.01s : 12199.49 words/s
[2019-07-14 06:39:36] Ep. 27 : Up. 384000 : Sen. 3,820,800 : Cost 32.42239761 : Time 882.32s : 13483.85 words/s
[2019-07-14 06:54:20] Ep. 27 : Up. 386000 : Sen. 4,409,252 : Cost 32.42907715 : Time 883.51s : 13491.98 words/s
[2019-07-14 07:02:24] Seen 4731350 samples
[2019-07-14 07:02:24] Starting epoch 28
[2019-07-14 07:02:24] [data] Shuffling data
[2019-07-14 07:02:27] [data] Done reading 5511754 sentences
[2019-07-14 07:02:49] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 07:09:32] Ep. 28 : Up. 388000 : Sen. 265,184 : Cost 32.13423157 : Time 912.47s : 13040.04 words/s
[2019-07-14 07:24:17] Ep. 28 : Up. 390000 : Sen. 855,388 : Cost 31.91500854 : Time 884.34s : 13544.66 words/s
[2019-07-14 07:38:57] Ep. 28 : Up. 392000 : Sen. 1,442,212 : Cost 31.89782333 : Time 880.10s : 13481.46 words/s
[2019-07-14 07:53:36] Ep. 28 : Up. 394000 : Sen. 2,027,420 : Cost 32.15386200 : Time 879.56s : 13496.89 words/s
[2019-07-14 08:08:17] Ep. 28 : Up. 396000 : Sen. 2,613,508 : Cost 32.14213562 : Time 880.66s : 13487.90 words/s
[2019-07-14 08:22:59] Ep. 28 : Up. 398000 : Sen. 3,200,000 : Cost 32.31517410 : Time 881.88s : 13474.59 words/s
[2019-07-14 08:37:40] Ep. 28 : Up. 400000 : Sen. 3,786,392 : Cost 32.23732758 : Time 881.02s : 13474.18 words/s
[2019-07-14 08:37:40] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 08:37:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter400000.npz
[2019-07-14 08:37:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 08:38:05] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 08:38:26] [valid] Ep. 28 : Up. 400000 : cross-entropy : 48.4666 : stalled 2 times (last best: 48.4041)
[2019-07-14 08:38:30] [valid] Ep. 28 : Up. 400000 : perplexity : 6.71353 : stalled 2 times (last best: 6.69705)
[2019-07-14 08:39:06] [valid] Ep. 28 : Up. 400000 : translation : 30.9 : stalled 1 times (last best: 30.91)
[2019-07-14 08:53:49] Ep. 28 : Up. 402000 : Sen. 4,370,936 : Cost 32.42938232 : Time 968.95s : 12222.98 words/s
[2019-07-14 09:02:54] Seen 4731350 samples
[2019-07-14 09:02:54] Starting epoch 29
[2019-07-14 09:02:54] [data] Shuffling data
[2019-07-14 09:02:57] [data] Done reading 5511754 sentences
[2019-07-14 09:03:24] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 09:09:01] Ep. 29 : Up. 404000 : Sen. 222,136 : Cost 32.20289230 : Time 912.03s : 12963.82 words/s
[2019-07-14 09:23:44] Ep. 29 : Up. 406000 : Sen. 811,420 : Cost 31.56222534 : Time 883.57s : 13502.93 words/s
[2019-07-14 09:38:25] Ep. 29 : Up. 408000 : Sen. 1,396,984 : Cost 31.92038155 : Time 880.61s : 13465.83 words/s
[2019-07-14 09:53:06] Ep. 29 : Up. 410000 : Sen. 1,981,984 : Cost 31.92940521 : Time 880.43s : 13458.13 words/s
[2019-07-14 10:07:48] Ep. 29 : Up. 412000 : Sen. 2,568,725 : Cost 32.08385468 : Time 882.37s : 13473.51 words/s
[2019-07-14 10:22:31] Ep. 29 : Up. 414000 : Sen. 3,156,076 : Cost 32.18231201 : Time 883.22s : 13495.27 words/s
[2019-07-14 10:37:14] Ep. 29 : Up. 416000 : Sen. 3,743,736 : Cost 32.19035721 : Time 883.06s : 13482.97 words/s
[2019-07-14 10:51:57] Ep. 29 : Up. 418000 : Sen. 4,330,460 : Cost 32.29991531 : Time 882.78s : 13479.13 words/s
[2019-07-14 11:01:59] Seen 4731350 samples
[2019-07-14 11:01:59] Starting epoch 30
[2019-07-14 11:01:59] [data] Shuffling data
[2019-07-14 11:02:02] [data] Done reading 5511754 sentences
[2019-07-14 11:02:24] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 11:07:09] Ep. 30 : Up. 420000 : Sen. 184,808 : Cost 32.13335037 : Time 911.87s : 13021.63 words/s
[2019-07-14 11:07:09] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 11:07:21] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter420000.npz
[2019-07-14 11:07:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 11:07:38] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 11:07:59] [valid] Ep. 30 : Up. 420000 : cross-entropy : 48.3918 : new best
[2019-07-14 11:08:03] [valid] Ep. 30 : Up. 420000 : perplexity : 6.69384 : new best
[2019-07-14 11:08:39] [valid] Ep. 30 : Up. 420000 : translation : 30.9 : stalled 2 times (last best: 30.91)
[2019-07-14 11:23:27] Ep. 30 : Up. 422000 : Sen. 770,504 : Cost 31.76437569 : Time 978.31s : 12153.47 words/s
[2019-07-14 11:38:10] Ep. 30 : Up. 424000 : Sen. 1,356,272 : Cost 31.58880997 : Time 882.39s : 13435.99 words/s
[2019-07-14 11:52:51] Ep. 30 : Up. 426000 : Sen. 1,941,767 : Cost 31.69360352 : Time 881.94s : 13456.31 words/s
[2019-07-14 12:07:34] Ep. 30 : Up. 428000 : Sen. 2,527,736 : Cost 31.89554024 : Time 882.07s : 13442.56 words/s
[2019-07-14 12:22:15] Ep. 30 : Up. 430000 : Sen. 3,113,200 : Cost 31.99366570 : Time 881.31s : 13451.50 words/s
[2019-07-14 12:36:56] Ep. 30 : Up. 432000 : Sen. 3,699,464 : Cost 32.00487137 : Time 880.96s : 13488.70 words/s
[2019-07-14 12:51:40] Ep. 30 : Up. 434000 : Sen. 4,287,736 : Cost 32.19853210 : Time 884.19s : 13485.43 words/s
[2019-07-14 13:02:47] Seen 4731350 samples
[2019-07-14 13:02:47] Starting epoch 31
[2019-07-14 13:02:47] [data] Shuffling data
[2019-07-14 13:03:04] [data] Done reading 5511754 sentences
[2019-07-14 13:03:27] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 13:07:03] Ep. 31 : Up. 436000 : Sen. 142,816 : Cost 32.09809494 : Time 923.44s : 12876.44 words/s
[2019-07-14 13:21:45] Ep. 31 : Up. 438000 : Sen. 730,392 : Cost 31.47037697 : Time 882.08s : 13500.68 words/s
[2019-07-14 13:36:29] Ep. 31 : Up. 440000 : Sen. 1,320,112 : Cost 31.66544533 : Time 883.29s : 13530.83 words/s
[2019-07-14 13:36:29] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 13:36:39] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter440000.npz
[2019-07-14 13:36:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 13:36:55] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 13:37:16] [valid] Ep. 31 : Up. 440000 : cross-entropy : 48.4212 : stalled 1 times (last best: 48.3918)
[2019-07-14 13:37:20] [valid] Ep. 31 : Up. 440000 : perplexity : 6.70156 : stalled 1 times (last best: 6.69384)
[2019-07-14 13:37:57] [valid] Ep. 31 : Up. 440000 : translation : 30.83 : stalled 3 times (last best: 30.91)
[2019-07-14 13:52:41] Ep. 31 : Up. 442000 : Sen. 1,905,516 : Cost 31.75436020 : Time 971.94s : 12214.01 words/s
[2019-07-14 14:07:21] Ep. 31 : Up. 444000 : Sen. 2,492,168 : Cost 31.82784081 : Time 880.39s : 13490.01 words/s
[2019-07-14 14:22:03] Ep. 31 : Up. 446000 : Sen. 3,079,192 : Cost 31.80311584 : Time 881.59s : 13484.78 words/s
[2019-07-14 14:36:42] Ep. 31 : Up. 448000 : Sen. 3,665,268 : Cost 31.86409950 : Time 879.79s : 13480.52 words/s
[2019-07-14 14:51:25] Ep. 31 : Up. 450000 : Sen. 4,252,520 : Cost 32.04302979 : Time 882.77s : 13510.17 words/s
[2019-07-14 15:03:26] Seen 4731350 samples
[2019-07-14 15:03:26] Starting epoch 32
[2019-07-14 15:03:26] [data] Shuffling data
[2019-07-14 15:03:29] [data] Done reading 5511754 sentences
[2019-07-14 15:03:52] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 15:06:41] Ep. 32 : Up. 452000 : Sen. 108,800 : Cost 31.93348122 : Time 915.75s : 13002.82 words/s
[2019-07-14 15:21:22] Ep. 32 : Up. 454000 : Sen. 694,429 : Cost 31.41041183 : Time 880.89s : 13473.90 words/s
[2019-07-14 15:36:04] Ep. 32 : Up. 456000 : Sen. 1,282,392 : Cost 31.65893364 : Time 882.44s : 13502.21 words/s
[2019-07-14 15:50:47] Ep. 32 : Up. 458000 : Sen. 1,869,328 : Cost 31.64182854 : Time 882.17s : 13467.27 words/s
[2019-07-14 14:52:30] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 14:52:30] [marian] Running on dagr as process 104225 with command line:
[2019-07-14 14:52:30] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/valid.log
[2019-07-14 14:52:30] [config] after-batches: 0
[2019-07-14 14:52:30] [config] after-epochs: 0
[2019-07-14 14:52:30] [config] allow-unk: false
[2019-07-14 14:52:30] [config] beam-size: 12
[2019-07-14 14:52:30] [config] bert-class-symbol: "[CLS]"
[2019-07-14 14:52:30] [config] bert-mask-symbol: "[MASK]"
[2019-07-14 14:52:30] [config] bert-masking-fraction: 0.15
[2019-07-14 14:52:30] [config] bert-sep-symbol: "[SEP]"
[2019-07-14 14:52:30] [config] bert-train-type-embeddings: true
[2019-07-14 14:52:30] [config] bert-type-vocab-size: 2
[2019-07-14 14:52:30] [config] best-deep: false
[2019-07-14 14:52:30] [config] clip-gemm: 0
[2019-07-14 14:52:30] [config] clip-norm: 1
[2019-07-14 14:52:30] [config] cost-type: ce-mean
[2019-07-14 14:52:30] [config] cpu-threads: 0
[2019-07-14 14:52:30] [config] data-weighting: ""
[2019-07-14 14:52:30] [config] data-weighting-type: sentence
[2019-07-14 14:52:30] [config] dec-cell: gru
[2019-07-14 14:52:30] [config] dec-cell-base-depth: 2
[2019-07-14 14:52:30] [config] dec-cell-high-depth: 1
[2019-07-14 14:52:30] [config] dec-depth: 1
[2019-07-14 14:52:30] [config] devices:
[2019-07-14 14:52:30] [config]   - 0
[2019-07-14 14:52:30] [config]   - 1
[2019-07-14 14:52:30] [config] dim-emb: 512
[2019-07-14 14:52:30] [config] dim-rnn: 1024
[2019-07-14 14:52:30] [config] dim-vocabs:
[2019-07-14 14:52:30] [config]   - 50000
[2019-07-14 14:52:30] [config]   - 50000
[2019-07-14 14:52:30] [config] disp-first: 0
[2019-07-14 14:52:30] [config] disp-freq: 2000
[2019-07-14 14:52:30] [config] disp-label-counts: false
[2019-07-14 14:52:30] [config] dropout-rnn: 0.2
[2019-07-14 14:52:30] [config] dropout-src: 0.1
[2019-07-14 14:52:30] [config] dropout-trg: 0.1
[2019-07-14 14:52:30] [config] dump-config: ""
[2019-07-14 14:52:30] [config] early-stopping: 5
[2019-07-14 14:52:30] [config] embedding-fix-src: false
[2019-07-14 14:52:30] [config] embedding-fix-trg: false
[2019-07-14 14:52:30] [config] embedding-normalization: false
[2019-07-14 14:52:30] [config] embedding-vectors:
[2019-07-14 14:52:30] [config]   []
[2019-07-14 14:52:30] [config] enc-cell: gru
[2019-07-14 14:52:30] [config] enc-cell-depth: 1
[2019-07-14 14:52:30] [config] enc-depth: 1
[2019-07-14 14:52:30] [config] enc-type: bidirectional
[2019-07-14 14:52:30] [config] exponential-smoothing: 0.0001
[2019-07-14 14:52:30] [config] grad-dropping-momentum: 0
[2019-07-14 14:52:30] [config] grad-dropping-rate: 0
[2019-07-14 14:52:30] [config] grad-dropping-warmup: 100
[2019-07-14 14:52:30] [config] guided-alignment: none
[2019-07-14 14:52:30] [config] guided-alignment-cost: mse
[2019-07-14 14:52:30] [config] guided-alignment-weight: 0.1
[2019-07-14 14:52:30] [config] ignore-model-config: false
[2019-07-14 14:52:30] [config] input-types:
[2019-07-14 14:52:30] [config]   []
[2019-07-14 14:52:30] [config] interpolate-env-vars: false
[2019-07-14 14:52:30] [config] keep-best: false
[2019-07-14 14:52:30] [config] label-smoothing: 0
[2019-07-14 14:52:30] [config] layer-normalization: true
[2019-07-14 14:52:30] [config] learn-rate: 0.0001
[2019-07-14 14:52:30] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/train.log
[2019-07-14 14:52:30] [config] log-level: info
[2019-07-14 14:52:30] [config] log-time-zone: ""
[2019-07-14 14:52:30] [config] lr-decay: 0
[2019-07-14 14:52:30] [config] lr-decay-freq: 50000
[2019-07-14 14:52:30] [config] lr-decay-inv-sqrt:
[2019-07-14 14:52:30] [config]   - 0
[2019-07-14 14:52:30] [config] lr-decay-repeat-warmup: false
[2019-07-14 14:52:30] [config] lr-decay-reset-optimizer: false
[2019-07-14 14:52:30] [config] lr-decay-start:
[2019-07-14 14:52:30] [config]   - 10
[2019-07-14 14:52:30] [config]   - 1
[2019-07-14 14:52:30] [config] lr-decay-strategy: epoch+stalled
[2019-07-14 14:52:30] [config] lr-report: false
[2019-07-14 14:52:30] [config] lr-warmup: 0
[2019-07-14 14:52:30] [config] lr-warmup-at-reload: false
[2019-07-14 14:52:30] [config] lr-warmup-cycle: false
[2019-07-14 14:52:30] [config] lr-warmup-start-rate: 0
[2019-07-14 14:52:30] [config] max-length: 50
[2019-07-14 14:52:30] [config] max-length-crop: false
[2019-07-14 14:52:30] [config] max-length-factor: 3
[2019-07-14 14:52:30] [config] maxi-batch: 100
[2019-07-14 14:52:30] [config] maxi-batch-sort: trg
[2019-07-14 14:52:30] [config] mini-batch: 64
[2019-07-14 14:52:30] [config] mini-batch-fit: true
[2019-07-14 14:52:30] [config] mini-batch-fit-step: 10
[2019-07-14 14:52:30] [config] mini-batch-overstuff: 1
[2019-07-14 14:52:30] [config] mini-batch-track-lr: false
[2019-07-14 14:52:30] [config] mini-batch-understuff: 1
[2019-07-14 14:52:30] [config] mini-batch-warmup: 0
[2019-07-14 14:52:30] [config] mini-batch-words: 0
[2019-07-14 14:52:30] [config] mini-batch-words-ref: 0
[2019-07-14 14:52:30] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 14:52:30] [config] multi-loss-type: sum
[2019-07-14 14:52:30] [config] multi-node: false
[2019-07-14 14:52:30] [config] multi-node-overlap: true
[2019-07-14 14:52:30] [config] n-best: false
[2019-07-14 14:52:30] [config] no-nccl: false
[2019-07-14 14:52:30] [config] no-reload: false
[2019-07-14 14:52:30] [config] no-restore-corpus: false
[2019-07-14 14:52:30] [config] no-shuffle: false
[2019-07-14 14:52:30] [config] normalize: 1
[2019-07-14 14:52:30] [config] num-devices: 0
[2019-07-14 14:52:30] [config] optimizer: adam
[2019-07-14 14:52:30] [config] optimizer-delay: 1
[2019-07-14 14:52:30] [config] optimizer-params:
[2019-07-14 14:52:30] [config]   []
[2019-07-14 14:52:30] [config] overwrite: false
[2019-07-14 14:52:30] [config] pretrained-model: ""
[2019-07-14 14:52:30] [config] quiet: false
[2019-07-14 14:52:30] [config] quiet-translation: true
[2019-07-14 14:52:30] [config] relative-paths: false
[2019-07-14 14:52:30] [config] right-left: false
[2019-07-14 14:52:30] [config] save-freq: 20000
[2019-07-14 14:52:30] [config] seed: 1111
[2019-07-14 14:52:30] [config] shuffle-in-ram: false
[2019-07-14 14:52:30] [config] skip: false
[2019-07-14 14:52:30] [config] sqlite: ""
[2019-07-14 14:52:30] [config] sqlite-drop: false
[2019-07-14 14:52:30] [config] sync-sgd: true
[2019-07-14 14:52:30] [config] tempdir: .
[2019-07-14 14:52:30] [config] tied-embeddings: false
[2019-07-14 14:52:30] [config] tied-embeddings-all: false
[2019-07-14 14:52:30] [config] tied-embeddings-src: false
[2019-07-14 14:52:30] [config] train-sets:
[2019-07-14 14:52:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de
[2019-07-14 14:52:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en
[2019-07-14 14:52:30] [config] transformer-aan-activation: swish
[2019-07-14 14:52:30] [config] transformer-aan-depth: 2
[2019-07-14 14:52:30] [config] transformer-aan-nogate: false
[2019-07-14 14:52:30] [config] transformer-decoder-autoreg: self-attention
[2019-07-14 14:52:30] [config] transformer-dim-aan: 2048
[2019-07-14 14:52:30] [config] transformer-dim-ffn: 2048
[2019-07-14 14:52:30] [config] transformer-dropout: 0
[2019-07-14 14:52:30] [config] transformer-dropout-attention: 0
[2019-07-14 14:52:30] [config] transformer-dropout-ffn: 0
[2019-07-14 14:52:30] [config] transformer-ffn-activation: swish
[2019-07-14 14:52:30] [config] transformer-ffn-depth: 2
[2019-07-14 14:52:30] [config] transformer-guided-alignment-layer: last
[2019-07-14 14:52:30] [config] transformer-heads: 8
[2019-07-14 14:52:30] [config] transformer-no-projection: false
[2019-07-14 14:52:30] [config] transformer-postprocess: dan
[2019-07-14 14:52:30] [config] transformer-postprocess-emb: d
[2019-07-14 14:52:30] [config] transformer-preprocess: ""
[2019-07-14 14:52:30] [config] transformer-tied-layers:
[2019-07-14 14:52:30] [config]   []
[2019-07-14 14:52:30] [config] transformer-train-position-embeddings: false
[2019-07-14 14:52:30] [config] type: amun
[2019-07-14 14:52:30] [config] ulr: false
[2019-07-14 14:52:30] [config] ulr-dim-emb: 0
[2019-07-14 14:52:30] [config] ulr-dropout: 0
[2019-07-14 14:52:30] [config] ulr-keys-vectors: ""
[2019-07-14 14:52:30] [config] ulr-query-vectors: ""
[2019-07-14 14:52:30] [config] ulr-softmax-temperature: 1
[2019-07-14 14:52:30] [config] ulr-trainable-transformation: false
[2019-07-14 14:52:30] [config] valid-freq: 20000
[2019-07-14 14:52:30] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/valid.log
[2019-07-14 14:52:30] [config] valid-max-length: 1000
[2019-07-14 14:52:30] [config] valid-metrics:
[2019-07-14 14:52:30] [config]   - cross-entropy
[2019-07-14 14:52:30] [config]   - perplexity
[2019-07-14 14:52:30] [config]   - translation
[2019-07-14 14:52:30] [config] valid-mini-batch: 8
[2019-07-14 14:52:30] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/score-dev.sh
[2019-07-14 14:52:30] [config] valid-sets:
[2019-07-14 14:52:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.de
[2019-07-14 14:52:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/dev.bpe.en
[2019-07-14 14:52:30] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/dev.out
[2019-07-14 14:52:30] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 14:52:30] [config] vocabs:
[2019-07-14 14:52:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json
[2019-07-14 14:52:30] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json
[2019-07-14 14:52:30] [config] word-penalty: 0
[2019-07-14 14:52:30] [config] workspace: 5000
[2019-07-14 14:52:30] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 14:52:30] Using synchronous training
[2019-07-14 14:52:30] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.de.json
[2019-07-14 14:52:31] [data] Using unused word id eos for 0
[2019-07-14 14:52:31] [data] Using unused word id UNK for 1
[2019-07-14 14:52:31] [data] Setting vocabulary size for input 0 to 50000
[2019-07-14 14:52:31] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/data/train.bpe.en.json
[2019-07-14 14:52:31] [data] Using unused word id eos for 0
[2019-07-14 14:52:31] [data] Using unused word id UNK for 1
[2019-07-14 14:52:31] [data] Setting vocabulary size for input 1 to 50000
[2019-07-14 14:52:31] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-14 14:52:31] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-14 14:52:33] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-14 14:52:34] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-14 14:52:34] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 14:52:34] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 14:52:34] [training] Using 2 GPUs
[2019-07-14 14:52:34] [memory] Reserving 422 MB, device gpu0
[2019-07-14 14:52:34] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-14 14:52:34] [memory] Reserving 422 MB, device gpu0
[2019-07-14 14:52:43] [batching] Done. Typical MB size is 13760 target words
[2019-07-14 14:52:43] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-14 14:52:43] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-14 14:52:43] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 14:52:43] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 14:52:43] [training] Using 2 GPUs
[2019-07-14 14:52:43] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 14:52:50] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 14:52:52] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 14:53:03] [memory] Reserving 422 MB, device gpu0
[2019-07-14 14:53:03] [memory] Reserving 422 MB, device gpu1
[2019-07-14 14:53:04] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 14:53:04] [data] Restoring the corpus state to epoch 31, batch 440000
[2019-07-14 14:53:04] [data] Shuffling data
[2019-07-14 14:53:07] [data] Done reading 5511754 sentences
[2019-07-14 14:53:31] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 14:54:08] Training started
[2019-07-14 14:54:08] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-14 14:54:08] [memory] Reserving 422 MB, device gpu0
[2019-07-14 14:54:08] [memory] Reserving 422 MB, device gpu1
[2019-07-14 14:54:09] [memory] Reserving 422 MB, device gpu0
[2019-07-14 14:54:09] [memory] Reserving 422 MB, device gpu1
[2019-07-14 14:54:09] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 14:54:16] [memory] Reserving 422 MB, device cpu0
[2019-07-14 14:54:17] [memory] Reserving 211 MB, device gpu0
[2019-07-14 14:54:17] [memory] Reserving 211 MB, device gpu1
[2019-07-14 16:05:28] Ep. 32 : Up. 460000 : Sen. 2,456,808 : Cost 31.58732224 : Time 881.44s : 13483.12 words/s
[2019-07-14 16:05:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 16:05:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter460000.npz
[2019-07-14 16:05:45] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 16:05:55] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 16:06:16] [valid] Ep. 32 : Up. 460000 : cross-entropy : 48.4575 : stalled 2 times (last best: 48.3918)
[2019-07-14 16:06:19] [valid] Ep. 32 : Up. 460000 : perplexity : 6.71113 : stalled 2 times (last best: 6.69384)
[2019-07-14 16:06:56] [valid] Ep. 32 : Up. 460000 : translation : 30.82 : stalled 4 times (last best: 30.91)
[2019-07-14 15:08:44] Ep. 31 : Up. 442000 : Sen. 1,905,516 : Cost 31.68900108 : Time 973.00s : 12200.65 words/s
[2019-07-14 16:21:43] Ep. 32 : Up. 462000 : Sen. 3,044,120 : Cost 31.84632111 : Time 975.43s : 12210.95 words/s
[2019-07-14 15:23:15] Ep. 31 : Up. 444000 : Sen. 2,492,168 : Cost 31.80521393 : Time 871.23s : 13631.88 words/s
[2019-07-14 16:36:22] Ep. 32 : Up. 464000 : Sen. 3,629,148 : Cost 31.97706032 : Time 879.00s : 13493.36 words/s
[2019-07-14 16:50:57] Ep. 32 : Up. 466000 : Sen. 4,214,912 : Cost 31.94388199 : Time 874.92s : 13587.26 words/s
[2019-07-14 17:03:46] Seen 4731350 samples
[2019-07-14 17:03:46] Starting epoch 33
[2019-07-14 17:03:46] [data] Shuffling data
[2019-07-14 17:03:49] [data] Done reading 5511754 sentences
[2019-07-14 17:04:13] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 17:06:04] Ep. 33 : Up. 468000 : Sen. 71,290 : Cost 31.77804756 : Time 906.27s : 13131.29 words/s
[2019-07-14 17:20:38] Ep. 33 : Up. 470000 : Sen. 658,476 : Cost 31.32604027 : Time 874.55s : 13602.29 words/s
[2019-07-14 17:35:15] Ep. 33 : Up. 472000 : Sen. 1,245,685 : Cost 31.49050903 : Time 876.86s : 13580.53 words/s
[2019-07-14 17:49:51] Ep. 33 : Up. 474000 : Sen. 1,833,347 : Cost 31.50153351 : Time 876.05s : 13576.58 words/s
[2019-07-14 18:04:29] Ep. 33 : Up. 476000 : Sen. 2,421,512 : Cost 31.63248444 : Time 877.67s : 13596.04 words/s
[2019-07-14 18:19:05] Ep. 33 : Up. 478000 : Sen. 3,010,044 : Cost 31.79925346 : Time 876.49s : 13620.14 words/s
[2019-07-14 18:33:38] Ep. 33 : Up. 480000 : Sen. 3,596,272 : Cost 31.72984314 : Time 872.71s : 13612.10 words/s
[2019-07-14 18:33:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 18:33:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter480000.npz
[2019-07-14 18:33:54] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 18:34:05] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 18:34:28] [valid] Ep. 33 : Up. 480000 : cross-entropy : 48.4763 : stalled 3 times (last best: 48.3918)
[2019-07-14 18:34:32] [valid] Ep. 33 : Up. 480000 : perplexity : 6.71608 : stalled 3 times (last best: 6.69384)
[2019-07-14 18:35:14] [valid] Ep. 33 : Up. 480000 : translation : 30.77 : stalled 5 times (last best: 30.91)
[2019-07-14 18:49:50] Ep. 33 : Up. 482000 : Sen. 4,183,686 : Cost 31.95261955 : Time 971.65s : 12243.79 words/s
[2019-07-14 19:03:25] Seen 4731350 samples
[2019-07-14 19:03:25] Starting epoch 34
[2019-07-14 19:03:25] [data] Shuffling data
[2019-07-14 19:03:28] [data] Done reading 5511754 sentences
[2019-07-14 19:03:50] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 19:04:51] Ep. 34 : Up. 484000 : Sen. 37,244 : Cost 31.88468361 : Time 901.66s : 13153.32 words/s
[2019-07-14 19:19:26] Ep. 34 : Up. 486000 : Sen. 623,556 : Cost 31.31453133 : Time 874.91s : 13582.38 words/s
[2019-07-14 19:34:06] Ep. 34 : Up. 488000 : Sen. 1,211,868 : Cost 31.33173180 : Time 879.60s : 13543.15 words/s
[2019-07-14 19:48:46] Ep. 34 : Up. 490000 : Sen. 1,797,704 : Cost 31.30298615 : Time 880.50s : 13473.07 words/s
[2019-07-14 20:03:29] Ep. 34 : Up. 492000 : Sen. 2,386,144 : Cost 31.55483055 : Time 883.09s : 13501.66 words/s
[2019-07-14 20:18:13] Ep. 34 : Up. 494000 : Sen. 2,973,720 : Cost 31.56064987 : Time 884.05s : 13478.13 words/s
[2019-07-14 20:32:55] Ep. 34 : Up. 496000 : Sen. 3,559,192 : Cost 31.63639259 : Time 881.19s : 13461.66 words/s
[2019-07-14 20:47:36] Ep. 34 : Up. 498000 : Sen. 4,146,672 : Cost 31.77181244 : Time 881.08s : 13496.50 words/s
[2019-07-14 21:02:17] Seen 4731350 samples
[2019-07-14 21:02:17] Starting epoch 35
[2019-07-14 21:02:17] [data] Shuffling data
[2019-07-14 21:02:20] [data] Done reading 5511754 sentences
[2019-07-14 21:02:42] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 21:02:49] Ep. 35 : Up. 500000 : Sen. 1,087 : Cost 31.83859825 : Time 913.43s : 12994.17 words/s
[2019-07-14 21:02:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 21:02:59] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter500000.npz
[2019-07-14 21:03:05] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 21:03:15] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 21:03:35] [valid] Ep. 35 : Up. 500000 : cross-entropy : 48.4022 : stalled 4 times (last best: 48.3918)
[2019-07-14 21:03:39] [valid] Ep. 35 : Up. 500000 : perplexity : 6.69655 : stalled 4 times (last best: 6.69384)
[2019-07-14 21:04:16] [valid] Ep. 35 : Up. 500000 : translation : 30.93 : new best
[2019-07-14 21:19:00] Ep. 35 : Up. 502000 : Sen. 588,272 : Cost 31.26881027 : Time 971.14s : 12276.97 words/s
[2019-07-14 21:33:44] Ep. 35 : Up. 504000 : Sen. 1,175,848 : Cost 31.26286888 : Time 883.59s : 13486.25 words/s
[2019-07-14 21:48:24] Ep. 35 : Up. 506000 : Sen. 1,760,612 : Cost 31.32655525 : Time 880.59s : 13455.32 words/s
[2019-07-14 22:03:07] Ep. 35 : Up. 508000 : Sen. 2,348,800 : Cost 31.41743851 : Time 883.02s : 13494.41 words/s
[2019-07-14 22:17:50] Ep. 35 : Up. 510000 : Sen. 2,935,831 : Cost 31.44314766 : Time 882.48s : 13470.74 words/s
[2019-07-14 22:32:30] Ep. 35 : Up. 512000 : Sen. 3,522,716 : Cost 31.47720337 : Time 879.89s : 13493.28 words/s
[2019-07-14 22:47:09] Ep. 35 : Up. 514000 : Sen. 4,108,272 : Cost 31.76374626 : Time 879.61s : 13516.05 words/s
[2019-07-14 23:01:52] Ep. 35 : Up. 516000 : Sen. 4,696,612 : Cost 31.66465569 : Time 882.80s : 13496.06 words/s
[2019-07-14 23:02:44] Seen 4731350 samples
[2019-07-14 23:02:44] Starting epoch 36
[2019-07-14 23:02:44] [data] Shuffling data
[2019-07-14 23:02:47] [data] Done reading 5511754 sentences
[2019-07-14 23:03:32] [data] Done shuffling 5511754 sentences to temp files
[2019-07-14 23:17:18] Ep. 36 : Up. 518000 : Sen. 550,664 : Cost 30.97283936 : Time 926.29s : 12790.65 words/s
[2019-07-14 23:31:56] Ep. 36 : Up. 520000 : Sen. 1,137,378 : Cost 31.05844688 : Time 878.02s : 13515.72 words/s
[2019-07-14 23:31:56] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 23:32:06] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.iter520000.npz
[2019-07-14 23:32:13] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 23:32:23] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
[2019-07-14 23:32:44] [valid] Ep. 36 : Up. 520000 : cross-entropy : 48.4135 : stalled 5 times (last best: 48.3918)
[2019-07-14 23:32:48] [valid] Ep. 36 : Up. 520000 : perplexity : 6.69953 : stalled 5 times (last best: 6.69384)
[2019-07-14 23:33:27] [valid] Ep. 36 : Up. 520000 : translation : 30.86 : stalled 1 times (last best: 30.93)
[2019-07-14 23:33:29] Training finished
[2019-07-14 23:33:33] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.orig.npz
[2019-07-14 23:33:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz
[2019-07-14 23:33:57] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_ens1/model/model.npz.optimizer.npz
