[2019-07-09 23:42:39] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-09 23:42:39] [marian] Running on hodor as process 31584 with command line:
[2019-07-09 23:42:39] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 2 3 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-09 23:42:39] [config] after-batches: 0
[2019-07-09 23:42:39] [config] after-epochs: 0
[2019-07-09 23:42:39] [config] allow-unk: false
[2019-07-09 23:42:39] [config] beam-size: 12
[2019-07-09 23:42:39] [config] bert-class-symbol: "[CLS]"
[2019-07-09 23:42:39] [config] bert-mask-symbol: "[MASK]"
[2019-07-09 23:42:39] [config] bert-masking-fraction: 0.15
[2019-07-09 23:42:39] [config] bert-sep-symbol: "[SEP]"
[2019-07-09 23:42:39] [config] bert-train-type-embeddings: true
[2019-07-09 23:42:39] [config] bert-type-vocab-size: 2
[2019-07-09 23:42:39] [config] best-deep: false
[2019-07-09 23:42:39] [config] clip-gemm: 0
[2019-07-09 23:42:39] [config] clip-norm: 1
[2019-07-09 23:42:39] [config] cost-type: ce-mean
[2019-07-09 23:42:39] [config] cpu-threads: 0
[2019-07-09 23:42:39] [config] data-weighting: ""
[2019-07-09 23:42:39] [config] data-weighting-type: sentence
[2019-07-09 23:42:39] [config] dec-cell: gru
[2019-07-09 23:42:39] [config] dec-cell-base-depth: 2
[2019-07-09 23:42:39] [config] dec-cell-high-depth: 1
[2019-07-09 23:42:39] [config] dec-depth: 1
[2019-07-09 23:42:39] [config] devices:
[2019-07-09 23:42:39] [config]   - 2
[2019-07-09 23:42:39] [config]   - 3
[2019-07-09 23:42:39] [config] dim-emb: 512
[2019-07-09 23:42:39] [config] dim-rnn: 1024
[2019-07-09 23:42:39] [config] dim-vocabs:
[2019-07-09 23:42:39] [config]   - 50000
[2019-07-09 23:42:39] [config]   - 50000
[2019-07-09 23:42:39] [config] disp-first: 0
[2019-07-09 23:42:39] [config] disp-freq: 2000
[2019-07-09 23:42:39] [config] disp-label-counts: false
[2019-07-09 23:42:39] [config] dropout-rnn: 0.2
[2019-07-09 23:42:39] [config] dropout-src: 0.1
[2019-07-09 23:42:39] [config] dropout-trg: 0.1
[2019-07-09 23:42:39] [config] dump-config: ""
[2019-07-09 23:42:39] [config] early-stopping: 5
[2019-07-09 23:42:39] [config] embedding-fix-src: false
[2019-07-09 23:42:39] [config] embedding-fix-trg: false
[2019-07-09 23:42:39] [config] embedding-normalization: false
[2019-07-09 23:42:39] [config] embedding-vectors:
[2019-07-09 23:42:39] [config]   []
[2019-07-09 23:42:39] [config] enc-cell: gru
[2019-07-09 23:42:39] [config] enc-cell-depth: 1
[2019-07-09 23:42:39] [config] enc-depth: 1
[2019-07-09 23:42:39] [config] enc-type: bidirectional
[2019-07-09 23:42:39] [config] exponential-smoothing: 0.0001
[2019-07-09 23:42:39] [config] grad-dropping-momentum: 0
[2019-07-09 23:42:39] [config] grad-dropping-rate: 0
[2019-07-09 23:42:39] [config] grad-dropping-warmup: 100
[2019-07-09 23:42:39] [config] guided-alignment: none
[2019-07-09 23:42:39] [config] guided-alignment-cost: mse
[2019-07-09 23:42:39] [config] guided-alignment-weight: 0.1
[2019-07-09 23:42:39] [config] ignore-model-config: false
[2019-07-09 23:42:39] [config] input-types:
[2019-07-09 23:42:39] [config]   []
[2019-07-09 23:42:39] [config] interpolate-env-vars: false
[2019-07-09 23:42:39] [config] keep-best: false
[2019-07-09 23:42:39] [config] label-smoothing: 0
[2019-07-09 23:42:39] [config] layer-normalization: true
[2019-07-09 23:42:39] [config] learn-rate: 0.0001
[2019-07-09 23:42:39] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-09 23:42:39] [config] log-level: info
[2019-07-09 23:42:39] [config] log-time-zone: ""
[2019-07-09 23:42:39] [config] lr-decay: 0
[2019-07-09 23:42:39] [config] lr-decay-freq: 50000
[2019-07-09 23:42:39] [config] lr-decay-inv-sqrt:
[2019-07-09 23:42:39] [config]   - 0
[2019-07-09 23:42:39] [config] lr-decay-repeat-warmup: false
[2019-07-09 23:42:39] [config] lr-decay-reset-optimizer: false
[2019-07-09 23:42:39] [config] lr-decay-start:
[2019-07-09 23:42:39] [config]   - 10
[2019-07-09 23:42:39] [config]   - 1
[2019-07-09 23:42:39] [config] lr-decay-strategy: epoch+stalled
[2019-07-09 23:42:39] [config] lr-report: false
[2019-07-09 23:42:39] [config] lr-warmup: 0
[2019-07-09 23:42:39] [config] lr-warmup-at-reload: false
[2019-07-09 23:42:39] [config] lr-warmup-cycle: false
[2019-07-09 23:42:39] [config] lr-warmup-start-rate: 0
[2019-07-09 23:42:39] [config] max-length: 50
[2019-07-09 23:42:39] [config] max-length-crop: false
[2019-07-09 23:42:39] [config] max-length-factor: 3
[2019-07-09 23:42:39] [config] maxi-batch: 100
[2019-07-09 23:42:39] [config] maxi-batch-sort: trg
[2019-07-09 23:42:39] [config] mini-batch: 64
[2019-07-09 23:42:39] [config] mini-batch-fit: true
[2019-07-09 23:42:39] [config] mini-batch-fit-step: 10
[2019-07-09 23:42:39] [config] mini-batch-overstuff: 1
[2019-07-09 23:42:39] [config] mini-batch-track-lr: false
[2019-07-09 23:42:39] [config] mini-batch-understuff: 1
[2019-07-09 23:42:39] [config] mini-batch-warmup: 0
[2019-07-09 23:42:39] [config] mini-batch-words: 0
[2019-07-09 23:42:39] [config] mini-batch-words-ref: 0
[2019-07-09 23:42:39] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-09 23:42:39] [config] multi-loss-type: sum
[2019-07-09 23:42:39] [config] multi-node: false
[2019-07-09 23:42:39] [config] multi-node-overlap: true
[2019-07-09 23:42:39] [config] n-best: false
[2019-07-09 23:42:39] [config] no-nccl: false
[2019-07-09 23:42:39] [config] no-reload: false
[2019-07-09 23:42:39] [config] no-restore-corpus: false
[2019-07-09 23:42:39] [config] no-shuffle: false
[2019-07-09 23:42:39] [config] normalize: 1
[2019-07-09 23:42:39] [config] num-devices: 0
[2019-07-09 23:42:39] [config] optimizer: adam
[2019-07-09 23:42:39] [config] optimizer-delay: 1
[2019-07-09 23:42:39] [config] optimizer-params:
[2019-07-09 23:42:39] [config]   []
[2019-07-09 23:42:39] [config] overwrite: false
[2019-07-09 23:42:39] [config] pretrained-model: ""
[2019-07-09 23:42:39] [config] quiet: false
[2019-07-09 23:42:39] [config] quiet-translation: true
[2019-07-09 23:42:39] [config] relative-paths: false
[2019-07-09 23:42:39] [config] right-left: false
[2019-07-09 23:42:39] [config] save-freq: 20000
[2019-07-09 23:42:39] [config] seed: 1111
[2019-07-09 23:42:39] [config] shuffle-in-ram: false
[2019-07-09 23:42:39] [config] skip: false
[2019-07-09 23:42:39] [config] sqlite: ""
[2019-07-09 23:42:39] [config] sqlite-drop: false
[2019-07-09 23:42:39] [config] sync-sgd: true
[2019-07-09 23:42:39] [config] tempdir: .
[2019-07-09 23:42:39] [config] tied-embeddings: false
[2019-07-09 23:42:39] [config] tied-embeddings-all: false
[2019-07-09 23:42:39] [config] tied-embeddings-src: false
[2019-07-09 23:42:39] [config] train-sets:
[2019-07-09 23:42:39] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-09 23:42:39] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-09 23:42:39] [config] transformer-aan-activation: swish
[2019-07-09 23:42:39] [config] transformer-aan-depth: 2
[2019-07-09 23:42:39] [config] transformer-aan-nogate: false
[2019-07-09 23:42:39] [config] transformer-decoder-autoreg: self-attention
[2019-07-09 23:42:39] [config] transformer-dim-aan: 2048
[2019-07-09 23:42:39] [config] transformer-dim-ffn: 2048
[2019-07-09 23:42:39] [config] transformer-dropout: 0
[2019-07-09 23:42:39] [config] transformer-dropout-attention: 0
[2019-07-09 23:42:39] [config] transformer-dropout-ffn: 0
[2019-07-09 23:42:39] [config] transformer-ffn-activation: swish
[2019-07-09 23:42:39] [config] transformer-ffn-depth: 2
[2019-07-09 23:42:39] [config] transformer-guided-alignment-layer: last
[2019-07-09 23:42:39] [config] transformer-heads: 8
[2019-07-09 23:42:39] [config] transformer-no-projection: false
[2019-07-09 23:42:39] [config] transformer-postprocess: dan
[2019-07-09 23:42:39] [config] transformer-postprocess-emb: d
[2019-07-09 23:42:39] [config] transformer-preprocess: ""
[2019-07-09 23:42:39] [config] transformer-tied-layers:
[2019-07-09 23:42:39] [config]   []
[2019-07-09 23:42:39] [config] transformer-train-position-embeddings: false
[2019-07-09 23:42:39] [config] type: amun
[2019-07-09 23:42:39] [config] ulr: false
[2019-07-09 23:42:39] [config] ulr-dim-emb: 0
[2019-07-09 23:42:39] [config] ulr-dropout: 0
[2019-07-09 23:42:39] [config] ulr-keys-vectors: ""
[2019-07-09 23:42:39] [config] ulr-query-vectors: ""
[2019-07-09 23:42:39] [config] ulr-softmax-temperature: 1
[2019-07-09 23:42:39] [config] ulr-trainable-transformation: false
[2019-07-09 23:42:39] [config] valid-freq: 20000
[2019-07-09 23:42:39] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-09 23:42:39] [config] valid-max-length: 1000
[2019-07-09 23:42:39] [config] valid-metrics:
[2019-07-09 23:42:39] [config]   - cross-entropy
[2019-07-09 23:42:39] [config]   - perplexity
[2019-07-09 23:42:39] [config]   - translation
[2019-07-09 23:42:39] [config] valid-mini-batch: 8
[2019-07-09 23:42:39] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-09 23:42:39] [config] valid-sets:
[2019-07-09 23:42:39] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-09 23:42:39] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-09 23:42:39] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-09 23:42:39] [config] vocabs:
[2019-07-09 23:42:39] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-09 23:42:39] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-09 23:42:39] [config] word-penalty: 0
[2019-07-09 23:42:39] [config] workspace: 6000
[2019-07-09 23:42:39] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-09 23:42:39] Using synchronous training
[2019-07-09 23:42:39] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-09 23:42:39] [data] Using unused word id eos for 0
[2019-07-09 23:42:39] [data] Using unused word id UNK for 1
[2019-07-09 23:42:39] [data] Setting vocabulary size for input 0 to 50000
[2019-07-09 23:42:39] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-09 23:42:39] [data] Using unused word id eos for 0
[2019-07-09 23:42:39] [data] Using unused word id UNK for 1
[2019-07-09 23:42:39] [data] Setting vocabulary size for input 1 to 50000
[2019-07-09 23:42:39] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-09 23:42:39] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-09 23:42:40] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-09 23:42:41] [memory] Extending reserved space to 6016 MB (device gpu3)
[2019-07-09 23:42:41] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-09 23:42:41] [comm] NCCLCommunicator constructed successfully.
[2019-07-09 23:42:41] [training] Using 2 GPUs
[2019-07-09 23:42:41] [memory] Reserving 422 MB, device gpu2
[2019-07-09 23:42:41] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-09 23:42:41] [memory] Reserving 422 MB, device gpu2
[2019-07-09 23:42:52] [batching] Done. Typical MB size is 16192 target words
[2019-07-09 23:42:52] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-09 23:42:52] [memory] Extending reserved space to 6016 MB (device gpu3)
[2019-07-09 23:42:52] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-09 23:42:52] [comm] NCCLCommunicator constructed successfully.
[2019-07-09 23:42:52] [training] Using 2 GPUs
[2019-07-09 23:42:52] Training started
[2019-07-09 23:42:52] [data] Shuffling data
[2019-07-09 23:42:55] [data] Done reading 5196149 sentences
[2019-07-09 23:43:17] [data] Done shuffling 5196149 sentences to temp files
[2019-07-09 23:43:22] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-09 23:43:22] [memory] Reserving 422 MB, device gpu3
[2019-07-09 23:43:22] [memory] Reserving 422 MB, device gpu2
[2019-07-09 23:43:23] [memory] Reserving 422 MB, device gpu3
[2019-07-09 23:43:23] [memory] Reserving 422 MB, device gpu2
[2019-07-09 23:43:23] [memory] Reserving 211 MB, device gpu2
[2019-07-09 23:43:23] [memory] Reserving 211 MB, device gpu3
[2019-07-09 23:43:23] [memory] Reserving 422 MB, device gpu2
[2019-07-09 23:43:23] [memory] Reserving 422 MB, device gpu3
[2019-07-10 00:01:11] Ep. 1 : Up. 2000 : Sen. 712,562 : Cost 120.86579132 : Time 1111.93s : 13659.02 words/s
[2019-07-10 00:19:07] Ep. 1 : Up. 4000 : Sen. 1,423,114 : Cost 92.21053314 : Time 1075.63s : 14118.78 words/s
[2019-07-10 00:37:00] Ep. 1 : Up. 6000 : Sen. 2,134,908 : Cost 79.04031372 : Time 1073.02s : 14122.45 words/s
[2019-07-10 00:54:57] Ep. 1 : Up. 8000 : Sen. 2,848,405 : Cost 71.96324158 : Time 1077.41s : 14135.29 words/s
[2019-07-10 01:12:50] Ep. 1 : Up. 10000 : Sen. 3,558,082 : Cost 67.57403564 : Time 1072.55s : 14126.58 words/s
[2019-07-10 01:30:44] Ep. 1 : Up. 12000 : Sen. 4,267,846 : Cost 64.42881012 : Time 1073.73s : 14108.25 words/s
[2019-07-10 01:33:36] Seen 4381942 samples
[2019-07-10 01:33:36] Starting epoch 2
[2019-07-10 01:33:36] [data] Shuffling data
[2019-07-10 01:33:39] [data] Done reading 5196149 sentences
[2019-07-10 01:34:00] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 01:49:13] Ep. 2 : Up. 14000 : Sen. 599,922 : Cost 61.54767609 : Time 1109.45s : 13736.40 words/s
[2019-07-10 02:07:10] Ep. 2 : Up. 16000 : Sen. 1,313,360 : Cost 59.77266693 : Time 1076.72s : 14147.53 words/s
[2019-07-10 02:25:05] Ep. 2 : Up. 18000 : Sen. 2,026,990 : Cost 58.27721405 : Time 1075.71s : 14147.01 words/s
[2019-07-10 02:42:56] Ep. 2 : Up. 20000 : Sen. 2,739,518 : Cost 57.08032227 : Time 1070.35s : 14185.26 words/s
[2019-07-10 02:42:56] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 02:43:06] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter20000.npz
[2019-07-10 02:43:13] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 02:43:23] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 02:43:47] [valid] Ep. 2 : Up. 20000 : cross-entropy : 65.9824 : new best
[2019-07-10 02:43:51] [valid] Ep. 2 : Up. 20000 : perplexity : 13.534 : new best
[2019-07-10 02:44:31] [valid] Ep. 2 : Up. 20000 : translation : 24.94 : new best
[2019-07-10 03:02:29] Ep. 2 : Up. 22000 : Sen. 3,449,918 : Cost 56.26862717 : Time 1173.17s : 12926.67 words/s
[2019-07-10 03:20:22] Ep. 2 : Up. 24000 : Sen. 4,161,042 : Cost 55.08058929 : Time 1072.95s : 14126.41 words/s
[2019-07-10 03:25:56] Seen 4381942 samples
[2019-07-10 03:25:56] Starting epoch 3
[2019-07-10 03:25:56] [data] Shuffling data
[2019-07-10 03:26:05] [data] Done reading 5196149 sentences
[2019-07-10 03:26:27] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 03:38:46] Ep. 3 : Up. 26000 : Sen. 489,296 : Cost 54.01268768 : Time 1104.15s : 13730.49 words/s
[2019-07-10 03:56:48] Ep. 3 : Up. 28000 : Sen. 1,205,189 : Cost 53.34684753 : Time 1082.36s : 14150.21 words/s
[2019-07-10 04:14:45] Ep. 3 : Up. 30000 : Sen. 1,918,640 : Cost 52.46765518 : Time 1076.18s : 14120.03 words/s
[2019-07-10 04:32:43] Ep. 3 : Up. 32000 : Sen. 2,629,378 : Cost 52.24642563 : Time 1078.34s : 14070.01 words/s
[2019-07-10 04:50:38] Ep. 3 : Up. 34000 : Sen. 3,338,892 : Cost 51.59522247 : Time 1075.13s : 14069.94 words/s
[2019-07-10 05:08:42] Ep. 3 : Up. 36000 : Sen. 4,054,458 : Cost 51.06229019 : Time 1084.33s : 14074.56 words/s
[2019-07-10 05:16:57] Seen 4381942 samples
[2019-07-10 05:16:57] Starting epoch 4
[2019-07-10 05:16:57] [data] Shuffling data
[2019-07-10 05:17:01] [data] Done reading 5196149 sentences
[2019-07-10 05:17:23] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 05:27:09] Ep. 4 : Up. 38000 : Sen. 388,184 : Cost 50.36524200 : Time 1106.68s : 13797.81 words/s
[2019-07-10 05:45:03] Ep. 4 : Up. 40000 : Sen. 1,099,116 : Cost 49.79553604 : Time 1074.04s : 14135.00 words/s
[2019-07-10 05:45:03] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 05:45:12] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter40000.npz
[2019-07-10 05:45:19] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 05:45:29] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 05:45:49] [valid] Ep. 4 : Up. 40000 : cross-entropy : 57.131 : new best
[2019-07-10 05:45:53] [valid] Ep. 4 : Up. 40000 : perplexity : 9.5422 : new best
[2019-07-10 05:46:35] [valid] Ep. 4 : Up. 40000 : translation : 27.49 : new best
[2019-07-10 06:04:33] Ep. 4 : Up. 42000 : Sen. 1,810,882 : Cost 49.52500153 : Time 1169.41s : 12987.26 words/s
[2019-07-10 06:22:31] Ep. 4 : Up. 44000 : Sen. 2,525,734 : Cost 49.27574539 : Time 1078.58s : 14138.08 words/s
[2019-07-10 06:40:26] Ep. 4 : Up. 46000 : Sen. 3,237,358 : Cost 48.98035431 : Time 1074.69s : 14114.25 words/s
[2019-07-10 06:58:26] Ep. 4 : Up. 48000 : Sen. 3,952,226 : Cost 48.91934586 : Time 1079.70s : 14142.29 words/s
[2019-07-10 07:09:17] Seen 4381942 samples
[2019-07-10 07:09:17] Starting epoch 5
[2019-07-10 07:09:17] [data] Shuffling data
[2019-07-10 07:09:20] [data] Done reading 5196149 sentences
[2019-07-10 07:09:41] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 07:16:46] Ep. 5 : Up. 50000 : Sen. 278,733 : Cost 48.05939102 : Time 1100.14s : 13702.88 words/s
[2019-07-10 07:34:39] Ep. 5 : Up. 52000 : Sen. 987,333 : Cost 47.82443237 : Time 1073.66s : 14107.63 words/s
[2019-07-10 07:52:36] Ep. 5 : Up. 54000 : Sen. 1,699,518 : Cost 47.56145096 : Time 1077.00s : 14103.82 words/s
[2019-07-10 08:10:31] Ep. 5 : Up. 56000 : Sen. 2,411,626 : Cost 47.27463913 : Time 1074.55s : 14134.78 words/s
[2019-07-10 08:28:25] Ep. 5 : Up. 58000 : Sen. 3,121,840 : Cost 47.33300018 : Time 1074.54s : 14119.86 words/s
[2019-07-10 08:46:17] Ep. 5 : Up. 60000 : Sen. 3,832,964 : Cost 46.97298813 : Time 1072.08s : 14136.31 words/s
[2019-07-10 08:46:17] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 08:46:26] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter60000.npz
[2019-07-10 08:46:33] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 08:46:43] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 08:47:04] [valid] Ep. 5 : Up. 60000 : cross-entropy : 53.6492 : new best
[2019-07-10 08:47:07] [valid] Ep. 5 : Up. 60000 : perplexity : 8.3166 : new best
[2019-07-10 08:47:49] [valid] Ep. 5 : Up. 60000 : translation : 28.49 : new best
[2019-07-10 09:01:43] Seen 4381942 samples
[2019-07-10 09:01:43] Starting epoch 6
[2019-07-10 09:01:43] [data] Shuffling data
[2019-07-10 09:01:45] [data] Done reading 5196149 sentences
[2019-07-10 09:02:06] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 09:06:19] Ep. 6 : Up. 62000 : Sen. 163,936 : Cost 46.78217697 : Time 1201.08s : 12661.14 words/s
[2019-07-10 09:24:12] Ep. 6 : Up. 64000 : Sen. 876,482 : Cost 46.10741043 : Time 1073.75s : 14157.05 words/s
[2019-07-10 09:42:04] Ep. 6 : Up. 66000 : Sen. 1,588,692 : Cost 45.96256638 : Time 1071.55s : 14159.64 words/s
[2019-07-10 09:59:59] Ep. 6 : Up. 68000 : Sen. 2,299,974 : Cost 46.06535339 : Time 1074.92s : 14130.97 words/s
[2019-07-10 10:17:56] Ep. 6 : Up. 70000 : Sen. 3,013,128 : Cost 46.01554489 : Time 1076.84s : 14153.59 words/s
[2019-07-10 10:35:50] Ep. 6 : Up. 72000 : Sen. 3,727,237 : Cost 45.63093567 : Time 1074.32s : 14163.57 words/s
[2019-07-10 10:52:14] Seen 4381942 samples
[2019-07-10 10:52:14] Starting epoch 7
[2019-07-10 10:52:14] [data] Shuffling data
[2019-07-10 10:52:17] [data] Done reading 5196149 sentences
[2019-07-10 10:52:39] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 10:54:16] Ep. 7 : Up. 74000 : Sen. 61,774 : Cost 45.71954346 : Time 1106.27s : 13821.40 words/s
[2019-07-10 11:12:06] Ep. 7 : Up. 76000 : Sen. 769,360 : Cost 44.89579010 : Time 1070.12s : 14113.94 words/s
[2019-07-10 11:30:00] Ep. 7 : Up. 78000 : Sen. 1,483,122 : Cost 44.97630692 : Time 1073.97s : 14179.15 words/s
[2019-07-10 11:47:55] Ep. 7 : Up. 80000 : Sen. 2,197,868 : Cost 44.91839218 : Time 1074.91s : 14180.14 words/s
[2019-07-10 11:47:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 11:48:05] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter80000.npz
[2019-07-10 11:48:12] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 11:48:21] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 11:48:42] [valid] Ep. 7 : Up. 80000 : cross-entropy : 51.8244 : new best
[2019-07-10 11:48:45] [valid] Ep. 7 : Up. 80000 : perplexity : 7.73846 : new best
[2019-07-10 11:49:27] [valid] Ep. 7 : Up. 80000 : translation : 29.23 : new best
[2019-07-10 12:07:26] Ep. 7 : Up. 82000 : Sen. 2,912,636 : Cost 44.84514618 : Time 1171.07s : 13030.98 words/s
[2019-07-10 12:25:20] Ep. 7 : Up. 84000 : Sen. 3,623,760 : Cost 44.91511536 : Time 1073.20s : 14138.71 words/s
[2019-07-10 12:43:09] Ep. 7 : Up. 86000 : Sen. 4,333,118 : Cost 44.79977036 : Time 1069.12s : 14145.09 words/s
[2019-07-10 12:44:22] Seen 4381942 samples
[2019-07-10 12:44:22] Starting epoch 8
[2019-07-10 12:44:22] [data] Shuffling data
[2019-07-10 12:44:25] [data] Done reading 5196149 sentences
[2019-07-10 12:44:46] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 13:01:35] Ep. 8 : Up. 88000 : Sen. 665,600 : Cost 43.85397720 : Time 1105.99s : 13779.74 words/s
[2019-07-10 13:19:28] Ep. 8 : Up. 90000 : Sen. 1,376,349 : Cost 44.04575348 : Time 1073.12s : 14128.57 words/s
[2019-07-10 13:37:23] Ep. 8 : Up. 92000 : Sen. 2,087,354 : Cost 44.08126068 : Time 1075.63s : 14124.66 words/s
[2019-07-10 13:55:15] Ep. 8 : Up. 94000 : Sen. 2,797,754 : Cost 43.96192551 : Time 1071.60s : 14147.73 words/s
[2019-07-10 14:13:08] Ep. 8 : Up. 96000 : Sen. 3,508,790 : Cost 44.02733612 : Time 1073.41s : 14129.05 words/s
[2019-07-10 14:31:02] Ep. 8 : Up. 98000 : Sen. 4,221,441 : Cost 43.98499298 : Time 1073.41s : 14137.90 words/s
[2019-07-10 14:35:06] Seen 4381942 samples
[2019-07-10 14:35:06] Starting epoch 9
[2019-07-10 14:35:06] [data] Shuffling data
[2019-07-10 14:35:08] [data] Done reading 5196149 sentences
[2019-07-10 14:35:29] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 14:49:25] Ep. 9 : Up. 100000 : Sen. 549,358 : Cost 43.38293839 : Time 1103.61s : 13728.54 words/s
[2019-07-10 14:49:25] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 14:49:35] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter100000.npz
[2019-07-10 14:49:41] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 14:49:51] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 14:50:12] [valid] Ep. 9 : Up. 100000 : cross-entropy : 50.5607 : new best
[2019-07-10 14:50:16] [valid] Ep. 9 : Up. 100000 : perplexity : 7.36181 : new best
[2019-07-10 14:50:58] [valid] Ep. 9 : Up. 100000 : translation : 29.73 : new best
[2019-07-10 15:08:54] Ep. 9 : Up. 102000 : Sen. 1,261,436 : Cost 43.27460861 : Time 1168.46s : 13002.60 words/s
[2019-07-10 15:26:44] Ep. 9 : Up. 104000 : Sen. 1,973,980 : Cost 43.15872574 : Time 1069.87s : 14190.45 words/s
[2019-07-10 15:44:33] Ep. 9 : Up. 106000 : Sen. 2,684,146 : Cost 43.25646210 : Time 1068.90s : 14187.24 words/s
[2019-07-10 16:02:37] Ep. 9 : Up. 108000 : Sen. 3,398,400 : Cost 43.29484177 : Time 1083.88s : 14056.70 words/s
[2019-07-10 16:20:55] Ep. 9 : Up. 110000 : Sen. 4,112,798 : Cost 43.33968353 : Time 1098.08s : 13883.73 words/s
[2019-07-10 16:27:51] Seen 4381942 samples
[2019-07-10 16:27:51] Starting epoch 10
[2019-07-10 16:27:51] [data] Shuffling data
[2019-07-10 16:27:57] [data] Done reading 5196149 sentences
[2019-07-10 16:28:28] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 16:39:56] Ep. 10 : Up. 112000 : Sen. 445,148 : Cost 42.77745819 : Time 1141.12s : 13356.41 words/s
[2019-07-10 16:58:19] Ep. 10 : Up. 114000 : Sen. 1,161,024 : Cost 42.52555084 : Time 1103.50s : 13836.99 words/s
[2019-07-10 17:16:34] Ep. 10 : Up. 116000 : Sen. 1,870,072 : Cost 42.91124344 : Time 1094.92s : 13841.64 words/s
[2019-07-10 17:34:26] Ep. 10 : Up. 118000 : Sen. 2,583,500 : Cost 42.55852127 : Time 1071.99s : 14178.85 words/s
[2019-07-10 17:52:19] Ep. 10 : Up. 120000 : Sen. 3,295,188 : Cost 42.95183945 : Time 1073.24s : 14170.16 words/s
[2019-07-10 17:52:19] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 17:52:30] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter120000.npz
[2019-07-10 17:52:41] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 17:52:51] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 17:53:12] [valid] Ep. 10 : Up. 120000 : cross-entropy : 49.7693 : new best
[2019-07-10 17:53:16] [valid] Ep. 10 : Up. 120000 : perplexity : 7.13535 : new best
[2019-07-10 17:53:56] [valid] Ep. 10 : Up. 120000 : translation : 29.9 : new best
[2019-07-10 18:11:55] Ep. 10 : Up. 122000 : Sen. 4,007,442 : Cost 42.65031433 : Time 1175.37s : 12914.45 words/s
[2019-07-10 18:21:22] Seen 4381942 samples
[2019-07-10 18:21:22] Starting epoch 11
[2019-07-10 18:21:22] [data] Shuffling data
[2019-07-10 18:21:25] [data] Done reading 5196149 sentences
[2019-07-10 18:21:46] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 18:30:16] Ep. 11 : Up. 124000 : Sen. 336,288 : Cost 42.33941269 : Time 1100.76s : 13779.85 words/s
[2019-07-10 18:48:04] Ep. 11 : Up. 126000 : Sen. 1,046,104 : Cost 41.81225967 : Time 1068.16s : 14146.68 words/s
[2019-07-10 19:05:56] Ep. 11 : Up. 128000 : Sen. 1,756,100 : Cost 42.09806824 : Time 1072.14s : 14153.46 words/s
[2019-07-10 19:23:49] Ep. 11 : Up. 130000 : Sen. 2,467,268 : Cost 42.19435501 : Time 1072.89s : 14149.25 words/s
[2019-07-10 19:41:44] Ep. 11 : Up. 132000 : Sen. 3,180,800 : Cost 42.30962372 : Time 1074.87s : 14165.74 words/s
[2019-07-10 19:59:34] Ep. 11 : Up. 134000 : Sen. 3,887,608 : Cost 42.29568481 : Time 1070.15s : 14111.00 words/s
[2019-07-10 20:11:58] Seen 4381942 samples
[2019-07-10 20:11:58] Starting epoch 12
[2019-07-10 20:11:58] [data] Shuffling data
[2019-07-10 20:12:00] [data] Done reading 5196149 sentences
[2019-07-10 20:12:21] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 20:17:58] Ep. 12 : Up. 136000 : Sen. 221,652 : Cost 41.90850830 : Time 1104.67s : 13797.46 words/s
[2019-07-10 20:35:57] Ep. 12 : Up. 138000 : Sen. 935,354 : Cost 41.60607529 : Time 1078.14s : 14150.70 words/s
[2019-07-10 20:53:48] Ep. 12 : Up. 140000 : Sen. 1,645,702 : Cost 41.46624756 : Time 1071.90s : 14118.77 words/s
[2019-07-10 20:53:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 20:53:58] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter140000.npz
[2019-07-10 20:54:04] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 20:54:14] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 20:54:35] [valid] Ep. 12 : Up. 140000 : cross-entropy : 49.235 : new best
[2019-07-10 20:54:38] [valid] Ep. 12 : Up. 140000 : perplexity : 6.9864 : new best
[2019-07-10 20:55:20] [valid] Ep. 12 : Up. 140000 : translation : 30.03 : new best
[2019-07-10 21:13:15] Ep. 12 : Up. 142000 : Sen. 2,355,518 : Cost 41.68212891 : Time 1166.45s : 12978.17 words/s
[2019-07-10 21:31:09] Ep. 12 : Up. 144000 : Sen. 3,065,194 : Cost 41.86830139 : Time 1073.92s : 14107.27 words/s
[2019-07-10 21:49:19] Ep. 12 : Up. 146000 : Sen. 3,781,446 : Cost 41.70369720 : Time 1090.30s : 14011.98 words/s
[2019-07-10 22:04:37] Seen 4381942 samples
[2019-07-10 22:04:37] Starting epoch 13
[2019-07-10 22:04:37] [data] Shuffling data
[2019-07-10 22:04:43] [data] Done reading 5196149 sentences
[2019-07-10 22:05:13] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 22:08:03] Ep. 13 : Up. 148000 : Sen. 111,148 : Cost 41.67259598 : Time 1124.23s : 13500.91 words/s
[2019-07-10 22:26:19] Ep. 13 : Up. 150000 : Sen. 824,558 : Cost 41.03351212 : Time 1095.79s : 13887.33 words/s
[2019-07-10 22:44:13] Ep. 13 : Up. 152000 : Sen. 1,535,594 : Cost 41.17793655 : Time 1074.30s : 14131.09 words/s
[2019-07-10 23:02:09] Ep. 13 : Up. 154000 : Sen. 2,246,400 : Cost 41.32898331 : Time 1075.34s : 14099.50 words/s
[2019-07-10 23:20:09] Ep. 13 : Up. 156000 : Sen. 2,962,246 : Cost 41.37460327 : Time 1080.05s : 14133.50 words/s
[2019-07-10 23:38:07] Ep. 13 : Up. 158000 : Sen. 3,675,340 : Cost 41.40930557 : Time 1078.53s : 14134.18 words/s
[2019-07-10 23:55:54] Seen 4381942 samples
[2019-07-10 23:55:54] Starting epoch 14
[2019-07-10 23:55:54] [data] Shuffling data
[2019-07-10 23:55:57] [data] Done reading 5196149 sentences
[2019-07-10 23:56:21] [data] Done shuffling 5196149 sentences to temp files
[2019-07-10 23:56:29] Ep. 14 : Up. 160000 : Sen. 4,316 : Cost 41.49638367 : Time 1101.25s : 13765.05 words/s
[2019-07-10 23:56:29] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-10 23:56:40] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter160000.npz
[2019-07-10 23:56:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-10 23:56:57] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-10 23:57:18] [valid] Ep. 14 : Up. 160000 : cross-entropy : 48.9124 : new best
[2019-07-10 23:57:23] [valid] Ep. 14 : Up. 160000 : perplexity : 6.89797 : new best
[2019-07-10 23:58:05] [valid] Ep. 14 : Up. 160000 : translation : 30.16 : new best
[2019-07-11 00:16:05] Ep. 14 : Up. 162000 : Sen. 716,800 : Cost 40.80692291 : Time 1175.90s : 12939.93 words/s
[2019-07-11 00:34:07] Ep. 14 : Up. 164000 : Sen. 1,431,094 : Cost 40.77570724 : Time 1082.84s : 14066.60 words/s
[2019-07-11 00:52:03] Ep. 14 : Up. 166000 : Sen. 2,143,364 : Cost 40.72045898 : Time 1076.09s : 14082.38 words/s
[2019-07-11 01:10:03] Ep. 14 : Up. 168000 : Sen. 2,854,400 : Cost 41.05875778 : Time 1079.61s : 14071.87 words/s
[2019-07-11 01:27:58] Ep. 14 : Up. 170000 : Sen. 3,565,775 : Cost 41.11179352 : Time 1074.77s : 14120.52 words/s
[2019-07-11 01:45:55] Ep. 14 : Up. 172000 : Sen. 4,278,112 : Cost 41.15656281 : Time 1077.17s : 14111.53 words/s
[2019-07-11 01:48:32] Seen 4381942 samples
[2019-07-11 01:48:32] Starting epoch 15
[2019-07-11 01:48:32] [data] Shuffling data
[2019-07-11 01:48:35] [data] Done reading 5196149 sentences
[2019-07-11 01:48:56] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 02:04:28] Ep. 15 : Up. 174000 : Sen. 612,272 : Cost 40.48145294 : Time 1113.20s : 13739.94 words/s
[2019-07-11 02:22:30] Ep. 15 : Up. 176000 : Sen. 1,326,884 : Cost 40.44403076 : Time 1081.34s : 14097.25 words/s
[2019-07-11 02:40:23] Ep. 15 : Up. 178000 : Sen. 2,036,718 : Cost 40.61179733 : Time 1073.24s : 14116.60 words/s
[2019-07-11 02:58:17] Ep. 15 : Up. 180000 : Sen. 2,751,364 : Cost 40.78790665 : Time 1074.65s : 14179.85 words/s
[2019-07-11 02:58:17] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 02:58:27] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter180000.npz
[2019-07-11 02:58:34] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 02:58:43] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 02:59:05] [valid] Ep. 15 : Up. 180000 : cross-entropy : 48.7377 : new best
[2019-07-11 02:59:09] [valid] Ep. 15 : Up. 180000 : perplexity : 6.85056 : new best
[2019-07-11 02:59:52] [valid] Ep. 15 : Up. 180000 : translation : 30.21 : new best
[2019-07-11 03:17:52] Ep. 15 : Up. 182000 : Sen. 3,461,862 : Cost 40.82414627 : Time 1174.22s : 12930.60 words/s
[2019-07-11 03:35:47] Ep. 15 : Up. 184000 : Sen. 4,174,123 : Cost 40.74765778 : Time 1075.35s : 14108.27 words/s
[2019-07-11 03:41:02] Seen 4381942 samples
[2019-07-11 03:41:02] Starting epoch 16
[2019-07-11 03:41:02] [data] Shuffling data
[2019-07-11 03:41:06] [data] Done reading 5196149 sentences
[2019-07-11 03:41:28] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 03:54:15] Ep. 16 : Up. 186000 : Sen. 503,434 : Cost 40.18490601 : Time 1108.31s : 13680.14 words/s
[2019-07-11 04:12:10] Ep. 16 : Up. 188000 : Sen. 1,215,046 : Cost 40.20653534 : Time 1074.38s : 14141.23 words/s
[2019-07-11 04:30:06] Ep. 16 : Up. 190000 : Sen. 1,926,718 : Cost 40.28514862 : Time 1076.76s : 14095.56 words/s
[2019-07-11 04:48:02] Ep. 16 : Up. 192000 : Sen. 2,638,380 : Cost 40.30157852 : Time 1075.29s : 14121.90 words/s
[2019-07-11 05:06:01] Ep. 16 : Up. 194000 : Sen. 3,352,228 : Cost 40.44412613 : Time 1079.46s : 14107.93 words/s
[2019-07-11 05:23:56] Ep. 16 : Up. 196000 : Sen. 4,064,318 : Cost 40.58407974 : Time 1075.15s : 14136.70 words/s
[2019-07-11 05:31:58] Seen 4381942 samples
[2019-07-11 05:31:58] Starting epoch 17
[2019-07-11 05:31:58] [data] Shuffling data
[2019-07-11 05:32:01] [data] Done reading 5196149 sentences
[2019-07-11 05:32:27] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 05:42:24] Ep. 17 : Up. 198000 : Sen. 394,990 : Cost 40.09257889 : Time 1107.29s : 13727.23 words/s
[2019-07-11 06:00:22] Ep. 17 : Up. 200000 : Sen. 1,108,472 : Cost 39.89657593 : Time 1077.84s : 14129.46 words/s
[2019-07-11 06:00:22] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 06:00:32] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter200000.npz
[2019-07-11 06:00:39] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 06:00:50] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 06:01:12] [valid] Ep. 17 : Up. 200000 : cross-entropy : 48.5039 : new best
[2019-07-11 06:01:16] [valid] Ep. 17 : Up. 200000 : perplexity : 6.78761 : new best
[2019-07-11 06:01:58] [valid] Ep. 17 : Up. 200000 : translation : 30.34 : new best
[2019-07-11 06:19:58] Ep. 17 : Up. 202000 : Sen. 1,821,554 : Cost 39.94556046 : Time 1176.93s : 12928.50 words/s
[2019-07-11 06:37:51] Ep. 17 : Up. 204000 : Sen. 2,530,466 : Cost 40.12611771 : Time 1073.01s : 14097.69 words/s
[2019-07-11 06:55:46] Ep. 17 : Up. 206000 : Sen. 3,245,118 : Cost 40.13492584 : Time 1074.88s : 14174.48 words/s
[2019-07-11 07:13:43] Ep. 17 : Up. 208000 : Sen. 3,959,154 : Cost 40.23765564 : Time 1076.47s : 14137.76 words/s
[2019-07-11 07:24:21] Seen 4381942 samples
[2019-07-11 07:24:21] Starting epoch 18
[2019-07-11 07:24:21] [data] Shuffling data
[2019-07-11 07:24:23] [data] Done reading 5196149 sentences
[2019-07-11 07:24:45] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 07:32:07] Ep. 18 : Up. 210000 : Sen. 290,235 : Cost 40.00224304 : Time 1104.34s : 13776.74 words/s
[2019-07-11 07:50:04] Ep. 18 : Up. 212000 : Sen. 1,003,440 : Cost 39.63856888 : Time 1077.33s : 14128.01 words/s
[2019-07-11 08:07:59] Ep. 18 : Up. 214000 : Sen. 1,714,026 : Cost 39.86337662 : Time 1074.93s : 14104.33 words/s
[2019-07-11 08:25:58] Ep. 18 : Up. 216000 : Sen. 2,425,062 : Cost 39.80089188 : Time 1078.96s : 14065.80 words/s
[2019-07-11 08:43:55] Ep. 18 : Up. 218000 : Sen. 3,137,360 : Cost 39.75370026 : Time 1076.99s : 14102.89 words/s
[2019-07-11 09:01:55] Ep. 18 : Up. 220000 : Sen. 3,853,118 : Cost 40.01832581 : Time 1079.56s : 14156.34 words/s
[2019-07-11 09:01:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 09:02:04] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter220000.npz
[2019-07-11 09:02:12] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 09:02:21] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 09:02:42] [valid] Ep. 18 : Up. 220000 : cross-entropy : 48.3959 : new best
[2019-07-11 09:02:45] [valid] Ep. 18 : Up. 220000 : perplexity : 6.75873 : new best
[2019-07-11 09:03:28] [valid] Ep. 18 : Up. 220000 : translation : 30.35 : new best
[2019-07-11 09:16:54] Seen 4381942 samples
[2019-07-11 09:16:54] Starting epoch 19
[2019-07-11 09:16:54] [data] Shuffling data
[2019-07-11 09:16:58] [data] Done reading 5196149 sentences
[2019-07-11 09:17:27] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 09:22:04] Ep. 19 : Up. 222000 : Sen. 181,070 : Cost 39.77397919 : Time 1209.00s : 12518.34 words/s
[2019-07-11 09:40:01] Ep. 19 : Up. 224000 : Sen. 892,046 : Cost 39.30121231 : Time 1076.73s : 14095.10 words/s
[2019-07-11 09:57:56] Ep. 19 : Up. 226000 : Sen. 1,604,492 : Cost 39.47258377 : Time 1075.30s : 14131.20 words/s
[2019-07-11 10:15:48] Ep. 19 : Up. 228000 : Sen. 2,313,192 : Cost 39.54723740 : Time 1072.23s : 14097.70 words/s
[2019-07-11 10:33:44] Ep. 19 : Up. 230000 : Sen. 3,025,522 : Cost 39.66525650 : Time 1075.37s : 14140.53 words/s
[2019-07-11 10:51:41] Ep. 19 : Up. 232000 : Sen. 3,740,131 : Cost 39.84076691 : Time 1077.87s : 14160.33 words/s
[2019-07-11 11:07:49] Seen 4381942 samples
[2019-07-11 11:07:49] Starting epoch 20
[2019-07-11 11:07:49] [data] Shuffling data
[2019-07-11 11:07:54] [data] Done reading 5196149 sentences
[2019-07-11 11:08:16] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 11:10:08] Ep. 20 : Up. 234000 : Sen. 70,718 : Cost 39.64398575 : Time 1106.52s : 13735.46 words/s
[2019-07-11 11:28:04] Ep. 20 : Up. 236000 : Sen. 783,179 : Cost 39.17070007 : Time 1076.22s : 14128.40 words/s
[2019-07-11 11:45:58] Ep. 20 : Up. 238000 : Sen. 1,491,200 : Cost 39.29227448 : Time 1073.79s : 14073.09 words/s
[2019-07-11 12:03:55] Ep. 20 : Up. 240000 : Sen. 2,204,550 : Cost 39.34074783 : Time 1076.85s : 14137.28 words/s
[2019-07-11 12:03:55] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 12:04:06] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter240000.npz
[2019-07-11 12:04:13] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 12:04:26] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 12:04:56] [valid] Ep. 20 : Up. 240000 : cross-entropy : 48.3911 : new best
[2019-07-11 12:05:00] [valid] Ep. 20 : Up. 240000 : perplexity : 6.75744 : new best
[2019-07-11 12:05:52] [valid] Ep. 20 : Up. 240000 : translation : 30.24 : stalled 1 times (last best: 30.35)
[2019-07-11 12:23:57] Ep. 20 : Up. 242000 : Sen. 2,915,548 : Cost 39.32513046 : Time 1201.74s : 12587.05 words/s
[2019-07-11 12:41:55] Ep. 20 : Up. 244000 : Sen. 3,626,514 : Cost 39.47473907 : Time 1078.28s : 14071.14 words/s
[2019-07-11 12:59:49] Ep. 20 : Up. 246000 : Sen. 4,337,938 : Cost 39.59093094 : Time 1073.91s : 14151.01 words/s
[2019-07-11 13:00:55] Seen 4381942 samples
[2019-07-11 13:00:55] Starting epoch 21
[2019-07-11 13:00:55] [data] Shuffling data
[2019-07-11 13:00:59] [data] Done reading 5196149 sentences
[2019-07-11 13:01:20] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 13:18:19] Ep. 21 : Up. 248000 : Sen. 675,341 : Cost 38.80883408 : Time 1110.14s : 13808.64 words/s
[2019-07-11 13:36:13] Ep. 21 : Up. 250000 : Sen. 1,387,018 : Cost 39.02331161 : Time 1074.13s : 14148.21 words/s
[2019-07-11 13:54:10] Ep. 21 : Up. 252000 : Sen. 2,096,298 : Cost 39.37620926 : Time 1076.56s : 14096.48 words/s
[2019-07-11 14:12:05] Ep. 21 : Up. 254000 : Sen. 2,809,918 : Cost 39.18897629 : Time 1075.82s : 14117.86 words/s
[2019-07-11 14:30:06] Ep. 21 : Up. 256000 : Sen. 3,520,812 : Cost 39.44027328 : Time 1080.83s : 14031.95 words/s
[2019-07-11 14:47:59] Ep. 21 : Up. 258000 : Sen. 4,230,400 : Cost 39.33227921 : Time 1073.17s : 14110.82 words/s
[2019-07-11 14:51:49] Seen 4381942 samples
[2019-07-11 14:51:49] Starting epoch 22
[2019-07-11 14:51:49] [data] Shuffling data
[2019-07-11 14:51:52] [data] Done reading 5196149 sentences
[2019-07-11 14:52:22] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 15:06:31] Ep. 22 : Up. 260000 : Sen. 559,998 : Cost 38.98223495 : Time 1112.10s : 13659.57 words/s
[2019-07-11 15:06:31] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 15:06:41] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter260000.npz
[2019-07-11 15:06:49] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 15:06:58] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 15:07:20] [valid] Ep. 22 : Up. 260000 : cross-entropy : 48.3471 : new best
[2019-07-11 15:07:23] [valid] Ep. 22 : Up. 260000 : perplexity : 6.74571 : new best
[2019-07-11 15:07:48] Error: Unknown word id: 49992
[2019-07-11 15:07:48] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f9df8818a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f9df8338c80]                                                       + 0xb8c80
[0x7f9df88116ba]                                                       + 0x76ba
[0x7f9df7a9e41d]    clone                                              + 0x6d

[2019-07-11 16:44:02] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 16:44:02] [marian] Running on hodor as process 3482 with command line:
[2019-07-11 16:44:02] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 2 3 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-11 16:44:02] [config] after-batches: 0
[2019-07-11 16:44:02] [config] after-epochs: 0
[2019-07-11 16:44:02] [config] allow-unk: false
[2019-07-11 16:44:02] [config] beam-size: 12
[2019-07-11 16:44:02] [config] bert-class-symbol: "[CLS]"
[2019-07-11 16:44:02] [config] bert-mask-symbol: "[MASK]"
[2019-07-11 16:44:02] [config] bert-masking-fraction: 0.15
[2019-07-11 16:44:02] [config] bert-sep-symbol: "[SEP]"
[2019-07-11 16:44:02] [config] bert-train-type-embeddings: true
[2019-07-11 16:44:02] [config] bert-type-vocab-size: 2
[2019-07-11 16:44:02] [config] best-deep: false
[2019-07-11 16:44:02] [config] clip-gemm: 0
[2019-07-11 16:44:02] [config] clip-norm: 1
[2019-07-11 16:44:02] [config] cost-type: ce-mean
[2019-07-11 16:44:02] [config] cpu-threads: 0
[2019-07-11 16:44:02] [config] data-weighting: ""
[2019-07-11 16:44:02] [config] data-weighting-type: sentence
[2019-07-11 16:44:02] [config] dec-cell: gru
[2019-07-11 16:44:02] [config] dec-cell-base-depth: 2
[2019-07-11 16:44:02] [config] dec-cell-high-depth: 1
[2019-07-11 16:44:02] [config] dec-depth: 1
[2019-07-11 16:44:02] [config] devices:
[2019-07-11 16:44:02] [config]   - 2
[2019-07-11 16:44:02] [config]   - 3
[2019-07-11 16:44:02] [config] dim-emb: 512
[2019-07-11 16:44:02] [config] dim-rnn: 1024
[2019-07-11 16:44:02] [config] dim-vocabs:
[2019-07-11 16:44:02] [config]   - 50000
[2019-07-11 16:44:02] [config]   - 50000
[2019-07-11 16:44:02] [config] disp-first: 0
[2019-07-11 16:44:02] [config] disp-freq: 2000
[2019-07-11 16:44:02] [config] disp-label-counts: false
[2019-07-11 16:44:02] [config] dropout-rnn: 0.2
[2019-07-11 16:44:02] [config] dropout-src: 0.1
[2019-07-11 16:44:02] [config] dropout-trg: 0.1
[2019-07-11 16:44:02] [config] dump-config: ""
[2019-07-11 16:44:02] [config] early-stopping: 5
[2019-07-11 16:44:02] [config] embedding-fix-src: false
[2019-07-11 16:44:02] [config] embedding-fix-trg: false
[2019-07-11 16:44:02] [config] embedding-normalization: false
[2019-07-11 16:44:02] [config] embedding-vectors:
[2019-07-11 16:44:02] [config]   []
[2019-07-11 16:44:02] [config] enc-cell: gru
[2019-07-11 16:44:02] [config] enc-cell-depth: 1
[2019-07-11 16:44:02] [config] enc-depth: 1
[2019-07-11 16:44:02] [config] enc-type: bidirectional
[2019-07-11 16:44:02] [config] exponential-smoothing: 0.0001
[2019-07-11 16:44:02] [config] grad-dropping-momentum: 0
[2019-07-11 16:44:02] [config] grad-dropping-rate: 0
[2019-07-11 16:44:02] [config] grad-dropping-warmup: 100
[2019-07-11 16:44:02] [config] guided-alignment: none
[2019-07-11 16:44:02] [config] guided-alignment-cost: mse
[2019-07-11 16:44:02] [config] guided-alignment-weight: 0.1
[2019-07-11 16:44:02] [config] ignore-model-config: false
[2019-07-11 16:44:02] [config] input-types:
[2019-07-11 16:44:02] [config]   []
[2019-07-11 16:44:02] [config] interpolate-env-vars: false
[2019-07-11 16:44:02] [config] keep-best: false
[2019-07-11 16:44:02] [config] label-smoothing: 0
[2019-07-11 16:44:02] [config] layer-normalization: true
[2019-07-11 16:44:02] [config] learn-rate: 0.0001
[2019-07-11 16:44:02] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-11 16:44:02] [config] log-level: info
[2019-07-11 16:44:02] [config] log-time-zone: ""
[2019-07-11 16:44:02] [config] lr-decay: 0
[2019-07-11 16:44:02] [config] lr-decay-freq: 50000
[2019-07-11 16:44:02] [config] lr-decay-inv-sqrt:
[2019-07-11 16:44:02] [config]   - 0
[2019-07-11 16:44:02] [config] lr-decay-repeat-warmup: false
[2019-07-11 16:44:02] [config] lr-decay-reset-optimizer: false
[2019-07-11 16:44:02] [config] lr-decay-start:
[2019-07-11 16:44:02] [config]   - 10
[2019-07-11 16:44:02] [config]   - 1
[2019-07-11 16:44:02] [config] lr-decay-strategy: epoch+stalled
[2019-07-11 16:44:02] [config] lr-report: false
[2019-07-11 16:44:02] [config] lr-warmup: 0
[2019-07-11 16:44:02] [config] lr-warmup-at-reload: false
[2019-07-11 16:44:02] [config] lr-warmup-cycle: false
[2019-07-11 16:44:02] [config] lr-warmup-start-rate: 0
[2019-07-11 16:44:02] [config] max-length: 50
[2019-07-11 16:44:02] [config] max-length-crop: false
[2019-07-11 16:44:02] [config] max-length-factor: 3
[2019-07-11 16:44:02] [config] maxi-batch: 100
[2019-07-11 16:44:02] [config] maxi-batch-sort: trg
[2019-07-11 16:44:02] [config] mini-batch: 64
[2019-07-11 16:44:02] [config] mini-batch-fit: true
[2019-07-11 16:44:02] [config] mini-batch-fit-step: 10
[2019-07-11 16:44:02] [config] mini-batch-overstuff: 1
[2019-07-11 16:44:02] [config] mini-batch-track-lr: false
[2019-07-11 16:44:02] [config] mini-batch-understuff: 1
[2019-07-11 16:44:02] [config] mini-batch-warmup: 0
[2019-07-11 16:44:02] [config] mini-batch-words: 0
[2019-07-11 16:44:02] [config] mini-batch-words-ref: 0
[2019-07-11 16:44:02] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 16:44:02] [config] multi-loss-type: sum
[2019-07-11 16:44:02] [config] multi-node: false
[2019-07-11 16:44:02] [config] multi-node-overlap: true
[2019-07-11 16:44:02] [config] n-best: false
[2019-07-11 16:44:02] [config] no-nccl: false
[2019-07-11 16:44:02] [config] no-reload: false
[2019-07-11 16:44:02] [config] no-restore-corpus: false
[2019-07-11 16:44:02] [config] no-shuffle: false
[2019-07-11 16:44:02] [config] normalize: 1
[2019-07-11 16:44:02] [config] num-devices: 0
[2019-07-11 16:44:02] [config] optimizer: adam
[2019-07-11 16:44:02] [config] optimizer-delay: 1
[2019-07-11 16:44:02] [config] optimizer-params:
[2019-07-11 16:44:02] [config]   []
[2019-07-11 16:44:02] [config] overwrite: false
[2019-07-11 16:44:02] [config] pretrained-model: ""
[2019-07-11 16:44:02] [config] quiet: false
[2019-07-11 16:44:02] [config] quiet-translation: true
[2019-07-11 16:44:02] [config] relative-paths: false
[2019-07-11 16:44:02] [config] right-left: false
[2019-07-11 16:44:02] [config] save-freq: 20000
[2019-07-11 16:44:02] [config] seed: 1111
[2019-07-11 16:44:02] [config] shuffle-in-ram: false
[2019-07-11 16:44:02] [config] skip: false
[2019-07-11 16:44:02] [config] sqlite: ""
[2019-07-11 16:44:02] [config] sqlite-drop: false
[2019-07-11 16:44:02] [config] sync-sgd: true
[2019-07-11 16:44:02] [config] tempdir: .
[2019-07-11 16:44:02] [config] tied-embeddings: false
[2019-07-11 16:44:02] [config] tied-embeddings-all: false
[2019-07-11 16:44:02] [config] tied-embeddings-src: false
[2019-07-11 16:44:02] [config] train-sets:
[2019-07-11 16:44:02] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-11 16:44:02] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-11 16:44:02] [config] transformer-aan-activation: swish
[2019-07-11 16:44:02] [config] transformer-aan-depth: 2
[2019-07-11 16:44:02] [config] transformer-aan-nogate: false
[2019-07-11 16:44:02] [config] transformer-decoder-autoreg: self-attention
[2019-07-11 16:44:02] [config] transformer-dim-aan: 2048
[2019-07-11 16:44:02] [config] transformer-dim-ffn: 2048
[2019-07-11 16:44:02] [config] transformer-dropout: 0
[2019-07-11 16:44:02] [config] transformer-dropout-attention: 0
[2019-07-11 16:44:02] [config] transformer-dropout-ffn: 0
[2019-07-11 16:44:02] [config] transformer-ffn-activation: swish
[2019-07-11 16:44:02] [config] transformer-ffn-depth: 2
[2019-07-11 16:44:02] [config] transformer-guided-alignment-layer: last
[2019-07-11 16:44:02] [config] transformer-heads: 8
[2019-07-11 16:44:02] [config] transformer-no-projection: false
[2019-07-11 16:44:02] [config] transformer-postprocess: dan
[2019-07-11 16:44:02] [config] transformer-postprocess-emb: d
[2019-07-11 16:44:02] [config] transformer-preprocess: ""
[2019-07-11 16:44:02] [config] transformer-tied-layers:
[2019-07-11 16:44:02] [config]   []
[2019-07-11 16:44:02] [config] transformer-train-position-embeddings: false
[2019-07-11 16:44:02] [config] type: amun
[2019-07-11 16:44:02] [config] ulr: false
[2019-07-11 16:44:02] [config] ulr-dim-emb: 0
[2019-07-11 16:44:02] [config] ulr-dropout: 0
[2019-07-11 16:44:02] [config] ulr-keys-vectors: ""
[2019-07-11 16:44:02] [config] ulr-query-vectors: ""
[2019-07-11 16:44:02] [config] ulr-softmax-temperature: 1
[2019-07-11 16:44:02] [config] ulr-trainable-transformation: false
[2019-07-11 16:44:02] [config] valid-freq: 20000
[2019-07-11 16:44:02] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-11 16:44:02] [config] valid-max-length: 1000
[2019-07-11 16:44:02] [config] valid-metrics:
[2019-07-11 16:44:02] [config]   - cross-entropy
[2019-07-11 16:44:02] [config]   - perplexity
[2019-07-11 16:44:02] [config]   - translation
[2019-07-11 16:44:02] [config] valid-mini-batch: 8
[2019-07-11 16:44:02] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-11 16:44:02] [config] valid-sets:
[2019-07-11 16:44:02] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-11 16:44:02] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-11 16:44:02] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-11 16:44:02] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 16:44:02] [config] vocabs:
[2019-07-11 16:44:02] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-11 16:44:02] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-11 16:44:02] [config] word-penalty: 0
[2019-07-11 16:44:02] [config] workspace: 6000
[2019-07-11 16:44:02] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 16:44:02] Using synchronous training
[2019-07-11 16:44:02] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-11 16:44:03] [data] Using unused word id eos for 0
[2019-07-11 16:44:03] [data] Using unused word id UNK for 1
[2019-07-11 16:44:03] [data] Setting vocabulary size for input 0 to 50000
[2019-07-11 16:44:03] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-11 16:44:03] [data] Using unused word id eos for 0
[2019-07-11 16:44:03] [data] Using unused word id UNK for 1
[2019-07-11 16:44:03] [data] Setting vocabulary size for input 1 to 50000
[2019-07-11 16:44:03] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-11 16:44:03] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-11 16:44:05] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-11 16:44:06] [memory] Extending reserved space to 6016 MB (device gpu3)
[2019-07-11 16:44:06] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-11 16:44:07] [comm] NCCLCommunicator constructed successfully.
[2019-07-11 16:44:07] [training] Using 2 GPUs
[2019-07-11 16:44:07] [memory] Reserving 422 MB, device gpu2
[2019-07-11 16:44:07] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-11 16:44:07] [memory] Reserving 422 MB, device gpu2
[2019-07-11 16:44:17] [batching] Done. Typical MB size is 16192 target words
[2019-07-11 16:44:18] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-11 16:44:18] [memory] Extending reserved space to 6016 MB (device gpu3)
[2019-07-11 16:44:18] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-11 16:44:18] [comm] NCCLCommunicator constructed successfully.
[2019-07-11 16:44:18] [training] Using 2 GPUs
[2019-07-11 16:44:18] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 16:44:24] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 16:44:26] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 16:44:36] [memory] Reserving 422 MB, device gpu2
[2019-07-11 16:44:37] [memory] Reserving 422 MB, device gpu3
[2019-07-11 16:44:38] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 16:44:38] [data] Restoring the corpus state to epoch 22, batch 260000
[2019-07-11 16:44:38] [data] Shuffling data
[2019-07-11 16:44:41] [data] Done reading 5196149 sentences
[2019-07-11 16:45:03] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 16:45:24] Training started
[2019-07-11 16:45:24] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-11 16:45:24] [memory] Reserving 422 MB, device gpu2
[2019-07-11 16:45:24] [memory] Reserving 422 MB, device gpu3
[2019-07-11 16:45:24] [memory] Reserving 422 MB, device gpu2
[2019-07-11 16:45:24] [memory] Reserving 422 MB, device gpu3
[2019-07-11 16:45:24] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 16:45:30] [memory] Reserving 422 MB, device cpu0
[2019-07-11 16:45:31] [memory] Reserving 211 MB, device gpu2
[2019-07-11 16:45:31] [memory] Reserving 211 MB, device gpu3
[2019-07-11 17:03:01] Ep. 22 : Up. 262000 : Sen. 1,276,297 : Cost 38.73228455 : Time 1137.98s : 13398.08 words/s
[2019-07-11 17:20:38] Ep. 22 : Up. 264000 : Sen. 1,990,400 : Cost 39.03032684 : Time 1057.10s : 14410.77 words/s
[2019-07-11 17:38:07] Ep. 22 : Up. 266000 : Sen. 2,699,528 : Cost 38.90795517 : Time 1049.23s : 14405.69 words/s
[2019-07-11 17:55:48] Ep. 22 : Up. 268000 : Sen. 3,414,326 : Cost 39.25662231 : Time 1060.92s : 14407.31 words/s
[2019-07-11 18:13:25] Ep. 22 : Up. 270000 : Sen. 4,129,448 : Cost 39.07781219 : Time 1056.41s : 14429.51 words/s
[2019-07-11 18:19:41] Seen 4381942 samples
[2019-07-11 18:19:41] Starting epoch 23
[2019-07-11 18:19:41] [data] Shuffling data
[2019-07-11 18:19:44] [data] Done reading 5196149 sentences
[2019-07-11 18:20:16] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 18:31:36] Ep. 23 : Up. 272000 : Sen. 458,108 : Cost 38.97049332 : Time 1091.66s : 13908.86 words/s
[2019-07-11 18:49:12] Ep. 23 : Up. 274000 : Sen. 1,171,924 : Cost 38.57442856 : Time 1055.90s : 14397.53 words/s
[2019-07-11 19:06:48] Ep. 23 : Up. 276000 : Sen. 1,884,204 : Cost 38.89564896 : Time 1055.36s : 14425.75 words/s
[2019-07-11 19:24:23] Ep. 23 : Up. 278000 : Sen. 2,596,401 : Cost 38.90711594 : Time 1055.64s : 14395.45 words/s
[2019-07-11 19:41:58] Ep. 23 : Up. 280000 : Sen. 3,309,665 : Cost 38.90420151 : Time 1054.59s : 14400.51 words/s
[2019-07-11 19:41:58] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 19:42:08] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter280000.npz
[2019-07-11 19:42:15] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 19:42:24] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 19:42:46] [valid] Ep. 23 : Up. 280000 : cross-entropy : 48.1466 : new best
[2019-07-11 19:42:50] [valid] Ep. 23 : Up. 280000 : perplexity : 6.69251 : new best
[2019-07-11 19:43:14] Error: Unknown word id: 49992
[2019-07-11 19:43:14] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f0b9304fa99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f0b92b6fc80]                                                       + 0xb8c80
[0x7f0b930486ba]                                                       + 0x76ba
[0x7f0b922d541d]    clone                                              + 0x6d

[2019-07-11 20:55:46] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 20:55:46] [marian] Running on hodor as process 123535 with command line:
[2019-07-11 20:55:46] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 2 3 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-11 20:55:46] [config] after-batches: 0
[2019-07-11 20:55:46] [config] after-epochs: 0
[2019-07-11 20:55:46] [config] allow-unk: false
[2019-07-11 20:55:46] [config] beam-size: 12
[2019-07-11 20:55:46] [config] bert-class-symbol: "[CLS]"
[2019-07-11 20:55:46] [config] bert-mask-symbol: "[MASK]"
[2019-07-11 20:55:46] [config] bert-masking-fraction: 0.15
[2019-07-11 20:55:46] [config] bert-sep-symbol: "[SEP]"
[2019-07-11 20:55:46] [config] bert-train-type-embeddings: true
[2019-07-11 20:55:46] [config] bert-type-vocab-size: 2
[2019-07-11 20:55:46] [config] best-deep: false
[2019-07-11 20:55:46] [config] clip-gemm: 0
[2019-07-11 20:55:46] [config] clip-norm: 1
[2019-07-11 20:55:46] [config] cost-type: ce-mean
[2019-07-11 20:55:46] [config] cpu-threads: 0
[2019-07-11 20:55:46] [config] data-weighting: ""
[2019-07-11 20:55:46] [config] data-weighting-type: sentence
[2019-07-11 20:55:46] [config] dec-cell: gru
[2019-07-11 20:55:46] [config] dec-cell-base-depth: 2
[2019-07-11 20:55:46] [config] dec-cell-high-depth: 1
[2019-07-11 20:55:46] [config] dec-depth: 1
[2019-07-11 20:55:46] [config] devices:
[2019-07-11 20:55:46] [config]   - 2
[2019-07-11 20:55:46] [config]   - 3
[2019-07-11 20:55:46] [config] dim-emb: 512
[2019-07-11 20:55:46] [config] dim-rnn: 1024
[2019-07-11 20:55:46] [config] dim-vocabs:
[2019-07-11 20:55:46] [config]   - 50000
[2019-07-11 20:55:46] [config]   - 50000
[2019-07-11 20:55:46] [config] disp-first: 0
[2019-07-11 20:55:46] [config] disp-freq: 2000
[2019-07-11 20:55:46] [config] disp-label-counts: false
[2019-07-11 20:55:46] [config] dropout-rnn: 0.2
[2019-07-11 20:55:46] [config] dropout-src: 0.1
[2019-07-11 20:55:46] [config] dropout-trg: 0.1
[2019-07-11 20:55:46] [config] dump-config: ""
[2019-07-11 20:55:46] [config] early-stopping: 5
[2019-07-11 20:55:46] [config] embedding-fix-src: false
[2019-07-11 20:55:46] [config] embedding-fix-trg: false
[2019-07-11 20:55:46] [config] embedding-normalization: false
[2019-07-11 20:55:46] [config] embedding-vectors:
[2019-07-11 20:55:46] [config]   []
[2019-07-11 20:55:46] [config] enc-cell: gru
[2019-07-11 20:55:46] [config] enc-cell-depth: 1
[2019-07-11 20:55:46] [config] enc-depth: 1
[2019-07-11 20:55:46] [config] enc-type: bidirectional
[2019-07-11 20:55:46] [config] exponential-smoothing: 0.0001
[2019-07-11 20:55:46] [config] grad-dropping-momentum: 0
[2019-07-11 20:55:46] [config] grad-dropping-rate: 0
[2019-07-11 20:55:46] [config] grad-dropping-warmup: 100
[2019-07-11 20:55:46] [config] guided-alignment: none
[2019-07-11 20:55:46] [config] guided-alignment-cost: mse
[2019-07-11 20:55:46] [config] guided-alignment-weight: 0.1
[2019-07-11 20:55:46] [config] ignore-model-config: false
[2019-07-11 20:55:46] [config] input-types:
[2019-07-11 20:55:46] [config]   []
[2019-07-11 20:55:46] [config] interpolate-env-vars: false
[2019-07-11 20:55:46] [config] keep-best: false
[2019-07-11 20:55:46] [config] label-smoothing: 0
[2019-07-11 20:55:46] [config] layer-normalization: true
[2019-07-11 20:55:46] [config] learn-rate: 0.0001
[2019-07-11 20:55:46] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-11 20:55:46] [config] log-level: info
[2019-07-11 20:55:46] [config] log-time-zone: ""
[2019-07-11 20:55:46] [config] lr-decay: 0
[2019-07-11 20:55:46] [config] lr-decay-freq: 50000
[2019-07-11 20:55:46] [config] lr-decay-inv-sqrt:
[2019-07-11 20:55:46] [config]   - 0
[2019-07-11 20:55:46] [config] lr-decay-repeat-warmup: false
[2019-07-11 20:55:46] [config] lr-decay-reset-optimizer: false
[2019-07-11 20:55:46] [config] lr-decay-start:
[2019-07-11 20:55:46] [config]   - 10
[2019-07-11 20:55:46] [config]   - 1
[2019-07-11 20:55:46] [config] lr-decay-strategy: epoch+stalled
[2019-07-11 20:55:46] [config] lr-report: false
[2019-07-11 20:55:46] [config] lr-warmup: 0
[2019-07-11 20:55:46] [config] lr-warmup-at-reload: false
[2019-07-11 20:55:46] [config] lr-warmup-cycle: false
[2019-07-11 20:55:46] [config] lr-warmup-start-rate: 0
[2019-07-11 20:55:46] [config] max-length: 50
[2019-07-11 20:55:46] [config] max-length-crop: false
[2019-07-11 20:55:46] [config] max-length-factor: 3
[2019-07-11 20:55:46] [config] maxi-batch: 100
[2019-07-11 20:55:46] [config] maxi-batch-sort: trg
[2019-07-11 20:55:46] [config] mini-batch: 64
[2019-07-11 20:55:46] [config] mini-batch-fit: true
[2019-07-11 20:55:46] [config] mini-batch-fit-step: 10
[2019-07-11 20:55:46] [config] mini-batch-overstuff: 1
[2019-07-11 20:55:46] [config] mini-batch-track-lr: false
[2019-07-11 20:55:46] [config] mini-batch-understuff: 1
[2019-07-11 20:55:46] [config] mini-batch-warmup: 0
[2019-07-11 20:55:46] [config] mini-batch-words: 0
[2019-07-11 20:55:46] [config] mini-batch-words-ref: 0
[2019-07-11 20:55:46] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 20:55:46] [config] multi-loss-type: sum
[2019-07-11 20:55:46] [config] multi-node: false
[2019-07-11 20:55:46] [config] multi-node-overlap: true
[2019-07-11 20:55:46] [config] n-best: false
[2019-07-11 20:55:46] [config] no-nccl: false
[2019-07-11 20:55:46] [config] no-reload: false
[2019-07-11 20:55:46] [config] no-restore-corpus: false
[2019-07-11 20:55:46] [config] no-shuffle: false
[2019-07-11 20:55:46] [config] normalize: 1
[2019-07-11 20:55:46] [config] num-devices: 0
[2019-07-11 20:55:46] [config] optimizer: adam
[2019-07-11 20:55:46] [config] optimizer-delay: 1
[2019-07-11 20:55:46] [config] optimizer-params:
[2019-07-11 20:55:46] [config]   []
[2019-07-11 20:55:46] [config] overwrite: false
[2019-07-11 20:55:46] [config] pretrained-model: ""
[2019-07-11 20:55:46] [config] quiet: false
[2019-07-11 20:55:46] [config] quiet-translation: true
[2019-07-11 20:55:46] [config] relative-paths: false
[2019-07-11 20:55:46] [config] right-left: false
[2019-07-11 20:55:46] [config] save-freq: 20000
[2019-07-11 20:55:46] [config] seed: 1111
[2019-07-11 20:55:46] [config] shuffle-in-ram: false
[2019-07-11 20:55:46] [config] skip: false
[2019-07-11 20:55:46] [config] sqlite: ""
[2019-07-11 20:55:46] [config] sqlite-drop: false
[2019-07-11 20:55:46] [config] sync-sgd: true
[2019-07-11 20:55:46] [config] tempdir: .
[2019-07-11 20:55:46] [config] tied-embeddings: false
[2019-07-11 20:55:46] [config] tied-embeddings-all: false
[2019-07-11 20:55:46] [config] tied-embeddings-src: false
[2019-07-11 20:55:46] [config] train-sets:
[2019-07-11 20:55:46] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-11 20:55:46] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-11 20:55:46] [config] transformer-aan-activation: swish
[2019-07-11 20:55:46] [config] transformer-aan-depth: 2
[2019-07-11 20:55:46] [config] transformer-aan-nogate: false
[2019-07-11 20:55:46] [config] transformer-decoder-autoreg: self-attention
[2019-07-11 20:55:46] [config] transformer-dim-aan: 2048
[2019-07-11 20:55:46] [config] transformer-dim-ffn: 2048
[2019-07-11 20:55:46] [config] transformer-dropout: 0
[2019-07-11 20:55:46] [config] transformer-dropout-attention: 0
[2019-07-11 20:55:46] [config] transformer-dropout-ffn: 0
[2019-07-11 20:55:46] [config] transformer-ffn-activation: swish
[2019-07-11 20:55:46] [config] transformer-ffn-depth: 2
[2019-07-11 20:55:46] [config] transformer-guided-alignment-layer: last
[2019-07-11 20:55:46] [config] transformer-heads: 8
[2019-07-11 20:55:46] [config] transformer-no-projection: false
[2019-07-11 20:55:46] [config] transformer-postprocess: dan
[2019-07-11 20:55:46] [config] transformer-postprocess-emb: d
[2019-07-11 20:55:46] [config] transformer-preprocess: ""
[2019-07-11 20:55:46] [config] transformer-tied-layers:
[2019-07-11 20:55:46] [config]   []
[2019-07-11 20:55:46] [config] transformer-train-position-embeddings: false
[2019-07-11 20:55:46] [config] type: amun
[2019-07-11 20:55:46] [config] ulr: false
[2019-07-11 20:55:46] [config] ulr-dim-emb: 0
[2019-07-11 20:55:46] [config] ulr-dropout: 0
[2019-07-11 20:55:46] [config] ulr-keys-vectors: ""
[2019-07-11 20:55:46] [config] ulr-query-vectors: ""
[2019-07-11 20:55:46] [config] ulr-softmax-temperature: 1
[2019-07-11 20:55:46] [config] ulr-trainable-transformation: false
[2019-07-11 20:55:46] [config] valid-freq: 20000
[2019-07-11 20:55:46] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-11 20:55:46] [config] valid-max-length: 1000
[2019-07-11 20:55:46] [config] valid-metrics:
[2019-07-11 20:55:46] [config]   - cross-entropy
[2019-07-11 20:55:46] [config]   - perplexity
[2019-07-11 20:55:46] [config]   - translation
[2019-07-11 20:55:46] [config] valid-mini-batch: 8
[2019-07-11 20:55:46] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-11 20:55:46] [config] valid-sets:
[2019-07-11 20:55:46] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-11 20:55:46] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-11 20:55:46] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-11 20:55:46] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 20:55:46] [config] vocabs:
[2019-07-11 20:55:46] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-11 20:55:46] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-11 20:55:46] [config] word-penalty: 0
[2019-07-11 20:55:46] [config] workspace: 6000
[2019-07-11 20:55:46] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-11 20:55:46] Using synchronous training
[2019-07-11 20:55:46] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-11 20:55:47] [data] Using unused word id eos for 0
[2019-07-11 20:55:47] [data] Using unused word id UNK for 1
[2019-07-11 20:55:47] [data] Setting vocabulary size for input 0 to 50000
[2019-07-11 20:55:47] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-11 20:55:47] [data] Using unused word id eos for 0
[2019-07-11 20:55:47] [data] Using unused word id UNK for 1
[2019-07-11 20:55:47] [data] Setting vocabulary size for input 1 to 50000
[2019-07-11 20:55:47] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-11 20:55:47] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-11 20:55:48] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-11 20:55:48] [memory] Extending reserved space to 6016 MB (device gpu3)
[2019-07-11 20:55:48] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-11 20:55:48] [comm] NCCLCommunicator constructed successfully.
[2019-07-11 20:55:48] [training] Using 2 GPUs
[2019-07-11 20:55:48] [memory] Reserving 422 MB, device gpu2
[2019-07-11 20:55:49] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-11 20:55:49] [memory] Reserving 422 MB, device gpu2
[2019-07-11 20:55:59] [batching] Done. Typical MB size is 16192 target words
[2019-07-11 20:56:00] [memory] Extending reserved space to 6016 MB (device gpu2)
[2019-07-11 20:56:00] [memory] Extending reserved space to 6016 MB (device gpu3)
[2019-07-11 20:56:00] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-11 20:56:00] [comm] NCCLCommunicator constructed successfully.
[2019-07-11 20:56:00] [training] Using 2 GPUs
[2019-07-11 20:56:00] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 20:56:06] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 20:56:08] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 20:56:18] [memory] Reserving 422 MB, device gpu2
[2019-07-11 20:56:18] [memory] Reserving 422 MB, device gpu3
[2019-07-11 20:56:18] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 20:56:18] [data] Restoring the corpus state to epoch 23, batch 280000
[2019-07-11 20:56:18] [data] Shuffling data
[2019-07-11 20:56:21] [data] Done reading 5196149 sentences
[2019-07-11 20:56:42] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 20:58:25] Training started
[2019-07-11 20:58:25] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-11 20:58:25] [memory] Reserving 422 MB, device gpu2
[2019-07-11 20:58:25] [memory] Reserving 422 MB, device gpu3
[2019-07-11 20:58:26] [memory] Reserving 422 MB, device gpu2
[2019-07-11 20:58:26] [memory] Reserving 422 MB, device gpu3
[2019-07-11 20:58:26] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 20:58:31] [memory] Reserving 422 MB, device cpu0
[2019-07-11 20:58:32] [memory] Reserving 211 MB, device gpu2
[2019-07-11 20:58:32] [memory] Reserving 211 MB, device gpu3
[2019-07-11 21:16:01] Ep. 23 : Up. 282000 : Sen. 4,020,648 : Cost 39.14264297 : Time 1214.02s : 12508.55 words/s
[2019-07-11 21:24:57] Seen 4381942 samples
[2019-07-11 21:24:57] Starting epoch 24
[2019-07-11 21:24:57] [data] Shuffling data
[2019-07-11 21:24:59] [data] Done reading 5196149 sentences
[2019-07-11 21:25:23] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 21:34:06] Ep. 24 : Up. 284000 : Sen. 351,144 : Cost 38.75620651 : Time 1084.96s : 14015.06 words/s
[2019-07-11 21:51:39] Ep. 24 : Up. 286000 : Sen. 1,061,764 : Cost 38.45955276 : Time 1052.74s : 14420.84 words/s
[2019-07-11 22:09:12] Ep. 24 : Up. 288000 : Sen. 1,773,524 : Cost 38.67092514 : Time 1053.87s : 14400.44 words/s
[2019-07-11 22:26:49] Ep. 24 : Up. 290000 : Sen. 2,488,558 : Cost 38.86975861 : Time 1057.00s : 14440.89 words/s
[2019-07-11 22:44:26] Ep. 24 : Up. 292000 : Sen. 3,200,318 : Cost 38.76237488 : Time 1056.23s : 14386.60 words/s
[2019-07-11 23:02:00] Ep. 24 : Up. 294000 : Sen. 3,913,668 : Cost 39.07907486 : Time 1054.20s : 14428.33 words/s
[2019-07-11 23:13:33] Seen 4381942 samples
[2019-07-11 23:13:33] Starting epoch 25
[2019-07-11 23:13:33] [data] Shuffling data
[2019-07-11 23:13:36] [data] Done reading 5196149 sentences
[2019-07-11 23:13:59] [data] Done shuffling 5196149 sentences to temp files
[2019-07-11 23:20:09] Ep. 25 : Up. 296000 : Sen. 245,954 : Cost 38.59934235 : Time 1088.71s : 13970.17 words/s
[2019-07-11 23:37:44] Ep. 25 : Up. 298000 : Sen. 955,424 : Cost 38.37379456 : Time 1055.86s : 14344.20 words/s
[2019-07-11 23:55:23] Ep. 25 : Up. 300000 : Sen. 1,668,406 : Cost 38.46683121 : Time 1058.42s : 14355.52 words/s
[2019-07-11 23:55:23] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-11 23:55:33] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter300000.npz
[2019-07-11 23:55:40] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-11 23:55:49] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-11 23:56:11] [valid] Ep. 25 : Up. 300000 : cross-entropy : 48.0854 : new best
[2019-07-11 23:56:15] [valid] Ep. 25 : Up. 300000 : perplexity : 6.67638 : new best
[2019-07-11 23:56:39] Error: Unknown word id: 49992
[2019-07-11 23:56:39] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f28fb8f9a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f28fb419c80]                                                       + 0xb8c80
[0x7f28fb8f26ba]                                                       + 0x76ba
[0x7f28fab7f41d]    clone                                              + 0x6d

[2019-07-12 13:03:21] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-12 13:03:21] [marian] Running on hodor as process 56186 with command line:
[2019-07-12 13:03:21] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-12 13:03:21] [config] after-batches: 0
[2019-07-12 13:03:21] [config] after-epochs: 0
[2019-07-12 13:03:21] [config] allow-unk: false
[2019-07-12 13:03:21] [config] beam-size: 12
[2019-07-12 13:03:21] [config] bert-class-symbol: "[CLS]"
[2019-07-12 13:03:21] [config] bert-mask-symbol: "[MASK]"
[2019-07-12 13:03:21] [config] bert-masking-fraction: 0.15
[2019-07-12 13:03:21] [config] bert-sep-symbol: "[SEP]"
[2019-07-12 13:03:21] [config] bert-train-type-embeddings: true
[2019-07-12 13:03:21] [config] bert-type-vocab-size: 2
[2019-07-12 13:03:21] [config] best-deep: false
[2019-07-12 13:03:21] [config] clip-gemm: 0
[2019-07-12 13:03:21] [config] clip-norm: 1
[2019-07-12 13:03:21] [config] cost-type: ce-mean
[2019-07-12 13:03:21] [config] cpu-threads: 0
[2019-07-12 13:03:21] [config] data-weighting: ""
[2019-07-12 13:03:21] [config] data-weighting-type: sentence
[2019-07-12 13:03:21] [config] dec-cell: gru
[2019-07-12 13:03:21] [config] dec-cell-base-depth: 2
[2019-07-12 13:03:21] [config] dec-cell-high-depth: 1
[2019-07-12 13:03:21] [config] dec-depth: 1
[2019-07-12 13:03:21] [config] devices:
[2019-07-12 13:03:21] [config]   - 0
[2019-07-12 13:03:21] [config]   - 1
[2019-07-12 13:03:21] [config] dim-emb: 512
[2019-07-12 13:03:21] [config] dim-rnn: 1024
[2019-07-12 13:03:21] [config] dim-vocabs:
[2019-07-12 13:03:21] [config]   - 50000
[2019-07-12 13:03:21] [config]   - 50000
[2019-07-12 13:03:21] [config] disp-first: 0
[2019-07-12 13:03:21] [config] disp-freq: 2000
[2019-07-12 13:03:21] [config] disp-label-counts: false
[2019-07-12 13:03:21] [config] dropout-rnn: 0.2
[2019-07-12 13:03:21] [config] dropout-src: 0.1
[2019-07-12 13:03:21] [config] dropout-trg: 0.1
[2019-07-12 13:03:21] [config] dump-config: ""
[2019-07-12 13:03:21] [config] early-stopping: 5
[2019-07-12 13:03:21] [config] embedding-fix-src: false
[2019-07-12 13:03:21] [config] embedding-fix-trg: false
[2019-07-12 13:03:21] [config] embedding-normalization: false
[2019-07-12 13:03:21] [config] embedding-vectors:
[2019-07-12 13:03:21] [config]   []
[2019-07-12 13:03:21] [config] enc-cell: gru
[2019-07-12 13:03:21] [config] enc-cell-depth: 1
[2019-07-12 13:03:21] [config] enc-depth: 1
[2019-07-12 13:03:21] [config] enc-type: bidirectional
[2019-07-12 13:03:21] [config] exponential-smoothing: 0.0001
[2019-07-12 13:03:21] [config] grad-dropping-momentum: 0
[2019-07-12 13:03:21] [config] grad-dropping-rate: 0
[2019-07-12 13:03:21] [config] grad-dropping-warmup: 100
[2019-07-12 13:03:21] [config] guided-alignment: none
[2019-07-12 13:03:21] [config] guided-alignment-cost: mse
[2019-07-12 13:03:21] [config] guided-alignment-weight: 0.1
[2019-07-12 13:03:21] [config] ignore-model-config: false
[2019-07-12 13:03:21] [config] input-types:
[2019-07-12 13:03:21] [config]   []
[2019-07-12 13:03:21] [config] interpolate-env-vars: false
[2019-07-12 13:03:21] [config] keep-best: false
[2019-07-12 13:03:21] [config] label-smoothing: 0
[2019-07-12 13:03:21] [config] layer-normalization: true
[2019-07-12 13:03:21] [config] learn-rate: 0.0001
[2019-07-12 13:03:21] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-12 13:03:21] [config] log-level: info
[2019-07-12 13:03:21] [config] log-time-zone: ""
[2019-07-12 13:03:21] [config] lr-decay: 0
[2019-07-12 13:03:21] [config] lr-decay-freq: 50000
[2019-07-12 13:03:21] [config] lr-decay-inv-sqrt:
[2019-07-12 13:03:21] [config]   - 0
[2019-07-12 13:03:21] [config] lr-decay-repeat-warmup: false
[2019-07-12 13:03:21] [config] lr-decay-reset-optimizer: false
[2019-07-12 13:03:21] [config] lr-decay-start:
[2019-07-12 13:03:21] [config]   - 10
[2019-07-12 13:03:21] [config]   - 1
[2019-07-12 13:03:21] [config] lr-decay-strategy: epoch+stalled
[2019-07-12 13:03:21] [config] lr-report: false
[2019-07-12 13:03:21] [config] lr-warmup: 0
[2019-07-12 13:03:21] [config] lr-warmup-at-reload: false
[2019-07-12 13:03:21] [config] lr-warmup-cycle: false
[2019-07-12 13:03:21] [config] lr-warmup-start-rate: 0
[2019-07-12 13:03:21] [config] max-length: 50
[2019-07-12 13:03:21] [config] max-length-crop: false
[2019-07-12 13:03:21] [config] max-length-factor: 3
[2019-07-12 13:03:21] [config] maxi-batch: 100
[2019-07-12 13:03:21] [config] maxi-batch-sort: trg
[2019-07-12 13:03:21] [config] mini-batch: 64
[2019-07-12 13:03:21] [config] mini-batch-fit: true
[2019-07-12 13:03:21] [config] mini-batch-fit-step: 10
[2019-07-12 13:03:21] [config] mini-batch-overstuff: 1
[2019-07-12 13:03:21] [config] mini-batch-track-lr: false
[2019-07-12 13:03:21] [config] mini-batch-understuff: 1
[2019-07-12 13:03:21] [config] mini-batch-warmup: 0
[2019-07-12 13:03:21] [config] mini-batch-words: 0
[2019-07-12 13:03:21] [config] mini-batch-words-ref: 0
[2019-07-12 13:03:21] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 13:03:21] [config] multi-loss-type: sum
[2019-07-12 13:03:21] [config] multi-node: false
[2019-07-12 13:03:21] [config] multi-node-overlap: true
[2019-07-12 13:03:21] [config] n-best: false
[2019-07-12 13:03:21] [config] no-nccl: false
[2019-07-12 13:03:21] [config] no-reload: false
[2019-07-12 13:03:21] [config] no-restore-corpus: false
[2019-07-12 13:03:21] [config] no-shuffle: false
[2019-07-12 13:03:21] [config] normalize: 1
[2019-07-12 13:03:21] [config] num-devices: 0
[2019-07-12 13:03:21] [config] optimizer: adam
[2019-07-12 13:03:21] [config] optimizer-delay: 1
[2019-07-12 13:03:21] [config] optimizer-params:
[2019-07-12 13:03:21] [config]   []
[2019-07-12 13:03:21] [config] overwrite: false
[2019-07-12 13:03:21] [config] pretrained-model: ""
[2019-07-12 13:03:21] [config] quiet: false
[2019-07-12 13:03:21] [config] quiet-translation: true
[2019-07-12 13:03:21] [config] relative-paths: false
[2019-07-12 13:03:21] [config] right-left: false
[2019-07-12 13:03:21] [config] save-freq: 20000
[2019-07-12 13:03:21] [config] seed: 1111
[2019-07-12 13:03:21] [config] shuffle-in-ram: false
[2019-07-12 13:03:21] [config] skip: false
[2019-07-12 13:03:21] [config] sqlite: ""
[2019-07-12 13:03:21] [config] sqlite-drop: false
[2019-07-12 13:03:21] [config] sync-sgd: true
[2019-07-12 13:03:21] [config] tempdir: .
[2019-07-12 13:03:21] [config] tied-embeddings: false
[2019-07-12 13:03:21] [config] tied-embeddings-all: false
[2019-07-12 13:03:21] [config] tied-embeddings-src: false
[2019-07-12 13:03:21] [config] train-sets:
[2019-07-12 13:03:21] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-12 13:03:21] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-12 13:03:21] [config] transformer-aan-activation: swish
[2019-07-12 13:03:21] [config] transformer-aan-depth: 2
[2019-07-12 13:03:21] [config] transformer-aan-nogate: false
[2019-07-12 13:03:21] [config] transformer-decoder-autoreg: self-attention
[2019-07-12 13:03:21] [config] transformer-dim-aan: 2048
[2019-07-12 13:03:21] [config] transformer-dim-ffn: 2048
[2019-07-12 13:03:21] [config] transformer-dropout: 0
[2019-07-12 13:03:21] [config] transformer-dropout-attention: 0
[2019-07-12 13:03:21] [config] transformer-dropout-ffn: 0
[2019-07-12 13:03:21] [config] transformer-ffn-activation: swish
[2019-07-12 13:03:21] [config] transformer-ffn-depth: 2
[2019-07-12 13:03:21] [config] transformer-guided-alignment-layer: last
[2019-07-12 13:03:21] [config] transformer-heads: 8
[2019-07-12 13:03:21] [config] transformer-no-projection: false
[2019-07-12 13:03:21] [config] transformer-postprocess: dan
[2019-07-12 13:03:21] [config] transformer-postprocess-emb: d
[2019-07-12 13:03:21] [config] transformer-preprocess: ""
[2019-07-12 13:03:21] [config] transformer-tied-layers:
[2019-07-12 13:03:21] [config]   []
[2019-07-12 13:03:21] [config] transformer-train-position-embeddings: false
[2019-07-12 13:03:21] [config] type: amun
[2019-07-12 13:03:21] [config] ulr: false
[2019-07-12 13:03:21] [config] ulr-dim-emb: 0
[2019-07-12 13:03:21] [config] ulr-dropout: 0
[2019-07-12 13:03:21] [config] ulr-keys-vectors: ""
[2019-07-12 13:03:21] [config] ulr-query-vectors: ""
[2019-07-12 13:03:21] [config] ulr-softmax-temperature: 1
[2019-07-12 13:03:21] [config] ulr-trainable-transformation: false
[2019-07-12 13:03:21] [config] valid-freq: 20000
[2019-07-12 13:03:21] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-12 13:03:21] [config] valid-max-length: 1000
[2019-07-12 13:03:21] [config] valid-metrics:
[2019-07-12 13:03:21] [config]   - cross-entropy
[2019-07-12 13:03:21] [config]   - perplexity
[2019-07-12 13:03:21] [config]   - translation
[2019-07-12 13:03:21] [config] valid-mini-batch: 8
[2019-07-12 13:03:21] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-12 13:03:21] [config] valid-sets:
[2019-07-12 13:03:21] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-12 13:03:21] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-12 13:03:21] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-12 13:03:21] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-12 13:03:21] [config] vocabs:
[2019-07-12 13:03:21] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-12 13:03:21] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-12 13:03:21] [config] word-penalty: 0
[2019-07-12 13:03:21] [config] workspace: 6000
[2019-07-12 13:03:21] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-12 13:03:21] Using synchronous training
[2019-07-12 13:03:21] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-12 13:03:21] [data] Using unused word id eos for 0
[2019-07-12 13:03:21] [data] Using unused word id UNK for 1
[2019-07-12 13:03:21] [data] Setting vocabulary size for input 0 to 50000
[2019-07-12 13:03:21] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-12 13:03:22] [data] Using unused word id eos for 0
[2019-07-12 13:03:22] [data] Using unused word id UNK for 1
[2019-07-12 13:03:22] [data] Setting vocabulary size for input 1 to 50000
[2019-07-12 13:03:22] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-12 13:03:22] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-12 13:03:22] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-12 13:03:23] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-12 13:03:23] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-12 13:03:23] [comm] NCCLCommunicator constructed successfully.
[2019-07-12 13:03:23] [training] Using 2 GPUs
[2019-07-12 13:03:23] [memory] Reserving 422 MB, device gpu0
[2019-07-12 13:03:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-12 13:03:23] [memory] Reserving 422 MB, device gpu0
[2019-07-12 13:03:34] [batching] Done. Typical MB size is 16192 target words
[2019-07-12 13:03:34] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-12 13:03:34] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-12 13:03:34] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-12 13:03:34] [comm] NCCLCommunicator constructed successfully.
[2019-07-12 13:03:34] [training] Using 2 GPUs
[2019-07-12 13:03:34] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-12 13:03:41] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-12 13:03:43] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-12 13:03:53] [memory] Reserving 422 MB, device gpu0
[2019-07-12 13:03:53] [memory] Reserving 422 MB, device gpu1
[2019-07-12 13:03:54] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 13:03:54] [data] Restoring the corpus state to epoch 25, batch 300000
[2019-07-12 13:03:54] [data] Shuffling data
[2019-07-12 13:03:57] [data] Done reading 5196149 sentences
[2019-07-12 13:04:18] [data] Done shuffling 5196149 sentences to temp files
[2019-07-12 13:05:09] Training started
[2019-07-12 13:05:09] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-12 13:05:09] [memory] Reserving 422 MB, device gpu0
[2019-07-12 13:05:09] [memory] Reserving 422 MB, device gpu1
[2019-07-12 13:05:09] [memory] Reserving 422 MB, device gpu1
[2019-07-12 13:05:09] [memory] Reserving 422 MB, device gpu0
[2019-07-12 13:05:09] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 13:05:15] [memory] Reserving 422 MB, device cpu0
[2019-07-12 13:05:15] [memory] Reserving 211 MB, device gpu0
[2019-07-12 13:05:15] [memory] Reserving 211 MB, device gpu1
[2019-07-12 13:22:27] Ep. 25 : Up. 302000 : Sen. 2,379,846 : Cost 38.47401810 : Time 1145.36s : 13250.99 words/s
[2019-07-12 13:39:42] Ep. 25 : Up. 304000 : Sen. 3,088,694 : Cost 38.66808319 : Time 1034.59s : 14624.70 words/s
[2019-07-12 13:56:57] Ep. 25 : Up. 306000 : Sen. 3,798,477 : Cost 38.93835449 : Time 1035.42s : 14652.78 words/s
[2019-07-12 14:11:04] Seen 4381942 samples
[2019-07-12 14:11:04] Starting epoch 26
[2019-07-12 14:11:04] [data] Shuffling data
[2019-07-12 14:11:07] [data] Done reading 5196149 sentences
[2019-07-12 14:11:32] [data] Done shuffling 5196149 sentences to temp files
[2019-07-12 14:14:41] Ep. 26 : Up. 308000 : Sen. 128,696 : Cost 38.67310715 : Time 1063.51s : 14273.32 words/s
[2019-07-12 14:31:55] Ep. 26 : Up. 310000 : Sen. 840,166 : Cost 38.15154266 : Time 1034.69s : 14659.05 words/s
[2019-07-12 14:49:11] Ep. 26 : Up. 312000 : Sen. 1,551,848 : Cost 38.35545349 : Time 1035.96s : 14663.99 words/s
[2019-07-12 15:06:27] Ep. 26 : Up. 314000 : Sen. 2,264,338 : Cost 38.59759521 : Time 1035.61s : 14689.98 words/s
[2019-07-12 15:23:44] Ep. 26 : Up. 316000 : Sen. 2,977,360 : Cost 38.65662003 : Time 1037.01s : 14676.94 words/s
[2019-07-12 15:41:00] Ep. 26 : Up. 318000 : Sen. 3,691,346 : Cost 38.74376678 : Time 1036.44s : 14689.24 words/s
[2019-07-12 15:57:44] Seen 4381942 samples
[2019-07-12 15:57:44] Starting epoch 27
[2019-07-12 15:57:44] [data] Shuffling data
[2019-07-12 15:57:47] [data] Done reading 5196149 sentences
[2019-07-12 15:58:08] [data] Done shuffling 5196149 sentences to temp files
[2019-07-12 15:58:47] Ep. 27 : Up. 320000 : Sen. 23,355 : Cost 38.81713104 : Time 1066.87s : 14282.57 words/s
[2019-07-12 15:58:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-12 15:58:56] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter320000.npz
[2019-07-12 15:59:03] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 15:59:12] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-12 15:59:33] [valid] Ep. 27 : Up. 320000 : cross-entropy : 48.1073 : new best
[2019-07-12 15:59:36] [valid] Ep. 27 : Up. 320000 : perplexity : 6.68213 : new best
[2019-07-12 15:59:59] Error: Unknown word id: 49992
[2019-07-12 15:59:59] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7fb8e40f7a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7fb8e3c17c80]                                                       + 0xb8c80
[0x7fb8e40f06ba]                                                       + 0x76ba
[0x7fb8e337d41d]    clone                                              + 0x6d

[2019-07-12 17:32:28] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-12 17:32:28] [marian] Running on hodor as process 68126 with command line:
[2019-07-12 17:32:28] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 6000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-12 17:32:28] [config] after-batches: 0
[2019-07-12 17:32:28] [config] after-epochs: 0
[2019-07-12 17:32:28] [config] allow-unk: false
[2019-07-12 17:32:28] [config] beam-size: 12
[2019-07-12 17:32:28] [config] bert-class-symbol: "[CLS]"
[2019-07-12 17:32:28] [config] bert-mask-symbol: "[MASK]"
[2019-07-12 17:32:28] [config] bert-masking-fraction: 0.15
[2019-07-12 17:32:28] [config] bert-sep-symbol: "[SEP]"
[2019-07-12 17:32:28] [config] bert-train-type-embeddings: true
[2019-07-12 17:32:28] [config] bert-type-vocab-size: 2
[2019-07-12 17:32:28] [config] best-deep: false
[2019-07-12 17:32:28] [config] clip-gemm: 0
[2019-07-12 17:32:28] [config] clip-norm: 1
[2019-07-12 17:32:28] [config] cost-type: ce-mean
[2019-07-12 17:32:28] [config] cpu-threads: 0
[2019-07-12 17:32:28] [config] data-weighting: ""
[2019-07-12 17:32:28] [config] data-weighting-type: sentence
[2019-07-12 17:32:28] [config] dec-cell: gru
[2019-07-12 17:32:28] [config] dec-cell-base-depth: 2
[2019-07-12 17:32:28] [config] dec-cell-high-depth: 1
[2019-07-12 17:32:28] [config] dec-depth: 1
[2019-07-12 17:32:28] [config] devices:
[2019-07-12 17:32:28] [config]   - 0
[2019-07-12 17:32:28] [config]   - 1
[2019-07-12 17:32:28] [config] dim-emb: 512
[2019-07-12 17:32:28] [config] dim-rnn: 1024
[2019-07-12 17:32:28] [config] dim-vocabs:
[2019-07-12 17:32:28] [config]   - 50000
[2019-07-12 17:32:28] [config]   - 50000
[2019-07-12 17:32:28] [config] disp-first: 0
[2019-07-12 17:32:28] [config] disp-freq: 2000
[2019-07-12 17:32:28] [config] disp-label-counts: false
[2019-07-12 17:32:28] [config] dropout-rnn: 0.2
[2019-07-12 17:32:28] [config] dropout-src: 0.1
[2019-07-12 17:32:28] [config] dropout-trg: 0.1
[2019-07-12 17:32:28] [config] dump-config: ""
[2019-07-12 17:32:28] [config] early-stopping: 5
[2019-07-12 17:32:28] [config] embedding-fix-src: false
[2019-07-12 17:32:28] [config] embedding-fix-trg: false
[2019-07-12 17:32:28] [config] embedding-normalization: false
[2019-07-12 17:32:28] [config] embedding-vectors:
[2019-07-12 17:32:28] [config]   []
[2019-07-12 17:32:28] [config] enc-cell: gru
[2019-07-12 17:32:28] [config] enc-cell-depth: 1
[2019-07-12 17:32:28] [config] enc-depth: 1
[2019-07-12 17:32:28] [config] enc-type: bidirectional
[2019-07-12 17:32:28] [config] exponential-smoothing: 0.0001
[2019-07-12 17:32:28] [config] grad-dropping-momentum: 0
[2019-07-12 17:32:28] [config] grad-dropping-rate: 0
[2019-07-12 17:32:28] [config] grad-dropping-warmup: 100
[2019-07-12 17:32:28] [config] guided-alignment: none
[2019-07-12 17:32:28] [config] guided-alignment-cost: mse
[2019-07-12 17:32:28] [config] guided-alignment-weight: 0.1
[2019-07-12 17:32:28] [config] ignore-model-config: false
[2019-07-12 17:32:28] [config] input-types:
[2019-07-12 17:32:28] [config]   []
[2019-07-12 17:32:28] [config] interpolate-env-vars: false
[2019-07-12 17:32:28] [config] keep-best: false
[2019-07-12 17:32:28] [config] label-smoothing: 0
[2019-07-12 17:32:28] [config] layer-normalization: true
[2019-07-12 17:32:28] [config] learn-rate: 0.0001
[2019-07-12 17:32:28] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-12 17:32:28] [config] log-level: info
[2019-07-12 17:32:28] [config] log-time-zone: ""
[2019-07-12 17:32:28] [config] lr-decay: 0
[2019-07-12 17:32:28] [config] lr-decay-freq: 50000
[2019-07-12 17:32:28] [config] lr-decay-inv-sqrt:
[2019-07-12 17:32:28] [config]   - 0
[2019-07-12 17:32:28] [config] lr-decay-repeat-warmup: false
[2019-07-12 17:32:28] [config] lr-decay-reset-optimizer: false
[2019-07-12 17:32:28] [config] lr-decay-start:
[2019-07-12 17:32:28] [config]   - 10
[2019-07-12 17:32:28] [config]   - 1
[2019-07-12 17:32:28] [config] lr-decay-strategy: epoch+stalled
[2019-07-12 17:32:28] [config] lr-report: false
[2019-07-12 17:32:28] [config] lr-warmup: 0
[2019-07-12 17:32:28] [config] lr-warmup-at-reload: false
[2019-07-12 17:32:28] [config] lr-warmup-cycle: false
[2019-07-12 17:32:28] [config] lr-warmup-start-rate: 0
[2019-07-12 17:32:28] [config] max-length: 50
[2019-07-12 17:32:28] [config] max-length-crop: false
[2019-07-12 17:32:28] [config] max-length-factor: 3
[2019-07-12 17:32:28] [config] maxi-batch: 100
[2019-07-12 17:32:28] [config] maxi-batch-sort: trg
[2019-07-12 17:32:28] [config] mini-batch: 64
[2019-07-12 17:32:28] [config] mini-batch-fit: true
[2019-07-12 17:32:28] [config] mini-batch-fit-step: 10
[2019-07-12 17:32:28] [config] mini-batch-overstuff: 1
[2019-07-12 17:32:28] [config] mini-batch-track-lr: false
[2019-07-12 17:32:28] [config] mini-batch-understuff: 1
[2019-07-12 17:32:28] [config] mini-batch-warmup: 0
[2019-07-12 17:32:28] [config] mini-batch-words: 0
[2019-07-12 17:32:28] [config] mini-batch-words-ref: 0
[2019-07-12 17:32:28] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 17:32:28] [config] multi-loss-type: sum
[2019-07-12 17:32:28] [config] multi-node: false
[2019-07-12 17:32:28] [config] multi-node-overlap: true
[2019-07-12 17:32:28] [config] n-best: false
[2019-07-12 17:32:28] [config] no-nccl: false
[2019-07-12 17:32:28] [config] no-reload: false
[2019-07-12 17:32:28] [config] no-restore-corpus: false
[2019-07-12 17:32:28] [config] no-shuffle: false
[2019-07-12 17:32:28] [config] normalize: 1
[2019-07-12 17:32:28] [config] num-devices: 0
[2019-07-12 17:32:28] [config] optimizer: adam
[2019-07-12 17:32:28] [config] optimizer-delay: 1
[2019-07-12 17:32:28] [config] optimizer-params:
[2019-07-12 17:32:28] [config]   []
[2019-07-12 17:32:28] [config] overwrite: false
[2019-07-12 17:32:28] [config] pretrained-model: ""
[2019-07-12 17:32:28] [config] quiet: false
[2019-07-12 17:32:28] [config] quiet-translation: true
[2019-07-12 17:32:28] [config] relative-paths: false
[2019-07-12 17:32:28] [config] right-left: false
[2019-07-12 17:32:28] [config] save-freq: 20000
[2019-07-12 17:32:28] [config] seed: 1111
[2019-07-12 17:32:28] [config] shuffle-in-ram: false
[2019-07-12 17:32:28] [config] skip: false
[2019-07-12 17:32:28] [config] sqlite: ""
[2019-07-12 17:32:28] [config] sqlite-drop: false
[2019-07-12 17:32:28] [config] sync-sgd: true
[2019-07-12 17:32:28] [config] tempdir: .
[2019-07-12 17:32:28] [config] tied-embeddings: false
[2019-07-12 17:32:28] [config] tied-embeddings-all: false
[2019-07-12 17:32:28] [config] tied-embeddings-src: false
[2019-07-12 17:32:28] [config] train-sets:
[2019-07-12 17:32:28] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-12 17:32:28] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-12 17:32:28] [config] transformer-aan-activation: swish
[2019-07-12 17:32:28] [config] transformer-aan-depth: 2
[2019-07-12 17:32:28] [config] transformer-aan-nogate: false
[2019-07-12 17:32:28] [config] transformer-decoder-autoreg: self-attention
[2019-07-12 17:32:28] [config] transformer-dim-aan: 2048
[2019-07-12 17:32:28] [config] transformer-dim-ffn: 2048
[2019-07-12 17:32:28] [config] transformer-dropout: 0
[2019-07-12 17:32:28] [config] transformer-dropout-attention: 0
[2019-07-12 17:32:28] [config] transformer-dropout-ffn: 0
[2019-07-12 17:32:28] [config] transformer-ffn-activation: swish
[2019-07-12 17:32:28] [config] transformer-ffn-depth: 2
[2019-07-12 17:32:28] [config] transformer-guided-alignment-layer: last
[2019-07-12 17:32:28] [config] transformer-heads: 8
[2019-07-12 17:32:28] [config] transformer-no-projection: false
[2019-07-12 17:32:28] [config] transformer-postprocess: dan
[2019-07-12 17:32:28] [config] transformer-postprocess-emb: d
[2019-07-12 17:32:28] [config] transformer-preprocess: ""
[2019-07-12 17:32:28] [config] transformer-tied-layers:
[2019-07-12 17:32:28] [config]   []
[2019-07-12 17:32:28] [config] transformer-train-position-embeddings: false
[2019-07-12 17:32:28] [config] type: amun
[2019-07-12 17:32:28] [config] ulr: false
[2019-07-12 17:32:28] [config] ulr-dim-emb: 0
[2019-07-12 17:32:28] [config] ulr-dropout: 0
[2019-07-12 17:32:28] [config] ulr-keys-vectors: ""
[2019-07-12 17:32:28] [config] ulr-query-vectors: ""
[2019-07-12 17:32:28] [config] ulr-softmax-temperature: 1
[2019-07-12 17:32:28] [config] ulr-trainable-transformation: false
[2019-07-12 17:32:28] [config] valid-freq: 20000
[2019-07-12 17:32:28] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-12 17:32:28] [config] valid-max-length: 1000
[2019-07-12 17:32:28] [config] valid-metrics:
[2019-07-12 17:32:28] [config]   - cross-entropy
[2019-07-12 17:32:28] [config]   - perplexity
[2019-07-12 17:32:28] [config]   - translation
[2019-07-12 17:32:28] [config] valid-mini-batch: 8
[2019-07-12 17:32:28] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-12 17:32:28] [config] valid-sets:
[2019-07-12 17:32:28] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-12 17:32:28] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-12 17:32:28] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-12 17:32:28] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-12 17:32:28] [config] vocabs:
[2019-07-12 17:32:28] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-12 17:32:28] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-12 17:32:28] [config] word-penalty: 0
[2019-07-12 17:32:28] [config] workspace: 6000
[2019-07-12 17:32:28] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-12 17:32:28] Using synchronous training
[2019-07-12 17:32:28] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-12 17:32:28] [data] Using unused word id eos for 0
[2019-07-12 17:32:28] [data] Using unused word id UNK for 1
[2019-07-12 17:32:28] [data] Setting vocabulary size for input 0 to 50000
[2019-07-12 17:32:28] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-12 17:32:29] [data] Using unused word id eos for 0
[2019-07-12 17:32:29] [data] Using unused word id UNK for 1
[2019-07-12 17:32:29] [data] Setting vocabulary size for input 1 to 50000
[2019-07-12 17:32:29] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-12 17:32:29] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-12 17:32:29] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-12 17:32:30] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-12 17:32:30] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-12 17:32:31] [comm] NCCLCommunicator constructed successfully.
[2019-07-12 17:32:31] [training] Using 2 GPUs
[2019-07-12 17:32:31] [memory] Reserving 422 MB, device gpu0
[2019-07-12 17:32:31] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-12 17:32:31] [memory] Reserving 422 MB, device gpu0
[2019-07-12 17:32:41] [batching] Done. Typical MB size is 16192 target words
[2019-07-12 17:32:42] [memory] Extending reserved space to 6016 MB (device gpu0)
[2019-07-12 17:32:42] [memory] Extending reserved space to 6016 MB (device gpu1)
[2019-07-12 17:32:42] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-12 17:32:42] [comm] NCCLCommunicator constructed successfully.
[2019-07-12 17:32:42] [training] Using 2 GPUs
[2019-07-12 17:32:42] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-12 17:32:48] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-12 17:32:50] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-12 17:33:01] [memory] Reserving 422 MB, device gpu0
[2019-07-12 17:33:01] [memory] Reserving 422 MB, device gpu1
[2019-07-12 17:33:02] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 17:33:02] [data] Restoring the corpus state to epoch 27, batch 320000
[2019-07-12 17:33:02] [data] Shuffling data
[2019-07-12 17:33:05] [data] Done reading 5196149 sentences
[2019-07-12 17:33:29] [data] Done shuffling 5196149 sentences to temp files
[2019-07-12 17:33:32] Training started
[2019-07-12 17:33:32] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-12 17:33:32] [memory] Reserving 422 MB, device gpu0
[2019-07-12 17:33:32] [memory] Reserving 422 MB, device gpu1
[2019-07-12 17:33:32] [memory] Reserving 422 MB, device gpu0
[2019-07-12 17:33:32] [memory] Reserving 422 MB, device gpu1
[2019-07-12 17:33:33] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 17:33:38] [memory] Reserving 422 MB, device cpu0
[2019-07-12 17:33:39] [memory] Reserving 211 MB, device gpu0
[2019-07-12 17:33:39] [memory] Reserving 211 MB, device gpu1
[2019-07-12 17:50:49] Ep. 27 : Up. 322000 : Sen. 735,046 : Cost 37.97378540 : Time 1100.22s : 13811.03 words/s
[2019-07-12 18:08:01] Ep. 27 : Up. 324000 : Sen. 1,445,128 : Cost 38.10945129 : Time 1031.69s : 14664.46 words/s
[2019-07-12 18:25:20] Ep. 27 : Up. 326000 : Sen. 2,160,480 : Cost 38.37996674 : Time 1039.27s : 14681.96 words/s
[2019-07-12 18:42:35] Ep. 27 : Up. 328000 : Sen. 2,872,010 : Cost 38.66205597 : Time 1035.08s : 14670.46 words/s
[2019-07-12 18:59:51] Ep. 27 : Up. 330000 : Sen. 3,584,318 : Cost 38.58279419 : Time 1036.26s : 14674.61 words/s
[2019-07-12 19:17:06] Ep. 27 : Up. 332000 : Sen. 4,296,356 : Cost 38.52960968 : Time 1035.00s : 14667.17 words/s
[2019-07-12 19:19:11] Seen 4381942 samples
[2019-07-12 19:19:11] Starting epoch 28
[2019-07-12 19:19:11] [data] Shuffling data
[2019-07-12 19:19:14] [data] Done reading 5196149 sentences
[2019-07-12 19:19:42] [data] Done shuffling 5196149 sentences to temp files
[2019-07-12 19:34:53] Ep. 28 : Up. 334000 : Sen. 623,016 : Cost 38.11843109 : Time 1067.08s : 14183.07 words/s
[2019-07-12 19:52:10] Ep. 28 : Up. 336000 : Sen. 1,336,542 : Cost 38.14720535 : Time 1036.32s : 14690.34 words/s
[2019-07-12 20:09:25] Ep. 28 : Up. 338000 : Sen. 2,047,682 : Cost 38.27443314 : Time 1034.94s : 14654.34 words/s
[2019-07-12 20:26:38] Ep. 28 : Up. 340000 : Sen. 2,759,354 : Cost 38.25732803 : Time 1033.47s : 14691.02 words/s
[2019-07-12 20:26:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-12 20:26:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter340000.npz
[2019-07-12 20:26:59] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-12 20:27:10] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-12 20:27:32] [valid] Ep. 28 : Up. 340000 : cross-entropy : 48.1015 : new best
[2019-07-12 20:27:36] [valid] Ep. 28 : Up. 340000 : perplexity : 6.68061 : new best
[2019-07-12 20:27:59] Error: Unknown word id: 49992
[2019-07-12 20:27:59] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f6e530e8a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f6e52c08c80]                                                       + 0xb8c80
[0x7f6e530e16ba]                                                       + 0x76ba
[0x7f6e5236e41d]    clone                                              + 0x6d

[2019-07-13 13:14:51] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 13:14:51] [marian] Running on hodor as process 54250 with command line:
[2019-07-13 13:14:51] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 0 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-13 13:14:52] [config] after-batches: 0
[2019-07-13 13:14:52] [config] after-epochs: 0
[2019-07-13 13:14:52] [config] allow-unk: false
[2019-07-13 13:14:52] [config] beam-size: 12
[2019-07-13 13:14:52] [config] bert-class-symbol: "[CLS]"
[2019-07-13 13:14:52] [config] bert-mask-symbol: "[MASK]"
[2019-07-13 13:14:52] [config] bert-masking-fraction: 0.15
[2019-07-13 13:14:52] [config] bert-sep-symbol: "[SEP]"
[2019-07-13 13:14:52] [config] bert-train-type-embeddings: true
[2019-07-13 13:14:52] [config] bert-type-vocab-size: 2
[2019-07-13 13:14:52] [config] best-deep: false
[2019-07-13 13:14:52] [config] clip-gemm: 0
[2019-07-13 13:14:52] [config] clip-norm: 1
[2019-07-13 13:14:52] [config] cost-type: ce-mean
[2019-07-13 13:14:52] [config] cpu-threads: 0
[2019-07-13 13:14:52] [config] data-weighting: ""
[2019-07-13 13:14:52] [config] data-weighting-type: sentence
[2019-07-13 13:14:52] [config] dec-cell: gru
[2019-07-13 13:14:52] [config] dec-cell-base-depth: 2
[2019-07-13 13:14:52] [config] dec-cell-high-depth: 1
[2019-07-13 13:14:52] [config] dec-depth: 1
[2019-07-13 13:14:52] [config] devices:
[2019-07-13 13:14:52] [config]   - 0
[2019-07-13 13:14:52] [config]   - 1
[2019-07-13 13:14:52] [config] dim-emb: 512
[2019-07-13 13:14:52] [config] dim-rnn: 1024
[2019-07-13 13:14:52] [config] dim-vocabs:
[2019-07-13 13:14:52] [config]   - 50000
[2019-07-13 13:14:52] [config]   - 50000
[2019-07-13 13:14:52] [config] disp-first: 0
[2019-07-13 13:14:52] [config] disp-freq: 2000
[2019-07-13 13:14:52] [config] disp-label-counts: false
[2019-07-13 13:14:52] [config] dropout-rnn: 0.2
[2019-07-13 13:14:52] [config] dropout-src: 0.1
[2019-07-13 13:14:52] [config] dropout-trg: 0.1
[2019-07-13 13:14:52] [config] dump-config: ""
[2019-07-13 13:14:52] [config] early-stopping: 5
[2019-07-13 13:14:52] [config] embedding-fix-src: false
[2019-07-13 13:14:52] [config] embedding-fix-trg: false
[2019-07-13 13:14:52] [config] embedding-normalization: false
[2019-07-13 13:14:52] [config] embedding-vectors:
[2019-07-13 13:14:52] [config]   []
[2019-07-13 13:14:52] [config] enc-cell: gru
[2019-07-13 13:14:52] [config] enc-cell-depth: 1
[2019-07-13 13:14:52] [config] enc-depth: 1
[2019-07-13 13:14:52] [config] enc-type: bidirectional
[2019-07-13 13:14:52] [config] exponential-smoothing: 0.0001
[2019-07-13 13:14:52] [config] grad-dropping-momentum: 0
[2019-07-13 13:14:52] [config] grad-dropping-rate: 0
[2019-07-13 13:14:52] [config] grad-dropping-warmup: 100
[2019-07-13 13:14:52] [config] guided-alignment: none
[2019-07-13 13:14:52] [config] guided-alignment-cost: mse
[2019-07-13 13:14:52] [config] guided-alignment-weight: 0.1
[2019-07-13 13:14:52] [config] ignore-model-config: false
[2019-07-13 13:14:52] [config] input-types:
[2019-07-13 13:14:52] [config]   []
[2019-07-13 13:14:52] [config] interpolate-env-vars: false
[2019-07-13 13:14:52] [config] keep-best: false
[2019-07-13 13:14:52] [config] label-smoothing: 0
[2019-07-13 13:14:52] [config] layer-normalization: true
[2019-07-13 13:14:52] [config] learn-rate: 0.0001
[2019-07-13 13:14:52] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-13 13:14:52] [config] log-level: info
[2019-07-13 13:14:52] [config] log-time-zone: ""
[2019-07-13 13:14:52] [config] lr-decay: 0
[2019-07-13 13:14:52] [config] lr-decay-freq: 50000
[2019-07-13 13:14:52] [config] lr-decay-inv-sqrt:
[2019-07-13 13:14:52] [config]   - 0
[2019-07-13 13:14:52] [config] lr-decay-repeat-warmup: false
[2019-07-13 13:14:52] [config] lr-decay-reset-optimizer: false
[2019-07-13 13:14:52] [config] lr-decay-start:
[2019-07-13 13:14:52] [config]   - 10
[2019-07-13 13:14:52] [config]   - 1
[2019-07-13 13:14:52] [config] lr-decay-strategy: epoch+stalled
[2019-07-13 13:14:52] [config] lr-report: false
[2019-07-13 13:14:52] [config] lr-warmup: 0
[2019-07-13 13:14:52] [config] lr-warmup-at-reload: false
[2019-07-13 13:14:52] [config] lr-warmup-cycle: false
[2019-07-13 13:14:52] [config] lr-warmup-start-rate: 0
[2019-07-13 13:14:52] [config] max-length: 50
[2019-07-13 13:14:52] [config] max-length-crop: false
[2019-07-13 13:14:52] [config] max-length-factor: 3
[2019-07-13 13:14:52] [config] maxi-batch: 100
[2019-07-13 13:14:52] [config] maxi-batch-sort: trg
[2019-07-13 13:14:52] [config] mini-batch: 64
[2019-07-13 13:14:52] [config] mini-batch-fit: true
[2019-07-13 13:14:52] [config] mini-batch-fit-step: 10
[2019-07-13 13:14:52] [config] mini-batch-overstuff: 1
[2019-07-13 13:14:52] [config] mini-batch-track-lr: false
[2019-07-13 13:14:52] [config] mini-batch-understuff: 1
[2019-07-13 13:14:52] [config] mini-batch-warmup: 0
[2019-07-13 13:14:52] [config] mini-batch-words: 0
[2019-07-13 13:14:52] [config] mini-batch-words-ref: 0
[2019-07-13 13:14:52] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-13 13:14:52] [config] multi-loss-type: sum
[2019-07-13 13:14:52] [config] multi-node: false
[2019-07-13 13:14:52] [config] multi-node-overlap: true
[2019-07-13 13:14:52] [config] n-best: false
[2019-07-13 13:14:52] [config] no-nccl: false
[2019-07-13 13:14:52] [config] no-reload: false
[2019-07-13 13:14:52] [config] no-restore-corpus: false
[2019-07-13 13:14:52] [config] no-shuffle: false
[2019-07-13 13:14:52] [config] normalize: 1
[2019-07-13 13:14:52] [config] num-devices: 0
[2019-07-13 13:14:52] [config] optimizer: adam
[2019-07-13 13:14:52] [config] optimizer-delay: 1
[2019-07-13 13:14:52] [config] optimizer-params:
[2019-07-13 13:14:52] [config]   []
[2019-07-13 13:14:52] [config] overwrite: false
[2019-07-13 13:14:52] [config] pretrained-model: ""
[2019-07-13 13:14:52] [config] quiet: false
[2019-07-13 13:14:52] [config] quiet-translation: true
[2019-07-13 13:14:52] [config] relative-paths: false
[2019-07-13 13:14:52] [config] right-left: false
[2019-07-13 13:14:52] [config] save-freq: 20000
[2019-07-13 13:14:52] [config] seed: 1111
[2019-07-13 13:14:52] [config] shuffle-in-ram: false
[2019-07-13 13:14:52] [config] skip: false
[2019-07-13 13:14:52] [config] sqlite: ""
[2019-07-13 13:14:52] [config] sqlite-drop: false
[2019-07-13 13:14:52] [config] sync-sgd: true
[2019-07-13 13:14:52] [config] tempdir: .
[2019-07-13 13:14:52] [config] tied-embeddings: false
[2019-07-13 13:14:52] [config] tied-embeddings-all: false
[2019-07-13 13:14:52] [config] tied-embeddings-src: false
[2019-07-13 13:14:52] [config] train-sets:
[2019-07-13 13:14:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-13 13:14:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-13 13:14:52] [config] transformer-aan-activation: swish
[2019-07-13 13:14:52] [config] transformer-aan-depth: 2
[2019-07-13 13:14:52] [config] transformer-aan-nogate: false
[2019-07-13 13:14:52] [config] transformer-decoder-autoreg: self-attention
[2019-07-13 13:14:52] [config] transformer-dim-aan: 2048
[2019-07-13 13:14:52] [config] transformer-dim-ffn: 2048
[2019-07-13 13:14:52] [config] transformer-dropout: 0
[2019-07-13 13:14:52] [config] transformer-dropout-attention: 0
[2019-07-13 13:14:52] [config] transformer-dropout-ffn: 0
[2019-07-13 13:14:52] [config] transformer-ffn-activation: swish
[2019-07-13 13:14:52] [config] transformer-ffn-depth: 2
[2019-07-13 13:14:52] [config] transformer-guided-alignment-layer: last
[2019-07-13 13:14:52] [config] transformer-heads: 8
[2019-07-13 13:14:52] [config] transformer-no-projection: false
[2019-07-13 13:14:52] [config] transformer-postprocess: dan
[2019-07-13 13:14:52] [config] transformer-postprocess-emb: d
[2019-07-13 13:14:52] [config] transformer-preprocess: ""
[2019-07-13 13:14:52] [config] transformer-tied-layers:
[2019-07-13 13:14:52] [config]   []
[2019-07-13 13:14:52] [config] transformer-train-position-embeddings: false
[2019-07-13 13:14:52] [config] type: amun
[2019-07-13 13:14:52] [config] ulr: false
[2019-07-13 13:14:52] [config] ulr-dim-emb: 0
[2019-07-13 13:14:52] [config] ulr-dropout: 0
[2019-07-13 13:14:52] [config] ulr-keys-vectors: ""
[2019-07-13 13:14:52] [config] ulr-query-vectors: ""
[2019-07-13 13:14:52] [config] ulr-softmax-temperature: 1
[2019-07-13 13:14:52] [config] ulr-trainable-transformation: false
[2019-07-13 13:14:52] [config] valid-freq: 20000
[2019-07-13 13:14:52] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-13 13:14:52] [config] valid-max-length: 1000
[2019-07-13 13:14:52] [config] valid-metrics:
[2019-07-13 13:14:52] [config]   - cross-entropy
[2019-07-13 13:14:52] [config]   - perplexity
[2019-07-13 13:14:52] [config]   - translation
[2019-07-13 13:14:52] [config] valid-mini-batch: 8
[2019-07-13 13:14:52] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-13 13:14:52] [config] valid-sets:
[2019-07-13 13:14:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-13 13:14:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-13 13:14:52] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-13 13:14:52] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 13:14:52] [config] vocabs:
[2019-07-13 13:14:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-13 13:14:52] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-13 13:14:52] [config] word-penalty: 0
[2019-07-13 13:14:52] [config] workspace: 5000
[2019-07-13 13:14:52] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-13 13:14:52] Using synchronous training
[2019-07-13 13:14:52] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-13 13:14:52] [data] Using unused word id eos for 0
[2019-07-13 13:14:52] [data] Using unused word id UNK for 1
[2019-07-13 13:14:52] [data] Setting vocabulary size for input 0 to 50000
[2019-07-13 13:14:52] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-13 13:14:52] [data] Using unused word id eos for 0
[2019-07-13 13:14:52] [data] Using unused word id UNK for 1
[2019-07-13 13:14:52] [data] Setting vocabulary size for input 1 to 50000
[2019-07-13 13:14:53] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-13 13:14:53] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-13 13:14:54] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-13 13:14:55] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-13 13:14:55] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-13 13:14:55] [comm] NCCLCommunicator constructed successfully.
[2019-07-13 13:14:55] [training] Using 2 GPUs
[2019-07-13 13:14:55] [memory] Reserving 422 MB, device gpu0
[2019-07-13 13:14:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-13 13:14:55] [memory] Reserving 422 MB, device gpu0
[2019-07-13 13:15:04] [batching] Done. Typical MB size is 13760 target words
[2019-07-13 13:15:04] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-13 13:15:04] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-13 13:15:04] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-13 13:15:04] [comm] NCCLCommunicator constructed successfully.
[2019-07-13 13:15:04] [training] Using 2 GPUs
[2019-07-13 13:15:04] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-13 13:15:11] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-13 13:15:13] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-13 13:15:24] [memory] Reserving 422 MB, device gpu0
[2019-07-13 13:15:24] [memory] Reserving 422 MB, device gpu1
[2019-07-13 13:15:25] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-13 13:15:25] [data] Restoring the corpus state to epoch 28, batch 340000
[2019-07-13 13:15:25] [data] Shuffling data
[2019-07-13 13:15:38] [data] Done reading 5196149 sentences
[2019-07-13 13:16:02] [data] Done shuffling 5196149 sentences to temp files
[2019-07-13 13:17:08] Training started
[2019-07-13 13:17:08] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-13 13:17:08] [memory] Reserving 422 MB, device gpu0
[2019-07-13 13:17:08] [memory] Reserving 422 MB, device gpu1
[2019-07-13 13:17:08] [memory] Reserving 422 MB, device gpu0
[2019-07-13 13:17:08] [memory] Reserving 422 MB, device gpu1
[2019-07-13 13:17:08] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-13 13:17:15] [memory] Reserving 422 MB, device cpu0
[2019-07-13 13:17:15] [memory] Reserving 211 MB, device gpu0
[2019-07-13 13:17:15] [memory] Reserving 211 MB, device gpu1
[2019-07-13 13:32:51] Ep. 28 : Up. 342000 : Sen. 3,365,117 : Cost 37.58449173 : Time 1078.03s : 11970.44 words/s
[2019-07-13 13:48:33] Ep. 28 : Up. 344000 : Sen. 3,971,305 : Cost 38.75832367 : Time 941.98s : 13743.72 words/s
[2019-07-13 14:04:14] Ep. 28 : Up. 346000 : Sen. 4,576,761 : Cost 38.57226562 : Time 941.62s : 13693.48 words/s
[2019-07-13 14:10:01] Seen 4796659 samples
[2019-07-13 14:10:01] Starting epoch 29
[2019-07-13 14:10:01] [data] Shuffling data
[2019-07-13 14:10:06] [data] Done reading 5196149 sentences
[2019-07-13 14:10:34] [data] Done shuffling 5196149 sentences to temp files
[2019-07-13 14:20:40] Ep. 29 : Up. 348000 : Sen. 384,988 : Cost 38.25436020 : Time 985.71s : 13110.03 words/s
[2019-07-13 14:36:23] Ep. 29 : Up. 350000 : Sen. 989,907 : Cost 37.93661880 : Time 942.76s : 13688.72 words/s
[2019-07-13 14:52:06] Ep. 29 : Up. 352000 : Sen. 1,593,336 : Cost 38.18767929 : Time 943.00s : 13664.63 words/s
[2019-07-13 15:07:45] Ep. 29 : Up. 354000 : Sen. 2,197,218 : Cost 38.18120193 : Time 939.47s : 13694.74 words/s
[2019-07-13 15:23:30] Ep. 29 : Up. 356000 : Sen. 2,803,464 : Cost 38.44757080 : Time 945.36s : 13695.95 words/s
[2019-07-13 15:39:13] Ep. 29 : Up. 358000 : Sen. 3,407,470 : Cost 38.47596359 : Time 942.03s : 13683.10 words/s
[2019-07-13 15:55:05] Ep. 29 : Up. 360000 : Sen. 4,014,288 : Cost 38.53231812 : Time 952.81s : 13571.64 words/s
[2019-07-13 15:55:05] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-13 15:55:21] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter360000.npz
[2019-07-13 15:55:30] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-13 15:55:42] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-13 15:56:03] [valid] Ep. 29 : Up. 360000 : cross-entropy : 48.1207 : new best
[2019-07-13 15:56:07] [valid] Ep. 29 : Up. 360000 : perplexity : 6.68567 : new best
[2019-07-13 15:56:30] Error: Unknown word id: 49992
[2019-07-13 15:56:30] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7fcb38abba99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7fcb385dbc80]                                                       + 0xb8c80
[0x7fcb38ab46ba]                                                       + 0x76ba
[0x7fcb37d4141d]    clone                                              + 0x6d

[2019-07-14 09:23:23] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 09:23:23] [marian] Running on hodor as process 187943 with command line:
[2019-07-14 09:23:23] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-14 09:23:24] [config] after-batches: 0
[2019-07-14 09:23:24] [config] after-epochs: 0
[2019-07-14 09:23:24] [config] allow-unk: false
[2019-07-14 09:23:24] [config] beam-size: 12
[2019-07-14 09:23:24] [config] bert-class-symbol: "[CLS]"
[2019-07-14 09:23:24] [config] bert-mask-symbol: "[MASK]"
[2019-07-14 09:23:24] [config] bert-masking-fraction: 0.15
[2019-07-14 09:23:24] [config] bert-sep-symbol: "[SEP]"
[2019-07-14 09:23:24] [config] bert-train-type-embeddings: true
[2019-07-14 09:23:24] [config] bert-type-vocab-size: 2
[2019-07-14 09:23:24] [config] best-deep: false
[2019-07-14 09:23:24] [config] clip-gemm: 0
[2019-07-14 09:23:24] [config] clip-norm: 1
[2019-07-14 09:23:24] [config] cost-type: ce-mean
[2019-07-14 09:23:24] [config] cpu-threads: 0
[2019-07-14 09:23:24] [config] data-weighting: ""
[2019-07-14 09:23:24] [config] data-weighting-type: sentence
[2019-07-14 09:23:24] [config] dec-cell: gru
[2019-07-14 09:23:24] [config] dec-cell-base-depth: 2
[2019-07-14 09:23:24] [config] dec-cell-high-depth: 1
[2019-07-14 09:23:24] [config] dec-depth: 1
[2019-07-14 09:23:24] [config] devices:
[2019-07-14 09:23:24] [config]   - 1
[2019-07-14 09:23:24] [config] dim-emb: 512
[2019-07-14 09:23:24] [config] dim-rnn: 1024
[2019-07-14 09:23:24] [config] dim-vocabs:
[2019-07-14 09:23:24] [config]   - 50000
[2019-07-14 09:23:24] [config]   - 50000
[2019-07-14 09:23:24] [config] disp-first: 0
[2019-07-14 09:23:24] [config] disp-freq: 2000
[2019-07-14 09:23:24] [config] disp-label-counts: false
[2019-07-14 09:23:24] [config] dropout-rnn: 0.2
[2019-07-14 09:23:24] [config] dropout-src: 0.1
[2019-07-14 09:23:24] [config] dropout-trg: 0.1
[2019-07-14 09:23:24] [config] dump-config: ""
[2019-07-14 09:23:24] [config] early-stopping: 5
[2019-07-14 09:23:24] [config] embedding-fix-src: false
[2019-07-14 09:23:24] [config] embedding-fix-trg: false
[2019-07-14 09:23:24] [config] embedding-normalization: false
[2019-07-14 09:23:24] [config] embedding-vectors:
[2019-07-14 09:23:24] [config]   []
[2019-07-14 09:23:24] [config] enc-cell: gru
[2019-07-14 09:23:24] [config] enc-cell-depth: 1
[2019-07-14 09:23:24] [config] enc-depth: 1
[2019-07-14 09:23:24] [config] enc-type: bidirectional
[2019-07-14 09:23:24] [config] exponential-smoothing: 0.0001
[2019-07-14 09:23:24] [config] grad-dropping-momentum: 0
[2019-07-14 09:23:24] [config] grad-dropping-rate: 0
[2019-07-14 09:23:24] [config] grad-dropping-warmup: 100
[2019-07-14 09:23:24] [config] guided-alignment: none
[2019-07-14 09:23:24] [config] guided-alignment-cost: mse
[2019-07-14 09:23:24] [config] guided-alignment-weight: 0.1
[2019-07-14 09:23:24] [config] ignore-model-config: false
[2019-07-14 09:23:24] [config] input-types:
[2019-07-14 09:23:24] [config]   []
[2019-07-14 09:23:24] [config] interpolate-env-vars: false
[2019-07-14 09:23:24] [config] keep-best: false
[2019-07-14 09:23:24] [config] label-smoothing: 0
[2019-07-14 09:23:24] [config] layer-normalization: true
[2019-07-14 09:23:24] [config] learn-rate: 0.0001
[2019-07-14 09:23:24] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-14 09:23:24] [config] log-level: info
[2019-07-14 09:23:24] [config] log-time-zone: ""
[2019-07-14 09:23:24] [config] lr-decay: 0
[2019-07-14 09:23:24] [config] lr-decay-freq: 50000
[2019-07-14 09:23:24] [config] lr-decay-inv-sqrt:
[2019-07-14 09:23:24] [config]   - 0
[2019-07-14 09:23:24] [config] lr-decay-repeat-warmup: false
[2019-07-14 09:23:24] [config] lr-decay-reset-optimizer: false
[2019-07-14 09:23:24] [config] lr-decay-start:
[2019-07-14 09:23:24] [config]   - 10
[2019-07-14 09:23:24] [config]   - 1
[2019-07-14 09:23:24] [config] lr-decay-strategy: epoch+stalled
[2019-07-14 09:23:24] [config] lr-report: false
[2019-07-14 09:23:24] [config] lr-warmup: 0
[2019-07-14 09:23:24] [config] lr-warmup-at-reload: false
[2019-07-14 09:23:24] [config] lr-warmup-cycle: false
[2019-07-14 09:23:24] [config] lr-warmup-start-rate: 0
[2019-07-14 09:23:24] [config] max-length: 50
[2019-07-14 09:23:24] [config] max-length-crop: false
[2019-07-14 09:23:24] [config] max-length-factor: 3
[2019-07-14 09:23:24] [config] maxi-batch: 100
[2019-07-14 09:23:24] [config] maxi-batch-sort: trg
[2019-07-14 09:23:24] [config] mini-batch: 64
[2019-07-14 09:23:24] [config] mini-batch-fit: true
[2019-07-14 09:23:24] [config] mini-batch-fit-step: 10
[2019-07-14 09:23:24] [config] mini-batch-overstuff: 1
[2019-07-14 09:23:24] [config] mini-batch-track-lr: false
[2019-07-14 09:23:24] [config] mini-batch-understuff: 1
[2019-07-14 09:23:24] [config] mini-batch-warmup: 0
[2019-07-14 09:23:24] [config] mini-batch-words: 0
[2019-07-14 09:23:24] [config] mini-batch-words-ref: 0
[2019-07-14 09:23:24] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 09:23:24] [config] multi-loss-type: sum
[2019-07-14 09:23:24] [config] multi-node: false
[2019-07-14 09:23:24] [config] multi-node-overlap: true
[2019-07-14 09:23:24] [config] n-best: false
[2019-07-14 09:23:24] [config] no-nccl: false
[2019-07-14 09:23:24] [config] no-reload: false
[2019-07-14 09:23:24] [config] no-restore-corpus: false
[2019-07-14 09:23:24] [config] no-shuffle: false
[2019-07-14 09:23:24] [config] normalize: 1
[2019-07-14 09:23:24] [config] num-devices: 0
[2019-07-14 09:23:24] [config] optimizer: adam
[2019-07-14 09:23:24] [config] optimizer-delay: 1
[2019-07-14 09:23:24] [config] optimizer-params:
[2019-07-14 09:23:24] [config]   []
[2019-07-14 09:23:24] [config] overwrite: false
[2019-07-14 09:23:24] [config] pretrained-model: ""
[2019-07-14 09:23:24] [config] quiet: false
[2019-07-14 09:23:24] [config] quiet-translation: true
[2019-07-14 09:23:24] [config] relative-paths: false
[2019-07-14 09:23:24] [config] right-left: false
[2019-07-14 09:23:24] [config] save-freq: 20000
[2019-07-14 09:23:24] [config] seed: 1111
[2019-07-14 09:23:24] [config] shuffle-in-ram: false
[2019-07-14 09:23:24] [config] skip: false
[2019-07-14 09:23:24] [config] sqlite: ""
[2019-07-14 09:23:24] [config] sqlite-drop: false
[2019-07-14 09:23:24] [config] sync-sgd: true
[2019-07-14 09:23:24] [config] tempdir: .
[2019-07-14 09:23:24] [config] tied-embeddings: false
[2019-07-14 09:23:24] [config] tied-embeddings-all: false
[2019-07-14 09:23:24] [config] tied-embeddings-src: false
[2019-07-14 09:23:24] [config] train-sets:
[2019-07-14 09:23:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-14 09:23:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-14 09:23:24] [config] transformer-aan-activation: swish
[2019-07-14 09:23:24] [config] transformer-aan-depth: 2
[2019-07-14 09:23:24] [config] transformer-aan-nogate: false
[2019-07-14 09:23:24] [config] transformer-decoder-autoreg: self-attention
[2019-07-14 09:23:24] [config] transformer-dim-aan: 2048
[2019-07-14 09:23:24] [config] transformer-dim-ffn: 2048
[2019-07-14 09:23:24] [config] transformer-dropout: 0
[2019-07-14 09:23:24] [config] transformer-dropout-attention: 0
[2019-07-14 09:23:24] [config] transformer-dropout-ffn: 0
[2019-07-14 09:23:24] [config] transformer-ffn-activation: swish
[2019-07-14 09:23:24] [config] transformer-ffn-depth: 2
[2019-07-14 09:23:24] [config] transformer-guided-alignment-layer: last
[2019-07-14 09:23:24] [config] transformer-heads: 8
[2019-07-14 09:23:24] [config] transformer-no-projection: false
[2019-07-14 09:23:24] [config] transformer-postprocess: dan
[2019-07-14 09:23:24] [config] transformer-postprocess-emb: d
[2019-07-14 09:23:24] [config] transformer-preprocess: ""
[2019-07-14 09:23:24] [config] transformer-tied-layers:
[2019-07-14 09:23:24] [config]   []
[2019-07-14 09:23:24] [config] transformer-train-position-embeddings: false
[2019-07-14 09:23:24] [config] type: amun
[2019-07-14 09:23:24] [config] ulr: false
[2019-07-14 09:23:24] [config] ulr-dim-emb: 0
[2019-07-14 09:23:24] [config] ulr-dropout: 0
[2019-07-14 09:23:24] [config] ulr-keys-vectors: ""
[2019-07-14 09:23:24] [config] ulr-query-vectors: ""
[2019-07-14 09:23:24] [config] ulr-softmax-temperature: 1
[2019-07-14 09:23:24] [config] ulr-trainable-transformation: false
[2019-07-14 09:23:24] [config] valid-freq: 20000
[2019-07-14 09:23:24] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-14 09:23:24] [config] valid-max-length: 1000
[2019-07-14 09:23:24] [config] valid-metrics:
[2019-07-14 09:23:24] [config]   - cross-entropy
[2019-07-14 09:23:24] [config]   - perplexity
[2019-07-14 09:23:24] [config]   - translation
[2019-07-14 09:23:24] [config] valid-mini-batch: 8
[2019-07-14 09:23:24] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-14 09:23:24] [config] valid-sets:
[2019-07-14 09:23:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-14 09:23:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-14 09:23:24] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-14 09:23:24] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 09:23:24] [config] vocabs:
[2019-07-14 09:23:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-14 09:23:24] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-14 09:23:24] [config] word-penalty: 0
[2019-07-14 09:23:24] [config] workspace: 5000
[2019-07-14 09:23:24] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-14 09:23:24] Using synchronous training
[2019-07-14 09:23:24] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-14 09:23:24] [data] Using unused word id eos for 0
[2019-07-14 09:23:24] [data] Using unused word id UNK for 1
[2019-07-14 09:23:24] [data] Setting vocabulary size for input 0 to 50000
[2019-07-14 09:23:24] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-14 09:23:25] [data] Using unused word id eos for 0
[2019-07-14 09:23:25] [data] Using unused word id UNK for 1
[2019-07-14 09:23:25] [data] Setting vocabulary size for input 1 to 50000
[2019-07-14 09:23:25] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-14 09:23:25] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-14 09:23:26] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-14 09:23:26] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 09:23:26] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 09:23:26] [training] Using 1 GPUs
[2019-07-14 09:23:26] [memory] Reserving 422 MB, device gpu1
[2019-07-14 09:23:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-14 09:23:26] [memory] Reserving 422 MB, device gpu1
[2019-07-14 09:23:35] [batching] Done. Typical MB size is 6880 target words
[2019-07-14 09:23:35] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-14 09:23:35] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-14 09:23:35] [comm] NCCLCommunicator constructed successfully.
[2019-07-14 09:23:35] [training] Using 1 GPUs
[2019-07-14 09:23:35] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 09:23:42] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 09:23:52] [memory] Reserving 844 MB, device gpu1
[2019-07-14 09:23:53] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 09:23:53] [data] Restoring the corpus state to epoch 29, batch 360000
[2019-07-14 09:23:53] [data] Shuffling data
[2019-07-14 09:24:03] [data] Done reading 5196149 sentences
[2019-07-14 09:24:23] [data] Done shuffling 5196149 sentences to temp files
[2019-07-14 09:25:28] Training started
[2019-07-14 09:25:28] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-14 09:25:28] [memory] Reserving 422 MB, device gpu1
[2019-07-14 09:25:29] [memory] Reserving 422 MB, device gpu1
[2019-07-14 09:25:29] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 09:25:35] [memory] Reserving 422 MB, device cpu0
[2019-07-14 09:25:36] [memory] Reserving 422 MB, device gpu1
[2019-07-14 09:39:29] Ep. 29 : Up. 362000 : Sen. 4,335,784 : Cost 37.69961929 : Time 964.43s : 7103.36 words/s
[2019-07-14 09:53:27] Ep. 29 : Up. 364000 : Sen. 4,657,349 : Cost 37.95696640 : Time 837.82s : 8182.77 words/s
[2019-07-14 10:07:31] Ep. 29 : Up. 366000 : Sen. 4,978,268 : Cost 38.29992676 : Time 843.84s : 8123.97 words/s
[2019-07-14 10:21:34] Ep. 29 : Up. 368000 : Sen. 5,298,472 : Cost 38.16261673 : Time 843.30s : 8129.76 words/s
[2019-07-14 10:35:32] Ep. 29 : Up. 370000 : Sen. 5,620,332 : Cost 37.83086777 : Time 838.01s : 8150.66 words/s
[2019-07-14 10:49:33] Ep. 29 : Up. 372000 : Sen. 5,941,330 : Cost 38.66210175 : Time 840.82s : 8173.44 words/s
[2019-07-14 11:03:33] Ep. 29 : Up. 374000 : Sen. 6,264,307 : Cost 38.91611099 : Time 840.39s : 8168.21 words/s
[2019-07-14 11:03:43] Seen 6267630 samples
[2019-07-14 11:03:43] Starting epoch 30
[2019-07-14 11:03:43] [data] Shuffling data
[2019-07-14 11:03:47] [data] Done reading 5196149 sentences
[2019-07-14 11:04:24] [data] Done shuffling 5196149 sentences to temp files
[2019-07-14 11:18:18] Ep. 30 : Up. 376000 : Sen. 317,362 : Cost 38.15974045 : Time 884.75s : 7742.02 words/s
[2019-07-14 11:32:18] Ep. 30 : Up. 378000 : Sen. 638,069 : Cost 37.99669266 : Time 840.03s : 8131.06 words/s
[2019-07-14 11:46:19] Ep. 30 : Up. 380000 : Sen. 958,631 : Cost 38.17739487 : Time 840.70s : 8148.13 words/s
[2019-07-14 11:46:19] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 11:46:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter380000.npz
[2019-07-14 11:46:35] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 11:46:45] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 11:47:10] [valid] Ep. 30 : Up. 380000 : cross-entropy : 48.19 : new best
[2019-07-14 11:47:18] [valid] Ep. 30 : Up. 380000 : perplexity : 6.70401 : new best
[2019-07-14 11:48:28] [valid] Ep. 30 : Up. 380000 : translation : 30.38 : new best
[2019-07-14 12:02:31] Ep. 30 : Up. 382000 : Sen. 1,279,826 : Cost 38.43586349 : Time 972.57s : 7043.04 words/s
[2019-07-14 12:16:32] Ep. 30 : Up. 384000 : Sen. 1,601,429 : Cost 38.50706100 : Time 841.01s : 8173.97 words/s
[2019-07-14 12:30:30] Ep. 30 : Up. 386000 : Sen. 1,921,316 : Cost 38.49246597 : Time 837.34s : 8152.72 words/s
[2019-07-14 12:44:30] Ep. 30 : Up. 388000 : Sen. 2,242,738 : Cost 38.44524002 : Time 840.32s : 8157.68 words/s
[2019-07-14 12:58:28] Ep. 30 : Up. 390000 : Sen. 2,563,423 : Cost 38.55051041 : Time 838.22s : 8165.75 words/s
[2019-07-14 13:12:27] Ep. 30 : Up. 392000 : Sen. 2,884,382 : Cost 38.60622025 : Time 839.13s : 8155.51 words/s
[2019-07-14 13:26:24] Ep. 30 : Up. 394000 : Sen. 3,204,289 : Cost 38.52139664 : Time 836.11s : 8164.21 words/s
[2019-07-14 13:40:24] Ep. 30 : Up. 396000 : Sen. 3,525,566 : Cost 38.80594254 : Time 840.56s : 8161.17 words/s
[2019-07-14 13:54:22] Ep. 30 : Up. 398000 : Sen. 3,845,787 : Cost 38.83094788 : Time 837.90s : 8160.41 words/s
[2019-07-14 14:08:21] Ep. 30 : Up. 400000 : Sen. 4,167,021 : Cost 38.69360733 : Time 838.89s : 8167.65 words/s
[2019-07-14 14:08:21] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 14:08:31] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter400000.npz
[2019-07-14 14:08:38] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 14:08:48] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 14:09:15] [valid] Ep. 30 : Up. 400000 : cross-entropy : 48.112 : new best
[2019-07-14 14:09:22] [valid] Ep. 30 : Up. 400000 : perplexity : 6.68338 : new best
[2019-07-14 14:10:33] [valid] Ep. 30 : Up. 400000 : translation : 30.38 : stalled 1 times (last best: 30.38)
[2019-07-14 14:19:57] Seen 4381942 samples
[2019-07-14 14:19:57] Starting epoch 31
[2019-07-14 14:19:57] [data] Shuffling data
[2019-07-14 14:20:01] [data] Done reading 5196149 sentences
[2019-07-14 14:20:26] [data] Done shuffling 5196149 sentences to temp files
[2019-07-14 14:25:06] Ep. 31 : Up. 402000 : Sen. 106,316 : Cost 38.25965118 : Time 1004.65s : 6796.32 words/s
[2019-07-14 14:39:07] Ep. 31 : Up. 404000 : Sen. 426,607 : Cost 37.92464828 : Time 841.21s : 8141.05 words/s
[2019-07-14 14:53:08] Ep. 31 : Up. 406000 : Sen. 747,876 : Cost 37.86351776 : Time 841.08s : 8139.94 words/s
[2019-07-14 15:07:07] Ep. 31 : Up. 408000 : Sen. 1,066,026 : Cost 37.98383331 : Time 839.09s : 8097.73 words/s
[2019-07-14 15:21:09] Ep. 31 : Up. 410000 : Sen. 1,388,140 : Cost 37.79476166 : Time 842.48s : 8129.47 words/s
[2019-07-14 15:35:13] Ep. 31 : Up. 412000 : Sen. 1,708,668 : Cost 38.32865906 : Time 843.44s : 8125.21 words/s
[2019-07-14 15:49:18] Ep. 31 : Up. 414000 : Sen. 2,031,263 : Cost 38.46398926 : Time 844.80s : 8146.38 words/s
[2019-07-14 16:03:21] Ep. 31 : Up. 416000 : Sen. 2,352,837 : Cost 38.26690292 : Time 843.76s : 8115.59 words/s
[2019-07-14 16:17:24] Ep. 31 : Up. 418000 : Sen. 2,673,190 : Cost 38.53010559 : Time 842.79s : 8137.51 words/s
[2019-07-14 16:31:30] Ep. 31 : Up. 420000 : Sen. 2,996,157 : Cost 38.48958969 : Time 845.64s : 8144.61 words/s
[2019-07-14 16:31:30] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 16:31:39] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter420000.npz
[2019-07-14 16:31:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 16:31:55] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 16:32:21] [valid] Ep. 31 : Up. 420000 : cross-entropy : 48.1513 : stalled 1 times (last best: 48.112)
[2019-07-14 16:32:28] [valid] Ep. 31 : Up. 420000 : perplexity : 6.69375 : stalled 1 times (last best: 6.68338)
[2019-07-14 16:33:40] [valid] Ep. 31 : Up. 420000 : translation : 30.38 : stalled 2 times (last best: 30.38)
[2019-07-14 16:47:42] Ep. 31 : Up. 422000 : Sen. 3,315,506 : Cost 38.37361145 : Time 971.89s : 7021.73 words/s
[2019-07-14 17:01:43] Ep. 31 : Up. 424000 : Sen. 3,637,009 : Cost 38.52120972 : Time 841.21s : 8153.31 words/s
[2019-07-14 17:15:45] Ep. 31 : Up. 426000 : Sen. 3,957,693 : Cost 38.64634705 : Time 841.94s : 8129.56 words/s
[2019-07-14 17:29:40] Ep. 31 : Up. 428000 : Sen. 4,276,830 : Cost 38.47069931 : Time 835.34s : 8141.46 words/s
[2019-07-14 17:34:15] Seen 4381942 samples
[2019-07-14 17:34:15] Starting epoch 32
[2019-07-14 17:34:15] [data] Shuffling data
[2019-07-14 17:34:19] [data] Done reading 5196149 sentences
[2019-07-14 17:34:41] [data] Done shuffling 5196149 sentences to temp files
[2019-07-14 17:44:11] Ep. 32 : Up. 430000 : Sen. 216,940 : Cost 37.96498108 : Time 870.98s : 7877.50 words/s
[2019-07-14 17:58:16] Ep. 32 : Up. 432000 : Sen. 538,477 : Cost 37.74272919 : Time 844.33s : 8136.23 words/s
[2019-07-14 18:12:20] Ep. 32 : Up. 434000 : Sen. 860,354 : Cost 37.78760529 : Time 844.55s : 8118.94 words/s
[2019-07-14 18:26:22] Ep. 32 : Up. 436000 : Sen. 1,181,439 : Cost 37.72896194 : Time 842.25s : 8119.02 words/s
[2019-07-14 18:40:23] Ep. 32 : Up. 438000 : Sen. 1,501,030 : Cost 38.02775574 : Time 840.99s : 8124.37 words/s
[2019-07-14 18:54:28] Ep. 32 : Up. 440000 : Sen. 1,823,858 : Cost 38.08674240 : Time 844.40s : 8148.34 words/s
[2019-07-14 18:54:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 18:54:37] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter440000.npz
[2019-07-14 18:54:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 18:54:58] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 18:55:31] [valid] Ep. 32 : Up. 440000 : cross-entropy : 48.087 : new best
[2019-07-14 18:55:38] [valid] Ep. 32 : Up. 440000 : perplexity : 6.67679 : new best
[2019-07-14 18:56:51] [valid] Ep. 32 : Up. 440000 : translation : 30.38 : stalled 3 times (last best: 30.38)
[2019-07-14 19:10:57] Ep. 32 : Up. 442000 : Sen. 2,144,396 : Cost 38.09821701 : Time 989.34s : 6917.50 words/s
[2019-07-14 19:24:56] Ep. 32 : Up. 444000 : Sen. 2,464,480 : Cost 38.12643051 : Time 839.40s : 8124.34 words/s
[2019-07-14 19:38:59] Ep. 32 : Up. 446000 : Sen. 2,787,002 : Cost 38.02548599 : Time 842.42s : 8143.63 words/s
[2019-07-14 19:52:57] Ep. 32 : Up. 448000 : Sen. 3,106,999 : Cost 38.27485275 : Time 838.03s : 8144.83 words/s
[2019-07-14 20:07:02] Ep. 32 : Up. 450000 : Sen. 3,428,640 : Cost 38.65536880 : Time 845.27s : 8160.23 words/s
[2019-07-14 20:21:02] Ep. 32 : Up. 452000 : Sen. 3,749,698 : Cost 38.25957870 : Time 839.40s : 8143.09 words/s
[2019-07-14 20:35:03] Ep. 32 : Up. 454000 : Sen. 4,069,286 : Cost 38.45428467 : Time 841.02s : 8122.63 words/s
[2019-07-14 20:48:42] Seen 4381942 samples
[2019-07-14 20:48:42] Starting epoch 33
[2019-07-14 20:48:42] [data] Shuffling data
[2019-07-14 20:48:45] [data] Done reading 5196149 sentences
[2019-07-14 20:49:13] [data] Done shuffling 5196149 sentences to temp files
[2019-07-14 20:49:36] Ep. 33 : Up. 456000 : Sen. 8,651 : Cost 38.31231689 : Time 873.45s : 7846.65 words/s
[2019-07-14 21:03:42] Ep. 33 : Up. 458000 : Sen. 330,776 : Cost 37.37776184 : Time 846.19s : 8120.25 words/s
[2019-07-14 21:17:43] Ep. 33 : Up. 460000 : Sen. 650,475 : Cost 37.68761826 : Time 840.62s : 8132.57 words/s
[2019-07-14 21:17:43] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 21:17:52] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter460000.npz
[2019-07-14 21:17:59] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 21:18:09] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 21:18:33] [valid] Ep. 33 : Up. 460000 : cross-entropy : 48.1178 : stalled 1 times (last best: 48.087)
[2019-07-14 21:18:41] [valid] Ep. 33 : Up. 460000 : perplexity : 6.68491 : stalled 1 times (last best: 6.67679)
[2019-07-14 21:19:52] [valid] Ep. 33 : Up. 460000 : translation : 30.36 : stalled 4 times (last best: 30.38)
[2019-07-14 21:33:58] Ep. 33 : Up. 462000 : Sen. 970,931 : Cost 37.84178925 : Time 974.81s : 7028.48 words/s
[2019-07-14 21:48:01] Ep. 33 : Up. 464000 : Sen. 1,292,000 : Cost 37.87734222 : Time 842.91s : 8117.87 words/s
[2019-07-14 22:02:05] Ep. 33 : Up. 466000 : Sen. 1,614,226 : Cost 37.96382523 : Time 844.33s : 8128.56 words/s
[2019-07-14 22:16:08] Ep. 33 : Up. 468000 : Sen. 1,935,196 : Cost 37.80584335 : Time 842.70s : 8122.24 words/s
[2019-07-14 22:30:14] Ep. 33 : Up. 470000 : Sen. 2,257,409 : Cost 38.17566681 : Time 846.80s : 8124.21 words/s
[2019-07-14 22:44:20] Ep. 33 : Up. 472000 : Sen. 2,578,998 : Cost 38.23273087 : Time 845.79s : 8120.36 words/s
[2019-07-14 22:58:24] Ep. 33 : Up. 474000 : Sen. 2,899,860 : Cost 38.15869522 : Time 844.13s : 8120.13 words/s
[2019-07-14 23:12:30] Ep. 33 : Up. 476000 : Sen. 3,221,536 : Cost 38.06996536 : Time 845.64s : 8108.26 words/s
[2019-07-14 23:26:35] Ep. 33 : Up. 478000 : Sen. 3,543,963 : Cost 38.22824097 : Time 845.18s : 8138.58 words/s
[2019-07-14 23:40:36] Ep. 33 : Up. 480000 : Sen. 3,863,467 : Cost 38.02465820 : Time 840.48s : 8090.16 words/s
[2019-07-14 23:40:36] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-14 23:40:45] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter480000.npz
[2019-07-14 23:40:52] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-14 23:41:02] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-14 23:41:27] [valid] Ep. 33 : Up. 480000 : cross-entropy : 48.1893 : stalled 2 times (last best: 48.087)
[2019-07-14 23:41:35] [valid] Ep. 33 : Up. 480000 : perplexity : 6.7038 : stalled 2 times (last best: 6.67679)
[2019-07-14 23:42:15] Error: Unknown word id: 49992
[2019-07-14 23:42:15] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f3986ab3a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f39865d3c80]                                                       + 0xb8c80
[0x7f3986aac6ba]                                                       + 0x76ba
[0x7f3985d3941d]    clone                                              + 0x6d

[2019-07-15 14:27:57] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-15 14:27:57] [marian] Running on hodor as process 62645 with command line:
[2019-07-15 14:27:57] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 1 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-15 14:27:57] [config] after-batches: 0
[2019-07-15 14:27:57] [config] after-epochs: 0
[2019-07-15 14:27:57] [config] allow-unk: false
[2019-07-15 14:27:57] [config] beam-size: 12
[2019-07-15 14:27:57] [config] bert-class-symbol: "[CLS]"
[2019-07-15 14:27:57] [config] bert-mask-symbol: "[MASK]"
[2019-07-15 14:27:57] [config] bert-masking-fraction: 0.15
[2019-07-15 14:27:57] [config] bert-sep-symbol: "[SEP]"
[2019-07-15 14:27:57] [config] bert-train-type-embeddings: true
[2019-07-15 14:27:57] [config] bert-type-vocab-size: 2
[2019-07-15 14:27:57] [config] best-deep: false
[2019-07-15 14:27:57] [config] clip-gemm: 0
[2019-07-15 14:27:57] [config] clip-norm: 1
[2019-07-15 14:27:57] [config] cost-type: ce-mean
[2019-07-15 14:27:57] [config] cpu-threads: 0
[2019-07-15 14:27:57] [config] data-weighting: ""
[2019-07-15 14:27:57] [config] data-weighting-type: sentence
[2019-07-15 14:27:57] [config] dec-cell: gru
[2019-07-15 14:27:57] [config] dec-cell-base-depth: 2
[2019-07-15 14:27:57] [config] dec-cell-high-depth: 1
[2019-07-15 14:27:57] [config] dec-depth: 1
[2019-07-15 14:27:57] [config] devices:
[2019-07-15 14:27:57] [config]   - 1
[2019-07-15 14:27:57] [config] dim-emb: 512
[2019-07-15 14:27:57] [config] dim-rnn: 1024
[2019-07-15 14:27:57] [config] dim-vocabs:
[2019-07-15 14:27:57] [config]   - 50000
[2019-07-15 14:27:57] [config]   - 50000
[2019-07-15 14:27:57] [config] disp-first: 0
[2019-07-15 14:27:57] [config] disp-freq: 2000
[2019-07-15 14:27:57] [config] disp-label-counts: false
[2019-07-15 14:27:57] [config] dropout-rnn: 0.2
[2019-07-15 14:27:57] [config] dropout-src: 0.1
[2019-07-15 14:27:57] [config] dropout-trg: 0.1
[2019-07-15 14:27:57] [config] dump-config: ""
[2019-07-15 14:27:57] [config] early-stopping: 5
[2019-07-15 14:27:57] [config] embedding-fix-src: false
[2019-07-15 14:27:57] [config] embedding-fix-trg: false
[2019-07-15 14:27:57] [config] embedding-normalization: false
[2019-07-15 14:27:57] [config] embedding-vectors:
[2019-07-15 14:27:57] [config]   []
[2019-07-15 14:27:57] [config] enc-cell: gru
[2019-07-15 14:27:57] [config] enc-cell-depth: 1
[2019-07-15 14:27:57] [config] enc-depth: 1
[2019-07-15 14:27:57] [config] enc-type: bidirectional
[2019-07-15 14:27:57] [config] exponential-smoothing: 0.0001
[2019-07-15 14:27:57] [config] grad-dropping-momentum: 0
[2019-07-15 14:27:57] [config] grad-dropping-rate: 0
[2019-07-15 14:27:57] [config] grad-dropping-warmup: 100
[2019-07-15 14:27:57] [config] guided-alignment: none
[2019-07-15 14:27:57] [config] guided-alignment-cost: mse
[2019-07-15 14:27:57] [config] guided-alignment-weight: 0.1
[2019-07-15 14:27:57] [config] ignore-model-config: false
[2019-07-15 14:27:57] [config] input-types:
[2019-07-15 14:27:57] [config]   []
[2019-07-15 14:27:57] [config] interpolate-env-vars: false
[2019-07-15 14:27:57] [config] keep-best: false
[2019-07-15 14:27:57] [config] label-smoothing: 0
[2019-07-15 14:27:57] [config] layer-normalization: true
[2019-07-15 14:27:57] [config] learn-rate: 0.0001
[2019-07-15 14:27:57] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-15 14:27:57] [config] log-level: info
[2019-07-15 14:27:57] [config] log-time-zone: ""
[2019-07-15 14:27:57] [config] lr-decay: 0
[2019-07-15 14:27:57] [config] lr-decay-freq: 50000
[2019-07-15 14:27:57] [config] lr-decay-inv-sqrt:
[2019-07-15 14:27:57] [config]   - 0
[2019-07-15 14:27:57] [config] lr-decay-repeat-warmup: false
[2019-07-15 14:27:57] [config] lr-decay-reset-optimizer: false
[2019-07-15 14:27:57] [config] lr-decay-start:
[2019-07-15 14:27:57] [config]   - 10
[2019-07-15 14:27:57] [config]   - 1
[2019-07-15 14:27:57] [config] lr-decay-strategy: epoch+stalled
[2019-07-15 14:27:57] [config] lr-report: false
[2019-07-15 14:27:57] [config] lr-warmup: 0
[2019-07-15 14:27:57] [config] lr-warmup-at-reload: false
[2019-07-15 14:27:57] [config] lr-warmup-cycle: false
[2019-07-15 14:27:57] [config] lr-warmup-start-rate: 0
[2019-07-15 14:27:57] [config] max-length: 50
[2019-07-15 14:27:57] [config] max-length-crop: false
[2019-07-15 14:27:57] [config] max-length-factor: 3
[2019-07-15 14:27:57] [config] maxi-batch: 100
[2019-07-15 14:27:57] [config] maxi-batch-sort: trg
[2019-07-15 14:27:57] [config] mini-batch: 64
[2019-07-15 14:27:57] [config] mini-batch-fit: true
[2019-07-15 14:27:57] [config] mini-batch-fit-step: 10
[2019-07-15 14:27:57] [config] mini-batch-overstuff: 1
[2019-07-15 14:27:57] [config] mini-batch-track-lr: false
[2019-07-15 14:27:57] [config] mini-batch-understuff: 1
[2019-07-15 14:27:57] [config] mini-batch-warmup: 0
[2019-07-15 14:27:57] [config] mini-batch-words: 0
[2019-07-15 14:27:57] [config] mini-batch-words-ref: 0
[2019-07-15 14:27:57] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-15 14:27:57] [config] multi-loss-type: sum
[2019-07-15 14:27:57] [config] multi-node: false
[2019-07-15 14:27:57] [config] multi-node-overlap: true
[2019-07-15 14:27:57] [config] n-best: false
[2019-07-15 14:27:57] [config] no-nccl: false
[2019-07-15 14:27:57] [config] no-reload: false
[2019-07-15 14:27:57] [config] no-restore-corpus: false
[2019-07-15 14:27:57] [config] no-shuffle: false
[2019-07-15 14:27:57] [config] normalize: 1
[2019-07-15 14:27:57] [config] num-devices: 0
[2019-07-15 14:27:57] [config] optimizer: adam
[2019-07-15 14:27:57] [config] optimizer-delay: 1
[2019-07-15 14:27:57] [config] optimizer-params:
[2019-07-15 14:27:57] [config]   []
[2019-07-15 14:27:57] [config] overwrite: false
[2019-07-15 14:27:57] [config] pretrained-model: ""
[2019-07-15 14:27:57] [config] quiet: false
[2019-07-15 14:27:57] [config] quiet-translation: true
[2019-07-15 14:27:57] [config] relative-paths: false
[2019-07-15 14:27:57] [config] right-left: false
[2019-07-15 14:27:57] [config] save-freq: 20000
[2019-07-15 14:27:57] [config] seed: 1111
[2019-07-15 14:27:57] [config] shuffle-in-ram: false
[2019-07-15 14:27:57] [config] skip: false
[2019-07-15 14:27:57] [config] sqlite: ""
[2019-07-15 14:27:57] [config] sqlite-drop: false
[2019-07-15 14:27:57] [config] sync-sgd: true
[2019-07-15 14:27:57] [config] tempdir: .
[2019-07-15 14:27:57] [config] tied-embeddings: false
[2019-07-15 14:27:57] [config] tied-embeddings-all: false
[2019-07-15 14:27:57] [config] tied-embeddings-src: false
[2019-07-15 14:27:57] [config] train-sets:
[2019-07-15 14:27:57] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-15 14:27:57] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-15 14:27:57] [config] transformer-aan-activation: swish
[2019-07-15 14:27:57] [config] transformer-aan-depth: 2
[2019-07-15 14:27:57] [config] transformer-aan-nogate: false
[2019-07-15 14:27:57] [config] transformer-decoder-autoreg: self-attention
[2019-07-15 14:27:57] [config] transformer-dim-aan: 2048
[2019-07-15 14:27:57] [config] transformer-dim-ffn: 2048
[2019-07-15 14:27:57] [config] transformer-dropout: 0
[2019-07-15 14:27:57] [config] transformer-dropout-attention: 0
[2019-07-15 14:27:57] [config] transformer-dropout-ffn: 0
[2019-07-15 14:27:57] [config] transformer-ffn-activation: swish
[2019-07-15 14:27:57] [config] transformer-ffn-depth: 2
[2019-07-15 14:27:57] [config] transformer-guided-alignment-layer: last
[2019-07-15 14:27:57] [config] transformer-heads: 8
[2019-07-15 14:27:57] [config] transformer-no-projection: false
[2019-07-15 14:27:57] [config] transformer-postprocess: dan
[2019-07-15 14:27:57] [config] transformer-postprocess-emb: d
[2019-07-15 14:27:57] [config] transformer-preprocess: ""
[2019-07-15 14:27:57] [config] transformer-tied-layers:
[2019-07-15 14:27:57] [config]   []
[2019-07-15 14:27:57] [config] transformer-train-position-embeddings: false
[2019-07-15 14:27:57] [config] type: amun
[2019-07-15 14:27:57] [config] ulr: false
[2019-07-15 14:27:57] [config] ulr-dim-emb: 0
[2019-07-15 14:27:57] [config] ulr-dropout: 0
[2019-07-15 14:27:57] [config] ulr-keys-vectors: ""
[2019-07-15 14:27:57] [config] ulr-query-vectors: ""
[2019-07-15 14:27:57] [config] ulr-softmax-temperature: 1
[2019-07-15 14:27:57] [config] ulr-trainable-transformation: false
[2019-07-15 14:27:57] [config] valid-freq: 20000
[2019-07-15 14:27:57] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-15 14:27:57] [config] valid-max-length: 1000
[2019-07-15 14:27:57] [config] valid-metrics:
[2019-07-15 14:27:57] [config]   - cross-entropy
[2019-07-15 14:27:57] [config]   - perplexity
[2019-07-15 14:27:57] [config]   - translation
[2019-07-15 14:27:57] [config] valid-mini-batch: 8
[2019-07-15 14:27:57] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-15 14:27:57] [config] valid-sets:
[2019-07-15 14:27:57] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-15 14:27:57] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-15 14:27:57] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-15 14:27:57] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-15 14:27:57] [config] vocabs:
[2019-07-15 14:27:57] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-15 14:27:57] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-15 14:27:57] [config] word-penalty: 0
[2019-07-15 14:27:57] [config] workspace: 5000
[2019-07-15 14:27:57] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-15 14:27:57] Using synchronous training
[2019-07-15 14:27:57] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-15 14:27:57] [data] Using unused word id eos for 0
[2019-07-15 14:27:57] [data] Using unused word id UNK for 1
[2019-07-15 14:27:57] [data] Setting vocabulary size for input 0 to 50000
[2019-07-15 14:27:57] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-15 14:27:58] [data] Using unused word id eos for 0
[2019-07-15 14:27:58] [data] Using unused word id UNK for 1
[2019-07-15 14:27:58] [data] Setting vocabulary size for input 1 to 50000
[2019-07-15 14:27:58] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-15 14:27:58] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-15 14:27:58] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-15 14:27:59] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-15 14:27:59] [comm] NCCLCommunicator constructed successfully.
[2019-07-15 14:27:59] [training] Using 1 GPUs
[2019-07-15 14:27:59] [memory] Reserving 422 MB, device gpu1
[2019-07-15 14:27:59] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-15 14:27:59] [memory] Reserving 422 MB, device gpu1
[2019-07-15 14:28:07] [batching] Done. Typical MB size is 6880 target words
[2019-07-15 14:28:07] [memory] Extending reserved space to 5120 MB (device gpu1)
[2019-07-15 14:28:07] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-15 14:28:07] [comm] NCCLCommunicator constructed successfully.
[2019-07-15 14:28:07] [training] Using 1 GPUs
[2019-07-15 14:28:08] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-15 14:28:14] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-15 14:28:24] [memory] Reserving 844 MB, device gpu1
[2019-07-15 14:28:25] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-15 14:28:25] [data] Restoring the corpus state to epoch 33, batch 480000
[2019-07-15 14:28:25] [data] Shuffling data
[2019-07-15 14:28:28] [data] Done reading 5196149 sentences
[2019-07-15 14:28:48] [data] Done shuffling 5196149 sentences to temp files
[2019-07-15 14:30:37] Training started
[2019-07-15 14:30:37] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-15 14:30:37] [memory] Reserving 422 MB, device gpu1
[2019-07-15 14:30:37] [memory] Reserving 422 MB, device gpu1
[2019-07-15 14:30:37] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-15 14:30:44] [memory] Reserving 422 MB, device cpu0
[2019-07-15 14:30:44] [memory] Reserving 422 MB, device gpu1
[2019-07-15 14:44:35] Ep. 33 : Up. 482000 : Sen. 4,185,600 : Cost 38.37812805 : Time 997.75s : 6890.70 words/s
[2019-07-15 14:53:05] Seen 4381942 samples
[2019-07-15 14:53:05] Starting epoch 34
[2019-07-15 14:53:05] [data] Shuffling data
[2019-07-15 14:53:08] [data] Done reading 5196149 sentences
[2019-07-15 14:53:37] [data] Done shuffling 5196149 sentences to temp files
[2019-07-15 14:59:03] Ep. 34 : Up. 484000 : Sen. 124,831 : Cost 37.77676392 : Time 867.70s : 7890.60 words/s
[2019-07-15 15:12:56] Ep. 34 : Up. 486000 : Sen. 445,483 : Cost 37.38051605 : Time 832.68s : 8207.74 words/s
[2019-07-15 15:26:51] Ep. 34 : Up. 488000 : Sen. 765,361 : Cost 37.53093719 : Time 834.94s : 8179.86 words/s
[2019-07-15 15:40:50] Ep. 34 : Up. 490000 : Sen. 1,088,000 : Cost 37.54051208 : Time 839.62s : 8212.84 words/s
[2019-07-15 15:54:43] Ep. 34 : Up. 492000 : Sen. 1,409,291 : Cost 37.68980408 : Time 832.80s : 8223.80 words/s
[2019-07-15 16:08:40] Ep. 34 : Up. 494000 : Sen. 1,729,589 : Cost 37.60927200 : Time 836.82s : 8161.75 words/s
[2019-07-15 16:22:36] Ep. 34 : Up. 496000 : Sen. 2,052,460 : Cost 37.80572510 : Time 836.46s : 8226.35 words/s
[2019-07-15 16:36:36] Ep. 34 : Up. 498000 : Sen. 2,373,217 : Cost 38.20385742 : Time 839.08s : 8188.47 words/s
[2019-07-15 16:50:30] Ep. 34 : Up. 500000 : Sen. 2,694,226 : Cost 37.92574692 : Time 834.84s : 8195.15 words/s
[2019-07-15 16:50:30] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-15 16:50:40] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter500000.npz
[2019-07-15 16:50:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-15 16:50:58] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-15 16:51:23] [valid] Ep. 34 : Up. 500000 : cross-entropy : 48.2662 : stalled 2 times (last best: 48.087)
[2019-07-15 16:51:31] [valid] Ep. 34 : Up. 500000 : perplexity : 6.7242 : stalled 2 times (last best: 6.67679)
[2019-07-15 16:52:10] Error: Unknown word id: 49992
[2019-07-15 16:52:10] Error: Aborted from virtual const string& marian::DefaultVocab::operator[](marian::Word) const in /fs/bil0/abdel/marian-dev/src/data/default_vocab.cpp:76

[CALL STACK]
[0x70f3a4]          marian::DefaultVocab::operator[][abi:  cxx11]  (unsigned int) const + 0x234
[0x7053da]          marian::DefaultVocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0xba
[0x701874]          marian::Vocab::decode[abi:  cxx11]  (std::vector<unsigned int,std::allocator<unsigned int>> const&,  bool) const + 0x24
[0x5e16e1]          void marian::OutputPrinter::  print  <std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>>(std::shared_ptr<marian::History>,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&,  std::__cxx11::basic_stringstream<char,std::char_traits<char>,std::allocator<char>>&) + 0x5e1
[0x979c3f]          marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}::  operator()  (unsigned long) const + 0x2cf
[0x97a2d9]          std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}::  operator()  () const + 0x29
[0x97acdc]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<void>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1}> ()>,void>>::  _M_invoke [0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f93f9b74a99]                                                       + 0xea99
[0x96d04f]          std::__future_base::_Task_state<std::future<std::result_of<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}& (unsigned long&)>::type> marian::ThreadPool::enqueue<marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&,unsigned long&>(std::result_of&&,(marian::TranslationValidator::validate(std::vector<std::shared_ptr<marian::ExpressionGraph>,std::allocator<std::shared_ptr<marian::ExpressionGraph>>> const&)::{lambda(unsigned long)#1}&)...)::{lambda()#1},std::allocator<int>,void ()>::  _M_run  () + 0xcf
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f93f9694c80]                                                       + 0xb8c80
[0x7f93f9b6d6ba]                                                       + 0x76ba
[0x7f93f8dfa41d]    clone                                              + 0x6d

[2019-07-16 09:56:18] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 09:56:18] [marian] Running on fulla as process 22505 with command line:
[2019-07-16 09:56:18] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz -T . --devices 4 --train-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en --vocabs ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out --valid-script-path ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log --valid-log ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-16 09:56:18] [config] after-batches: 0
[2019-07-16 09:56:18] [config] after-epochs: 0
[2019-07-16 09:56:18] [config] allow-unk: false
[2019-07-16 09:56:18] [config] beam-size: 12
[2019-07-16 09:56:18] [config] bert-class-symbol: "[CLS]"
[2019-07-16 09:56:18] [config] bert-mask-symbol: "[MASK]"
[2019-07-16 09:56:18] [config] bert-masking-fraction: 0.15
[2019-07-16 09:56:18] [config] bert-sep-symbol: "[SEP]"
[2019-07-16 09:56:18] [config] bert-train-type-embeddings: true
[2019-07-16 09:56:18] [config] bert-type-vocab-size: 2
[2019-07-16 09:56:18] [config] best-deep: false
[2019-07-16 09:56:18] [config] clip-gemm: 0
[2019-07-16 09:56:18] [config] clip-norm: 1
[2019-07-16 09:56:18] [config] cost-type: ce-mean
[2019-07-16 09:56:18] [config] cpu-threads: 0
[2019-07-16 09:56:18] [config] data-weighting: ""
[2019-07-16 09:56:18] [config] data-weighting-type: sentence
[2019-07-16 09:56:18] [config] dec-cell: gru
[2019-07-16 09:56:18] [config] dec-cell-base-depth: 2
[2019-07-16 09:56:18] [config] dec-cell-high-depth: 1
[2019-07-16 09:56:18] [config] dec-depth: 1
[2019-07-16 09:56:18] [config] devices:
[2019-07-16 09:56:18] [config]   - 4
[2019-07-16 09:56:18] [config] dim-emb: 512
[2019-07-16 09:56:18] [config] dim-rnn: 1024
[2019-07-16 09:56:18] [config] dim-vocabs:
[2019-07-16 09:56:18] [config]   - 50000
[2019-07-16 09:56:18] [config]   - 50000
[2019-07-16 09:56:18] [config] disp-first: 0
[2019-07-16 09:56:18] [config] disp-freq: 2000
[2019-07-16 09:56:18] [config] disp-label-counts: false
[2019-07-16 09:56:18] [config] dropout-rnn: 0.2
[2019-07-16 09:56:18] [config] dropout-src: 0.1
[2019-07-16 09:56:18] [config] dropout-trg: 0.1
[2019-07-16 09:56:18] [config] dump-config: ""
[2019-07-16 09:56:18] [config] early-stopping: 5
[2019-07-16 09:56:18] [config] embedding-fix-src: false
[2019-07-16 09:56:18] [config] embedding-fix-trg: false
[2019-07-16 09:56:18] [config] embedding-normalization: false
[2019-07-16 09:56:18] [config] embedding-vectors:
[2019-07-16 09:56:18] [config]   []
[2019-07-16 09:56:18] [config] enc-cell: gru
[2019-07-16 09:56:18] [config] enc-cell-depth: 1
[2019-07-16 09:56:18] [config] enc-depth: 1
[2019-07-16 09:56:18] [config] enc-type: bidirectional
[2019-07-16 09:56:18] [config] exponential-smoothing: 0.0001
[2019-07-16 09:56:18] [config] grad-dropping-momentum: 0
[2019-07-16 09:56:18] [config] grad-dropping-rate: 0
[2019-07-16 09:56:18] [config] grad-dropping-warmup: 100
[2019-07-16 09:56:18] [config] guided-alignment: none
[2019-07-16 09:56:18] [config] guided-alignment-cost: mse
[2019-07-16 09:56:18] [config] guided-alignment-weight: 0.1
[2019-07-16 09:56:18] [config] ignore-model-config: false
[2019-07-16 09:56:18] [config] input-types:
[2019-07-16 09:56:18] [config]   []
[2019-07-16 09:56:18] [config] interpolate-env-vars: false
[2019-07-16 09:56:18] [config] keep-best: false
[2019-07-16 09:56:18] [config] label-smoothing: 0
[2019-07-16 09:56:18] [config] layer-normalization: true
[2019-07-16 09:56:18] [config] learn-rate: 0.0001
[2019-07-16 09:56:18] [config] log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/train.log
[2019-07-16 09:56:18] [config] log-level: info
[2019-07-16 09:56:18] [config] log-time-zone: ""
[2019-07-16 09:56:18] [config] lr-decay: 0
[2019-07-16 09:56:18] [config] lr-decay-freq: 50000
[2019-07-16 09:56:18] [config] lr-decay-inv-sqrt:
[2019-07-16 09:56:18] [config]   - 0
[2019-07-16 09:56:18] [config] lr-decay-repeat-warmup: false
[2019-07-16 09:56:18] [config] lr-decay-reset-optimizer: false
[2019-07-16 09:56:18] [config] lr-decay-start:
[2019-07-16 09:56:18] [config]   - 10
[2019-07-16 09:56:18] [config]   - 1
[2019-07-16 09:56:18] [config] lr-decay-strategy: epoch+stalled
[2019-07-16 09:56:18] [config] lr-report: false
[2019-07-16 09:56:18] [config] lr-warmup: 0
[2019-07-16 09:56:18] [config] lr-warmup-at-reload: false
[2019-07-16 09:56:18] [config] lr-warmup-cycle: false
[2019-07-16 09:56:18] [config] lr-warmup-start-rate: 0
[2019-07-16 09:56:18] [config] max-length: 50
[2019-07-16 09:56:18] [config] max-length-crop: false
[2019-07-16 09:56:18] [config] max-length-factor: 3
[2019-07-16 09:56:18] [config] maxi-batch: 100
[2019-07-16 09:56:18] [config] maxi-batch-sort: trg
[2019-07-16 09:56:18] [config] mini-batch: 64
[2019-07-16 09:56:18] [config] mini-batch-fit: true
[2019-07-16 09:56:18] [config] mini-batch-fit-step: 10
[2019-07-16 09:56:18] [config] mini-batch-overstuff: 1
[2019-07-16 09:56:18] [config] mini-batch-track-lr: false
[2019-07-16 09:56:18] [config] mini-batch-understuff: 1
[2019-07-16 09:56:18] [config] mini-batch-warmup: 0
[2019-07-16 09:56:18] [config] mini-batch-words: 0
[2019-07-16 09:56:18] [config] mini-batch-words-ref: 0
[2019-07-16 09:56:18] [config] model: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 09:56:18] [config] multi-loss-type: sum
[2019-07-16 09:56:18] [config] multi-node: false
[2019-07-16 09:56:18] [config] multi-node-overlap: true
[2019-07-16 09:56:18] [config] n-best: false
[2019-07-16 09:56:18] [config] no-nccl: false
[2019-07-16 09:56:18] [config] no-reload: false
[2019-07-16 09:56:18] [config] no-restore-corpus: false
[2019-07-16 09:56:18] [config] no-shuffle: false
[2019-07-16 09:56:18] [config] normalize: 1
[2019-07-16 09:56:18] [config] num-devices: 0
[2019-07-16 09:56:18] [config] optimizer: adam
[2019-07-16 09:56:18] [config] optimizer-delay: 1
[2019-07-16 09:56:18] [config] optimizer-params:
[2019-07-16 09:56:18] [config]   []
[2019-07-16 09:56:18] [config] overwrite: false
[2019-07-16 09:56:18] [config] pretrained-model: ""
[2019-07-16 09:56:18] [config] quiet: false
[2019-07-16 09:56:18] [config] quiet-translation: true
[2019-07-16 09:56:18] [config] relative-paths: false
[2019-07-16 09:56:18] [config] right-left: false
[2019-07-16 09:56:18] [config] save-freq: 20000
[2019-07-16 09:56:18] [config] seed: 1111
[2019-07-16 09:56:18] [config] shuffle-in-ram: false
[2019-07-16 09:56:18] [config] skip: false
[2019-07-16 09:56:18] [config] sqlite: ""
[2019-07-16 09:56:18] [config] sqlite-drop: false
[2019-07-16 09:56:18] [config] sync-sgd: true
[2019-07-16 09:56:18] [config] tempdir: .
[2019-07-16 09:56:18] [config] tied-embeddings: false
[2019-07-16 09:56:18] [config] tied-embeddings-all: false
[2019-07-16 09:56:18] [config] tied-embeddings-src: false
[2019-07-16 09:56:18] [config] train-sets:
[2019-07-16 09:56:18] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de
[2019-07-16 09:56:18] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en
[2019-07-16 09:56:18] [config] transformer-aan-activation: swish
[2019-07-16 09:56:18] [config] transformer-aan-depth: 2
[2019-07-16 09:56:18] [config] transformer-aan-nogate: false
[2019-07-16 09:56:18] [config] transformer-decoder-autoreg: self-attention
[2019-07-16 09:56:18] [config] transformer-dim-aan: 2048
[2019-07-16 09:56:18] [config] transformer-dim-ffn: 2048
[2019-07-16 09:56:18] [config] transformer-dropout: 0
[2019-07-16 09:56:18] [config] transformer-dropout-attention: 0
[2019-07-16 09:56:18] [config] transformer-dropout-ffn: 0
[2019-07-16 09:56:18] [config] transformer-ffn-activation: swish
[2019-07-16 09:56:18] [config] transformer-ffn-depth: 2
[2019-07-16 09:56:18] [config] transformer-guided-alignment-layer: last
[2019-07-16 09:56:18] [config] transformer-heads: 8
[2019-07-16 09:56:18] [config] transformer-no-projection: false
[2019-07-16 09:56:18] [config] transformer-postprocess: dan
[2019-07-16 09:56:18] [config] transformer-postprocess-emb: d
[2019-07-16 09:56:18] [config] transformer-preprocess: ""
[2019-07-16 09:56:18] [config] transformer-tied-layers:
[2019-07-16 09:56:18] [config]   []
[2019-07-16 09:56:18] [config] transformer-train-position-embeddings: false
[2019-07-16 09:56:18] [config] type: amun
[2019-07-16 09:56:18] [config] ulr: false
[2019-07-16 09:56:18] [config] ulr-dim-emb: 0
[2019-07-16 09:56:18] [config] ulr-dropout: 0
[2019-07-16 09:56:18] [config] ulr-keys-vectors: ""
[2019-07-16 09:56:18] [config] ulr-query-vectors: ""
[2019-07-16 09:56:18] [config] ulr-softmax-temperature: 1
[2019-07-16 09:56:18] [config] ulr-trainable-transformation: false
[2019-07-16 09:56:18] [config] valid-freq: 20000
[2019-07-16 09:56:18] [config] valid-log: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/valid.log
[2019-07-16 09:56:18] [config] valid-max-length: 1000
[2019-07-16 09:56:18] [config] valid-metrics:
[2019-07-16 09:56:18] [config]   - cross-entropy
[2019-07-16 09:56:18] [config]   - perplexity
[2019-07-16 09:56:18] [config]   - translation
[2019-07-16 09:56:18] [config] valid-mini-batch: 8
[2019-07-16 09:56:18] [config] valid-script-path: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/score-dev.sh
[2019-07-16 09:56:18] [config] valid-sets:
[2019-07-16 09:56:18] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.de
[2019-07-16 09:56:18] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/dev.bpe.en
[2019-07-16 09:56:18] [config] valid-translation-output: ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/dev.out
[2019-07-16 09:56:18] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 09:56:18] [config] vocabs:
[2019-07-16 09:56:18] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-16 09:56:18] [config]   - ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-16 09:56:18] [config] word-penalty: 0
[2019-07-16 09:56:18] [config] workspace: 5000
[2019-07-16 09:56:18] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-16 09:56:18] Using synchronous training
[2019-07-16 09:56:18] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.de.json
[2019-07-16 09:56:19] [data] Using unused word id eos for 0
[2019-07-16 09:56:19] [data] Using unused word id UNK for 1
[2019-07-16 09:56:19] [data] Setting vocabulary size for input 0 to 50000
[2019-07-16 09:56:19] [data] Loading vocabulary from JSON/Yaml file ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/data/train.bpe.en.json
[2019-07-16 09:56:19] [data] Using unused word id eos for 0
[2019-07-16 09:56:19] [data] Using unused word id UNK for 1
[2019-07-16 09:56:19] [data] Setting vocabulary size for input 1 to 50000
[2019-07-16 09:56:19] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-16 09:56:19] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-16 09:56:21] [memory] Extending reserved space to 5120 MB (device gpu4)
[2019-07-16 09:56:21] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 09:56:21] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 09:56:21] [training] Using 1 GPUs
[2019-07-16 09:56:21] [memory] Reserving 422 MB, device gpu4
[2019-07-16 09:56:21] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-16 09:56:21] [memory] Reserving 422 MB, device gpu4
[2019-07-16 09:56:25] [batching] Done. Typical MB size is 6880 target words
[2019-07-16 09:56:26] [memory] Extending reserved space to 5120 MB (device gpu4)
[2019-07-16 09:56:26] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-16 09:56:26] [comm] NCCLCommunicator constructed successfully.
[2019-07-16 09:56:26] [training] Using 1 GPUs
[2019-07-16 09:56:26] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-16 09:56:34] Loading Adam parameters from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-16 09:56:46] [memory] Reserving 844 MB, device gpu4
[2019-07-16 09:56:47] [training] Model reloaded from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 09:56:47] [data] Restoring the corpus state to epoch 34, batch 500000
[2019-07-16 09:56:47] [data] Shuffling data
[2019-07-16 09:57:01] [data] Done reading 5196149 sentences
[2019-07-16 09:57:29] [data] Done shuffling 5196149 sentences to temp files
[2019-07-16 09:59:19] Training started
[2019-07-16 09:59:19] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-07-16 09:59:19] [memory] Reserving 422 MB, device gpu4
[2019-07-16 09:59:20] [memory] Reserving 422 MB, device gpu4
[2019-07-16 09:59:20] Loading model from ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 09:59:27] [memory] Reserving 422 MB, device cpu0
[2019-07-16 09:59:27] [memory] Reserving 422 MB, device gpu4
[2019-07-16 10:06:21] Ep. 34 : Up. 502000 : Sen. 3,016,514 : Cost 37.92036438 : Time 602.19s : 11414.82 words/s
[2019-07-16 10:13:15] Ep. 34 : Up. 504000 : Sen. 3,338,149 : Cost 38.00379944 : Time 413.69s : 16591.45 words/s
[2019-07-16 10:20:08] Ep. 34 : Up. 506000 : Sen. 3,658,441 : Cost 38.24193192 : Time 412.55s : 16569.50 words/s
[2019-07-16 10:27:00] Ep. 34 : Up. 508000 : Sen. 3,979,284 : Cost 38.16868591 : Time 412.14s : 16607.97 words/s
[2019-07-16 10:33:52] Ep. 34 : Up. 510000 : Sen. 4,300,140 : Cost 38.14244843 : Time 411.88s : 16600.93 words/s
[2019-07-16 10:35:37] Seen 4381942 samples
[2019-07-16 10:35:37] Starting epoch 35
[2019-07-16 10:35:37] [data] Shuffling data
[2019-07-16 10:35:40] [data] Done reading 5196149 sentences
[2019-07-16 10:36:03] [data] Done shuffling 5196149 sentences to temp files
[2019-07-16 10:41:16] Ep. 35 : Up. 512000 : Sen. 236,800 : Cost 37.59511566 : Time 444.61s : 15304.27 words/s
[2019-07-16 10:48:08] Ep. 35 : Up. 514000 : Sen. 556,362 : Cost 37.47725677 : Time 411.91s : 16559.93 words/s
[2019-07-16 10:55:01] Ep. 35 : Up. 516000 : Sen. 878,047 : Cost 37.32442474 : Time 412.92s : 16604.89 words/s
[2019-07-16 11:01:53] Ep. 35 : Up. 518000 : Sen. 1,198,282 : Cost 37.61685944 : Time 412.09s : 16582.01 words/s
[2019-07-16 11:08:48] Ep. 35 : Up. 520000 : Sen. 1,520,102 : Cost 37.47815704 : Time 414.79s : 16575.99 words/s
[2019-07-16 11:08:48] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-16 11:08:58] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter520000.npz
[2019-07-16 11:09:06] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 11:09:16] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-16 11:09:43] [valid] Ep. 35 : Up. 520000 : cross-entropy : 48.2318 : stalled 2 times (last best: 48.087)
[2019-07-16 11:09:50] [valid] Ep. 35 : Up. 520000 : perplexity : 6.71508 : stalled 2 times (last best: 6.67679)
[2019-07-16 11:10:41] [valid] Ep. 35 : Up. 520000 : translation : 30.37 : stalled 5 times (last best: 30.38)
[2019-07-16 11:17:37] Ep. 35 : Up. 522000 : Sen. 1,840,298 : Cost 37.64676285 : Time 528.76s : 12912.90 words/s
[2019-07-16 11:24:32] Ep. 35 : Up. 524000 : Sen. 2,163,332 : Cost 37.67347336 : Time 415.23s : 16622.29 words/s
[2019-07-16 11:31:26] Ep. 35 : Up. 526000 : Sen. 2,486,005 : Cost 37.82710648 : Time 414.19s : 16607.19 words/s
[2019-07-16 11:38:20] Ep. 35 : Up. 528000 : Sen. 2,807,752 : Cost 37.89897919 : Time 414.11s : 16591.66 words/s
[2019-07-16 11:45:15] Ep. 35 : Up. 530000 : Sen. 3,130,091 : Cost 37.98894119 : Time 414.69s : 16579.13 words/s
[2019-07-16 11:52:07] Ep. 35 : Up. 532000 : Sen. 3,449,600 : Cost 38.19368362 : Time 411.91s : 16546.06 words/s
[2019-07-16 11:59:01] Ep. 35 : Up. 534000 : Sen. 3,772,192 : Cost 38.08728790 : Time 414.06s : 16612.20 words/s
[2019-07-16 12:05:54] Ep. 35 : Up. 536000 : Sen. 4,093,743 : Cost 37.90465164 : Time 412.78s : 16600.94 words/s
[2019-07-16 12:12:04] Seen 4381942 samples
[2019-07-16 12:12:04] Starting epoch 36
[2019-07-16 12:12:04] [data] Shuffling data
[2019-07-16 12:12:08] [data] Done reading 5196149 sentences
[2019-07-16 12:12:35] [data] Done shuffling 5196149 sentences to temp files
[2019-07-16 12:13:26] Ep. 36 : Up. 538000 : Sen. 32,516 : Cost 37.82897186 : Time 452.15s : 15123.84 words/s
[2019-07-16 12:20:20] Ep. 36 : Up. 540000 : Sen. 354,018 : Cost 37.19733810 : Time 414.55s : 16560.92 words/s
[2019-07-16 12:20:20] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-16 12:20:31] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter540000.npz
[2019-07-16 12:20:39] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 12:20:49] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-16 12:21:18] [valid] Ep. 36 : Up. 540000 : cross-entropy : 48.1738 : stalled 3 times (last best: 48.087)
[2019-07-16 12:21:25] [valid] Ep. 36 : Up. 540000 : perplexity : 6.69972 : stalled 3 times (last best: 6.67679)
[2019-07-16 12:22:16] [valid] Ep. 36 : Up. 540000 : translation : 30.4 : new best
[2019-07-16 12:29:09] Ep. 36 : Up. 542000 : Sen. 674,077 : Cost 36.96432114 : Time 528.58s : 12869.51 words/s
[2019-07-16 12:36:03] Ep. 36 : Up. 544000 : Sen. 996,940 : Cost 37.32438278 : Time 414.09s : 16617.62 words/s
[2019-07-16 12:42:57] Ep. 36 : Up. 546000 : Sen. 1,317,524 : Cost 37.58815002 : Time 413.98s : 16534.37 words/s
[2019-07-16 12:49:49] Ep. 36 : Up. 548000 : Sen. 1,637,872 : Cost 37.47956848 : Time 411.65s : 16616.44 words/s
[2019-07-16 12:56:42] Ep. 36 : Up. 550000 : Sen. 1,958,532 : Cost 37.57675552 : Time 412.94s : 16577.90 words/s
[2019-07-16 13:03:37] Ep. 36 : Up. 552000 : Sen. 2,280,360 : Cost 37.69964218 : Time 414.92s : 16576.11 words/s
[2019-07-16 13:10:31] Ep. 36 : Up. 554000 : Sen. 2,602,101 : Cost 37.56105423 : Time 413.98s : 16542.30 words/s
[2019-07-16 13:17:24] Ep. 36 : Up. 556000 : Sen. 2,922,400 : Cost 37.77502823 : Time 413.00s : 16566.63 words/s
[2019-07-16 13:24:16] Ep. 36 : Up. 558000 : Sen. 3,243,958 : Cost 37.82225418 : Time 412.34s : 16646.06 words/s
[2019-07-16 13:31:09] Ep. 36 : Up. 560000 : Sen. 3,565,106 : Cost 37.97879028 : Time 412.71s : 16609.07 words/s
[2019-07-16 13:31:09] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-16 13:31:20] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter560000.npz
[2019-07-16 13:31:28] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 13:31:39] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-16 13:32:07] [valid] Ep. 36 : Up. 560000 : cross-entropy : 48.1945 : stalled 4 times (last best: 48.087)
[2019-07-16 13:32:14] [valid] Ep. 36 : Up. 560000 : perplexity : 6.70518 : stalled 4 times (last best: 6.67679)
[2019-07-16 13:33:05] [valid] Ep. 36 : Up. 560000 : translation : 30.38 : stalled 1 times (last best: 30.4)
[2019-07-16 13:40:03] Ep. 36 : Up. 562000 : Sen. 3,886,414 : Cost 37.91971970 : Time 533.88s : 12847.51 words/s
[2019-07-16 13:46:55] Ep. 36 : Up. 564000 : Sen. 4,207,339 : Cost 37.97848511 : Time 412.45s : 16621.84 words/s
[2019-07-16 13:50:39] Seen 4381942 samples
[2019-07-16 13:50:39] Starting epoch 37
[2019-07-16 13:50:39] [data] Shuffling data
[2019-07-16 13:50:43] [data] Done reading 5196149 sentences
[2019-07-16 13:51:09] [data] Done shuffling 5196149 sentences to temp files
[2019-07-16 13:54:30] Ep. 37 : Up. 566000 : Sen. 147,464 : Cost 37.50136185 : Time 454.59s : 15112.70 words/s
[2019-07-16 14:01:22] Ep. 37 : Up. 568000 : Sen. 467,910 : Cost 36.92805099 : Time 412.31s : 16554.70 words/s
[2019-07-16 14:08:14] Ep. 37 : Up. 570000 : Sen. 787,944 : Cost 37.19116592 : Time 412.56s : 16568.88 words/s
[2019-07-16 14:15:09] Ep. 37 : Up. 572000 : Sen. 1,109,316 : Cost 37.25775909 : Time 414.73s : 16545.55 words/s
[2019-07-16 14:22:02] Ep. 37 : Up. 574000 : Sen. 1,428,905 : Cost 37.31534576 : Time 412.54s : 16554.98 words/s
[2019-07-16 14:28:56] Ep. 37 : Up. 576000 : Sen. 1,751,319 : Cost 37.42688751 : Time 414.62s : 16598.38 words/s
[2019-07-16 14:35:50] Ep. 37 : Up. 578000 : Sen. 2,072,448 : Cost 37.57142639 : Time 413.80s : 16561.74 words/s
[2019-07-16 14:42:46] Ep. 37 : Up. 580000 : Sen. 2,394,302 : Cost 37.61286926 : Time 415.86s : 16497.49 words/s
[2019-07-16 14:42:46] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-16 14:42:56] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.iter580000.npz
[2019-07-16 14:43:04] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 14:43:14] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
[2019-07-16 14:43:41] [valid] Ep. 37 : Up. 580000 : cross-entropy : 48.2758 : stalled 5 times (last best: 48.087)
[2019-07-16 14:43:47] [valid] Ep. 37 : Up. 580000 : perplexity : 6.72676 : stalled 5 times (last best: 6.67679)
[2019-07-16 14:44:39] [valid] Ep. 37 : Up. 580000 : translation : 30.45 : new best
[2019-07-16 14:44:42] Training finished
[2019-07-16 14:44:47] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.orig.npz
[2019-07-16 14:44:58] Saving model to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz
[2019-07-16 14:45:08] Saving Adam parameters to ../experiments/100M_fasttext_prob_x_len_+_dcce_x_ced_0.25/model/model.npz.optimizer.npz
