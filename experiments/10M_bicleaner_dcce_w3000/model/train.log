[2019-07-26 09:42:47] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 09:42:47] [marian] Running on fulla as process 129287 with command line:
[2019-07-26 09:42:47] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_dcce_w3000/model/model.npz -T . --devices 0 1 --train-sets ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_dcce_w3000/model/dev.out --valid-script-path ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_dcce_w3000/model/train.log --valid-log ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 09:42:47] [config] after-batches: 0
[2019-07-26 09:42:47] [config] after-epochs: 0
[2019-07-26 09:42:47] [config] allow-unk: false
[2019-07-26 09:42:47] [config] beam-size: 12
[2019-07-26 09:42:47] [config] bert-class-symbol: "[CLS]"
[2019-07-26 09:42:47] [config] bert-mask-symbol: "[MASK]"
[2019-07-26 09:42:47] [config] bert-masking-fraction: 0.15
[2019-07-26 09:42:47] [config] bert-sep-symbol: "[SEP]"
[2019-07-26 09:42:47] [config] bert-train-type-embeddings: true
[2019-07-26 09:42:47] [config] bert-type-vocab-size: 2
[2019-07-26 09:42:47] [config] best-deep: false
[2019-07-26 09:42:47] [config] clip-gemm: 0
[2019-07-26 09:42:47] [config] clip-norm: 1
[2019-07-26 09:42:47] [config] cost-type: ce-mean
[2019-07-26 09:42:47] [config] cpu-threads: 0
[2019-07-26 09:42:47] [config] data-weighting: ""
[2019-07-26 09:42:47] [config] data-weighting-type: sentence
[2019-07-26 09:42:47] [config] dec-cell: gru
[2019-07-26 09:42:47] [config] dec-cell-base-depth: 2
[2019-07-26 09:42:47] [config] dec-cell-high-depth: 1
[2019-07-26 09:42:47] [config] dec-depth: 1
[2019-07-26 09:42:47] [config] devices:
[2019-07-26 09:42:47] [config]   - 0
[2019-07-26 09:42:47] [config]   - 1
[2019-07-26 09:42:47] [config] dim-emb: 512
[2019-07-26 09:42:47] [config] dim-rnn: 1024
[2019-07-26 09:42:47] [config] dim-vocabs:
[2019-07-26 09:42:47] [config]   - 50000
[2019-07-26 09:42:47] [config]   - 50000
[2019-07-26 09:42:47] [config] disp-first: 0
[2019-07-26 09:42:47] [config] disp-freq: 2000
[2019-07-26 09:42:47] [config] disp-label-counts: false
[2019-07-26 09:42:47] [config] dropout-rnn: 0.2
[2019-07-26 09:42:47] [config] dropout-src: 0.1
[2019-07-26 09:42:47] [config] dropout-trg: 0.1
[2019-07-26 09:42:47] [config] dump-config: ""
[2019-07-26 09:42:47] [config] early-stopping: 5
[2019-07-26 09:42:47] [config] embedding-fix-src: false
[2019-07-26 09:42:47] [config] embedding-fix-trg: false
[2019-07-26 09:42:47] [config] embedding-normalization: false
[2019-07-26 09:42:47] [config] embedding-vectors:
[2019-07-26 09:42:47] [config]   []
[2019-07-26 09:42:47] [config] enc-cell: gru
[2019-07-26 09:42:47] [config] enc-cell-depth: 1
[2019-07-26 09:42:47] [config] enc-depth: 1
[2019-07-26 09:42:47] [config] enc-type: bidirectional
[2019-07-26 09:42:47] [config] exponential-smoothing: 0.0001
[2019-07-26 09:42:47] [config] grad-dropping-momentum: 0
[2019-07-26 09:42:47] [config] grad-dropping-rate: 0
[2019-07-26 09:42:47] [config] grad-dropping-warmup: 100
[2019-07-26 09:42:47] [config] guided-alignment: none
[2019-07-26 09:42:47] [config] guided-alignment-cost: mse
[2019-07-26 09:42:47] [config] guided-alignment-weight: 0.1
[2019-07-26 09:42:47] [config] ignore-model-config: false
[2019-07-26 09:42:47] [config] input-types:
[2019-07-26 09:42:47] [config]   []
[2019-07-26 09:42:47] [config] interpolate-env-vars: false
[2019-07-26 09:42:47] [config] keep-best: false
[2019-07-26 09:42:47] [config] label-smoothing: 0
[2019-07-26 09:42:47] [config] layer-normalization: true
[2019-07-26 09:42:47] [config] learn-rate: 0.0001
[2019-07-26 09:42:47] [config] log: ../experiments/10M_bicleaner_dcce_w3000/model/train.log
[2019-07-26 09:42:47] [config] log-level: info
[2019-07-26 09:42:47] [config] log-time-zone: ""
[2019-07-26 09:42:47] [config] lr-decay: 0
[2019-07-26 09:42:47] [config] lr-decay-freq: 50000
[2019-07-26 09:42:47] [config] lr-decay-inv-sqrt:
[2019-07-26 09:42:47] [config]   - 0
[2019-07-26 09:42:47] [config] lr-decay-repeat-warmup: false
[2019-07-26 09:42:47] [config] lr-decay-reset-optimizer: false
[2019-07-26 09:42:47] [config] lr-decay-start:
[2019-07-26 09:42:47] [config]   - 10
[2019-07-26 09:42:47] [config]   - 1
[2019-07-26 09:42:47] [config] lr-decay-strategy: epoch+stalled
[2019-07-26 09:42:47] [config] lr-report: false
[2019-07-26 09:42:47] [config] lr-warmup: 0
[2019-07-26 09:42:47] [config] lr-warmup-at-reload: false
[2019-07-26 09:42:47] [config] lr-warmup-cycle: false
[2019-07-26 09:42:47] [config] lr-warmup-start-rate: 0
[2019-07-26 09:42:47] [config] max-length: 50
[2019-07-26 09:42:47] [config] max-length-crop: false
[2019-07-26 09:42:47] [config] max-length-factor: 3
[2019-07-26 09:42:47] [config] maxi-batch: 100
[2019-07-26 09:42:47] [config] maxi-batch-sort: trg
[2019-07-26 09:42:47] [config] mini-batch: 64
[2019-07-26 09:42:47] [config] mini-batch-fit: true
[2019-07-26 09:42:47] [config] mini-batch-fit-step: 10
[2019-07-26 09:42:47] [config] mini-batch-overstuff: 1
[2019-07-26 09:42:47] [config] mini-batch-track-lr: false
[2019-07-26 09:42:47] [config] mini-batch-understuff: 1
[2019-07-26 09:42:47] [config] mini-batch-warmup: 0
[2019-07-26 09:42:47] [config] mini-batch-words: 0
[2019-07-26 09:42:47] [config] mini-batch-words-ref: 0
[2019-07-26 09:42:47] [config] model: ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 09:42:47] [config] multi-loss-type: sum
[2019-07-26 09:42:47] [config] multi-node: false
[2019-07-26 09:42:47] [config] multi-node-overlap: true
[2019-07-26 09:42:47] [config] n-best: false
[2019-07-26 09:42:47] [config] no-nccl: false
[2019-07-26 09:42:47] [config] no-reload: false
[2019-07-26 09:42:47] [config] no-restore-corpus: false
[2019-07-26 09:42:47] [config] no-shuffle: false
[2019-07-26 09:42:47] [config] normalize: 1
[2019-07-26 09:42:47] [config] num-devices: 0
[2019-07-26 09:42:47] [config] optimizer: adam
[2019-07-26 09:42:47] [config] optimizer-delay: 1
[2019-07-26 09:42:47] [config] optimizer-params:
[2019-07-26 09:42:47] [config]   []
[2019-07-26 09:42:47] [config] overwrite: false
[2019-07-26 09:42:47] [config] pretrained-model: ""
[2019-07-26 09:42:47] [config] quiet: false
[2019-07-26 09:42:47] [config] quiet-translation: true
[2019-07-26 09:42:47] [config] relative-paths: false
[2019-07-26 09:42:47] [config] right-left: false
[2019-07-26 09:42:47] [config] save-freq: 20000
[2019-07-26 09:42:47] [config] seed: 1111
[2019-07-26 09:42:47] [config] shuffle-in-ram: false
[2019-07-26 09:42:47] [config] skip: false
[2019-07-26 09:42:47] [config] sqlite: ""
[2019-07-26 09:42:47] [config] sqlite-drop: false
[2019-07-26 09:42:47] [config] sync-sgd: true
[2019-07-26 09:42:47] [config] tempdir: .
[2019-07-26 09:42:47] [config] tied-embeddings: false
[2019-07-26 09:42:47] [config] tied-embeddings-all: false
[2019-07-26 09:42:47] [config] tied-embeddings-src: false
[2019-07-26 09:42:47] [config] train-sets:
[2019-07-26 09:42:47] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de
[2019-07-26 09:42:47] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en
[2019-07-26 09:42:47] [config] transformer-aan-activation: swish
[2019-07-26 09:42:47] [config] transformer-aan-depth: 2
[2019-07-26 09:42:47] [config] transformer-aan-nogate: false
[2019-07-26 09:42:47] [config] transformer-decoder-autoreg: self-attention
[2019-07-26 09:42:47] [config] transformer-dim-aan: 2048
[2019-07-26 09:42:47] [config] transformer-dim-ffn: 2048
[2019-07-26 09:42:47] [config] transformer-dropout: 0
[2019-07-26 09:42:47] [config] transformer-dropout-attention: 0
[2019-07-26 09:42:47] [config] transformer-dropout-ffn: 0
[2019-07-26 09:42:47] [config] transformer-ffn-activation: swish
[2019-07-26 09:42:47] [config] transformer-ffn-depth: 2
[2019-07-26 09:42:47] [config] transformer-guided-alignment-layer: last
[2019-07-26 09:42:47] [config] transformer-heads: 8
[2019-07-26 09:42:47] [config] transformer-no-projection: false
[2019-07-26 09:42:47] [config] transformer-postprocess: dan
[2019-07-26 09:42:47] [config] transformer-postprocess-emb: d
[2019-07-26 09:42:47] [config] transformer-preprocess: ""
[2019-07-26 09:42:47] [config] transformer-tied-layers:
[2019-07-26 09:42:47] [config]   []
[2019-07-26 09:42:47] [config] transformer-train-position-embeddings: false
[2019-07-26 09:42:47] [config] type: amun
[2019-07-26 09:42:47] [config] ulr: false
[2019-07-26 09:42:47] [config] ulr-dim-emb: 0
[2019-07-26 09:42:47] [config] ulr-dropout: 0
[2019-07-26 09:42:47] [config] ulr-keys-vectors: ""
[2019-07-26 09:42:47] [config] ulr-query-vectors: ""
[2019-07-26 09:42:47] [config] ulr-softmax-temperature: 1
[2019-07-26 09:42:47] [config] ulr-trainable-transformation: false
[2019-07-26 09:42:47] [config] valid-freq: 20000
[2019-07-26 09:42:47] [config] valid-log: ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 09:42:47] [config] valid-max-length: 1000
[2019-07-26 09:42:47] [config] valid-metrics:
[2019-07-26 09:42:47] [config]   - cross-entropy
[2019-07-26 09:42:47] [config]   - perplexity
[2019-07-26 09:42:47] [config]   - translation
[2019-07-26 09:42:47] [config] valid-mini-batch: 8
[2019-07-26 09:42:47] [config] valid-script-path: ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh
[2019-07-26 09:42:47] [config] valid-sets:
[2019-07-26 09:42:47] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de
[2019-07-26 09:42:47] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en
[2019-07-26 09:42:47] [config] valid-translation-output: ../experiments/10M_bicleaner_dcce_w3000/model/dev.out
[2019-07-26 09:42:47] [config] vocabs:
[2019-07-26 09:42:47] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 09:42:47] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 09:42:47] [config] word-penalty: 0
[2019-07-26 09:42:47] [config] workspace: 5000
[2019-07-26 09:42:47] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 09:42:47] Using synchronous training
[2019-07-26 09:42:47] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 09:42:47] [data] Using unused word id eos for 0
[2019-07-26 09:42:47] [data] Using unused word id UNK for 1
[2019-07-26 09:42:47] [data] Setting vocabulary size for input 0 to 50000
[2019-07-26 09:42:47] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 09:42:47] [data] Using unused word id eos for 0
[2019-07-26 09:42:47] [data] Using unused word id UNK for 1
[2019-07-26 09:42:47] [data] Setting vocabulary size for input 1 to 50000
[2019-07-26 09:42:47] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-26 09:42:47] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-26 09:42:48] [memory] Extending reserved space to 5120 MB (device gpu0)
[2019-07-26 09:42:49] Error: CUDA error 2 'out of memory' - /fs/bil0/abdel/marian-dev/src/tensors/gpu/device.cu:38: cudaMalloc(&data_, size)
[2019-07-26 09:42:49] Error: Aborted from virtual void marian::gpu::Device::reserve(size_t) in /fs/bil0/abdel/marian-dev/src/tensors/gpu/device.cu:38

[CALL STACK]
[0x19f32c1]         marian::gpu::Device::  reserve  (unsigned long)    + 0x1401
[0x93c8cb]          marian::SyncGraphGroup::  SyncGraphGroup  (std::shared_ptr<marian::Options>,  std::shared_ptr<marian::IMPIWrapper>) + 0xdcb
[0x605a90]          std::shared_ptr<marian::SyncGraphGroup> marian::  New  <marian::SyncGraphGroup,std::shared_ptr<marian::Options>&,std::shared_ptr<marian::IMPIWrapper>&>(std::shared_ptr<marian::Options>&,  std::shared_ptr<marian::IMPIWrapper>&) + 0x70
[0x66f24c]          marian::Train<marian::SyncGraphGroup>::  run  ()   + 0x35c
[0x5a13aa]          mainTrainer  (int,  char**)                        + 0x2ca
[0x57dd1a]          main                                               + 0x8a
[0x7fa2082c5830]    __libc_start_main                                  + 0xf0
[0x59edc9]          _start                                             + 0x29

[2019-07-26 09:43:08] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 09:43:08] [marian] Running on fulla as process 129304 with command line:
[2019-07-26 09:43:08] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_dcce_w3000/model/model.npz -T . --devices 6 7 --train-sets ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_dcce_w3000/model/dev.out --valid-script-path ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_dcce_w3000/model/train.log --valid-log ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 09:43:08] [config] after-batches: 0
[2019-07-26 09:43:08] [config] after-epochs: 0
[2019-07-26 09:43:08] [config] allow-unk: false
[2019-07-26 09:43:08] [config] beam-size: 12
[2019-07-26 09:43:08] [config] bert-class-symbol: "[CLS]"
[2019-07-26 09:43:08] [config] bert-mask-symbol: "[MASK]"
[2019-07-26 09:43:08] [config] bert-masking-fraction: 0.15
[2019-07-26 09:43:08] [config] bert-sep-symbol: "[SEP]"
[2019-07-26 09:43:08] [config] bert-train-type-embeddings: true
[2019-07-26 09:43:08] [config] bert-type-vocab-size: 2
[2019-07-26 09:43:08] [config] best-deep: false
[2019-07-26 09:43:08] [config] clip-gemm: 0
[2019-07-26 09:43:08] [config] clip-norm: 1
[2019-07-26 09:43:08] [config] cost-type: ce-mean
[2019-07-26 09:43:08] [config] cpu-threads: 0
[2019-07-26 09:43:08] [config] data-weighting: ""
[2019-07-26 09:43:08] [config] data-weighting-type: sentence
[2019-07-26 09:43:08] [config] dec-cell: gru
[2019-07-26 09:43:08] [config] dec-cell-base-depth: 2
[2019-07-26 09:43:08] [config] dec-cell-high-depth: 1
[2019-07-26 09:43:08] [config] dec-depth: 1
[2019-07-26 09:43:08] [config] devices:
[2019-07-26 09:43:08] [config]   - 6
[2019-07-26 09:43:08] [config]   - 7
[2019-07-26 09:43:08] [config] dim-emb: 512
[2019-07-26 09:43:08] [config] dim-rnn: 1024
[2019-07-26 09:43:08] [config] dim-vocabs:
[2019-07-26 09:43:08] [config]   - 50000
[2019-07-26 09:43:08] [config]   - 50000
[2019-07-26 09:43:08] [config] disp-first: 0
[2019-07-26 09:43:08] [config] disp-freq: 2000
[2019-07-26 09:43:08] [config] disp-label-counts: false
[2019-07-26 09:43:08] [config] dropout-rnn: 0.2
[2019-07-26 09:43:08] [config] dropout-src: 0.1
[2019-07-26 09:43:08] [config] dropout-trg: 0.1
[2019-07-26 09:43:08] [config] dump-config: ""
[2019-07-26 09:43:08] [config] early-stopping: 5
[2019-07-26 09:43:08] [config] embedding-fix-src: false
[2019-07-26 09:43:08] [config] embedding-fix-trg: false
[2019-07-26 09:43:08] [config] embedding-normalization: false
[2019-07-26 09:43:08] [config] embedding-vectors:
[2019-07-26 09:43:08] [config]   []
[2019-07-26 09:43:08] [config] enc-cell: gru
[2019-07-26 09:43:08] [config] enc-cell-depth: 1
[2019-07-26 09:43:08] [config] enc-depth: 1
[2019-07-26 09:43:08] [config] enc-type: bidirectional
[2019-07-26 09:43:08] [config] exponential-smoothing: 0.0001
[2019-07-26 09:43:08] [config] grad-dropping-momentum: 0
[2019-07-26 09:43:08] [config] grad-dropping-rate: 0
[2019-07-26 09:43:08] [config] grad-dropping-warmup: 100
[2019-07-26 09:43:08] [config] guided-alignment: none
[2019-07-26 09:43:08] [config] guided-alignment-cost: mse
[2019-07-26 09:43:08] [config] guided-alignment-weight: 0.1
[2019-07-26 09:43:08] [config] ignore-model-config: false
[2019-07-26 09:43:08] [config] input-types:
[2019-07-26 09:43:08] [config]   []
[2019-07-26 09:43:08] [config] interpolate-env-vars: false
[2019-07-26 09:43:08] [config] keep-best: false
[2019-07-26 09:43:08] [config] label-smoothing: 0
[2019-07-26 09:43:08] [config] layer-normalization: true
[2019-07-26 09:43:08] [config] learn-rate: 0.0001
[2019-07-26 09:43:08] [config] log: ../experiments/10M_bicleaner_dcce_w3000/model/train.log
[2019-07-26 09:43:08] [config] log-level: info
[2019-07-26 09:43:08] [config] log-time-zone: ""
[2019-07-26 09:43:08] [config] lr-decay: 0
[2019-07-26 09:43:08] [config] lr-decay-freq: 50000
[2019-07-26 09:43:08] [config] lr-decay-inv-sqrt:
[2019-07-26 09:43:08] [config]   - 0
[2019-07-26 09:43:08] [config] lr-decay-repeat-warmup: false
[2019-07-26 09:43:08] [config] lr-decay-reset-optimizer: false
[2019-07-26 09:43:08] [config] lr-decay-start:
[2019-07-26 09:43:08] [config]   - 10
[2019-07-26 09:43:08] [config]   - 1
[2019-07-26 09:43:08] [config] lr-decay-strategy: epoch+stalled
[2019-07-26 09:43:08] [config] lr-report: false
[2019-07-26 09:43:08] [config] lr-warmup: 0
[2019-07-26 09:43:08] [config] lr-warmup-at-reload: false
[2019-07-26 09:43:08] [config] lr-warmup-cycle: false
[2019-07-26 09:43:08] [config] lr-warmup-start-rate: 0
[2019-07-26 09:43:08] [config] max-length: 50
[2019-07-26 09:43:08] [config] max-length-crop: false
[2019-07-26 09:43:08] [config] max-length-factor: 3
[2019-07-26 09:43:08] [config] maxi-batch: 100
[2019-07-26 09:43:08] [config] maxi-batch-sort: trg
[2019-07-26 09:43:08] [config] mini-batch: 64
[2019-07-26 09:43:08] [config] mini-batch-fit: true
[2019-07-26 09:43:08] [config] mini-batch-fit-step: 10
[2019-07-26 09:43:08] [config] mini-batch-overstuff: 1
[2019-07-26 09:43:08] [config] mini-batch-track-lr: false
[2019-07-26 09:43:08] [config] mini-batch-understuff: 1
[2019-07-26 09:43:08] [config] mini-batch-warmup: 0
[2019-07-26 09:43:08] [config] mini-batch-words: 0
[2019-07-26 09:43:08] [config] mini-batch-words-ref: 0
[2019-07-26 09:43:08] [config] model: ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 09:43:08] [config] multi-loss-type: sum
[2019-07-26 09:43:08] [config] multi-node: false
[2019-07-26 09:43:08] [config] multi-node-overlap: true
[2019-07-26 09:43:08] [config] n-best: false
[2019-07-26 09:43:08] [config] no-nccl: false
[2019-07-26 09:43:08] [config] no-reload: false
[2019-07-26 09:43:08] [config] no-restore-corpus: false
[2019-07-26 09:43:08] [config] no-shuffle: false
[2019-07-26 09:43:08] [config] normalize: 1
[2019-07-26 09:43:08] [config] num-devices: 0
[2019-07-26 09:43:08] [config] optimizer: adam
[2019-07-26 09:43:08] [config] optimizer-delay: 1
[2019-07-26 09:43:08] [config] optimizer-params:
[2019-07-26 09:43:08] [config]   []
[2019-07-26 09:43:08] [config] overwrite: false
[2019-07-26 09:43:08] [config] pretrained-model: ""
[2019-07-26 09:43:08] [config] quiet: false
[2019-07-26 09:43:08] [config] quiet-translation: true
[2019-07-26 09:43:08] [config] relative-paths: false
[2019-07-26 09:43:08] [config] right-left: false
[2019-07-26 09:43:08] [config] save-freq: 20000
[2019-07-26 09:43:08] [config] seed: 1111
[2019-07-26 09:43:08] [config] shuffle-in-ram: false
[2019-07-26 09:43:08] [config] skip: false
[2019-07-26 09:43:08] [config] sqlite: ""
[2019-07-26 09:43:08] [config] sqlite-drop: false
[2019-07-26 09:43:08] [config] sync-sgd: true
[2019-07-26 09:43:08] [config] tempdir: .
[2019-07-26 09:43:08] [config] tied-embeddings: false
[2019-07-26 09:43:08] [config] tied-embeddings-all: false
[2019-07-26 09:43:08] [config] tied-embeddings-src: false
[2019-07-26 09:43:08] [config] train-sets:
[2019-07-26 09:43:08] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de
[2019-07-26 09:43:08] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en
[2019-07-26 09:43:08] [config] transformer-aan-activation: swish
[2019-07-26 09:43:08] [config] transformer-aan-depth: 2
[2019-07-26 09:43:08] [config] transformer-aan-nogate: false
[2019-07-26 09:43:08] [config] transformer-decoder-autoreg: self-attention
[2019-07-26 09:43:08] [config] transformer-dim-aan: 2048
[2019-07-26 09:43:08] [config] transformer-dim-ffn: 2048
[2019-07-26 09:43:08] [config] transformer-dropout: 0
[2019-07-26 09:43:08] [config] transformer-dropout-attention: 0
[2019-07-26 09:43:08] [config] transformer-dropout-ffn: 0
[2019-07-26 09:43:08] [config] transformer-ffn-activation: swish
[2019-07-26 09:43:08] [config] transformer-ffn-depth: 2
[2019-07-26 09:43:08] [config] transformer-guided-alignment-layer: last
[2019-07-26 09:43:08] [config] transformer-heads: 8
[2019-07-26 09:43:08] [config] transformer-no-projection: false
[2019-07-26 09:43:08] [config] transformer-postprocess: dan
[2019-07-26 09:43:08] [config] transformer-postprocess-emb: d
[2019-07-26 09:43:08] [config] transformer-preprocess: ""
[2019-07-26 09:43:08] [config] transformer-tied-layers:
[2019-07-26 09:43:08] [config]   []
[2019-07-26 09:43:08] [config] transformer-train-position-embeddings: false
[2019-07-26 09:43:08] [config] type: amun
[2019-07-26 09:43:08] [config] ulr: false
[2019-07-26 09:43:08] [config] ulr-dim-emb: 0
[2019-07-26 09:43:08] [config] ulr-dropout: 0
[2019-07-26 09:43:08] [config] ulr-keys-vectors: ""
[2019-07-26 09:43:08] [config] ulr-query-vectors: ""
[2019-07-26 09:43:08] [config] ulr-softmax-temperature: 1
[2019-07-26 09:43:08] [config] ulr-trainable-transformation: false
[2019-07-26 09:43:08] [config] valid-freq: 20000
[2019-07-26 09:43:08] [config] valid-log: ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 09:43:08] [config] valid-max-length: 1000
[2019-07-26 09:43:08] [config] valid-metrics:
[2019-07-26 09:43:08] [config]   - cross-entropy
[2019-07-26 09:43:08] [config]   - perplexity
[2019-07-26 09:43:08] [config]   - translation
[2019-07-26 09:43:08] [config] valid-mini-batch: 8
[2019-07-26 09:43:08] [config] valid-script-path: ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh
[2019-07-26 09:43:08] [config] valid-sets:
[2019-07-26 09:43:08] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de
[2019-07-26 09:43:08] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en
[2019-07-26 09:43:08] [config] valid-translation-output: ../experiments/10M_bicleaner_dcce_w3000/model/dev.out
[2019-07-26 09:43:08] [config] vocabs:
[2019-07-26 09:43:08] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 09:43:08] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 09:43:08] [config] word-penalty: 0
[2019-07-26 09:43:08] [config] workspace: 5000
[2019-07-26 09:43:08] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 09:43:08] Using synchronous training
[2019-07-26 09:43:08] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 09:43:09] [data] Using unused word id eos for 0
[2019-07-26 09:43:09] [data] Using unused word id UNK for 1
[2019-07-26 09:43:09] [data] Setting vocabulary size for input 0 to 50000
[2019-07-26 09:43:09] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 09:43:09] [data] Using unused word id eos for 0
[2019-07-26 09:43:09] [data] Using unused word id UNK for 1
[2019-07-26 09:43:09] [data] Setting vocabulary size for input 1 to 50000
[2019-07-26 09:43:09] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-26 09:43:09] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-26 09:43:10] [memory] Extending reserved space to 5120 MB (device gpu6)
[2019-07-26 09:43:11] [memory] Extending reserved space to 5120 MB (device gpu7)
[2019-07-26 09:43:11] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-26 09:43:11] [comm] NCCLCommunicator constructed successfully.
[2019-07-26 09:43:11] [training] Using 2 GPUs
[2019-07-26 09:43:11] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:43:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-26 09:43:11] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:43:16] [batching] Done. Typical MB size is 13760 target words
[2019-07-26 09:43:16] [memory] Extending reserved space to 5120 MB (device gpu6)
[2019-07-26 09:43:16] [memory] Extending reserved space to 5120 MB (device gpu7)
[2019-07-26 09:43:16] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-26 09:43:16] [comm] NCCLCommunicator constructed successfully.
[2019-07-26 09:43:16] [training] Using 2 GPUs
[2019-07-26 09:43:16] Training started
[2019-07-26 09:43:16] [data] Shuffling data
[2019-07-26 09:43:16] [data] Done reading 545666 sentences
[2019-07-26 09:43:18] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 09:43:20] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-26 09:43:20] [memory] Reserving 422 MB, device gpu7
[2019-07-26 09:43:20] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:43:20] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:43:20] [memory] Reserving 422 MB, device gpu7
[2019-07-26 09:43:20] [memory] Reserving 211 MB, device gpu6
[2019-07-26 09:43:20] [memory] Reserving 211 MB, device gpu7
[2019-07-26 09:43:20] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:43:20] [memory] Reserving 422 MB, device gpu7
[2019-07-26 09:44:19] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 09:44:19] [marian] Running on fulla as process 129408 with command line:
[2019-07-26 09:44:19] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_dcce_w3000/model/model.npz -T . --devices 6 7 --train-sets ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json --mini-batch-fit -w 3000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_dcce_w3000/model/dev.out --valid-script-path ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_dcce_w3000/model/train.log --valid-log ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 09:44:19] [config] after-batches: 0
[2019-07-26 09:44:19] [config] after-epochs: 0
[2019-07-26 09:44:19] [config] allow-unk: false
[2019-07-26 09:44:19] [config] beam-size: 12
[2019-07-26 09:44:19] [config] bert-class-symbol: "[CLS]"
[2019-07-26 09:44:19] [config] bert-mask-symbol: "[MASK]"
[2019-07-26 09:44:19] [config] bert-masking-fraction: 0.15
[2019-07-26 09:44:19] [config] bert-sep-symbol: "[SEP]"
[2019-07-26 09:44:19] [config] bert-train-type-embeddings: true
[2019-07-26 09:44:19] [config] bert-type-vocab-size: 2
[2019-07-26 09:44:19] [config] best-deep: false
[2019-07-26 09:44:19] [config] clip-gemm: 0
[2019-07-26 09:44:19] [config] clip-norm: 1
[2019-07-26 09:44:19] [config] cost-type: ce-mean
[2019-07-26 09:44:19] [config] cpu-threads: 0
[2019-07-26 09:44:19] [config] data-weighting: ""
[2019-07-26 09:44:19] [config] data-weighting-type: sentence
[2019-07-26 09:44:19] [config] dec-cell: gru
[2019-07-26 09:44:19] [config] dec-cell-base-depth: 2
[2019-07-26 09:44:19] [config] dec-cell-high-depth: 1
[2019-07-26 09:44:19] [config] dec-depth: 1
[2019-07-26 09:44:19] [config] devices:
[2019-07-26 09:44:19] [config]   - 6
[2019-07-26 09:44:19] [config]   - 7
[2019-07-26 09:44:19] [config] dim-emb: 512
[2019-07-26 09:44:19] [config] dim-rnn: 1024
[2019-07-26 09:44:19] [config] dim-vocabs:
[2019-07-26 09:44:19] [config]   - 50000
[2019-07-26 09:44:19] [config]   - 50000
[2019-07-26 09:44:19] [config] disp-first: 0
[2019-07-26 09:44:19] [config] disp-freq: 2000
[2019-07-26 09:44:19] [config] disp-label-counts: false
[2019-07-26 09:44:19] [config] dropout-rnn: 0.2
[2019-07-26 09:44:19] [config] dropout-src: 0.1
[2019-07-26 09:44:19] [config] dropout-trg: 0.1
[2019-07-26 09:44:19] [config] dump-config: ""
[2019-07-26 09:44:19] [config] early-stopping: 5
[2019-07-26 09:44:19] [config] embedding-fix-src: false
[2019-07-26 09:44:19] [config] embedding-fix-trg: false
[2019-07-26 09:44:19] [config] embedding-normalization: false
[2019-07-26 09:44:19] [config] embedding-vectors:
[2019-07-26 09:44:19] [config]   []
[2019-07-26 09:44:19] [config] enc-cell: gru
[2019-07-26 09:44:19] [config] enc-cell-depth: 1
[2019-07-26 09:44:19] [config] enc-depth: 1
[2019-07-26 09:44:19] [config] enc-type: bidirectional
[2019-07-26 09:44:19] [config] exponential-smoothing: 0.0001
[2019-07-26 09:44:19] [config] grad-dropping-momentum: 0
[2019-07-26 09:44:19] [config] grad-dropping-rate: 0
[2019-07-26 09:44:19] [config] grad-dropping-warmup: 100
[2019-07-26 09:44:19] [config] guided-alignment: none
[2019-07-26 09:44:19] [config] guided-alignment-cost: mse
[2019-07-26 09:44:19] [config] guided-alignment-weight: 0.1
[2019-07-26 09:44:19] [config] ignore-model-config: false
[2019-07-26 09:44:19] [config] input-types:
[2019-07-26 09:44:19] [config]   []
[2019-07-26 09:44:19] [config] interpolate-env-vars: false
[2019-07-26 09:44:19] [config] keep-best: false
[2019-07-26 09:44:19] [config] label-smoothing: 0
[2019-07-26 09:44:19] [config] layer-normalization: true
[2019-07-26 09:44:19] [config] learn-rate: 0.0001
[2019-07-26 09:44:19] [config] log: ../experiments/10M_bicleaner_dcce_w3000/model/train.log
[2019-07-26 09:44:19] [config] log-level: info
[2019-07-26 09:44:19] [config] log-time-zone: ""
[2019-07-26 09:44:19] [config] lr-decay: 0
[2019-07-26 09:44:19] [config] lr-decay-freq: 50000
[2019-07-26 09:44:19] [config] lr-decay-inv-sqrt:
[2019-07-26 09:44:19] [config]   - 0
[2019-07-26 09:44:19] [config] lr-decay-repeat-warmup: false
[2019-07-26 09:44:19] [config] lr-decay-reset-optimizer: false
[2019-07-26 09:44:19] [config] lr-decay-start:
[2019-07-26 09:44:19] [config]   - 10
[2019-07-26 09:44:19] [config]   - 1
[2019-07-26 09:44:19] [config] lr-decay-strategy: epoch+stalled
[2019-07-26 09:44:19] [config] lr-report: false
[2019-07-26 09:44:19] [config] lr-warmup: 0
[2019-07-26 09:44:19] [config] lr-warmup-at-reload: false
[2019-07-26 09:44:19] [config] lr-warmup-cycle: false
[2019-07-26 09:44:19] [config] lr-warmup-start-rate: 0
[2019-07-26 09:44:19] [config] max-length: 50
[2019-07-26 09:44:19] [config] max-length-crop: false
[2019-07-26 09:44:19] [config] max-length-factor: 3
[2019-07-26 09:44:19] [config] maxi-batch: 100
[2019-07-26 09:44:19] [config] maxi-batch-sort: trg
[2019-07-26 09:44:19] [config] mini-batch: 64
[2019-07-26 09:44:19] [config] mini-batch-fit: true
[2019-07-26 09:44:19] [config] mini-batch-fit-step: 10
[2019-07-26 09:44:19] [config] mini-batch-overstuff: 1
[2019-07-26 09:44:19] [config] mini-batch-track-lr: false
[2019-07-26 09:44:19] [config] mini-batch-understuff: 1
[2019-07-26 09:44:19] [config] mini-batch-warmup: 0
[2019-07-26 09:44:19] [config] mini-batch-words: 0
[2019-07-26 09:44:19] [config] mini-batch-words-ref: 0
[2019-07-26 09:44:19] [config] model: ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 09:44:19] [config] multi-loss-type: sum
[2019-07-26 09:44:19] [config] multi-node: false
[2019-07-26 09:44:19] [config] multi-node-overlap: true
[2019-07-26 09:44:19] [config] n-best: false
[2019-07-26 09:44:19] [config] no-nccl: false
[2019-07-26 09:44:19] [config] no-reload: false
[2019-07-26 09:44:19] [config] no-restore-corpus: false
[2019-07-26 09:44:19] [config] no-shuffle: false
[2019-07-26 09:44:19] [config] normalize: 1
[2019-07-26 09:44:19] [config] num-devices: 0
[2019-07-26 09:44:19] [config] optimizer: adam
[2019-07-26 09:44:19] [config] optimizer-delay: 1
[2019-07-26 09:44:19] [config] optimizer-params:
[2019-07-26 09:44:19] [config]   []
[2019-07-26 09:44:19] [config] overwrite: false
[2019-07-26 09:44:19] [config] pretrained-model: ""
[2019-07-26 09:44:19] [config] quiet: false
[2019-07-26 09:44:19] [config] quiet-translation: true
[2019-07-26 09:44:19] [config] relative-paths: false
[2019-07-26 09:44:19] [config] right-left: false
[2019-07-26 09:44:19] [config] save-freq: 20000
[2019-07-26 09:44:19] [config] seed: 1111
[2019-07-26 09:44:19] [config] shuffle-in-ram: false
[2019-07-26 09:44:19] [config] skip: false
[2019-07-26 09:44:19] [config] sqlite: ""
[2019-07-26 09:44:19] [config] sqlite-drop: false
[2019-07-26 09:44:19] [config] sync-sgd: true
[2019-07-26 09:44:19] [config] tempdir: .
[2019-07-26 09:44:19] [config] tied-embeddings: false
[2019-07-26 09:44:19] [config] tied-embeddings-all: false
[2019-07-26 09:44:19] [config] tied-embeddings-src: false
[2019-07-26 09:44:19] [config] train-sets:
[2019-07-26 09:44:19] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de
[2019-07-26 09:44:19] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en
[2019-07-26 09:44:19] [config] transformer-aan-activation: swish
[2019-07-26 09:44:19] [config] transformer-aan-depth: 2
[2019-07-26 09:44:19] [config] transformer-aan-nogate: false
[2019-07-26 09:44:19] [config] transformer-decoder-autoreg: self-attention
[2019-07-26 09:44:19] [config] transformer-dim-aan: 2048
[2019-07-26 09:44:19] [config] transformer-dim-ffn: 2048
[2019-07-26 09:44:19] [config] transformer-dropout: 0
[2019-07-26 09:44:19] [config] transformer-dropout-attention: 0
[2019-07-26 09:44:19] [config] transformer-dropout-ffn: 0
[2019-07-26 09:44:19] [config] transformer-ffn-activation: swish
[2019-07-26 09:44:19] [config] transformer-ffn-depth: 2
[2019-07-26 09:44:19] [config] transformer-guided-alignment-layer: last
[2019-07-26 09:44:19] [config] transformer-heads: 8
[2019-07-26 09:44:19] [config] transformer-no-projection: false
[2019-07-26 09:44:19] [config] transformer-postprocess: dan
[2019-07-26 09:44:19] [config] transformer-postprocess-emb: d
[2019-07-26 09:44:19] [config] transformer-preprocess: ""
[2019-07-26 09:44:19] [config] transformer-tied-layers:
[2019-07-26 09:44:19] [config]   []
[2019-07-26 09:44:19] [config] transformer-train-position-embeddings: false
[2019-07-26 09:44:19] [config] type: amun
[2019-07-26 09:44:19] [config] ulr: false
[2019-07-26 09:44:19] [config] ulr-dim-emb: 0
[2019-07-26 09:44:19] [config] ulr-dropout: 0
[2019-07-26 09:44:19] [config] ulr-keys-vectors: ""
[2019-07-26 09:44:19] [config] ulr-query-vectors: ""
[2019-07-26 09:44:19] [config] ulr-softmax-temperature: 1
[2019-07-26 09:44:19] [config] ulr-trainable-transformation: false
[2019-07-26 09:44:19] [config] valid-freq: 20000
[2019-07-26 09:44:19] [config] valid-log: ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 09:44:19] [config] valid-max-length: 1000
[2019-07-26 09:44:19] [config] valid-metrics:
[2019-07-26 09:44:19] [config]   - cross-entropy
[2019-07-26 09:44:19] [config]   - perplexity
[2019-07-26 09:44:19] [config]   - translation
[2019-07-26 09:44:19] [config] valid-mini-batch: 8
[2019-07-26 09:44:19] [config] valid-script-path: ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh
[2019-07-26 09:44:19] [config] valid-sets:
[2019-07-26 09:44:19] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de
[2019-07-26 09:44:19] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en
[2019-07-26 09:44:19] [config] valid-translation-output: ../experiments/10M_bicleaner_dcce_w3000/model/dev.out
[2019-07-26 09:44:19] [config] vocabs:
[2019-07-26 09:44:19] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 09:44:19] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 09:44:19] [config] word-penalty: 0
[2019-07-26 09:44:19] [config] workspace: 3000
[2019-07-26 09:44:19] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 09:44:19] Using synchronous training
[2019-07-26 09:44:19] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 09:44:19] [data] Using unused word id eos for 0
[2019-07-26 09:44:19] [data] Using unused word id UNK for 1
[2019-07-26 09:44:19] [data] Setting vocabulary size for input 0 to 50000
[2019-07-26 09:44:19] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 09:44:20] [data] Using unused word id eos for 0
[2019-07-26 09:44:20] [data] Using unused word id UNK for 1
[2019-07-26 09:44:20] [data] Setting vocabulary size for input 1 to 50000
[2019-07-26 09:44:20] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-26 09:44:20] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-26 09:44:21] [memory] Extending reserved space to 3072 MB (device gpu6)
[2019-07-26 09:44:22] [memory] Extending reserved space to 3072 MB (device gpu7)
[2019-07-26 09:44:22] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-26 09:44:22] [comm] NCCLCommunicator constructed successfully.
[2019-07-26 09:44:22] [training] Using 2 GPUs
[2019-07-26 09:44:22] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:44:22] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-26 09:44:22] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:44:25] [batching] Done. Typical MB size is 8084 target words
[2019-07-26 09:44:25] [memory] Extending reserved space to 3072 MB (device gpu6)
[2019-07-26 09:44:25] [memory] Extending reserved space to 3072 MB (device gpu7)
[2019-07-26 09:44:25] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-26 09:44:25] [comm] NCCLCommunicator constructed successfully.
[2019-07-26 09:44:25] [training] Using 2 GPUs
[2019-07-26 09:44:25] Training started
[2019-07-26 09:44:25] [data] Shuffling data
[2019-07-26 09:44:25] [data] Done reading 545666 sentences
[2019-07-26 09:44:27] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 09:44:29] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-26 09:44:29] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:44:29] [memory] Reserving 422 MB, device gpu7
[2019-07-26 09:44:29] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:44:29] [memory] Reserving 422 MB, device gpu7
[2019-07-26 09:44:29] [memory] Reserving 211 MB, device gpu6
[2019-07-26 09:44:29] [memory] Reserving 211 MB, device gpu7
[2019-07-26 09:44:30] [memory] Reserving 422 MB, device gpu6
[2019-07-26 09:44:30] [memory] Reserving 422 MB, device gpu7
[2019-07-26 09:54:24] Ep. 1 : Up. 2000 : Sen. 481,466 : Cost 115.21718597 : Time 604.84s : 17025.93 words/s
[2019-07-26 09:54:52] Seen 503759 samples
[2019-07-26 09:54:52] Starting epoch 2
[2019-07-26 09:54:52] [data] Shuffling data
[2019-07-26 09:54:53] [data] Done reading 545666 sentences
[2019-07-26 09:54:56] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 10:04:23] Ep. 2 : Up. 4000 : Sen. 458,342 : Cost 79.46025848 : Time 598.86s : 17173.67 words/s
[2019-07-26 10:05:19] Seen 503759 samples
[2019-07-26 10:05:19] Starting epoch 3
[2019-07-26 10:05:19] [data] Shuffling data
[2019-07-26 10:05:20] [data] Done reading 545666 sentences
[2019-07-26 10:05:21] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 10:14:21] Ep. 3 : Up. 6000 : Sen. 436,082 : Cost 64.67562866 : Time 597.90s : 17236.24 words/s
[2019-07-26 10:15:44] Seen 503759 samples
[2019-07-26 10:15:44] Starting epoch 4
[2019-07-26 10:15:44] [data] Shuffling data
[2019-07-26 10:15:45] [data] Done reading 545666 sentences
[2019-07-26 10:15:47] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 10:24:18] Ep. 4 : Up. 8000 : Sen. 413,148 : Cost 56.26265717 : Time 596.66s : 17222.78 words/s
[2019-07-26 10:26:10] Seen 503759 samples
[2019-07-26 10:26:10] Starting epoch 5
[2019-07-26 10:26:10] [data] Shuffling data
[2019-07-26 10:26:10] [data] Done reading 545666 sentences
[2019-07-26 10:26:12] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 10:34:16] Ep. 5 : Up. 10000 : Sen. 391,450 : Cost 51.19667816 : Time 598.37s : 17270.06 words/s
[2019-07-26 10:36:35] Seen 503759 samples
[2019-07-26 10:36:35] Starting epoch 6
[2019-07-26 10:36:35] [data] Shuffling data
[2019-07-26 10:36:35] [data] Done reading 545666 sentences
[2019-07-26 10:36:37] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 10:44:13] Ep. 6 : Up. 12000 : Sen. 367,988 : Cost 47.35638046 : Time 596.33s : 17229.39 words/s
[2019-07-26 10:47:00] Seen 503759 samples
[2019-07-26 10:47:00] Starting epoch 7
[2019-07-26 10:47:00] [data] Shuffling data
[2019-07-26 10:47:00] [data] Done reading 545666 sentences
[2019-07-26 10:47:02] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 10:54:09] Ep. 7 : Up. 14000 : Sen. 344,502 : Cost 44.47446060 : Time 596.22s : 17189.86 words/s
[2019-07-26 10:57:25] Seen 503759 samples
[2019-07-26 10:57:25] Starting epoch 8
[2019-07-26 10:57:25] [data] Shuffling data
[2019-07-26 10:57:25] [data] Done reading 545666 sentences
[2019-07-26 10:57:27] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 11:04:07] Ep. 8 : Up. 16000 : Sen. 321,712 : Cost 42.42534637 : Time 597.88s : 17244.56 words/s
[2019-07-26 11:07:51] Seen 503759 samples
[2019-07-26 11:07:51] Starting epoch 9
[2019-07-26 11:07:51] [data] Shuffling data
[2019-07-26 11:07:51] [data] Done reading 545666 sentences
[2019-07-26 11:07:53] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 11:14:16] Ep. 9 : Up. 18000 : Sen. 300,260 : Cost 40.50019455 : Time 609.34s : 16938.33 words/s
[2019-07-26 11:18:30] Seen 503759 samples
[2019-07-26 11:18:30] Starting epoch 10
[2019-07-26 11:18:30] [data] Shuffling data
[2019-07-26 11:18:30] [data] Done reading 545666 sentences
[2019-07-26 11:18:32] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 11:25:30] Ep. 10 : Up. 20000 : Sen. 277,408 : Cost 38.97502518 : Time 674.36s : 15273.60 words/s
[2019-07-26 11:25:30] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 11:25:48] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter20000.npz
[2019-07-26 11:25:59] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 11:26:19] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-26 11:26:59] [valid] Ep. 10 : Up. 20000 : cross-entropy : 67.4888 : new best
[2019-07-26 11:27:03] [valid] Ep. 10 : Up. 20000 : perplexity : 14.1919 : new best
[2019-07-26 11:28:01] [valid] Ep. 10 : Up. 20000 : translation : 23.57 : new best
[2019-07-26 11:33:57] Seen 503759 samples
[2019-07-26 11:33:57] Starting epoch 11
[2019-07-26 11:33:57] [data] Shuffling data
[2019-07-26 11:33:57] [data] Done reading 545666 sentences
[2019-07-26 11:33:59] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 11:39:19] Ep. 11 : Up. 22000 : Sen. 254,078 : Cost 37.51728439 : Time 828.93s : 12389.67 words/s
[2019-07-26 11:44:39] Seen 503759 samples
[2019-07-26 11:44:39] Starting epoch 12
[2019-07-26 11:44:39] [data] Shuffling data
[2019-07-26 11:44:40] [data] Done reading 545666 sentences
[2019-07-26 11:44:43] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 11:50:28] Ep. 12 : Up. 24000 : Sen. 232,938 : Cost 36.36186981 : Time 668.60s : 15427.67 words/s
[2019-07-26 11:57:11] Seen 503759 samples
[2019-07-26 11:57:11] Starting epoch 13
[2019-07-26 11:57:11] [data] Shuffling data
[2019-07-26 11:57:11] [data] Done reading 545666 sentences
[2019-07-26 11:57:14] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 12:02:24] Ep. 13 : Up. 26000 : Sen. 208,358 : Cost 35.24542236 : Time 716.02s : 14326.97 words/s
[2019-07-26 12:09:38] Seen 503759 samples
[2019-07-26 12:09:38] Starting epoch 14
[2019-07-26 12:09:38] [data] Shuffling data
[2019-07-26 12:09:38] [data] Done reading 545666 sentences
[2019-07-26 12:09:41] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 12:14:18] Ep. 14 : Up. 28000 : Sen. 187,206 : Cost 34.23946381 : Time 714.40s : 14449.14 words/s
[2019-07-26 12:21:59] Seen 503759 samples
[2019-07-26 12:21:59] Starting epoch 15
[2019-07-26 12:21:59] [data] Shuffling data
[2019-07-26 12:21:59] [data] Done reading 545666 sentences
[2019-07-26 12:22:02] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 12:26:06] Ep. 15 : Up. 30000 : Sen. 165,680 : Cost 33.35528564 : Time 707.83s : 14570.30 words/s
[2019-07-26 12:34:19] Seen 503759 samples
[2019-07-26 12:34:19] Starting epoch 16
[2019-07-26 12:34:19] [data] Shuffling data
[2019-07-26 12:34:19] [data] Done reading 545666 sentences
[2019-07-26 12:34:22] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 12:37:53] Ep. 16 : Up. 32000 : Sen. 142,524 : Cost 32.43903732 : Time 706.98s : 14558.12 words/s
[2019-07-26 12:46:41] Seen 503759 samples
[2019-07-26 12:46:41] Starting epoch 17
[2019-07-26 12:46:41] [data] Shuffling data
[2019-07-26 12:46:42] [data] Done reading 545666 sentences
[2019-07-26 12:46:45] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 12:49:43] Ep. 17 : Up. 34000 : Sen. 121,084 : Cost 31.58016777 : Time 709.42s : 14530.36 words/s
[2019-07-26 12:59:02] Seen 503759 samples
[2019-07-26 12:59:02] Starting epoch 18
[2019-07-26 12:59:02] [data] Shuffling data
[2019-07-26 12:59:03] [data] Done reading 545666 sentences
[2019-07-26 12:59:06] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 13:01:34] Ep. 18 : Up. 36000 : Sen. 99,728 : Cost 31.02064323 : Time 711.14s : 14512.13 words/s
[2019-07-26 13:11:25] Seen 503759 samples
[2019-07-26 13:11:25] Starting epoch 19
[2019-07-26 13:11:25] [data] Shuffling data
[2019-07-26 13:11:26] [data] Done reading 545666 sentences
[2019-07-26 13:11:32] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 13:13:22] Ep. 19 : Up. 38000 : Sen. 74,860 : Cost 30.30554199 : Time 708.25s : 14478.02 words/s
[2019-07-26 13:23:44] Seen 503759 samples
[2019-07-26 13:23:44] Starting epoch 20
[2019-07-26 13:23:44] [data] Shuffling data
[2019-07-26 13:23:45] [data] Done reading 545666 sentences
[2019-07-26 13:23:48] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 13:25:06] Ep. 20 : Up. 40000 : Sen. 50,634 : Cost 29.55237579 : Time 704.11s : 14569.88 words/s
[2019-07-26 13:25:06] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 13:25:21] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter40000.npz
[2019-07-26 13:25:30] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 13:25:44] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-26 13:26:20] [valid] Ep. 20 : Up. 40000 : cross-entropy : 62.0269 : new best
[2019-07-26 13:26:24] [valid] Ep. 20 : Up. 40000 : perplexity : 11.45 : new best
[2019-07-26 13:27:16] [valid] Ep. 20 : Up. 40000 : translation : 25.78 : new best
[2019-07-26 13:38:33] Seen 503759 samples
[2019-07-26 13:38:33] Starting epoch 21
[2019-07-26 13:38:33] [data] Shuffling data
[2019-07-26 13:38:33] [data] Done reading 545666 sentences
[2019-07-26 13:38:36] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 13:39:21] Ep. 21 : Up. 42000 : Sen. 29,544 : Cost 29.17445564 : Time 855.32s : 12069.37 words/s
[2019-07-26 13:51:21] Seen 503759 samples
[2019-07-26 13:51:21] Starting epoch 22
[2019-07-26 13:51:21] [data] Shuffling data
[2019-07-26 13:51:22] [data] Done reading 545666 sentences
[2019-07-26 13:51:25] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 13:51:37] Ep. 22 : Up. 44000 : Sen. 5,990 : Cost 28.54972267 : Time 735.72s : 13973.04 words/s
[2019-07-26 14:35:15] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 14:35:15] [marian] Running on fulla as process 156284 with command line:
[2019-07-26 14:35:15] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_dcce_w3000/model/model.npz -T . --devices 6 7 --train-sets ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json --mini-batch-fit -w 3000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_dcce_w3000/model/dev.out --valid-script-path ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_dcce_w3000/model/train.log --valid-log ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 14:35:15] [config] after-batches: 0
[2019-07-26 14:35:15] [config] after-epochs: 0
[2019-07-26 14:35:15] [config] allow-unk: false
[2019-07-26 14:35:15] [config] beam-size: 12
[2019-07-26 14:35:15] [config] bert-class-symbol: "[CLS]"
[2019-07-26 14:35:15] [config] bert-mask-symbol: "[MASK]"
[2019-07-26 14:35:15] [config] bert-masking-fraction: 0.15
[2019-07-26 14:35:15] [config] bert-sep-symbol: "[SEP]"
[2019-07-26 14:35:15] [config] bert-train-type-embeddings: true
[2019-07-26 14:35:15] [config] bert-type-vocab-size: 2
[2019-07-26 14:35:15] [config] best-deep: false
[2019-07-26 14:35:15] [config] clip-gemm: 0
[2019-07-26 14:35:15] [config] clip-norm: 1
[2019-07-26 14:35:15] [config] cost-type: ce-mean
[2019-07-26 14:35:15] [config] cpu-threads: 0
[2019-07-26 14:35:15] [config] data-weighting: ""
[2019-07-26 14:35:15] [config] data-weighting-type: sentence
[2019-07-26 14:35:15] [config] dec-cell: gru
[2019-07-26 14:35:15] [config] dec-cell-base-depth: 2
[2019-07-26 14:35:15] [config] dec-cell-high-depth: 1
[2019-07-26 14:35:15] [config] dec-depth: 1
[2019-07-26 14:35:15] [config] devices:
[2019-07-26 14:35:15] [config]   - 6
[2019-07-26 14:35:15] [config]   - 7
[2019-07-26 14:35:15] [config] dim-emb: 512
[2019-07-26 14:35:15] [config] dim-rnn: 1024
[2019-07-26 14:35:15] [config] dim-vocabs:
[2019-07-26 14:35:15] [config]   - 50000
[2019-07-26 14:35:15] [config]   - 50000
[2019-07-26 14:35:15] [config] disp-first: 0
[2019-07-26 14:35:15] [config] disp-freq: 2000
[2019-07-26 14:35:15] [config] disp-label-counts: false
[2019-07-26 14:35:15] [config] dropout-rnn: 0.2
[2019-07-26 14:35:15] [config] dropout-src: 0.1
[2019-07-26 14:35:15] [config] dropout-trg: 0.1
[2019-07-26 14:35:15] [config] dump-config: ""
[2019-07-26 14:35:15] [config] early-stopping: 5
[2019-07-26 14:35:15] [config] embedding-fix-src: false
[2019-07-26 14:35:15] [config] embedding-fix-trg: false
[2019-07-26 14:35:15] [config] embedding-normalization: false
[2019-07-26 14:35:15] [config] embedding-vectors:
[2019-07-26 14:35:15] [config]   []
[2019-07-26 14:35:15] [config] enc-cell: gru
[2019-07-26 14:35:15] [config] enc-cell-depth: 1
[2019-07-26 14:35:15] [config] enc-depth: 1
[2019-07-26 14:35:15] [config] enc-type: bidirectional
[2019-07-26 14:35:15] [config] exponential-smoothing: 0.0001
[2019-07-26 14:35:15] [config] grad-dropping-momentum: 0
[2019-07-26 14:35:15] [config] grad-dropping-rate: 0
[2019-07-26 14:35:15] [config] grad-dropping-warmup: 100
[2019-07-26 14:35:15] [config] guided-alignment: none
[2019-07-26 14:35:15] [config] guided-alignment-cost: mse
[2019-07-26 14:35:15] [config] guided-alignment-weight: 0.1
[2019-07-26 14:35:15] [config] ignore-model-config: false
[2019-07-26 14:35:15] [config] input-types:
[2019-07-26 14:35:15] [config]   []
[2019-07-26 14:35:15] [config] interpolate-env-vars: false
[2019-07-26 14:35:15] [config] keep-best: false
[2019-07-26 14:35:15] [config] label-smoothing: 0
[2019-07-26 14:35:15] [config] layer-normalization: true
[2019-07-26 14:35:15] [config] learn-rate: 0.0001
[2019-07-26 14:35:15] [config] log: ../experiments/10M_bicleaner_dcce_w3000/model/train.log
[2019-07-26 14:35:15] [config] log-level: info
[2019-07-26 14:35:15] [config] log-time-zone: ""
[2019-07-26 14:35:15] [config] lr-decay: 0
[2019-07-26 14:35:15] [config] lr-decay-freq: 50000
[2019-07-26 14:35:15] [config] lr-decay-inv-sqrt:
[2019-07-26 14:35:15] [config]   - 0
[2019-07-26 14:35:15] [config] lr-decay-repeat-warmup: false
[2019-07-26 14:35:15] [config] lr-decay-reset-optimizer: false
[2019-07-26 14:35:15] [config] lr-decay-start:
[2019-07-26 14:35:15] [config]   - 10
[2019-07-26 14:35:15] [config]   - 1
[2019-07-26 14:35:15] [config] lr-decay-strategy: epoch+stalled
[2019-07-26 14:35:15] [config] lr-report: false
[2019-07-26 14:35:15] [config] lr-warmup: 0
[2019-07-26 14:35:15] [config] lr-warmup-at-reload: false
[2019-07-26 14:35:15] [config] lr-warmup-cycle: false
[2019-07-26 14:35:15] [config] lr-warmup-start-rate: 0
[2019-07-26 14:35:15] [config] max-length: 50
[2019-07-26 14:35:15] [config] max-length-crop: false
[2019-07-26 14:35:15] [config] max-length-factor: 3
[2019-07-26 14:35:15] [config] maxi-batch: 100
[2019-07-26 14:35:15] [config] maxi-batch-sort: trg
[2019-07-26 14:35:15] [config] mini-batch: 64
[2019-07-26 14:35:15] [config] mini-batch-fit: true
[2019-07-26 14:35:15] [config] mini-batch-fit-step: 10
[2019-07-26 14:35:15] [config] mini-batch-overstuff: 1
[2019-07-26 14:35:15] [config] mini-batch-track-lr: false
[2019-07-26 14:35:15] [config] mini-batch-understuff: 1
[2019-07-26 14:35:15] [config] mini-batch-warmup: 0
[2019-07-26 14:35:15] [config] mini-batch-words: 0
[2019-07-26 14:35:15] [config] mini-batch-words-ref: 0
[2019-07-26 14:35:15] [config] model: ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 14:35:15] [config] multi-loss-type: sum
[2019-07-26 14:35:15] [config] multi-node: false
[2019-07-26 14:35:15] [config] multi-node-overlap: true
[2019-07-26 14:35:15] [config] n-best: false
[2019-07-26 14:35:15] [config] no-nccl: false
[2019-07-26 14:35:15] [config] no-reload: false
[2019-07-26 14:35:15] [config] no-restore-corpus: false
[2019-07-26 14:35:15] [config] no-shuffle: false
[2019-07-26 14:35:15] [config] normalize: 1
[2019-07-26 14:35:15] [config] num-devices: 0
[2019-07-26 14:35:15] [config] optimizer: adam
[2019-07-26 14:35:15] [config] optimizer-delay: 1
[2019-07-26 14:35:15] [config] optimizer-params:
[2019-07-26 14:35:15] [config]   []
[2019-07-26 14:35:15] [config] overwrite: false
[2019-07-26 14:35:15] [config] pretrained-model: ""
[2019-07-26 14:35:15] [config] quiet: false
[2019-07-26 14:35:15] [config] quiet-translation: true
[2019-07-26 14:35:15] [config] relative-paths: false
[2019-07-26 14:35:15] [config] right-left: false
[2019-07-26 14:35:15] [config] save-freq: 20000
[2019-07-26 14:35:15] [config] seed: 1111
[2019-07-26 14:35:15] [config] shuffle-in-ram: false
[2019-07-26 14:35:15] [config] skip: false
[2019-07-26 14:35:15] [config] sqlite: ""
[2019-07-26 14:35:15] [config] sqlite-drop: false
[2019-07-26 14:35:15] [config] sync-sgd: true
[2019-07-26 14:35:15] [config] tempdir: .
[2019-07-26 14:35:15] [config] tied-embeddings: false
[2019-07-26 14:35:15] [config] tied-embeddings-all: false
[2019-07-26 14:35:15] [config] tied-embeddings-src: false
[2019-07-26 14:35:15] [config] train-sets:
[2019-07-26 14:35:15] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de
[2019-07-26 14:35:15] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en
[2019-07-26 14:35:15] [config] transformer-aan-activation: swish
[2019-07-26 14:35:15] [config] transformer-aan-depth: 2
[2019-07-26 14:35:15] [config] transformer-aan-nogate: false
[2019-07-26 14:35:15] [config] transformer-decoder-autoreg: self-attention
[2019-07-26 14:35:15] [config] transformer-dim-aan: 2048
[2019-07-26 14:35:15] [config] transformer-dim-ffn: 2048
[2019-07-26 14:35:15] [config] transformer-dropout: 0
[2019-07-26 14:35:15] [config] transformer-dropout-attention: 0
[2019-07-26 14:35:15] [config] transformer-dropout-ffn: 0
[2019-07-26 14:35:15] [config] transformer-ffn-activation: swish
[2019-07-26 14:35:15] [config] transformer-ffn-depth: 2
[2019-07-26 14:35:15] [config] transformer-guided-alignment-layer: last
[2019-07-26 14:35:15] [config] transformer-heads: 8
[2019-07-26 14:35:15] [config] transformer-no-projection: false
[2019-07-26 14:35:15] [config] transformer-postprocess: dan
[2019-07-26 14:35:15] [config] transformer-postprocess-emb: d
[2019-07-26 14:35:15] [config] transformer-preprocess: ""
[2019-07-26 14:35:15] [config] transformer-tied-layers:
[2019-07-26 14:35:15] [config]   []
[2019-07-26 14:35:15] [config] transformer-train-position-embeddings: false
[2019-07-26 14:35:15] [config] type: amun
[2019-07-26 14:35:15] [config] ulr: false
[2019-07-26 14:35:15] [config] ulr-dim-emb: 0
[2019-07-26 14:35:15] [config] ulr-dropout: 0
[2019-07-26 14:35:15] [config] ulr-keys-vectors: ""
[2019-07-26 14:35:15] [config] ulr-query-vectors: ""
[2019-07-26 14:35:15] [config] ulr-softmax-temperature: 1
[2019-07-26 14:35:15] [config] ulr-trainable-transformation: false
[2019-07-26 14:35:15] [config] valid-freq: 20000
[2019-07-26 14:35:15] [config] valid-log: ../experiments/10M_bicleaner_dcce_w3000/model/valid.log
[2019-07-26 14:35:15] [config] valid-max-length: 1000
[2019-07-26 14:35:15] [config] valid-metrics:
[2019-07-26 14:35:15] [config]   - cross-entropy
[2019-07-26 14:35:15] [config]   - perplexity
[2019-07-26 14:35:15] [config]   - translation
[2019-07-26 14:35:15] [config] valid-mini-batch: 8
[2019-07-26 14:35:15] [config] valid-script-path: ../experiments/10M_bicleaner_dcce_w3000/score-dev.sh
[2019-07-26 14:35:15] [config] valid-sets:
[2019-07-26 14:35:15] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.de
[2019-07-26 14:35:15] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/dev.bpe.en
[2019-07-26 14:35:15] [config] valid-translation-output: ../experiments/10M_bicleaner_dcce_w3000/model/dev.out
[2019-07-26 14:35:15] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 14:35:15] [config] vocabs:
[2019-07-26 14:35:15] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 14:35:15] [config]   - ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 14:35:15] [config] word-penalty: 0
[2019-07-26 14:35:15] [config] workspace: 3000
[2019-07-26 14:35:15] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-26 14:35:15] Using synchronous training
[2019-07-26 14:35:15] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.de.json
[2019-07-26 14:35:16] [data] Using unused word id eos for 0
[2019-07-26 14:35:16] [data] Using unused word id UNK for 1
[2019-07-26 14:35:16] [data] Setting vocabulary size for input 0 to 50000
[2019-07-26 14:35:16] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_dcce_w3000/data/train.bpe.en.json
[2019-07-26 14:35:17] [data] Using unused word id eos for 0
[2019-07-26 14:35:17] [data] Using unused word id UNK for 1
[2019-07-26 14:35:17] [data] Setting vocabulary size for input 1 to 50000
[2019-07-26 14:35:17] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-26 14:35:17] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-26 14:35:19] [memory] Extending reserved space to 3072 MB (device gpu6)
[2019-07-26 14:35:22] [memory] Extending reserved space to 3072 MB (device gpu7)
[2019-07-26 14:35:22] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-26 14:35:23] [comm] NCCLCommunicator constructed successfully.
[2019-07-26 14:35:23] [training] Using 2 GPUs
[2019-07-26 14:35:23] [memory] Reserving 422 MB, device gpu6
[2019-07-26 14:35:23] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-26 14:35:23] [memory] Reserving 422 MB, device gpu6
[2019-07-26 14:35:26] [batching] Done. Typical MB size is 8084 target words
[2019-07-26 14:35:26] [memory] Extending reserved space to 3072 MB (device gpu6)
[2019-07-26 14:35:26] [memory] Extending reserved space to 3072 MB (device gpu7)
[2019-07-26 14:35:26] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-26 14:35:26] [comm] NCCLCommunicator constructed successfully.
[2019-07-26 14:35:26] [training] Using 2 GPUs
[2019-07-26 14:35:26] Loading model from ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 14:35:36] Loading model from ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 14:35:41] Loading Adam parameters from ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-26 14:35:56] [memory] Reserving 422 MB, device gpu6
[2019-07-26 14:35:56] [memory] Reserving 422 MB, device gpu7
[2019-07-26 14:35:58] [training] Model reloaded from ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 14:35:58] [data] Restoring the corpus state to epoch 20, batch 40000
[2019-07-26 14:35:58] [data] Shuffling data
[2019-07-26 14:35:59] [data] Done reading 545666 sentences
[2019-07-26 14:36:03] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 14:36:09] Training started
[2019-07-26 14:36:09] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-26 14:36:09] [memory] Reserving 422 MB, device gpu6
[2019-07-26 14:36:09] [memory] Reserving 422 MB, device gpu7
[2019-07-26 14:36:10] [memory] Reserving 422 MB, device gpu6
[2019-07-26 14:36:10] [memory] Reserving 422 MB, device gpu7
[2019-07-26 14:36:10] Loading model from ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 14:36:23] [memory] Reserving 422 MB, device cpu0
[2019-07-26 14:36:24] [memory] Reserving 211 MB, device gpu6
[2019-07-26 14:36:24] [memory] Reserving 211 MB, device gpu7
[2019-07-26 14:59:09] Seen 503759 samples
[2019-07-26 14:59:09] Starting epoch 21
[2019-07-26 14:59:09] [data] Shuffling data
[2019-07-26 14:59:12] [data] Done reading 545666 sentences
[2019-07-26 14:59:18] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 15:00:53] Ep. 21 : Up. 42000 : Sen. 29,544 : Cost 29.05070877 : Time 1535.98s : 6720.92 words/s
[2019-07-26 15:24:48] Seen 503759 samples
[2019-07-26 15:24:48] Starting epoch 22
[2019-07-26 15:24:48] [data] Shuffling data
[2019-07-26 15:24:50] [data] Done reading 545666 sentences
[2019-07-26 15:25:00] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 15:25:22] Ep. 22 : Up. 44000 : Sen. 5,990 : Cost 28.71719551 : Time 1469.15s : 6997.39 words/s
[2019-07-26 15:49:34] Ep. 22 : Up. 46000 : Sen. 487,728 : Cost 28.03602219 : Time 1452.06s : 7095.60 words/s
[2019-07-26 15:50:25] Seen 503759 samples
[2019-07-26 15:50:25] Starting epoch 23
[2019-07-26 15:50:25] [data] Shuffling data
[2019-07-26 15:50:26] [data] Done reading 545666 sentences
[2019-07-26 15:50:32] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 16:13:39] Ep. 23 : Up. 48000 : Sen. 463,102 : Cost 27.58338928 : Time 1445.29s : 7095.49 words/s
[2019-07-26 16:15:26] Seen 503759 samples
[2019-07-26 16:15:26] Starting epoch 24
[2019-07-26 16:15:26] [data] Shuffling data
[2019-07-26 16:15:29] [data] Done reading 545666 sentences
[2019-07-26 16:15:34] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 16:37:07] Ep. 24 : Up. 50000 : Sen. 440,002 : Cost 27.08944511 : Time 1408.32s : 7306.65 words/s
[2019-07-26 16:40:13] Seen 503759 samples
[2019-07-26 16:40:13] Starting epoch 25
[2019-07-26 16:40:13] [data] Shuffling data
[2019-07-26 16:40:15] [data] Done reading 545666 sentences
[2019-07-26 16:40:24] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 17:01:01] Ep. 25 : Up. 52000 : Sen. 418,596 : Cost 26.54119682 : Time 1433.91s : 7198.48 words/s
[2019-07-26 17:05:09] Seen 503759 samples
[2019-07-26 17:05:09] Starting epoch 26
[2019-07-26 17:05:09] [data] Shuffling data
[2019-07-26 17:05:11] [data] Done reading 545666 sentences
[2019-07-26 17:05:19] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 17:24:59] Ep. 26 : Up. 54000 : Sen. 395,334 : Cost 26.15828896 : Time 1438.14s : 7141.42 words/s
[2019-07-26 17:30:39] Seen 503759 samples
[2019-07-26 17:30:40] Starting epoch 27
[2019-07-26 17:30:40] [data] Shuffling data
[2019-07-26 17:30:42] [data] Done reading 545666 sentences
[2019-07-26 17:30:53] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 17:47:49] Ep. 27 : Up. 56000 : Sen. 374,078 : Cost 25.74004364 : Time 1369.45s : 7530.81 words/s
[2019-07-26 17:53:02] Seen 503759 samples
[2019-07-26 17:53:02] Starting epoch 28
[2019-07-26 17:53:02] [data] Shuffling data
[2019-07-26 17:53:03] [data] Done reading 545666 sentences
[2019-07-26 17:53:06] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 18:06:55] Ep. 28 : Up. 58000 : Sen. 350,912 : Cost 25.50706482 : Time 1145.78s : 8993.45 words/s
[2019-07-26 18:12:51] Seen 503759 samples
[2019-07-26 18:12:51] Starting epoch 29
[2019-07-26 18:12:51] [data] Shuffling data
[2019-07-26 18:12:52] [data] Done reading 545666 sentences
[2019-07-26 18:12:58] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 18:24:49] Ep. 29 : Up. 60000 : Sen. 328,674 : Cost 24.90995407 : Time 1073.97s : 9572.21 words/s
[2019-07-26 18:24:49] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 18:25:03] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter60000.npz
[2019-07-26 18:25:12] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 18:25:27] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-26 18:26:03] [valid] Ep. 29 : Up. 60000 : cross-entropy : 61.8212 : new best
[2019-07-26 18:26:12] [valid] Ep. 29 : Up. 60000 : perplexity : 11.3578 : new best
[2019-07-26 18:27:21] [valid] Ep. 29 : Up. 60000 : translation : 26.02 : new best
[2019-07-26 18:33:14] Seen 503759 samples
[2019-07-26 18:33:14] Starting epoch 30
[2019-07-26 18:33:14] [data] Shuffling data
[2019-07-26 18:33:15] [data] Done reading 545666 sentences
[2019-07-26 18:33:19] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 18:43:31] Ep. 30 : Up. 62000 : Sen. 306,068 : Cost 24.68737221 : Time 1122.56s : 9177.14 words/s
[2019-07-26 18:49:57] Seen 503759 samples
[2019-07-26 18:49:57] Starting epoch 31
[2019-07-26 18:49:57] [data] Shuffling data
[2019-07-26 18:49:58] [data] Done reading 545666 sentences
[2019-07-26 18:50:03] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 18:59:34] Ep. 31 : Up. 64000 : Sen. 283,066 : Cost 24.31392288 : Time 962.89s : 10684.20 words/s
[2019-07-26 19:07:05] Seen 503759 samples
[2019-07-26 19:07:05] Starting epoch 32
[2019-07-26 19:07:05] [data] Shuffling data
[2019-07-26 19:07:06] [data] Done reading 545666 sentences
[2019-07-26 19:07:10] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 19:15:57] Ep. 32 : Up. 66000 : Sen. 259,600 : Cost 24.05675697 : Time 982.78s : 10457.83 words/s
[2019-07-26 19:24:02] Seen 503759 samples
[2019-07-26 19:24:02] Starting epoch 33
[2019-07-26 19:24:02] [data] Shuffling data
[2019-07-26 19:24:03] [data] Done reading 545666 sentences
[2019-07-26 19:24:07] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 19:32:02] Ep. 33 : Up. 68000 : Sen. 235,540 : Cost 23.77167892 : Time 965.42s : 10626.38 words/s
[2019-07-26 19:41:09] Seen 503759 samples
[2019-07-26 19:41:09] Starting epoch 34
[2019-07-26 19:41:09] [data] Shuffling data
[2019-07-26 19:41:09] [data] Done reading 545666 sentences
[2019-07-26 19:41:12] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 19:47:44] Ep. 34 : Up. 70000 : Sen. 211,200 : Cost 23.35228348 : Time 941.72s : 10891.34 words/s
[2019-07-26 19:56:51] Seen 503759 samples
[2019-07-26 19:56:51] Starting epoch 35
[2019-07-26 19:56:51] [data] Shuffling data
[2019-07-26 19:56:51] [data] Done reading 545666 sentences
[2019-07-26 19:56:55] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 20:03:21] Ep. 35 : Up. 72000 : Sen. 189,674 : Cost 23.06224823 : Time 936.75s : 11018.14 words/s
[2019-07-26 20:13:50] Seen 503759 samples
[2019-07-26 20:13:50] Starting epoch 36
[2019-07-26 20:13:50] [data] Shuffling data
[2019-07-26 20:13:51] [data] Done reading 545666 sentences
[2019-07-26 20:13:55] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 20:19:35] Ep. 36 : Up. 74000 : Sen. 164,950 : Cost 22.70600891 : Time 974.15s : 10531.76 words/s
[2019-07-26 20:31:14] Seen 503759 samples
[2019-07-26 20:31:14] Starting epoch 37
[2019-07-26 20:31:14] [data] Shuffling data
[2019-07-26 20:31:15] [data] Done reading 545666 sentences
[2019-07-26 20:31:19] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 20:36:11] Ep. 37 : Up. 76000 : Sen. 144,694 : Cost 22.42260933 : Time 995.87s : 10368.97 words/s
[2019-07-26 20:48:25] Seen 503759 samples
[2019-07-26 20:48:25] Starting epoch 38
[2019-07-26 20:48:25] [data] Shuffling data
[2019-07-26 20:48:26] [data] Done reading 545666 sentences
[2019-07-26 20:48:30] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 20:52:36] Ep. 38 : Up. 78000 : Sen. 120,252 : Cost 22.23365211 : Time 984.83s : 10427.12 words/s
[2019-07-26 21:05:43] Seen 503759 samples
[2019-07-26 21:05:43] Starting epoch 39
[2019-07-26 21:05:43] [data] Shuffling data
[2019-07-26 21:05:44] [data] Done reading 545666 sentences
[2019-07-26 21:05:47] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 21:09:00] Ep. 39 : Up. 80000 : Sen. 96,000 : Cost 21.85118103 : Time 984.52s : 10414.83 words/s
[2019-07-26 21:09:00] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 21:09:14] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter80000.npz
[2019-07-26 21:09:23] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 21:09:37] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-26 21:10:14] [valid] Ep. 39 : Up. 80000 : cross-entropy : 63.2039 : stalled 1 times (last best: 61.8212)
[2019-07-26 21:10:21] [valid] Ep. 39 : Up. 80000 : perplexity : 11.9921 : stalled 1 times (last best: 11.3578)
[2019-07-26 21:11:34] [valid] Ep. 39 : Up. 80000 : translation : 25.93 : stalled 1 times (last best: 26.02)
[2019-07-26 21:25:12] Seen 503759 samples
[2019-07-26 21:25:12] Starting epoch 40
[2019-07-26 21:25:12] [data] Shuffling data
[2019-07-26 21:25:13] [data] Done reading 545666 sentences
[2019-07-26 21:25:18] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 21:27:49] Ep. 40 : Up. 82000 : Sen. 72,096 : Cost 21.63895226 : Time 1128.98s : 9093.96 words/s
[2019-07-26 21:42:26] Seen 503759 samples
[2019-07-26 21:42:26] Starting epoch 41
[2019-07-26 21:42:26] [data] Shuffling data
[2019-07-26 21:42:27] [data] Done reading 545666 sentences
[2019-07-26 21:42:31] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 21:44:17] Ep. 41 : Up. 84000 : Sen. 50,618 : Cost 21.34085274 : Time 988.17s : 10437.57 words/s
[2019-07-26 21:59:44] Seen 503759 samples
[2019-07-26 21:59:44] Starting epoch 42
[2019-07-26 21:59:44] [data] Shuffling data
[2019-07-26 21:59:45] [data] Done reading 545666 sentences
[2019-07-26 21:59:48] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 22:00:48] Ep. 42 : Up. 86000 : Sen. 28,212 : Cost 21.18472862 : Time 990.84s : 10398.28 words/s
[2019-07-26 22:17:07] Seen 503759 samples
[2019-07-26 22:17:07] Starting epoch 43
[2019-07-26 22:17:07] [data] Shuffling data
[2019-07-26 22:17:07] [data] Done reading 545666 sentences
[2019-07-26 22:17:11] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 22:17:17] Ep. 43 : Up. 88000 : Sen. 3,162 : Cost 20.94976616 : Time 989.21s : 10349.69 words/s
[2019-07-26 22:33:46] Ep. 43 : Up. 90000 : Sen. 484,122 : Cost 20.70764351 : Time 988.67s : 10419.01 words/s
[2019-07-26 22:34:25] Seen 503759 samples
[2019-07-26 22:34:25] Starting epoch 44
[2019-07-26 22:34:25] [data] Shuffling data
[2019-07-26 22:34:26] [data] Done reading 545666 sentences
[2019-07-26 22:34:30] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 22:50:20] Ep. 44 : Up. 92000 : Sen. 460,800 : Cost 20.46793175 : Time 993.80s : 10336.58 words/s
[2019-07-26 22:51:50] Seen 503759 samples
[2019-07-26 22:51:50] Starting epoch 45
[2019-07-26 22:51:50] [data] Shuffling data
[2019-07-26 22:51:50] [data] Done reading 545666 sentences
[2019-07-26 22:51:54] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 23:06:38] Ep. 45 : Up. 94000 : Sen. 439,202 : Cost 20.31132507 : Time 977.79s : 10549.43 words/s
[2019-07-26 23:08:48] Seen 503759 samples
[2019-07-26 23:08:48] Starting epoch 46
[2019-07-26 23:08:48] [data] Shuffling data
[2019-07-26 23:08:48] [data] Done reading 545666 sentences
[2019-07-26 23:08:53] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 23:22:56] Ep. 46 : Up. 96000 : Sen. 415,370 : Cost 20.09882927 : Time 978.49s : 10494.14 words/s
[2019-07-26 23:25:58] Seen 503759 samples
[2019-07-26 23:25:58] Starting epoch 47
[2019-07-26 23:25:58] [data] Shuffling data
[2019-07-26 23:25:59] [data] Done reading 545666 sentences
[2019-07-26 23:26:04] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 23:39:05] Ep. 47 : Up. 98000 : Sen. 393,062 : Cost 19.82686996 : Time 968.91s : 10635.56 words/s
[2019-07-26 23:42:55] Seen 503759 samples
[2019-07-26 23:42:55] Starting epoch 48
[2019-07-26 23:42:55] [data] Shuffling data
[2019-07-26 23:42:56] [data] Done reading 545666 sentences
[2019-07-26 23:43:01] [data] Done shuffling 545666 sentences to temp files
[2019-07-26 23:55:41] Ep. 48 : Up. 100000 : Sen. 368,853 : Cost 19.80407715 : Time 995.92s : 10300.91 words/s
[2019-07-26 23:55:41] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-26 23:55:57] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter100000.npz
[2019-07-26 23:56:07] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-26 23:56:22] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-26 23:57:00] [valid] Ep. 48 : Up. 100000 : cross-entropy : 65.1444 : stalled 2 times (last best: 61.8212)
[2019-07-26 23:57:06] [valid] Ep. 48 : Up. 100000 : perplexity : 12.9426 : stalled 2 times (last best: 11.3578)
[2019-07-26 23:58:18] [valid] Ep. 48 : Up. 100000 : translation : 25.27 : stalled 2 times (last best: 26.02)
[2019-07-27 00:02:57] Seen 503759 samples
[2019-07-27 00:02:57] Starting epoch 49
[2019-07-27 00:02:57] [data] Shuffling data
[2019-07-27 00:02:58] [data] Done reading 545666 sentences
[2019-07-27 00:03:02] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 00:14:57] Ep. 49 : Up. 102000 : Sen. 344,542 : Cost 19.48801613 : Time 1156.01s : 8877.40 words/s
[2019-07-27 00:20:17] Seen 503759 samples
[2019-07-27 00:20:17] Starting epoch 50
[2019-07-27 00:20:17] [data] Shuffling data
[2019-07-27 00:20:18] [data] Done reading 545666 sentences
[2019-07-27 00:20:22] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 00:31:22] Ep. 50 : Up. 104000 : Sen. 322,074 : Cost 19.33192062 : Time 985.20s : 10433.59 words/s
[2019-07-27 00:37:35] Seen 503759 samples
[2019-07-27 00:37:35] Starting epoch 51
[2019-07-27 00:37:35] [data] Shuffling data
[2019-07-27 00:37:36] [data] Done reading 545666 sentences
[2019-07-27 00:37:39] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 00:47:53] Ep. 51 : Up. 106000 : Sen. 298,805 : Cost 19.15891838 : Time 990.75s : 10395.31 words/s
[2019-07-27 00:54:51] Seen 503759 samples
[2019-07-27 00:54:51] Starting epoch 52
[2019-07-27 00:54:51] [data] Shuffling data
[2019-07-27 00:54:51] [data] Done reading 545666 sentences
[2019-07-27 00:54:55] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 01:04:26] Ep. 52 : Up. 108000 : Sen. 276,788 : Cost 18.91805458 : Time 993.45s : 10361.52 words/s
[2019-07-27 01:12:15] Seen 503759 samples
[2019-07-27 01:12:15] Starting epoch 53
[2019-07-27 01:12:15] [data] Shuffling data
[2019-07-27 01:12:16] [data] Done reading 545666 sentences
[2019-07-27 01:12:19] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 01:20:47] Ep. 53 : Up. 110000 : Sen. 254,130 : Cost 18.88979530 : Time 980.91s : 10505.11 words/s
[2019-07-27 01:29:07] Seen 503759 samples
[2019-07-27 01:29:07] Starting epoch 54
[2019-07-27 01:29:07] [data] Shuffling data
[2019-07-27 01:29:08] [data] Done reading 545666 sentences
[2019-07-27 01:29:12] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 01:37:09] Ep. 54 : Up. 112000 : Sen. 228,682 : Cost 18.66935730 : Time 981.37s : 10428.25 words/s
[2019-07-27 01:46:32] Seen 503759 samples
[2019-07-27 01:46:32] Starting epoch 55
[2019-07-27 01:46:32] [data] Shuffling data
[2019-07-27 01:46:33] [data] Done reading 545666 sentences
[2019-07-27 01:46:37] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 01:53:34] Ep. 55 : Up. 114000 : Sen. 207,474 : Cost 18.37807274 : Time 985.26s : 10465.45 words/s
[2019-07-27 02:03:46] Seen 503759 samples
[2019-07-27 02:03:46] Starting epoch 56
[2019-07-27 02:03:46] [data] Shuffling data
[2019-07-27 02:03:47] [data] Done reading 545666 sentences
[2019-07-27 02:03:51] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 02:10:18] Ep. 56 : Up. 116000 : Sen. 186,590 : Cost 18.25636864 : Time 1003.96s : 10299.75 words/s
[2019-07-27 02:21:03] Seen 503759 samples
[2019-07-27 02:21:03] Starting epoch 57
[2019-07-27 02:21:03] [data] Shuffling data
[2019-07-27 02:21:04] [data] Done reading 545666 sentences
[2019-07-27 02:21:08] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 02:26:52] Ep. 57 : Up. 118000 : Sen. 165,012 : Cost 18.23731041 : Time 994.18s : 10369.79 words/s
[2019-07-27 02:38:27] Seen 503759 samples
[2019-07-27 02:38:27] Starting epoch 58
[2019-07-27 02:38:27] [data] Shuffling data
[2019-07-27 02:38:28] [data] Done reading 545666 sentences
[2019-07-27 02:38:32] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 02:43:28] Ep. 58 : Up. 120000 : Sen. 142,820 : Cost 18.01617622 : Time 995.45s : 10342.73 words/s
[2019-07-27 02:43:28] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-27 02:43:43] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter120000.npz
[2019-07-27 02:43:51] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-27 02:44:06] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-27 02:44:40] [valid] Ep. 58 : Up. 120000 : cross-entropy : 67.3481 : stalled 3 times (last best: 61.8212)
[2019-07-27 02:44:45] [valid] Ep. 58 : Up. 120000 : perplexity : 14.1136 : stalled 3 times (last best: 11.3578)
[2019-07-27 02:45:55] [valid] Ep. 58 : Up. 120000 : translation : 25.01 : stalled 3 times (last best: 26.02)
[2019-07-27 02:58:18] Seen 503759 samples
[2019-07-27 02:58:18] Starting epoch 59
[2019-07-27 02:58:18] [data] Shuffling data
[2019-07-27 02:58:19] [data] Done reading 545666 sentences
[2019-07-27 02:58:24] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 03:02:28] Ep. 59 : Up. 122000 : Sen. 119,428 : Cost 18.00287628 : Time 1140.85s : 9015.60 words/s
[2019-07-27 03:15:48] Seen 503759 samples
[2019-07-27 03:15:48] Starting epoch 60
[2019-07-27 03:15:48] [data] Shuffling data
[2019-07-27 03:15:49] [data] Done reading 545666 sentences
[2019-07-27 03:15:52] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 03:18:56] Ep. 60 : Up. 124000 : Sen. 95,574 : Cost 17.82182884 : Time 987.76s : 10399.07 words/s
[2019-07-27 03:33:05] Seen 503759 samples
[2019-07-27 03:33:05] Starting epoch 61
[2019-07-27 03:33:05] [data] Shuffling data
[2019-07-27 03:33:06] [data] Done reading 545666 sentences
[2019-07-27 03:33:09] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 03:35:42] Ep. 61 : Up. 126000 : Sen. 70,868 : Cost 17.59081268 : Time 1005.36s : 10206.53 words/s
[2019-07-27 03:50:26] Seen 503759 samples
[2019-07-27 03:50:26] Starting epoch 62
[2019-07-27 03:50:26] [data] Shuffling data
[2019-07-27 03:50:27] [data] Done reading 545666 sentences
[2019-07-27 03:50:33] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 03:52:16] Ep. 62 : Up. 128000 : Sen. 47,826 : Cost 17.49311256 : Time 994.29s : 10337.46 words/s
[2019-07-27 04:07:58] Seen 503759 samples
[2019-07-27 04:07:58] Starting epoch 63
[2019-07-27 04:07:58] [data] Shuffling data
[2019-07-27 04:07:59] [data] Done reading 545666 sentences
[2019-07-27 04:08:05] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 04:09:01] Ep. 63 : Up. 130000 : Sen. 25,960 : Cost 17.31753159 : Time 1004.60s : 10261.09 words/s
[2019-07-27 04:25:33] Seen 503759 samples
[2019-07-27 04:25:33] Starting epoch 64
[2019-07-27 04:25:33] [data] Shuffling data
[2019-07-27 04:25:33] [data] Done reading 545666 sentences
[2019-07-27 04:25:37] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 04:25:46] Ep. 64 : Up. 132000 : Sen. 3,162 : Cost 17.20419693 : Time 1005.48s : 10234.41 words/s
[2019-07-27 04:42:20] Ep. 64 : Up. 134000 : Sen. 484,984 : Cost 17.04140472 : Time 993.79s : 10358.99 words/s
[2019-07-27 04:42:56] Seen 503759 samples
[2019-07-27 04:42:56] Starting epoch 65
[2019-07-27 04:42:56] [data] Shuffling data
[2019-07-27 04:42:57] [data] Done reading 545666 sentences
[2019-07-27 04:43:01] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 04:58:58] Ep. 65 : Up. 136000 : Sen. 461,996 : Cost 16.99716187 : Time 997.93s : 10322.58 words/s
[2019-07-27 05:00:23] Seen 503759 samples
[2019-07-27 05:00:23] Starting epoch 66
[2019-07-27 05:00:23] [data] Shuffling data
[2019-07-27 05:00:23] [data] Done reading 545666 sentences
[2019-07-27 05:00:27] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 05:15:29] Ep. 66 : Up. 138000 : Sen. 438,575 : Cost 16.75779343 : Time 991.75s : 10359.65 words/s
[2019-07-27 05:17:35] Seen 503759 samples
[2019-07-27 05:17:35] Starting epoch 67
[2019-07-27 05:17:35] [data] Shuffling data
[2019-07-27 05:17:36] [data] Done reading 545666 sentences
[2019-07-27 05:17:40] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 05:31:52] Ep. 67 : Up. 140000 : Sen. 415,434 : Cost 16.68056870 : Time 982.14s : 10469.36 words/s
[2019-07-27 05:31:52] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-27 05:32:06] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter140000.npz
[2019-07-27 05:32:15] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-27 05:32:29] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-27 05:33:14] [valid] Ep. 67 : Up. 140000 : cross-entropy : 69.5798 : stalled 4 times (last best: 61.8212)
[2019-07-27 05:33:21] [valid] Ep. 67 : Up. 140000 : perplexity : 15.4076 : stalled 4 times (last best: 11.3578)
[2019-07-27 05:34:32] [valid] Ep. 67 : Up. 140000 : translation : 24.35 : stalled 4 times (last best: 26.02)
[2019-07-27 05:37:39] Seen 503759 samples
[2019-07-27 05:37:39] Starting epoch 68
[2019-07-27 05:37:39] [data] Shuffling data
[2019-07-27 05:37:40] [data] Done reading 545666 sentences
[2019-07-27 05:37:44] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 05:51:21] Ep. 68 : Up. 142000 : Sen. 393,544 : Cost 16.63818359 : Time 1169.00s : 8813.11 words/s
[2019-07-27 05:55:08] Seen 503759 samples
[2019-07-27 05:55:08] Starting epoch 69
[2019-07-27 05:55:08] [data] Shuffling data
[2019-07-27 05:55:09] [data] Done reading 545666 sentences
[2019-07-27 05:55:13] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 06:07:37] Ep. 69 : Up. 144000 : Sen. 369,842 : Cost 16.58355904 : Time 976.77s : 10524.62 words/s
[2019-07-27 06:12:07] Seen 503759 samples
[2019-07-27 06:12:07] Starting epoch 70
[2019-07-27 06:12:07] [data] Shuffling data
[2019-07-27 06:12:07] [data] Done reading 545666 sentences
[2019-07-27 06:12:11] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 06:24:00] Ep. 70 : Up. 146000 : Sen. 347,926 : Cost 16.45697403 : Time 982.16s : 10501.27 words/s
[2019-07-27 06:29:12] Seen 503759 samples
[2019-07-27 06:29:12] Starting epoch 71
[2019-07-27 06:29:12] [data] Shuffling data
[2019-07-27 06:29:13] [data] Done reading 545666 sentences
[2019-07-27 06:29:17] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 06:40:25] Ep. 71 : Up. 148000 : Sen. 325,990 : Cost 16.25634956 : Time 984.98s : 10454.29 words/s
[2019-07-27 06:46:30] Seen 503759 samples
[2019-07-27 06:46:30] Starting epoch 72
[2019-07-27 06:46:30] [data] Shuffling data
[2019-07-27 06:46:30] [data] Done reading 545666 sentences
[2019-07-27 06:46:35] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 06:56:55] Ep. 72 : Up. 150000 : Sen. 302,872 : Cost 16.22876358 : Time 990.63s : 10399.09 words/s
[2019-07-27 07:03:41] Seen 503759 samples
[2019-07-27 07:03:41] Starting epoch 73
[2019-07-27 07:03:41] [data] Shuffling data
[2019-07-27 07:03:42] [data] Done reading 545666 sentences
[2019-07-27 07:03:46] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 07:13:18] Ep. 73 : Up. 152000 : Sen. 278,768 : Cost 16.01734352 : Time 982.91s : 10436.80 words/s
[2019-07-27 07:20:50] Seen 503759 samples
[2019-07-27 07:20:50] Starting epoch 74
[2019-07-27 07:20:50] [data] Shuffling data
[2019-07-27 07:20:51] [data] Done reading 545666 sentences
[2019-07-27 07:20:56] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 07:29:43] Ep. 74 : Up. 154000 : Sen. 256,976 : Cost 15.87307835 : Time 984.85s : 10452.36 words/s
[2019-07-27 07:37:51] Seen 503759 samples
[2019-07-27 07:37:51] Starting epoch 75
[2019-07-27 07:37:51] [data] Shuffling data
[2019-07-27 07:37:52] [data] Done reading 545666 sentences
[2019-07-27 07:37:55] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 07:45:55] Ep. 75 : Up. 156000 : Sen. 234,829 : Cost 15.93939304 : Time 971.88s : 10594.15 words/s
[2019-07-27 07:55:07] Seen 503759 samples
[2019-07-27 07:55:07] Starting epoch 76
[2019-07-27 07:55:07] [data] Shuffling data
[2019-07-27 07:55:08] [data] Done reading 545666 sentences
[2019-07-27 07:55:11] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 08:02:24] Ep. 76 : Up. 158000 : Sen. 211,610 : Cost 15.76454544 : Time 989.33s : 10400.54 words/s
[2019-07-27 08:12:10] Seen 503759 samples
[2019-07-27 08:12:10] Starting epoch 77
[2019-07-27 08:12:10] [data] Shuffling data
[2019-07-27 08:12:10] [data] Done reading 545666 sentences
[2019-07-27 08:12:14] [data] Done shuffling 545666 sentences to temp files
[2019-07-27 08:18:31] Ep. 77 : Up. 160000 : Sen. 188,085 : Cost 15.82949352 : Time 967.11s : 10625.36 words/s
[2019-07-27 08:18:31] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-27 08:18:44] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.iter160000.npz
[2019-07-27 08:18:54] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-27 08:19:08] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
[2019-07-27 08:19:46] [valid] Ep. 77 : Up. 160000 : cross-entropy : 71.7343 : stalled 5 times (last best: 61.8212)
[2019-07-27 08:19:53] [valid] Ep. 77 : Up. 160000 : perplexity : 16.7692 : stalled 5 times (last best: 11.3578)
[2019-07-27 08:21:00] [valid] Ep. 77 : Up. 160000 : translation : 24.04 : stalled 5 times (last best: 26.02)
[2019-07-27 08:21:05] Training finished
[2019-07-27 08:21:15] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.orig.npz
[2019-07-27 08:21:27] Saving model to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz
[2019-07-27 08:21:42] Saving Adam parameters to ../experiments/10M_bicleaner_dcce_w3000/model/model.npz.optimizer.npz
