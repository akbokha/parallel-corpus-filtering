[2019-07-25 09:31:39] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 09:31:39] [marian] Running on fulla as process 365898 with command line:
[2019-07-25 09:31:39] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_st_lm_2/model/model.npz -T . --devices 4 5 --train-sets ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.de ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_st_lm_2/model/dev.out --valid-script-path ../experiments/10M_bicleaner_st_lm_2/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_st_lm_2/model/train.log --valid-log ../experiments/10M_bicleaner_st_lm_2/model/valid.log
[2019-07-25 09:31:39] [config] after-batches: 0
[2019-07-25 09:31:39] [config] after-epochs: 0
[2019-07-25 09:31:39] [config] allow-unk: false
[2019-07-25 09:31:39] [config] beam-size: 12
[2019-07-25 09:31:39] [config] bert-class-symbol: "[CLS]"
[2019-07-25 09:31:39] [config] bert-mask-symbol: "[MASK]"
[2019-07-25 09:31:39] [config] bert-masking-fraction: 0.15
[2019-07-25 09:31:39] [config] bert-sep-symbol: "[SEP]"
[2019-07-25 09:31:39] [config] bert-train-type-embeddings: true
[2019-07-25 09:31:39] [config] bert-type-vocab-size: 2
[2019-07-25 09:31:39] [config] best-deep: false
[2019-07-25 09:31:39] [config] clip-gemm: 0
[2019-07-25 09:31:39] [config] clip-norm: 1
[2019-07-25 09:31:39] [config] cost-type: ce-mean
[2019-07-25 09:31:39] [config] cpu-threads: 0
[2019-07-25 09:31:39] [config] data-weighting: ""
[2019-07-25 09:31:39] [config] data-weighting-type: sentence
[2019-07-25 09:31:39] [config] dec-cell: gru
[2019-07-25 09:31:39] [config] dec-cell-base-depth: 2
[2019-07-25 09:31:39] [config] dec-cell-high-depth: 1
[2019-07-25 09:31:39] [config] dec-depth: 1
[2019-07-25 09:31:39] [config] devices:
[2019-07-25 09:31:39] [config]   - 4
[2019-07-25 09:31:39] [config]   - 5
[2019-07-25 09:31:39] [config] dim-emb: 512
[2019-07-25 09:31:39] [config] dim-rnn: 1024
[2019-07-25 09:31:39] [config] dim-vocabs:
[2019-07-25 09:31:39] [config]   - 50000
[2019-07-25 09:31:39] [config]   - 50000
[2019-07-25 09:31:39] [config] disp-first: 0
[2019-07-25 09:31:39] [config] disp-freq: 2000
[2019-07-25 09:31:39] [config] disp-label-counts: false
[2019-07-25 09:31:39] [config] dropout-rnn: 0.2
[2019-07-25 09:31:39] [config] dropout-src: 0.1
[2019-07-25 09:31:39] [config] dropout-trg: 0.1
[2019-07-25 09:31:39] [config] dump-config: ""
[2019-07-25 09:31:39] [config] early-stopping: 5
[2019-07-25 09:31:39] [config] embedding-fix-src: false
[2019-07-25 09:31:39] [config] embedding-fix-trg: false
[2019-07-25 09:31:39] [config] embedding-normalization: false
[2019-07-25 09:31:39] [config] embedding-vectors:
[2019-07-25 09:31:39] [config]   []
[2019-07-25 09:31:39] [config] enc-cell: gru
[2019-07-25 09:31:39] [config] enc-cell-depth: 1
[2019-07-25 09:31:39] [config] enc-depth: 1
[2019-07-25 09:31:39] [config] enc-type: bidirectional
[2019-07-25 09:31:39] [config] exponential-smoothing: 0.0001
[2019-07-25 09:31:39] [config] grad-dropping-momentum: 0
[2019-07-25 09:31:39] [config] grad-dropping-rate: 0
[2019-07-25 09:31:39] [config] grad-dropping-warmup: 100
[2019-07-25 09:31:39] [config] guided-alignment: none
[2019-07-25 09:31:39] [config] guided-alignment-cost: mse
[2019-07-25 09:31:39] [config] guided-alignment-weight: 0.1
[2019-07-25 09:31:39] [config] ignore-model-config: false
[2019-07-25 09:31:39] [config] input-types:
[2019-07-25 09:31:39] [config]   []
[2019-07-25 09:31:39] [config] interpolate-env-vars: false
[2019-07-25 09:31:39] [config] keep-best: false
[2019-07-25 09:31:39] [config] label-smoothing: 0
[2019-07-25 09:31:39] [config] layer-normalization: true
[2019-07-25 09:31:39] [config] learn-rate: 0.0001
[2019-07-25 09:31:39] [config] log: ../experiments/10M_bicleaner_st_lm_2/model/train.log
[2019-07-25 09:31:39] [config] log-level: info
[2019-07-25 09:31:39] [config] log-time-zone: ""
[2019-07-25 09:31:39] [config] lr-decay: 0
[2019-07-25 09:31:39] [config] lr-decay-freq: 50000
[2019-07-25 09:31:39] [config] lr-decay-inv-sqrt:
[2019-07-25 09:31:39] [config]   - 0
[2019-07-25 09:31:39] [config] lr-decay-repeat-warmup: false
[2019-07-25 09:31:39] [config] lr-decay-reset-optimizer: false
[2019-07-25 09:31:39] [config] lr-decay-start:
[2019-07-25 09:31:39] [config]   - 10
[2019-07-25 09:31:39] [config]   - 1
[2019-07-25 09:31:39] [config] lr-decay-strategy: epoch+stalled
[2019-07-25 09:31:39] [config] lr-report: false
[2019-07-25 09:31:39] [config] lr-warmup: 0
[2019-07-25 09:31:39] [config] lr-warmup-at-reload: false
[2019-07-25 09:31:39] [config] lr-warmup-cycle: false
[2019-07-25 09:31:39] [config] lr-warmup-start-rate: 0
[2019-07-25 09:31:39] [config] max-length: 50
[2019-07-25 09:31:39] [config] max-length-crop: false
[2019-07-25 09:31:39] [config] max-length-factor: 3
[2019-07-25 09:31:39] [config] maxi-batch: 100
[2019-07-25 09:31:39] [config] maxi-batch-sort: trg
[2019-07-25 09:31:39] [config] mini-batch: 64
[2019-07-25 09:31:39] [config] mini-batch-fit: true
[2019-07-25 09:31:39] [config] mini-batch-fit-step: 10
[2019-07-25 09:31:39] [config] mini-batch-overstuff: 1
[2019-07-25 09:31:39] [config] mini-batch-track-lr: false
[2019-07-25 09:31:39] [config] mini-batch-understuff: 1
[2019-07-25 09:31:39] [config] mini-batch-warmup: 0
[2019-07-25 09:31:39] [config] mini-batch-words: 0
[2019-07-25 09:31:39] [config] mini-batch-words-ref: 0
[2019-07-25 09:31:39] [config] model: ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 09:31:39] [config] multi-loss-type: sum
[2019-07-25 09:31:39] [config] multi-node: false
[2019-07-25 09:31:39] [config] multi-node-overlap: true
[2019-07-25 09:31:39] [config] n-best: false
[2019-07-25 09:31:39] [config] no-nccl: false
[2019-07-25 09:31:39] [config] no-reload: false
[2019-07-25 09:31:39] [config] no-restore-corpus: false
[2019-07-25 09:31:39] [config] no-shuffle: false
[2019-07-25 09:31:39] [config] normalize: 1
[2019-07-25 09:31:39] [config] num-devices: 0
[2019-07-25 09:31:39] [config] optimizer: adam
[2019-07-25 09:31:39] [config] optimizer-delay: 1
[2019-07-25 09:31:39] [config] optimizer-params:
[2019-07-25 09:31:39] [config]   []
[2019-07-25 09:31:39] [config] overwrite: false
[2019-07-25 09:31:39] [config] pretrained-model: ""
[2019-07-25 09:31:39] [config] quiet: false
[2019-07-25 09:31:39] [config] quiet-translation: true
[2019-07-25 09:31:39] [config] relative-paths: false
[2019-07-25 09:31:39] [config] right-left: false
[2019-07-25 09:31:39] [config] save-freq: 20000
[2019-07-25 09:31:39] [config] seed: 1111
[2019-07-25 09:31:39] [config] shuffle-in-ram: false
[2019-07-25 09:31:39] [config] skip: false
[2019-07-25 09:31:39] [config] sqlite: ""
[2019-07-25 09:31:39] [config] sqlite-drop: false
[2019-07-25 09:31:39] [config] sync-sgd: true
[2019-07-25 09:31:39] [config] tempdir: .
[2019-07-25 09:31:39] [config] tied-embeddings: false
[2019-07-25 09:31:39] [config] tied-embeddings-all: false
[2019-07-25 09:31:39] [config] tied-embeddings-src: false
[2019-07-25 09:31:39] [config] train-sets:
[2019-07-25 09:31:39] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de
[2019-07-25 09:31:39] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en
[2019-07-25 09:31:39] [config] transformer-aan-activation: swish
[2019-07-25 09:31:39] [config] transformer-aan-depth: 2
[2019-07-25 09:31:39] [config] transformer-aan-nogate: false
[2019-07-25 09:31:39] [config] transformer-decoder-autoreg: self-attention
[2019-07-25 09:31:39] [config] transformer-dim-aan: 2048
[2019-07-25 09:31:39] [config] transformer-dim-ffn: 2048
[2019-07-25 09:31:39] [config] transformer-dropout: 0
[2019-07-25 09:31:39] [config] transformer-dropout-attention: 0
[2019-07-25 09:31:39] [config] transformer-dropout-ffn: 0
[2019-07-25 09:31:39] [config] transformer-ffn-activation: swish
[2019-07-25 09:31:39] [config] transformer-ffn-depth: 2
[2019-07-25 09:31:39] [config] transformer-guided-alignment-layer: last
[2019-07-25 09:31:39] [config] transformer-heads: 8
[2019-07-25 09:31:39] [config] transformer-no-projection: false
[2019-07-25 09:31:39] [config] transformer-postprocess: dan
[2019-07-25 09:31:39] [config] transformer-postprocess-emb: d
[2019-07-25 09:31:39] [config] transformer-preprocess: ""
[2019-07-25 09:31:39] [config] transformer-tied-layers:
[2019-07-25 09:31:39] [config]   []
[2019-07-25 09:31:39] [config] transformer-train-position-embeddings: false
[2019-07-25 09:31:39] [config] type: amun
[2019-07-25 09:31:39] [config] ulr: false
[2019-07-25 09:31:39] [config] ulr-dim-emb: 0
[2019-07-25 09:31:39] [config] ulr-dropout: 0
[2019-07-25 09:31:39] [config] ulr-keys-vectors: ""
[2019-07-25 09:31:39] [config] ulr-query-vectors: ""
[2019-07-25 09:31:39] [config] ulr-softmax-temperature: 1
[2019-07-25 09:31:39] [config] ulr-trainable-transformation: false
[2019-07-25 09:31:39] [config] valid-freq: 20000
[2019-07-25 09:31:39] [config] valid-log: ../experiments/10M_bicleaner_st_lm_2/model/valid.log
[2019-07-25 09:31:39] [config] valid-max-length: 1000
[2019-07-25 09:31:39] [config] valid-metrics:
[2019-07-25 09:31:39] [config]   - cross-entropy
[2019-07-25 09:31:39] [config]   - perplexity
[2019-07-25 09:31:39] [config]   - translation
[2019-07-25 09:31:39] [config] valid-mini-batch: 8
[2019-07-25 09:31:39] [config] valid-script-path: ../experiments/10M_bicleaner_st_lm_2/score-dev.sh
[2019-07-25 09:31:39] [config] valid-sets:
[2019-07-25 09:31:39] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.de
[2019-07-25 09:31:39] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.en
[2019-07-25 09:31:39] [config] valid-translation-output: ../experiments/10M_bicleaner_st_lm_2/model/dev.out
[2019-07-25 09:31:39] [config] vocabs:
[2019-07-25 09:31:39] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json
[2019-07-25 09:31:39] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json
[2019-07-25 09:31:39] [config] word-penalty: 0
[2019-07-25 09:31:39] [config] workspace: 5000
[2019-07-25 09:31:39] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 09:31:39] Using synchronous training
[2019-07-25 09:31:39] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json
[2019-07-25 09:31:40] [data] Using unused word id eos for 0
[2019-07-25 09:31:40] [data] Using unused word id UNK for 1
[2019-07-25 09:31:40] [data] Setting vocabulary size for input 0 to 50000
[2019-07-25 09:31:40] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json
[2019-07-25 09:31:40] [data] Using unused word id eos for 0
[2019-07-25 09:31:40] [data] Using unused word id UNK for 1
[2019-07-25 09:31:40] [data] Setting vocabulary size for input 1 to 50000
[2019-07-25 09:31:40] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-25 09:31:40] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-25 09:31:41] [memory] Extending reserved space to 5120 MB (device gpu4)
[2019-07-25 09:31:43] [memory] Extending reserved space to 5120 MB (device gpu5)
[2019-07-25 09:31:43] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-25 09:31:43] [comm] NCCLCommunicator constructed successfully.
[2019-07-25 09:31:43] [training] Using 2 GPUs
[2019-07-25 09:31:43] [memory] Reserving 422 MB, device gpu4
[2019-07-25 09:31:43] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-25 09:31:43] [memory] Reserving 422 MB, device gpu4
[2019-07-25 09:31:48] [batching] Done. Typical MB size is 13760 target words
[2019-07-25 09:31:48] [memory] Extending reserved space to 5120 MB (device gpu4)
[2019-07-25 09:31:48] [memory] Extending reserved space to 5120 MB (device gpu5)
[2019-07-25 09:31:48] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-25 09:31:48] [comm] NCCLCommunicator constructed successfully.
[2019-07-25 09:31:48] [training] Using 2 GPUs
[2019-07-25 09:31:48] Training started
[2019-07-25 09:31:48] [data] Shuffling data
[2019-07-25 09:31:48] [data] Done reading 632833 sentences
[2019-07-25 09:31:51] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 09:31:53] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-25 09:31:53] [memory] Reserving 422 MB, device gpu5
[2019-07-25 09:31:53] [memory] Reserving 422 MB, device gpu4
[2019-07-25 09:31:53] [memory] Reserving 422 MB, device gpu5
[2019-07-25 09:31:53] [memory] Reserving 422 MB, device gpu4
[2019-07-25 09:31:53] [memory] Reserving 211 MB, device gpu4
[2019-07-25 09:31:53] [memory] Reserving 211 MB, device gpu5
[2019-07-25 09:31:53] [memory] Reserving 422 MB, device gpu5
[2019-07-25 09:31:53] [memory] Reserving 422 MB, device gpu4
[2019-07-25 09:40:35] Seen 599177 samples
[2019-07-25 09:40:35] Starting epoch 2
[2019-07-25 09:40:35] [data] Shuffling data
[2019-07-25 09:40:35] [data] Done reading 632833 sentences
[2019-07-25 09:40:37] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 09:43:45] Ep. 2 : Up. 2000 : Sen. 213,430 : Cost 103.37337494 : Time 724.68s : 22022.21 words/s
[2019-07-25 09:49:21] Seen 599177 samples
[2019-07-25 09:49:21] Starting epoch 3
[2019-07-25 09:49:21] [data] Shuffling data
[2019-07-25 09:49:22] [data] Done reading 632833 sentences
[2019-07-25 09:49:24] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 09:55:37] Ep. 3 : Up. 4000 : Sen. 426,202 : Cost 67.04113770 : Time 712.15s : 22425.35 words/s
[2019-07-25 09:58:07] Seen 599177 samples
[2019-07-25 09:58:07] Starting epoch 4
[2019-07-25 09:58:07] [data] Shuffling data
[2019-07-25 09:58:08] [data] Done reading 632833 sentences
[2019-07-25 09:58:10] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:06:54] Seen 599177 samples
[2019-07-25 10:06:54] Starting epoch 5
[2019-07-25 10:06:54] [data] Shuffling data
[2019-07-25 10:06:54] [data] Done reading 632833 sentences
[2019-07-25 10:06:56] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:07:34] Ep. 5 : Up. 6000 : Sen. 41,676 : Cost 52.80685043 : Time 717.21s : 22239.85 words/s
[2019-07-25 10:15:40] Seen 599177 samples
[2019-07-25 10:15:40] Starting epoch 6
[2019-07-25 10:15:40] [data] Shuffling data
[2019-07-25 10:15:40] [data] Done reading 632833 sentences
[2019-07-25 10:15:42] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:19:28] Ep. 6 : Up. 8000 : Sen. 256,018 : Cost 45.85404968 : Time 713.61s : 22405.95 words/s
[2019-07-25 10:24:27] Seen 599177 samples
[2019-07-25 10:24:27] Starting epoch 7
[2019-07-25 10:24:27] [data] Shuffling data
[2019-07-25 10:24:27] [data] Done reading 632833 sentences
[2019-07-25 10:24:29] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:31:21] Ep. 7 : Up. 10000 : Sen. 470,324 : Cost 41.74198151 : Time 713.20s : 22422.59 words/s
[2019-07-25 10:33:12] Seen 599177 samples
[2019-07-25 10:33:12] Starting epoch 8
[2019-07-25 10:33:12] [data] Shuffling data
[2019-07-25 10:33:12] [data] Done reading 632833 sentences
[2019-07-25 10:33:14] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:41:58] Seen 599177 samples
[2019-07-25 10:41:58] Starting epoch 9
[2019-07-25 10:41:58] [data] Shuffling data
[2019-07-25 10:41:59] [data] Done reading 632833 sentences
[2019-07-25 10:42:01] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:43:20] Ep. 9 : Up. 12000 : Sen. 89,948 : Cost 38.66394806 : Time 719.04s : 22328.46 words/s
[2019-07-25 10:50:44] Seen 599177 samples
[2019-07-25 10:50:44] Starting epoch 10
[2019-07-25 10:50:44] [data] Shuffling data
[2019-07-25 10:50:45] [data] Done reading 632833 sentences
[2019-07-25 10:50:47] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 10:55:13] Ep. 10 : Up. 14000 : Sen. 303,670 : Cost 36.33370972 : Time 712.62s : 22421.37 words/s
[2019-07-25 10:59:28] Seen 599177 samples
[2019-07-25 10:59:28] Starting epoch 11
[2019-07-25 10:59:28] [data] Shuffling data
[2019-07-25 10:59:29] [data] Done reading 632833 sentences
[2019-07-25 10:59:31] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:07:07] Ep. 11 : Up. 16000 : Sen. 519,974 : Cost 34.39414978 : Time 714.19s : 22424.16 words/s
[2019-07-25 11:08:16] Seen 599177 samples
[2019-07-25 11:08:16] Starting epoch 12
[2019-07-25 11:08:16] [data] Shuffling data
[2019-07-25 11:08:16] [data] Done reading 632833 sentences
[2019-07-25 11:08:19] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:17:03] Seen 599177 samples
[2019-07-25 11:17:03] Starting epoch 13
[2019-07-25 11:17:03] [data] Shuffling data
[2019-07-25 11:17:03] [data] Done reading 632833 sentences
[2019-07-25 11:17:05] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:19:05] Ep. 13 : Up. 18000 : Sen. 133,420 : Cost 32.80145264 : Time 718.38s : 22212.47 words/s
[2019-07-25 11:25:50] Seen 599177 samples
[2019-07-25 11:25:50] Starting epoch 14
[2019-07-25 11:25:50] [data] Shuffling data
[2019-07-25 11:25:51] [data] Done reading 632833 sentences
[2019-07-25 11:25:53] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:30:59] Ep. 14 : Up. 20000 : Sen. 348,094 : Cost 31.51474380 : Time 713.41s : 22399.75 words/s
[2019-07-25 11:30:59] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 11:31:09] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter20000.npz
[2019-07-25 11:31:16] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 11:31:27] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-25 11:31:53] [valid] Ep. 14 : Up. 20000 : cross-entropy : 67.1668 : new best
[2019-07-25 11:31:57] [valid] Ep. 14 : Up. 20000 : perplexity : 13.9156 : new best
[2019-07-25 11:32:46] [valid] Ep. 14 : Up. 20000 : translation : 23.16 : new best
[2019-07-25 11:36:26] Seen 599177 samples
[2019-07-25 11:36:26] Starting epoch 15
[2019-07-25 11:36:26] [data] Shuffling data
[2019-07-25 11:36:26] [data] Done reading 632833 sentences
[2019-07-25 11:36:28] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:44:40] Ep. 15 : Up. 22000 : Sen. 562,588 : Cost 30.33756638 : Time 821.15s : 19445.63 words/s
[2019-07-25 11:45:12] Seen 599177 samples
[2019-07-25 11:45:12] Starting epoch 16
[2019-07-25 11:45:12] [data] Shuffling data
[2019-07-25 11:45:12] [data] Done reading 632833 sentences
[2019-07-25 11:45:14] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:53:57] Seen 599177 samples
[2019-07-25 11:53:57] Starting epoch 17
[2019-07-25 11:53:57] [data] Shuffling data
[2019-07-25 11:53:58] [data] Done reading 632833 sentences
[2019-07-25 11:54:00] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 11:56:35] Ep. 17 : Up. 24000 : Sen. 176,342 : Cost 29.19320869 : Time 715.74s : 22283.06 words/s
[2019-07-25 12:02:44] Seen 599177 samples
[2019-07-25 12:02:44] Starting epoch 18
[2019-07-25 12:02:44] [data] Shuffling data
[2019-07-25 12:02:44] [data] Done reading 632833 sentences
[2019-07-25 12:02:46] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:08:26] Ep. 18 : Up. 26000 : Sen. 388,332 : Cost 28.30318260 : Time 710.59s : 22447.20 words/s
[2019-07-25 12:11:29] Seen 599177 samples
[2019-07-25 12:11:29] Starting epoch 19
[2019-07-25 12:11:29] [data] Shuffling data
[2019-07-25 12:11:30] [data] Done reading 632833 sentences
[2019-07-25 12:11:32] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:20:16] Seen 599177 samples
[2019-07-25 12:20:16] Starting epoch 20
[2019-07-25 12:20:16] [data] Shuffling data
[2019-07-25 12:20:16] [data] Done reading 632833 sentences
[2019-07-25 12:20:18] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:20:22] Ep. 20 : Up. 28000 : Sen. 1,880 : Cost 27.40375519 : Time 716.11s : 22265.80 words/s
[2019-07-25 12:29:01] Seen 599177 samples
[2019-07-25 12:29:01] Starting epoch 21
[2019-07-25 12:29:01] [data] Shuffling data
[2019-07-25 12:29:02] [data] Done reading 632833 sentences
[2019-07-25 12:29:04] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:32:13] Ep. 21 : Up. 30000 : Sen. 215,746 : Cost 26.36665916 : Time 711.05s : 22450.22 words/s
[2019-07-25 12:37:46] Seen 599177 samples
[2019-07-25 12:37:46] Starting epoch 22
[2019-07-25 12:37:46] [data] Shuffling data
[2019-07-25 12:37:46] [data] Done reading 632833 sentences
[2019-07-25 12:37:48] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:44:06] Ep. 22 : Up. 32000 : Sen. 433,192 : Cost 25.91416359 : Time 712.58s : 22526.58 words/s
[2019-07-25 12:46:30] Seen 599177 samples
[2019-07-25 12:46:30] Starting epoch 23
[2019-07-25 12:46:30] [data] Shuffling data
[2019-07-25 12:46:31] [data] Done reading 632833 sentences
[2019-07-25 12:46:33] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:55:16] Seen 599177 samples
[2019-07-25 12:55:16] Starting epoch 24
[2019-07-25 12:55:16] [data] Shuffling data
[2019-07-25 12:55:16] [data] Done reading 632833 sentences
[2019-07-25 12:55:18] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 12:56:03] Ep. 24 : Up. 34000 : Sen. 49,152 : Cost 25.38095665 : Time 717.10s : 22293.20 words/s
[2019-07-25 13:04:01] Seen 599177 samples
[2019-07-25 13:04:01] Starting epoch 25
[2019-07-25 13:04:01] [data] Shuffling data
[2019-07-25 13:04:01] [data] Done reading 632833 sentences
[2019-07-25 13:04:03] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 13:07:54] Ep. 25 : Up. 36000 : Sen. 262,052 : Cost 24.58083153 : Time 710.77s : 22443.09 words/s
[2019-07-25 13:12:47] Seen 599177 samples
[2019-07-25 13:12:47] Starting epoch 26
[2019-07-25 13:12:47] [data] Shuffling data
[2019-07-25 13:12:47] [data] Done reading 632833 sentences
[2019-07-25 13:12:49] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 13:19:48] Ep. 26 : Up. 38000 : Sen. 477,966 : Cost 24.11407089 : Time 713.93s : 22423.73 words/s
[2019-07-25 13:21:33] Seen 599177 samples
[2019-07-25 13:21:33] Starting epoch 27
[2019-07-25 13:21:33] [data] Shuffling data
[2019-07-25 13:21:33] [data] Done reading 632833 sentences
[2019-07-25 13:21:35] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 13:30:18] Seen 599177 samples
[2019-07-25 13:30:18] Starting epoch 28
[2019-07-25 13:30:18] [data] Shuffling data
[2019-07-25 13:30:18] [data] Done reading 632833 sentences
[2019-07-25 13:30:21] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 13:31:46] Ep. 28 : Up. 40000 : Sen. 96,000 : Cost 23.54069710 : Time 718.13s : 22327.78 words/s
[2019-07-25 13:31:46] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 13:31:57] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter40000.npz
[2019-07-25 13:32:04] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 13:32:15] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-25 13:32:41] [valid] Ep. 28 : Up. 40000 : cross-entropy : 63.3453 : new best
[2019-07-25 13:32:44] [valid] Ep. 28 : Up. 40000 : perplexity : 11.9796 : new best
[2019-07-25 13:33:33] [valid] Ep. 28 : Up. 40000 : translation : 24.28 : new best
[2019-07-25 13:40:53] Seen 599177 samples
[2019-07-25 13:40:53] Starting epoch 29
[2019-07-25 13:40:53] [data] Shuffling data
[2019-07-25 13:40:53] [data] Done reading 632833 sentences
[2019-07-25 13:40:55] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 13:45:27] Ep. 29 : Up. 42000 : Sen. 310,544 : Cost 22.87070847 : Time 821.56s : 19461.19 words/s
[2019-07-25 13:49:38] Seen 599177 samples
[2019-07-25 13:49:38] Starting epoch 30
[2019-07-25 13:49:38] [data] Shuffling data
[2019-07-25 13:49:38] [data] Done reading 632833 sentences
[2019-07-25 13:49:40] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 13:57:20] Ep. 30 : Up. 44000 : Sen. 524,800 : Cost 22.49294472 : Time 712.83s : 22409.14 words/s
[2019-07-25 13:58:25] Seen 599177 samples
[2019-07-25 13:58:25] Starting epoch 31
[2019-07-25 13:58:25] [data] Shuffling data
[2019-07-25 13:58:25] [data] Done reading 632833 sentences
[2019-07-25 13:58:27] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 15:24:11] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 15:24:11] [marian] Running on fulla as process 413425 with command line:
[2019-07-25 15:24:11] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_st_lm_2/model/model.npz -T . --devices 4 5 --train-sets ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.de ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_st_lm_2/model/dev.out --valid-script-path ../experiments/10M_bicleaner_st_lm_2/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_st_lm_2/model/train.log --valid-log ../experiments/10M_bicleaner_st_lm_2/model/valid.log
[2019-07-25 15:24:12] [config] after-batches: 0
[2019-07-25 15:24:12] [config] after-epochs: 0
[2019-07-25 15:24:12] [config] allow-unk: false
[2019-07-25 15:24:12] [config] beam-size: 12
[2019-07-25 15:24:12] [config] bert-class-symbol: "[CLS]"
[2019-07-25 15:24:12] [config] bert-mask-symbol: "[MASK]"
[2019-07-25 15:24:12] [config] bert-masking-fraction: 0.15
[2019-07-25 15:24:12] [config] bert-sep-symbol: "[SEP]"
[2019-07-25 15:24:12] [config] bert-train-type-embeddings: true
[2019-07-25 15:24:12] [config] bert-type-vocab-size: 2
[2019-07-25 15:24:12] [config] best-deep: false
[2019-07-25 15:24:12] [config] clip-gemm: 0
[2019-07-25 15:24:12] [config] clip-norm: 1
[2019-07-25 15:24:12] [config] cost-type: ce-mean
[2019-07-25 15:24:12] [config] cpu-threads: 0
[2019-07-25 15:24:12] [config] data-weighting: ""
[2019-07-25 15:24:12] [config] data-weighting-type: sentence
[2019-07-25 15:24:12] [config] dec-cell: gru
[2019-07-25 15:24:12] [config] dec-cell-base-depth: 2
[2019-07-25 15:24:12] [config] dec-cell-high-depth: 1
[2019-07-25 15:24:12] [config] dec-depth: 1
[2019-07-25 15:24:12] [config] devices:
[2019-07-25 15:24:12] [config]   - 4
[2019-07-25 15:24:12] [config]   - 5
[2019-07-25 15:24:12] [config] dim-emb: 512
[2019-07-25 15:24:12] [config] dim-rnn: 1024
[2019-07-25 15:24:12] [config] dim-vocabs:
[2019-07-25 15:24:12] [config]   - 50000
[2019-07-25 15:24:12] [config]   - 50000
[2019-07-25 15:24:12] [config] disp-first: 0
[2019-07-25 15:24:12] [config] disp-freq: 2000
[2019-07-25 15:24:12] [config] disp-label-counts: false
[2019-07-25 15:24:12] [config] dropout-rnn: 0.2
[2019-07-25 15:24:12] [config] dropout-src: 0.1
[2019-07-25 15:24:12] [config] dropout-trg: 0.1
[2019-07-25 15:24:12] [config] dump-config: ""
[2019-07-25 15:24:12] [config] early-stopping: 5
[2019-07-25 15:24:12] [config] embedding-fix-src: false
[2019-07-25 15:24:12] [config] embedding-fix-trg: false
[2019-07-25 15:24:12] [config] embedding-normalization: false
[2019-07-25 15:24:12] [config] embedding-vectors:
[2019-07-25 15:24:12] [config]   []
[2019-07-25 15:24:12] [config] enc-cell: gru
[2019-07-25 15:24:12] [config] enc-cell-depth: 1
[2019-07-25 15:24:12] [config] enc-depth: 1
[2019-07-25 15:24:12] [config] enc-type: bidirectional
[2019-07-25 15:24:12] [config] exponential-smoothing: 0.0001
[2019-07-25 15:24:12] [config] grad-dropping-momentum: 0
[2019-07-25 15:24:12] [config] grad-dropping-rate: 0
[2019-07-25 15:24:12] [config] grad-dropping-warmup: 100
[2019-07-25 15:24:12] [config] guided-alignment: none
[2019-07-25 15:24:12] [config] guided-alignment-cost: mse
[2019-07-25 15:24:12] [config] guided-alignment-weight: 0.1
[2019-07-25 15:24:12] [config] ignore-model-config: false
[2019-07-25 15:24:12] [config] input-types:
[2019-07-25 15:24:12] [config]   []
[2019-07-25 15:24:12] [config] interpolate-env-vars: false
[2019-07-25 15:24:12] [config] keep-best: false
[2019-07-25 15:24:12] [config] label-smoothing: 0
[2019-07-25 15:24:12] [config] layer-normalization: true
[2019-07-25 15:24:12] [config] learn-rate: 0.0001
[2019-07-25 15:24:12] [config] log: ../experiments/10M_bicleaner_st_lm_2/model/train.log
[2019-07-25 15:24:12] [config] log-level: info
[2019-07-25 15:24:12] [config] log-time-zone: ""
[2019-07-25 15:24:12] [config] lr-decay: 0
[2019-07-25 15:24:12] [config] lr-decay-freq: 50000
[2019-07-25 15:24:12] [config] lr-decay-inv-sqrt:
[2019-07-25 15:24:12] [config]   - 0
[2019-07-25 15:24:12] [config] lr-decay-repeat-warmup: false
[2019-07-25 15:24:12] [config] lr-decay-reset-optimizer: false
[2019-07-25 15:24:12] [config] lr-decay-start:
[2019-07-25 15:24:12] [config]   - 10
[2019-07-25 15:24:12] [config]   - 1
[2019-07-25 15:24:12] [config] lr-decay-strategy: epoch+stalled
[2019-07-25 15:24:12] [config] lr-report: false
[2019-07-25 15:24:12] [config] lr-warmup: 0
[2019-07-25 15:24:12] [config] lr-warmup-at-reload: false
[2019-07-25 15:24:12] [config] lr-warmup-cycle: false
[2019-07-25 15:24:12] [config] lr-warmup-start-rate: 0
[2019-07-25 15:24:12] [config] max-length: 50
[2019-07-25 15:24:12] [config] max-length-crop: false
[2019-07-25 15:24:12] [config] max-length-factor: 3
[2019-07-25 15:24:12] [config] maxi-batch: 100
[2019-07-25 15:24:12] [config] maxi-batch-sort: trg
[2019-07-25 15:24:12] [config] mini-batch: 64
[2019-07-25 15:24:12] [config] mini-batch-fit: true
[2019-07-25 15:24:12] [config] mini-batch-fit-step: 10
[2019-07-25 15:24:12] [config] mini-batch-overstuff: 1
[2019-07-25 15:24:12] [config] mini-batch-track-lr: false
[2019-07-25 15:24:12] [config] mini-batch-understuff: 1
[2019-07-25 15:24:12] [config] mini-batch-warmup: 0
[2019-07-25 15:24:12] [config] mini-batch-words: 0
[2019-07-25 15:24:12] [config] mini-batch-words-ref: 0
[2019-07-25 15:24:12] [config] model: ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 15:24:12] [config] multi-loss-type: sum
[2019-07-25 15:24:12] [config] multi-node: false
[2019-07-25 15:24:12] [config] multi-node-overlap: true
[2019-07-25 15:24:12] [config] n-best: false
[2019-07-25 15:24:12] [config] no-nccl: false
[2019-07-25 15:24:12] [config] no-reload: false
[2019-07-25 15:24:12] [config] no-restore-corpus: false
[2019-07-25 15:24:12] [config] no-shuffle: false
[2019-07-25 15:24:12] [config] normalize: 1
[2019-07-25 15:24:12] [config] num-devices: 0
[2019-07-25 15:24:12] [config] optimizer: adam
[2019-07-25 15:24:12] [config] optimizer-delay: 1
[2019-07-25 15:24:12] [config] optimizer-params:
[2019-07-25 15:24:12] [config]   []
[2019-07-25 15:24:12] [config] overwrite: false
[2019-07-25 15:24:12] [config] pretrained-model: ""
[2019-07-25 15:24:12] [config] quiet: false
[2019-07-25 15:24:12] [config] quiet-translation: true
[2019-07-25 15:24:12] [config] relative-paths: false
[2019-07-25 15:24:12] [config] right-left: false
[2019-07-25 15:24:12] [config] save-freq: 20000
[2019-07-25 15:24:12] [config] seed: 1111
[2019-07-25 15:24:12] [config] shuffle-in-ram: false
[2019-07-25 15:24:12] [config] skip: false
[2019-07-25 15:24:12] [config] sqlite: ""
[2019-07-25 15:24:12] [config] sqlite-drop: false
[2019-07-25 15:24:12] [config] sync-sgd: true
[2019-07-25 15:24:12] [config] tempdir: .
[2019-07-25 15:24:12] [config] tied-embeddings: false
[2019-07-25 15:24:12] [config] tied-embeddings-all: false
[2019-07-25 15:24:12] [config] tied-embeddings-src: false
[2019-07-25 15:24:12] [config] train-sets:
[2019-07-25 15:24:12] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de
[2019-07-25 15:24:12] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en
[2019-07-25 15:24:12] [config] transformer-aan-activation: swish
[2019-07-25 15:24:12] [config] transformer-aan-depth: 2
[2019-07-25 15:24:12] [config] transformer-aan-nogate: false
[2019-07-25 15:24:12] [config] transformer-decoder-autoreg: self-attention
[2019-07-25 15:24:12] [config] transformer-dim-aan: 2048
[2019-07-25 15:24:12] [config] transformer-dim-ffn: 2048
[2019-07-25 15:24:12] [config] transformer-dropout: 0
[2019-07-25 15:24:12] [config] transformer-dropout-attention: 0
[2019-07-25 15:24:12] [config] transformer-dropout-ffn: 0
[2019-07-25 15:24:12] [config] transformer-ffn-activation: swish
[2019-07-25 15:24:12] [config] transformer-ffn-depth: 2
[2019-07-25 15:24:12] [config] transformer-guided-alignment-layer: last
[2019-07-25 15:24:12] [config] transformer-heads: 8
[2019-07-25 15:24:12] [config] transformer-no-projection: false
[2019-07-25 15:24:12] [config] transformer-postprocess: dan
[2019-07-25 15:24:12] [config] transformer-postprocess-emb: d
[2019-07-25 15:24:12] [config] transformer-preprocess: ""
[2019-07-25 15:24:12] [config] transformer-tied-layers:
[2019-07-25 15:24:12] [config]   []
[2019-07-25 15:24:12] [config] transformer-train-position-embeddings: false
[2019-07-25 15:24:12] [config] type: amun
[2019-07-25 15:24:12] [config] ulr: false
[2019-07-25 15:24:12] [config] ulr-dim-emb: 0
[2019-07-25 15:24:12] [config] ulr-dropout: 0
[2019-07-25 15:24:12] [config] ulr-keys-vectors: ""
[2019-07-25 15:24:12] [config] ulr-query-vectors: ""
[2019-07-25 15:24:12] [config] ulr-softmax-temperature: 1
[2019-07-25 15:24:12] [config] ulr-trainable-transformation: false
[2019-07-25 15:24:12] [config] valid-freq: 20000
[2019-07-25 15:24:12] [config] valid-log: ../experiments/10M_bicleaner_st_lm_2/model/valid.log
[2019-07-25 15:24:12] [config] valid-max-length: 1000
[2019-07-25 15:24:12] [config] valid-metrics:
[2019-07-25 15:24:12] [config]   - cross-entropy
[2019-07-25 15:24:12] [config]   - perplexity
[2019-07-25 15:24:12] [config]   - translation
[2019-07-25 15:24:12] [config] valid-mini-batch: 8
[2019-07-25 15:24:12] [config] valid-script-path: ../experiments/10M_bicleaner_st_lm_2/score-dev.sh
[2019-07-25 15:24:12] [config] valid-sets:
[2019-07-25 15:24:12] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.de
[2019-07-25 15:24:12] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.en
[2019-07-25 15:24:12] [config] valid-translation-output: ../experiments/10M_bicleaner_st_lm_2/model/dev.out
[2019-07-25 15:24:12] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 15:24:12] [config] vocabs:
[2019-07-25 15:24:12] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json
[2019-07-25 15:24:12] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json
[2019-07-25 15:24:12] [config] word-penalty: 0
[2019-07-25 15:24:12] [config] workspace: 5000
[2019-07-25 15:24:12] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 15:24:12] Using synchronous training
[2019-07-25 15:24:12] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json
[2019-07-25 15:24:12] [data] Using unused word id eos for 0
[2019-07-25 15:24:12] [data] Using unused word id UNK for 1
[2019-07-25 15:24:12] [data] Setting vocabulary size for input 0 to 50000
[2019-07-25 15:24:12] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json
[2019-07-25 15:24:12] [data] Using unused word id eos for 0
[2019-07-25 15:24:12] [data] Using unused word id UNK for 1
[2019-07-25 15:24:12] [data] Setting vocabulary size for input 1 to 50000
[2019-07-25 15:24:12] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-25 15:24:12] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-25 15:24:14] [memory] Extending reserved space to 5120 MB (device gpu4)
[2019-07-25 15:24:15] [memory] Extending reserved space to 5120 MB (device gpu5)
[2019-07-25 15:24:15] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-25 15:24:15] [comm] NCCLCommunicator constructed successfully.
[2019-07-25 15:24:15] [training] Using 2 GPUs
[2019-07-25 15:24:15] [memory] Reserving 422 MB, device gpu4
[2019-07-25 15:24:15] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-25 15:24:15] [memory] Reserving 422 MB, device gpu4
[2019-07-25 15:24:20] [batching] Done. Typical MB size is 13760 target words
[2019-07-25 15:24:20] [memory] Extending reserved space to 5120 MB (device gpu4)
[2019-07-25 15:24:20] [memory] Extending reserved space to 5120 MB (device gpu5)
[2019-07-25 15:24:20] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-25 15:24:20] [comm] NCCLCommunicator constructed successfully.
[2019-07-25 15:24:20] [training] Using 2 GPUs
[2019-07-25 15:24:20] Loading model from ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 15:24:27] Loading model from ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 15:24:31] Loading Adam parameters from ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-25 15:24:43] [memory] Reserving 422 MB, device gpu4
[2019-07-25 15:24:43] [memory] Reserving 422 MB, device gpu5
[2019-07-25 15:24:44] [training] Model reloaded from ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 15:24:44] [data] Restoring the corpus state to epoch 28, batch 40000
[2019-07-25 15:24:44] [data] Shuffling data
[2019-07-25 15:24:45] [data] Done reading 632833 sentences
[2019-07-25 15:24:47] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 15:24:50] Training started
[2019-07-25 15:24:51] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-25 15:24:51] [memory] Reserving 422 MB, device gpu4
[2019-07-25 15:24:51] [memory] Reserving 422 MB, device gpu5
[2019-07-25 15:24:51] [memory] Reserving 422 MB, device gpu5
[2019-07-25 15:24:51] [memory] Reserving 422 MB, device gpu4
[2019-07-25 15:24:51] Loading model from ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 15:24:58] [memory] Reserving 422 MB, device cpu0
[2019-07-25 15:24:58] [memory] Reserving 211 MB, device gpu4
[2019-07-25 15:24:59] [memory] Reserving 211 MB, device gpu5
[2019-07-25 15:32:14] Seen 599177 samples
[2019-07-25 15:32:14] Starting epoch 29
[2019-07-25 15:32:14] [data] Shuffling data
[2019-07-25 15:32:15] [data] Done reading 632833 sentences
[2019-07-25 15:32:17] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 15:36:49] Ep. 29 : Up. 42000 : Sen. 310,544 : Cost 23.03028870 : Time 756.76s : 21127.67 words/s
[2019-07-25 15:40:59] Seen 599177 samples
[2019-07-25 15:40:59] Starting epoch 30
[2019-07-25 15:40:59] [data] Shuffling data
[2019-07-25 15:41:00] [data] Done reading 632833 sentences
[2019-07-25 15:41:02] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 15:48:40] Ep. 30 : Up. 44000 : Sen. 524,800 : Cost 22.65501976 : Time 711.14s : 22462.31 words/s
[2019-07-25 15:49:45] Seen 599177 samples
[2019-07-25 15:49:45] Starting epoch 31
[2019-07-25 15:49:45] [data] Shuffling data
[2019-07-25 15:49:45] [data] Done reading 632833 sentences
[2019-07-25 15:49:47] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 15:58:29] Seen 599177 samples
[2019-07-25 15:58:29] Starting epoch 32
[2019-07-25 15:58:29] [data] Shuffling data
[2019-07-25 15:58:29] [data] Done reading 632833 sentences
[2019-07-25 15:58:31] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:00:37] Ep. 32 : Up. 46000 : Sen. 142,654 : Cost 22.22448540 : Time 716.24s : 22383.50 words/s
[2019-07-25 16:07:13] Seen 599177 samples
[2019-07-25 16:07:13] Starting epoch 33
[2019-07-25 16:07:13] [data] Shuffling data
[2019-07-25 16:07:13] [data] Done reading 632833 sentences
[2019-07-25 16:07:16] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:12:27] Ep. 33 : Up. 48000 : Sen. 356,366 : Cost 21.76802254 : Time 710.38s : 22471.30 words/s
[2019-07-25 16:15:58] Seen 599177 samples
[2019-07-25 16:15:58] Starting epoch 34
[2019-07-25 16:15:58] [data] Shuffling data
[2019-07-25 16:15:58] [data] Done reading 632833 sentences
[2019-07-25 16:16:00] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:24:17] Ep. 34 : Up. 50000 : Sen. 570,996 : Cost 21.44810295 : Time 709.78s : 22512.89 words/s
[2019-07-25 16:24:42] Seen 599177 samples
[2019-07-25 16:24:42] Starting epoch 35
[2019-07-25 16:24:42] [data] Shuffling data
[2019-07-25 16:24:42] [data] Done reading 632833 sentences
[2019-07-25 16:24:44] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:33:27] Seen 599177 samples
[2019-07-25 16:33:27] Starting epoch 36
[2019-07-25 16:33:27] [data] Shuffling data
[2019-07-25 16:33:27] [data] Done reading 632833 sentences
[2019-07-25 16:33:29] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:36:14] Ep. 36 : Up. 52000 : Sen. 188,206 : Cost 20.86109543 : Time 716.78s : 22362.31 words/s
[2019-07-25 16:42:10] Seen 599177 samples
[2019-07-25 16:42:10] Starting epoch 37
[2019-07-25 16:42:10] [data] Shuffling data
[2019-07-25 16:42:11] [data] Done reading 632833 sentences
[2019-07-25 16:42:13] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:48:04] Ep. 37 : Up. 54000 : Sen. 401,948 : Cost 20.63138008 : Time 710.48s : 22478.99 words/s
[2019-07-25 16:50:54] Seen 599177 samples
[2019-07-25 16:50:54] Starting epoch 38
[2019-07-25 16:50:54] [data] Shuffling data
[2019-07-25 16:50:54] [data] Done reading 632833 sentences
[2019-07-25 16:50:57] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:59:38] Seen 599177 samples
[2019-07-25 16:59:38] Starting epoch 39
[2019-07-25 16:59:38] [data] Shuffling data
[2019-07-25 16:59:39] [data] Done reading 632833 sentences
[2019-07-25 16:59:41] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 16:59:59] Ep. 39 : Up. 56000 : Sen. 18,834 : Cost 20.20716667 : Time 715.42s : 22381.91 words/s
[2019-07-25 17:08:24] Seen 599177 samples
[2019-07-25 17:08:24] Starting epoch 40
[2019-07-25 17:08:24] [data] Shuffling data
[2019-07-25 17:08:25] [data] Done reading 632833 sentences
[2019-07-25 17:08:27] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 17:11:50] Ep. 40 : Up. 58000 : Sen. 232,076 : Cost 19.91262436 : Time 710.52s : 22462.59 words/s
[2019-07-25 17:17:06] Seen 599177 samples
[2019-07-25 17:17:06] Starting epoch 41
[2019-07-25 17:17:06] [data] Shuffling data
[2019-07-25 17:17:07] [data] Done reading 632833 sentences
[2019-07-25 17:17:09] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 17:23:40] Ep. 41 : Up. 60000 : Sen. 450,620 : Cost 19.59584045 : Time 710.06s : 22613.74 words/s
[2019-07-25 17:23:40] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 17:23:50] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter60000.npz
[2019-07-25 17:23:57] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 17:24:07] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-25 17:24:32] [valid] Ep. 41 : Up. 60000 : cross-entropy : 64.0206 : new best
[2019-07-25 17:24:36] [valid] Ep. 41 : Up. 60000 : perplexity : 12.3009 : new best
[2019-07-25 17:25:22] [valid] Ep. 41 : Up. 60000 : translation : 24.08 : new best
[2019-07-25 17:27:52] Seen 599177 samples
[2019-07-25 17:27:52] Starting epoch 42
[2019-07-25 17:27:52] [data] Shuffling data
[2019-07-25 17:27:52] [data] Done reading 632833 sentences
[2019-07-25 17:27:55] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 17:38:34] Seen 599177 samples
[2019-07-25 17:38:34] Starting epoch 43
[2019-07-25 17:38:34] [data] Shuffling data
[2019-07-25 17:38:34] [data] Done reading 632833 sentences
[2019-07-25 17:38:36] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 20:33:22] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 20:33:22] [marian] Running on fulla as process 2695 with command line:
[2019-07-25 20:33:22] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_bicleaner_st_lm_2/model/model.npz -T . --devices 2 3 --train-sets ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en --vocabs ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json --mini-batch-fit -w 5000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.de ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_bicleaner_st_lm_2/model/dev.out --valid-script-path ../experiments/10M_bicleaner_st_lm_2/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_bicleaner_st_lm_2/model/train.log --valid-log ../experiments/10M_bicleaner_st_lm_2/model/valid.log
[2019-07-25 20:33:22] [config] after-batches: 0
[2019-07-25 20:33:22] [config] after-epochs: 0
[2019-07-25 20:33:22] [config] allow-unk: false
[2019-07-25 20:33:22] [config] beam-size: 12
[2019-07-25 20:33:22] [config] bert-class-symbol: "[CLS]"
[2019-07-25 20:33:22] [config] bert-mask-symbol: "[MASK]"
[2019-07-25 20:33:22] [config] bert-masking-fraction: 0.15
[2019-07-25 20:33:22] [config] bert-sep-symbol: "[SEP]"
[2019-07-25 20:33:22] [config] bert-train-type-embeddings: true
[2019-07-25 20:33:22] [config] bert-type-vocab-size: 2
[2019-07-25 20:33:22] [config] best-deep: false
[2019-07-25 20:33:22] [config] clip-gemm: 0
[2019-07-25 20:33:22] [config] clip-norm: 1
[2019-07-25 20:33:22] [config] cost-type: ce-mean
[2019-07-25 20:33:22] [config] cpu-threads: 0
[2019-07-25 20:33:22] [config] data-weighting: ""
[2019-07-25 20:33:22] [config] data-weighting-type: sentence
[2019-07-25 20:33:22] [config] dec-cell: gru
[2019-07-25 20:33:22] [config] dec-cell-base-depth: 2
[2019-07-25 20:33:22] [config] dec-cell-high-depth: 1
[2019-07-25 20:33:22] [config] dec-depth: 1
[2019-07-25 20:33:22] [config] devices:
[2019-07-25 20:33:22] [config]   - 2
[2019-07-25 20:33:22] [config]   - 3
[2019-07-25 20:33:22] [config] dim-emb: 512
[2019-07-25 20:33:22] [config] dim-rnn: 1024
[2019-07-25 20:33:22] [config] dim-vocabs:
[2019-07-25 20:33:22] [config]   - 50000
[2019-07-25 20:33:22] [config]   - 50000
[2019-07-25 20:33:22] [config] disp-first: 0
[2019-07-25 20:33:22] [config] disp-freq: 2000
[2019-07-25 20:33:22] [config] disp-label-counts: false
[2019-07-25 20:33:22] [config] dropout-rnn: 0.2
[2019-07-25 20:33:22] [config] dropout-src: 0.1
[2019-07-25 20:33:22] [config] dropout-trg: 0.1
[2019-07-25 20:33:22] [config] dump-config: ""
[2019-07-25 20:33:22] [config] early-stopping: 5
[2019-07-25 20:33:22] [config] embedding-fix-src: false
[2019-07-25 20:33:22] [config] embedding-fix-trg: false
[2019-07-25 20:33:22] [config] embedding-normalization: false
[2019-07-25 20:33:22] [config] embedding-vectors:
[2019-07-25 20:33:22] [config]   []
[2019-07-25 20:33:22] [config] enc-cell: gru
[2019-07-25 20:33:22] [config] enc-cell-depth: 1
[2019-07-25 20:33:22] [config] enc-depth: 1
[2019-07-25 20:33:22] [config] enc-type: bidirectional
[2019-07-25 20:33:22] [config] exponential-smoothing: 0.0001
[2019-07-25 20:33:22] [config] grad-dropping-momentum: 0
[2019-07-25 20:33:22] [config] grad-dropping-rate: 0
[2019-07-25 20:33:22] [config] grad-dropping-warmup: 100
[2019-07-25 20:33:22] [config] guided-alignment: none
[2019-07-25 20:33:22] [config] guided-alignment-cost: mse
[2019-07-25 20:33:22] [config] guided-alignment-weight: 0.1
[2019-07-25 20:33:22] [config] ignore-model-config: false
[2019-07-25 20:33:22] [config] input-types:
[2019-07-25 20:33:22] [config]   []
[2019-07-25 20:33:22] [config] interpolate-env-vars: false
[2019-07-25 20:33:22] [config] keep-best: false
[2019-07-25 20:33:22] [config] label-smoothing: 0
[2019-07-25 20:33:22] [config] layer-normalization: true
[2019-07-25 20:33:22] [config] learn-rate: 0.0001
[2019-07-25 20:33:22] [config] log: ../experiments/10M_bicleaner_st_lm_2/model/train.log
[2019-07-25 20:33:22] [config] log-level: info
[2019-07-25 20:33:22] [config] log-time-zone: ""
[2019-07-25 20:33:22] [config] lr-decay: 0
[2019-07-25 20:33:22] [config] lr-decay-freq: 50000
[2019-07-25 20:33:22] [config] lr-decay-inv-sqrt:
[2019-07-25 20:33:22] [config]   - 0
[2019-07-25 20:33:22] [config] lr-decay-repeat-warmup: false
[2019-07-25 20:33:22] [config] lr-decay-reset-optimizer: false
[2019-07-25 20:33:22] [config] lr-decay-start:
[2019-07-25 20:33:22] [config]   - 10
[2019-07-25 20:33:22] [config]   - 1
[2019-07-25 20:33:22] [config] lr-decay-strategy: epoch+stalled
[2019-07-25 20:33:22] [config] lr-report: false
[2019-07-25 20:33:22] [config] lr-warmup: 0
[2019-07-25 20:33:22] [config] lr-warmup-at-reload: false
[2019-07-25 20:33:22] [config] lr-warmup-cycle: false
[2019-07-25 20:33:22] [config] lr-warmup-start-rate: 0
[2019-07-25 20:33:22] [config] max-length: 50
[2019-07-25 20:33:22] [config] max-length-crop: false
[2019-07-25 20:33:22] [config] max-length-factor: 3
[2019-07-25 20:33:22] [config] maxi-batch: 100
[2019-07-25 20:33:22] [config] maxi-batch-sort: trg
[2019-07-25 20:33:22] [config] mini-batch: 64
[2019-07-25 20:33:22] [config] mini-batch-fit: true
[2019-07-25 20:33:22] [config] mini-batch-fit-step: 10
[2019-07-25 20:33:22] [config] mini-batch-overstuff: 1
[2019-07-25 20:33:22] [config] mini-batch-track-lr: false
[2019-07-25 20:33:22] [config] mini-batch-understuff: 1
[2019-07-25 20:33:22] [config] mini-batch-warmup: 0
[2019-07-25 20:33:22] [config] mini-batch-words: 0
[2019-07-25 20:33:22] [config] mini-batch-words-ref: 0
[2019-07-25 20:33:22] [config] model: ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 20:33:22] [config] multi-loss-type: sum
[2019-07-25 20:33:22] [config] multi-node: false
[2019-07-25 20:33:22] [config] multi-node-overlap: true
[2019-07-25 20:33:22] [config] n-best: false
[2019-07-25 20:33:22] [config] no-nccl: false
[2019-07-25 20:33:22] [config] no-reload: false
[2019-07-25 20:33:22] [config] no-restore-corpus: false
[2019-07-25 20:33:22] [config] no-shuffle: false
[2019-07-25 20:33:22] [config] normalize: 1
[2019-07-25 20:33:22] [config] num-devices: 0
[2019-07-25 20:33:22] [config] optimizer: adam
[2019-07-25 20:33:22] [config] optimizer-delay: 1
[2019-07-25 20:33:22] [config] optimizer-params:
[2019-07-25 20:33:22] [config]   []
[2019-07-25 20:33:22] [config] overwrite: false
[2019-07-25 20:33:22] [config] pretrained-model: ""
[2019-07-25 20:33:22] [config] quiet: false
[2019-07-25 20:33:22] [config] quiet-translation: true
[2019-07-25 20:33:22] [config] relative-paths: false
[2019-07-25 20:33:22] [config] right-left: false
[2019-07-25 20:33:22] [config] save-freq: 20000
[2019-07-25 20:33:22] [config] seed: 1111
[2019-07-25 20:33:22] [config] shuffle-in-ram: false
[2019-07-25 20:33:22] [config] skip: false
[2019-07-25 20:33:22] [config] sqlite: ""
[2019-07-25 20:33:22] [config] sqlite-drop: false
[2019-07-25 20:33:22] [config] sync-sgd: true
[2019-07-25 20:33:22] [config] tempdir: .
[2019-07-25 20:33:22] [config] tied-embeddings: false
[2019-07-25 20:33:22] [config] tied-embeddings-all: false
[2019-07-25 20:33:22] [config] tied-embeddings-src: false
[2019-07-25 20:33:22] [config] train-sets:
[2019-07-25 20:33:22] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de
[2019-07-25 20:33:22] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en
[2019-07-25 20:33:22] [config] transformer-aan-activation: swish
[2019-07-25 20:33:22] [config] transformer-aan-depth: 2
[2019-07-25 20:33:22] [config] transformer-aan-nogate: false
[2019-07-25 20:33:22] [config] transformer-decoder-autoreg: self-attention
[2019-07-25 20:33:22] [config] transformer-dim-aan: 2048
[2019-07-25 20:33:22] [config] transformer-dim-ffn: 2048
[2019-07-25 20:33:22] [config] transformer-dropout: 0
[2019-07-25 20:33:22] [config] transformer-dropout-attention: 0
[2019-07-25 20:33:22] [config] transformer-dropout-ffn: 0
[2019-07-25 20:33:22] [config] transformer-ffn-activation: swish
[2019-07-25 20:33:22] [config] transformer-ffn-depth: 2
[2019-07-25 20:33:22] [config] transformer-guided-alignment-layer: last
[2019-07-25 20:33:22] [config] transformer-heads: 8
[2019-07-25 20:33:22] [config] transformer-no-projection: false
[2019-07-25 20:33:22] [config] transformer-postprocess: dan
[2019-07-25 20:33:22] [config] transformer-postprocess-emb: d
[2019-07-25 20:33:22] [config] transformer-preprocess: ""
[2019-07-25 20:33:22] [config] transformer-tied-layers:
[2019-07-25 20:33:22] [config]   []
[2019-07-25 20:33:22] [config] transformer-train-position-embeddings: false
[2019-07-25 20:33:22] [config] type: amun
[2019-07-25 20:33:22] [config] ulr: false
[2019-07-25 20:33:22] [config] ulr-dim-emb: 0
[2019-07-25 20:33:22] [config] ulr-dropout: 0
[2019-07-25 20:33:22] [config] ulr-keys-vectors: ""
[2019-07-25 20:33:22] [config] ulr-query-vectors: ""
[2019-07-25 20:33:22] [config] ulr-softmax-temperature: 1
[2019-07-25 20:33:22] [config] ulr-trainable-transformation: false
[2019-07-25 20:33:22] [config] valid-freq: 20000
[2019-07-25 20:33:22] [config] valid-log: ../experiments/10M_bicleaner_st_lm_2/model/valid.log
[2019-07-25 20:33:22] [config] valid-max-length: 1000
[2019-07-25 20:33:22] [config] valid-metrics:
[2019-07-25 20:33:22] [config]   - cross-entropy
[2019-07-25 20:33:22] [config]   - perplexity
[2019-07-25 20:33:22] [config]   - translation
[2019-07-25 20:33:22] [config] valid-mini-batch: 8
[2019-07-25 20:33:22] [config] valid-script-path: ../experiments/10M_bicleaner_st_lm_2/score-dev.sh
[2019-07-25 20:33:22] [config] valid-sets:
[2019-07-25 20:33:22] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.de
[2019-07-25 20:33:22] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/dev.bpe.en
[2019-07-25 20:33:22] [config] valid-translation-output: ../experiments/10M_bicleaner_st_lm_2/model/dev.out
[2019-07-25 20:33:22] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 20:33:22] [config] vocabs:
[2019-07-25 20:33:22] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json
[2019-07-25 20:33:22] [config]   - ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json
[2019-07-25 20:33:22] [config] word-penalty: 0
[2019-07-25 20:33:22] [config] workspace: 5000
[2019-07-25 20:33:22] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-07-25 20:33:22] Using synchronous training
[2019-07-25 20:33:22] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.de.json
[2019-07-25 20:33:23] [data] Using unused word id eos for 0
[2019-07-25 20:33:23] [data] Using unused word id UNK for 1
[2019-07-25 20:33:23] [data] Setting vocabulary size for input 0 to 50000
[2019-07-25 20:33:23] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_bicleaner_st_lm_2/data/train.bpe.en.json
[2019-07-25 20:33:23] [data] Using unused word id eos for 0
[2019-07-25 20:33:23] [data] Using unused word id UNK for 1
[2019-07-25 20:33:23] [data] Setting vocabulary size for input 1 to 50000
[2019-07-25 20:33:23] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-07-25 20:33:23] [batching] Collecting statistics for batch fitting with step size 10
[2019-07-25 20:33:24] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-25 20:33:25] [memory] Extending reserved space to 5120 MB (device gpu3)
[2019-07-25 20:33:25] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-25 20:33:26] [comm] NCCLCommunicator constructed successfully.
[2019-07-25 20:33:26] [training] Using 2 GPUs
[2019-07-25 20:33:26] [memory] Reserving 422 MB, device gpu2
[2019-07-25 20:33:26] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-07-25 20:33:26] [memory] Reserving 422 MB, device gpu2
[2019-07-25 20:33:30] [batching] Done. Typical MB size is 13760 target words
[2019-07-25 20:33:30] [memory] Extending reserved space to 5120 MB (device gpu2)
[2019-07-25 20:33:30] [memory] Extending reserved space to 5120 MB (device gpu3)
[2019-07-25 20:33:30] [comm] Using NCCL 2.4.2 for GPU communication
[2019-07-25 20:33:30] [comm] NCCLCommunicator constructed successfully.
[2019-07-25 20:33:30] [training] Using 2 GPUs
[2019-07-25 20:33:30] Loading model from ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 20:33:38] Loading model from ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 20:33:41] Loading Adam parameters from ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-25 20:33:51] [memory] Reserving 422 MB, device gpu2
[2019-07-25 20:33:51] [memory] Reserving 422 MB, device gpu3
[2019-07-25 20:33:52] [training] Model reloaded from ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 20:33:52] [data] Restoring the corpus state to epoch 41, batch 60000
[2019-07-25 20:33:52] [data] Shuffling data
[2019-07-25 20:33:53] [data] Done reading 632833 sentences
[2019-07-25 20:33:56] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 20:34:06] Training started
[2019-07-25 20:34:06] [training] Batches are processed as 1 process(es) x 2 devices/process
[2019-07-25 20:34:06] [memory] Reserving 422 MB, device gpu3
[2019-07-25 20:34:06] [memory] Reserving 422 MB, device gpu2
[2019-07-25 20:34:07] [memory] Reserving 422 MB, device gpu2
[2019-07-25 20:34:07] [memory] Reserving 422 MB, device gpu3
[2019-07-25 20:34:07] Loading model from ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 20:34:13] [memory] Reserving 422 MB, device cpu0
[2019-07-25 20:34:13] [memory] Reserving 211 MB, device gpu2
[2019-07-25 20:34:13] [memory] Reserving 211 MB, device gpu3
[2019-07-25 20:36:21] Seen 599177 samples
[2019-07-25 20:36:21] Starting epoch 42
[2019-07-25 20:36:21] [data] Shuffling data
[2019-07-25 20:36:21] [data] Done reading 632833 sentences
[2019-07-25 20:36:23] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 20:45:00] Seen 599177 samples
[2019-07-25 20:45:00] Starting epoch 43
[2019-07-25 20:45:00] [data] Shuffling data
[2019-07-25 20:45:00] [data] Done reading 632833 sentences
[2019-07-25 20:45:03] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 20:46:03] Ep. 43 : Up. 62000 : Sen. 68,152 : Cost 19.22379494 : Time 760.24s : 21088.67 words/s
[2019-07-25 20:53:37] Seen 599177 samples
[2019-07-25 20:53:37] Starting epoch 44
[2019-07-25 20:53:37] [data] Shuffling data
[2019-07-25 20:53:38] [data] Done reading 632833 sentences
[2019-07-25 20:53:40] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 20:57:46] Ep. 44 : Up. 64000 : Sen. 285,976 : Cost 18.92418289 : Time 702.98s : 22817.99 words/s
[2019-07-25 21:02:15] Seen 599177 samples
[2019-07-25 21:02:15] Starting epoch 45
[2019-07-25 21:02:15] [data] Shuffling data
[2019-07-25 21:02:16] [data] Done reading 632833 sentences
[2019-07-25 21:02:18] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:09:30] Ep. 45 : Up. 66000 : Sen. 502,280 : Cost 18.79273033 : Time 703.33s : 22783.17 words/s
[2019-07-25 21:10:54] Seen 599177 samples
[2019-07-25 21:10:54] Starting epoch 46
[2019-07-25 21:10:54] [data] Shuffling data
[2019-07-25 21:10:54] [data] Done reading 632833 sentences
[2019-07-25 21:10:56] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:19:32] Seen 599177 samples
[2019-07-25 21:19:32] Starting epoch 47
[2019-07-25 21:19:32] [data] Shuffling data
[2019-07-25 21:19:32] [data] Done reading 632833 sentences
[2019-07-25 21:19:34] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:21:18] Ep. 47 : Up. 68000 : Sen. 117,628 : Cost 18.64694023 : Time 707.91s : 22592.05 words/s
[2019-07-25 21:28:11] Seen 599177 samples
[2019-07-25 21:28:11] Starting epoch 48
[2019-07-25 21:28:11] [data] Shuffling data
[2019-07-25 21:28:11] [data] Done reading 632833 sentences
[2019-07-25 21:28:13] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:33:01] Ep. 48 : Up. 70000 : Sen. 333,628 : Cost 18.17301178 : Time 703.84s : 22724.62 words/s
[2019-07-25 21:36:49] Seen 599177 samples
[2019-07-25 21:36:49] Starting epoch 49
[2019-07-25 21:36:49] [data] Shuffling data
[2019-07-25 21:36:50] [data] Done reading 632833 sentences
[2019-07-25 21:36:52] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:44:46] Ep. 49 : Up. 72000 : Sen. 549,438 : Cost 18.00658607 : Time 704.72s : 22724.72 words/s
[2019-07-25 21:45:29] Seen 599177 samples
[2019-07-25 21:45:29] Starting epoch 50
[2019-07-25 21:45:29] [data] Shuffling data
[2019-07-25 21:45:30] [data] Done reading 632833 sentences
[2019-07-25 21:45:32] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:54:09] Seen 599177 samples
[2019-07-25 21:54:09] Starting epoch 51
[2019-07-25 21:54:09] [data] Shuffling data
[2019-07-25 21:54:10] [data] Done reading 632833 sentences
[2019-07-25 21:54:12] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 21:56:34] Ep. 51 : Up. 74000 : Sen. 161,440 : Cost 17.81324768 : Time 707.77s : 22481.41 words/s
[2019-07-25 22:02:51] Seen 599177 samples
[2019-07-25 22:02:51] Starting epoch 52
[2019-07-25 22:02:51] [data] Shuffling data
[2019-07-25 22:02:52] [data] Done reading 632833 sentences
[2019-07-25 22:02:56] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:08:22] Ep. 52 : Up. 76000 : Sen. 375,608 : Cost 17.47807503 : Time 708.23s : 22564.08 words/s
[2019-07-25 22:11:35] Seen 599177 samples
[2019-07-25 22:11:35] Starting epoch 53
[2019-07-25 22:11:35] [data] Shuffling data
[2019-07-25 22:11:35] [data] Done reading 632833 sentences
[2019-07-25 22:11:37] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:20:07] Ep. 53 : Up. 78000 : Sen. 588,536 : Cost 17.34696007 : Time 704.83s : 22630.26 words/s
[2019-07-25 22:20:16] Seen 599177 samples
[2019-07-25 22:20:16] Starting epoch 54
[2019-07-25 22:20:16] [data] Shuffling data
[2019-07-25 22:20:17] [data] Done reading 632833 sentences
[2019-07-25 22:20:20] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:28:59] Seen 599177 samples
[2019-07-25 22:28:59] Starting epoch 55
[2019-07-25 22:28:59] [data] Shuffling data
[2019-07-25 22:28:59] [data] Done reading 632833 sentences
[2019-07-25 22:29:01] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:31:58] Ep. 55 : Up. 80000 : Sen. 202,178 : Cost 16.96407509 : Time 711.34s : 22449.55 words/s
[2019-07-25 22:31:58] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-25 22:32:08] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter80000.npz
[2019-07-25 22:32:15] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-25 22:32:25] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-25 22:32:49] [valid] Ep. 55 : Up. 80000 : cross-entropy : 65.9999 : new best
[2019-07-25 22:32:52] [valid] Ep. 55 : Up. 80000 : perplexity : 13.2934 : new best
[2019-07-25 22:33:40] [valid] Ep. 55 : Up. 80000 : translation : 23.8 : new best
[2019-07-25 22:39:25] Seen 599177 samples
[2019-07-25 22:39:25] Starting epoch 56
[2019-07-25 22:39:25] [data] Shuffling data
[2019-07-25 22:39:25] [data] Done reading 632833 sentences
[2019-07-25 22:39:27] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:45:27] Ep. 56 : Up. 82000 : Sen. 413,600 : Cost 16.96496964 : Time 808.31s : 19679.37 words/s
[2019-07-25 22:48:06] Seen 599177 samples
[2019-07-25 22:48:06] Starting epoch 57
[2019-07-25 22:48:06] [data] Shuffling data
[2019-07-25 22:48:07] [data] Done reading 632833 sentences
[2019-07-25 22:48:09] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:56:47] Seen 599177 samples
[2019-07-25 22:56:47] Starting epoch 58
[2019-07-25 22:56:47] [data] Shuffling data
[2019-07-25 22:56:47] [data] Done reading 632833 sentences
[2019-07-25 22:56:49] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 22:57:19] Ep. 58 : Up. 84000 : Sen. 32,000 : Cost 16.71480179 : Time 711.87s : 22534.21 words/s
[2019-07-25 23:05:28] Seen 599177 samples
[2019-07-25 23:05:28] Starting epoch 59
[2019-07-25 23:05:28] [data] Shuffling data
[2019-07-25 23:05:28] [data] Done reading 632833 sentences
[2019-07-25 23:05:30] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 23:09:06] Ep. 59 : Up. 86000 : Sen. 249,252 : Cost 16.53807449 : Time 707.63s : 22664.28 words/s
[2019-07-25 23:14:08] Seen 599177 samples
[2019-07-25 23:14:08] Starting epoch 60
[2019-07-25 23:14:08] [data] Shuffling data
[2019-07-25 23:14:08] [data] Done reading 632833 sentences
[2019-07-25 23:14:11] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 23:20:52] Ep. 60 : Up. 88000 : Sen. 463,600 : Cost 16.43001556 : Time 706.04s : 22629.72 words/s
[2019-07-25 23:22:49] Seen 599177 samples
[2019-07-25 23:22:49] Starting epoch 61
[2019-07-25 23:22:49] [data] Shuffling data
[2019-07-25 23:22:49] [data] Done reading 632833 sentences
[2019-07-25 23:22:52] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 23:31:29] Seen 599177 samples
[2019-07-25 23:31:29] Starting epoch 62
[2019-07-25 23:31:29] [data] Shuffling data
[2019-07-25 23:31:29] [data] Done reading 632833 sentences
[2019-07-25 23:31:31] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 23:32:43] Ep. 62 : Up. 90000 : Sen. 80,356 : Cost 16.21011162 : Time 710.63s : 22539.84 words/s
[2019-07-25 23:40:11] Seen 599177 samples
[2019-07-25 23:40:11] Starting epoch 63
[2019-07-25 23:40:11] [data] Shuffling data
[2019-07-25 23:40:11] [data] Done reading 632833 sentences
[2019-07-25 23:40:13] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 23:44:30] Ep. 63 : Up. 92000 : Sen. 294,860 : Cost 15.87069893 : Time 706.72s : 22606.20 words/s
[2019-07-25 23:48:52] Seen 599177 samples
[2019-07-25 23:48:52] Starting epoch 64
[2019-07-25 23:48:52] [data] Shuffling data
[2019-07-25 23:48:53] [data] Done reading 632833 sentences
[2019-07-25 23:48:55] [data] Done shuffling 632833 sentences to temp files
[2019-07-25 23:56:17] Ep. 64 : Up. 94000 : Sen. 510,018 : Cost 15.81445122 : Time 707.03s : 22621.83 words/s
[2019-07-25 23:57:34] Seen 599177 samples
[2019-07-25 23:57:34] Starting epoch 65
[2019-07-25 23:57:34] [data] Shuffling data
[2019-07-25 23:57:34] [data] Done reading 632833 sentences
[2019-07-25 23:57:36] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:06:16] Seen 599177 samples
[2019-07-26 00:06:16] Starting epoch 66
[2019-07-26 00:06:16] [data] Shuffling data
[2019-07-26 00:06:16] [data] Done reading 632833 sentences
[2019-07-26 00:06:18] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:08:08] Ep. 66 : Up. 96000 : Sen. 125,516 : Cost 15.66964340 : Time 711.56s : 22478.14 words/s
[2019-07-26 00:14:57] Seen 599177 samples
[2019-07-26 00:14:57] Starting epoch 67
[2019-07-26 00:14:57] [data] Shuffling data
[2019-07-26 00:14:58] [data] Done reading 632833 sentences
[2019-07-26 00:15:00] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:19:54] Ep. 67 : Up. 98000 : Sen. 337,778 : Cost 15.57103348 : Time 706.16s : 22564.36 words/s
[2019-07-26 00:23:39] Seen 599177 samples
[2019-07-26 00:23:39] Starting epoch 68
[2019-07-26 00:23:39] [data] Shuffling data
[2019-07-26 00:23:39] [data] Done reading 632833 sentences
[2019-07-26 00:23:41] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:31:43] Ep. 68 : Up. 100000 : Sen. 556,536 : Cost 15.32618141 : Time 708.95s : 22659.12 words/s
[2019-07-26 00:31:43] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-26 00:31:53] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter100000.npz
[2019-07-26 00:32:00] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-26 00:32:10] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-26 00:32:34] [valid] Ep. 68 : Up. 100000 : cross-entropy : 68.3984 : stalled 1 times (last best: 65.9999)
[2019-07-26 00:32:38] [valid] Ep. 68 : Up. 100000 : perplexity : 14.6039 : stalled 1 times (last best: 13.2934)
[2019-07-26 00:33:21] [valid] Ep. 68 : Up. 100000 : translation : 23.54 : stalled 1 times (last best: 23.8)
[2019-07-26 00:34:01] Seen 599177 samples
[2019-07-26 00:34:01] Starting epoch 69
[2019-07-26 00:34:01] [data] Shuffling data
[2019-07-26 00:34:01] [data] Done reading 632833 sentences
[2019-07-26 00:34:03] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:42:43] Seen 599177 samples
[2019-07-26 00:42:43] Starting epoch 70
[2019-07-26 00:42:43] [data] Shuffling data
[2019-07-26 00:42:43] [data] Done reading 632833 sentences
[2019-07-26 00:42:46] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:45:16] Ep. 70 : Up. 102000 : Sen. 172,452 : Cost 15.04311180 : Time 812.53s : 19687.97 words/s
[2019-07-26 00:51:24] Seen 599177 samples
[2019-07-26 00:51:24] Starting epoch 71
[2019-07-26 00:51:24] [data] Shuffling data
[2019-07-26 00:51:25] [data] Done reading 632833 sentences
[2019-07-26 00:51:27] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 00:57:02] Ep. 71 : Up. 104000 : Sen. 385,770 : Cost 15.09925079 : Time 706.28s : 22595.88 words/s
[2019-07-26 01:00:07] Seen 599177 samples
[2019-07-26 01:00:07] Starting epoch 72
[2019-07-26 01:00:07] [data] Shuffling data
[2019-07-26 01:00:07] [data] Done reading 632833 sentences
[2019-07-26 01:00:09] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:08:48] Ep. 72 : Up. 106000 : Sen. 597,318 : Cost 14.91519165 : Time 706.16s : 22548.76 words/s
[2019-07-26 01:08:50] Seen 599177 samples
[2019-07-26 01:08:50] Starting epoch 73
[2019-07-26 01:08:50] [data] Shuffling data
[2019-07-26 01:08:50] [data] Done reading 632833 sentences
[2019-07-26 01:08:53] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:17:32] Seen 599177 samples
[2019-07-26 01:17:32] Starting epoch 74
[2019-07-26 01:17:32] [data] Shuffling data
[2019-07-26 01:17:32] [data] Done reading 632833 sentences
[2019-07-26 01:17:34] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:20:40] Ep. 74 : Up. 108000 : Sen. 213,294 : Cost 14.69205952 : Time 712.04s : 22460.03 words/s
[2019-07-26 01:26:14] Seen 599177 samples
[2019-07-26 01:26:14] Starting epoch 75
[2019-07-26 01:26:14] [data] Shuffling data
[2019-07-26 01:26:14] [data] Done reading 632833 sentences
[2019-07-26 01:26:16] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:32:29] Ep. 75 : Up. 110000 : Sen. 429,148 : Cost 14.57737350 : Time 708.71s : 22602.47 words/s
[2019-07-26 01:34:56] Seen 599177 samples
[2019-07-26 01:34:56] Starting epoch 76
[2019-07-26 01:34:56] [data] Shuffling data
[2019-07-26 01:34:57] [data] Done reading 632833 sentences
[2019-07-26 01:34:59] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:43:39] Seen 599177 samples
[2019-07-26 01:43:39] Starting epoch 77
[2019-07-26 01:43:39] [data] Shuffling data
[2019-07-26 01:43:40] [data] Done reading 632833 sentences
[2019-07-26 01:43:42] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:44:21] Ep. 77 : Up. 112000 : Sen. 41,880 : Cost 14.46034908 : Time 712.09s : 22389.14 words/s
[2019-07-26 01:52:22] Seen 599177 samples
[2019-07-26 01:52:22] Starting epoch 78
[2019-07-26 01:52:22] [data] Shuffling data
[2019-07-26 01:52:22] [data] Done reading 632833 sentences
[2019-07-26 01:52:24] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 01:56:09] Ep. 78 : Up. 114000 : Sen. 256,698 : Cost 14.24802876 : Time 707.65s : 22567.50 words/s
[2019-07-26 02:01:05] Seen 599177 samples
[2019-07-26 02:01:05] Starting epoch 79
[2019-07-26 02:01:05] [data] Shuffling data
[2019-07-26 02:01:05] [data] Done reading 632833 sentences
[2019-07-26 02:01:07] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:07:57] Ep. 79 : Up. 116000 : Sen. 471,914 : Cost 14.19373035 : Time 708.21s : 22591.80 words/s
[2019-07-26 02:09:46] Seen 599177 samples
[2019-07-26 02:09:46] Starting epoch 80
[2019-07-26 02:09:46] [data] Shuffling data
[2019-07-26 02:09:46] [data] Done reading 632833 sentences
[2019-07-26 02:09:48] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:18:29] Seen 599177 samples
[2019-07-26 02:18:29] Starting epoch 81
[2019-07-26 02:18:29] [data] Shuffling data
[2019-07-26 02:18:30] [data] Done reading 632833 sentences
[2019-07-26 02:18:31] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:19:50] Ep. 81 : Up. 118000 : Sen. 89,252 : Cost 13.95822811 : Time 713.53s : 22455.39 words/s
[2019-07-26 02:27:12] Seen 599177 samples
[2019-07-26 02:27:12] Starting epoch 82
[2019-07-26 02:27:12] [data] Shuffling data
[2019-07-26 02:27:12] [data] Done reading 632833 sentences
[2019-07-26 02:27:14] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:31:38] Ep. 82 : Up. 120000 : Sen. 301,608 : Cost 14.07931423 : Time 707.45s : 22534.84 words/s
[2019-07-26 02:31:38] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-26 02:31:48] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter120000.npz
[2019-07-26 02:31:55] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-26 02:32:05] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-26 02:32:26] [valid] Ep. 82 : Up. 120000 : cross-entropy : 71.0686 : stalled 2 times (last best: 65.9999)
[2019-07-26 02:32:29] [valid] Ep. 82 : Up. 120000 : perplexity : 16.2155 : stalled 2 times (last best: 13.2934)
[2019-07-26 02:33:15] [valid] Ep. 82 : Up. 120000 : translation : 23.32 : stalled 2 times (last best: 23.8)
[2019-07-26 02:37:33] Seen 599177 samples
[2019-07-26 02:37:33] Starting epoch 83
[2019-07-26 02:37:33] [data] Shuffling data
[2019-07-26 02:37:34] [data] Done reading 632833 sentences
[2019-07-26 02:37:36] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:45:07] Ep. 83 : Up. 122000 : Sen. 521,786 : Cost 13.88321686 : Time 809.18s : 19882.60 words/s
[2019-07-26 02:46:15] Seen 599177 samples
[2019-07-26 02:46:15] Starting epoch 84
[2019-07-26 02:46:15] [data] Shuffling data
[2019-07-26 02:46:15] [data] Done reading 632833 sentences
[2019-07-26 02:46:17] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:54:57] Seen 599177 samples
[2019-07-26 02:54:57] Starting epoch 85
[2019-07-26 02:54:57] [data] Shuffling data
[2019-07-26 02:54:57] [data] Done reading 632833 sentences
[2019-07-26 02:54:59] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 02:56:59] Ep. 85 : Up. 124000 : Sen. 135,822 : Cost 13.71027088 : Time 712.28s : 22411.60 words/s
[2019-07-26 03:03:39] Seen 599177 samples
[2019-07-26 03:03:39] Starting epoch 86
[2019-07-26 03:03:39] [data] Shuffling data
[2019-07-26 03:03:40] [data] Done reading 632833 sentences
[2019-07-26 03:03:42] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:08:48] Ep. 86 : Up. 126000 : Sen. 355,404 : Cost 13.65405655 : Time 709.06s : 22674.04 words/s
[2019-07-26 03:12:20] Seen 599177 samples
[2019-07-26 03:12:20] Starting epoch 87
[2019-07-26 03:12:20] [data] Shuffling data
[2019-07-26 03:12:20] [data] Done reading 632833 sentences
[2019-07-26 03:12:23] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:20:37] Ep. 87 : Up. 128000 : Sen. 569,600 : Cost 13.59934998 : Time 708.29s : 22560.81 words/s
[2019-07-26 03:21:02] Seen 599177 samples
[2019-07-26 03:21:02] Starting epoch 88
[2019-07-26 03:21:02] [data] Shuffling data
[2019-07-26 03:21:03] [data] Done reading 632833 sentences
[2019-07-26 03:21:04] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:29:45] Seen 599177 samples
[2019-07-26 03:29:45] Starting epoch 89
[2019-07-26 03:29:45] [data] Shuffling data
[2019-07-26 03:29:45] [data] Done reading 632833 sentences
[2019-07-26 03:29:47] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:32:28] Ep. 89 : Up. 130000 : Sen. 184,528 : Cost 13.40722561 : Time 711.42s : 22449.56 words/s
[2019-07-26 03:38:26] Seen 599177 samples
[2019-07-26 03:38:26] Starting epoch 90
[2019-07-26 03:38:26] [data] Shuffling data
[2019-07-26 03:38:26] [data] Done reading 632833 sentences
[2019-07-26 03:38:28] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:44:16] Ep. 90 : Up. 132000 : Sen. 400,036 : Cost 13.42111969 : Time 708.33s : 22613.10 words/s
[2019-07-26 03:47:08] Seen 599177 samples
[2019-07-26 03:47:08] Starting epoch 91
[2019-07-26 03:47:08] [data] Shuffling data
[2019-07-26 03:47:08] [data] Done reading 632833 sentences
[2019-07-26 03:47:10] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:55:50] Seen 599177 samples
[2019-07-26 03:55:50] Starting epoch 92
[2019-07-26 03:55:50] [data] Shuffling data
[2019-07-26 03:55:50] [data] Done reading 632833 sentences
[2019-07-26 03:55:52] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 03:56:07] Ep. 92 : Up. 134000 : Sen. 15,634 : Cost 13.26525497 : Time 710.79s : 22474.42 words/s
[2019-07-26 04:04:30] Seen 599177 samples
[2019-07-26 04:04:30] Starting epoch 93
[2019-07-26 04:04:30] [data] Shuffling data
[2019-07-26 04:04:31] [data] Done reading 632833 sentences
[2019-07-26 04:04:33] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 04:07:54] Ep. 93 : Up. 136000 : Sen. 231,202 : Cost 13.11517143 : Time 706.60s : 22656.96 words/s
[2019-07-26 04:13:11] Seen 599177 samples
[2019-07-26 04:13:11] Starting epoch 94
[2019-07-26 04:13:11] [data] Shuffling data
[2019-07-26 04:13:11] [data] Done reading 632833 sentences
[2019-07-26 04:13:13] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 04:19:45] Ep. 94 : Up. 138000 : Sen. 447,304 : Cost 13.21831036 : Time 711.08s : 22510.18 words/s
[2019-07-26 04:21:56] Seen 599177 samples
[2019-07-26 04:21:56] Starting epoch 95
[2019-07-26 04:21:56] [data] Shuffling data
[2019-07-26 04:21:56] [data] Done reading 632833 sentences
[2019-07-26 04:21:58] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 04:30:37] Seen 599177 samples
[2019-07-26 04:30:37] Starting epoch 96
[2019-07-26 04:30:37] [data] Shuffling data
[2019-07-26 04:30:38] [data] Done reading 632833 sentences
[2019-07-26 04:30:40] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 04:31:37] Ep. 96 : Up. 140000 : Sen. 64,000 : Cost 13.05647469 : Time 712.17s : 22491.97 words/s
[2019-07-26 04:31:37] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-26 04:31:47] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter140000.npz
[2019-07-26 04:31:54] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-26 04:32:03] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-26 04:32:27] [valid] Ep. 96 : Up. 140000 : cross-entropy : 73.5528 : stalled 3 times (last best: 65.9999)
[2019-07-26 04:32:30] [valid] Ep. 96 : Up. 140000 : perplexity : 17.874 : stalled 3 times (last best: 13.2934)
[2019-07-26 04:33:10] [valid] Ep. 96 : Up. 140000 : translation : 22.92 : stalled 3 times (last best: 23.8)
[2019-07-26 04:40:53] Seen 599177 samples
[2019-07-26 04:40:53] Starting epoch 97
[2019-07-26 04:40:53] [data] Shuffling data
[2019-07-26 04:40:54] [data] Done reading 632833 sentences
[2019-07-26 04:40:56] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 04:44:59] Ep. 97 : Up. 142000 : Sen. 278,304 : Cost 12.92188644 : Time 801.70s : 19950.80 words/s
[2019-07-26 04:49:35] Seen 599177 samples
[2019-07-26 04:49:35] Starting epoch 98
[2019-07-26 04:49:35] [data] Shuffling data
[2019-07-26 04:49:35] [data] Done reading 632833 sentences
[2019-07-26 04:49:37] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 04:56:47] Ep. 98 : Up. 144000 : Sen. 494,332 : Cost 12.91510677 : Time 708.09s : 22584.43 words/s
[2019-07-26 04:58:18] Seen 599177 samples
[2019-07-26 04:58:18] Starting epoch 99
[2019-07-26 04:58:18] [data] Shuffling data
[2019-07-26 04:58:18] [data] Done reading 632833 sentences
[2019-07-26 04:58:20] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:06:58] Seen 599177 samples
[2019-07-26 05:06:58] Starting epoch 100
[2019-07-26 05:06:58] [data] Shuffling data
[2019-07-26 05:06:58] [data] Done reading 632833 sentences
[2019-07-26 05:07:00] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:08:38] Ep. 100 : Up. 146000 : Sen. 110,068 : Cost 12.72637272 : Time 710.60s : 22508.40 words/s
[2019-07-26 05:15:39] Seen 599177 samples
[2019-07-26 05:15:39] Starting epoch 101
[2019-07-26 05:15:39] [data] Shuffling data
[2019-07-26 05:15:39] [data] Done reading 632833 sentences
[2019-07-26 05:15:41] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:20:24] Ep. 101 : Up. 148000 : Sen. 327,012 : Cost 12.67539978 : Time 706.75s : 22691.15 words/s
[2019-07-26 05:24:19] Seen 599177 samples
[2019-07-26 05:24:19] Starting epoch 102
[2019-07-26 05:24:19] [data] Shuffling data
[2019-07-26 05:24:19] [data] Done reading 632833 sentences
[2019-07-26 05:24:21] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:32:09] Ep. 102 : Up. 150000 : Sen. 540,596 : Cost 12.59292698 : Time 705.10s : 22632.05 words/s
[2019-07-26 05:33:00] Seen 599177 samples
[2019-07-26 05:33:00] Starting epoch 103
[2019-07-26 05:33:00] [data] Shuffling data
[2019-07-26 05:33:01] [data] Done reading 632833 sentences
[2019-07-26 05:33:03] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:41:40] Seen 599177 samples
[2019-07-26 05:41:40] Starting epoch 104
[2019-07-26 05:41:40] [data] Shuffling data
[2019-07-26 05:41:41] [data] Done reading 632833 sentences
[2019-07-26 05:41:43] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:43:59] Ep. 104 : Up. 152000 : Sen. 156,554 : Cost 12.38175869 : Time 709.84s : 22527.22 words/s
[2019-07-26 05:50:21] Seen 599177 samples
[2019-07-26 05:50:21] Starting epoch 105
[2019-07-26 05:50:21] [data] Shuffling data
[2019-07-26 05:50:21] [data] Done reading 632833 sentences
[2019-07-26 05:50:23] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 05:55:45] Ep. 105 : Up. 154000 : Sen. 370,986 : Cost 12.54741859 : Time 705.59s : 22661.95 words/s
[2019-07-26 05:59:01] Seen 599177 samples
[2019-07-26 05:59:01] Starting epoch 106
[2019-07-26 05:59:01] [data] Shuffling data
[2019-07-26 05:59:01] [data] Done reading 632833 sentences
[2019-07-26 05:59:03] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:07:30] Ep. 106 : Up. 156000 : Sen. 585,940 : Cost 12.42640209 : Time 705.65s : 22649.82 words/s
[2019-07-26 06:07:42] Seen 599177 samples
[2019-07-26 06:07:42] Starting epoch 107
[2019-07-26 06:07:42] [data] Shuffling data
[2019-07-26 06:07:42] [data] Done reading 632833 sentences
[2019-07-26 06:07:44] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:16:23] Seen 599177 samples
[2019-07-26 06:16:23] Starting epoch 108
[2019-07-26 06:16:23] [data] Shuffling data
[2019-07-26 06:16:23] [data] Done reading 632833 sentences
[2019-07-26 06:16:25] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:19:19] Ep. 108 : Up. 158000 : Sen. 198,400 : Cost 12.19222546 : Time 708.60s : 22487.43 words/s
[2019-07-26 06:25:03] Seen 599177 samples
[2019-07-26 06:25:03] Starting epoch 109
[2019-07-26 06:25:03] [data] Shuffling data
[2019-07-26 06:25:04] [data] Done reading 632833 sentences
[2019-07-26 06:25:06] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:31:08] Ep. 109 : Up. 160000 : Sen. 416,698 : Cost 12.16121674 : Time 708.51s : 22652.60 words/s
[2019-07-26 06:31:08] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-26 06:31:17] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter160000.npz
[2019-07-26 06:31:25] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-26 06:31:35] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-26 06:31:58] [valid] Ep. 109 : Up. 160000 : cross-entropy : 75.8723 : stalled 4 times (last best: 65.9999)
[2019-07-26 06:32:01] [valid] Ep. 109 : Up. 160000 : perplexity : 19.5754 : stalled 4 times (last best: 13.2934)
[2019-07-26 06:32:51] [valid] Ep. 109 : Up. 160000 : translation : 22.74 : stalled 4 times (last best: 23.8)
[2019-07-26 06:35:31] Seen 599177 samples
[2019-07-26 06:35:31] Starting epoch 110
[2019-07-26 06:35:31] [data] Shuffling data
[2019-07-26 06:35:31] [data] Done reading 632833 sentences
[2019-07-26 06:35:33] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:44:13] Seen 599177 samples
[2019-07-26 06:44:13] Starting epoch 111
[2019-07-26 06:44:13] [data] Shuffling data
[2019-07-26 06:44:13] [data] Done reading 632833 sentences
[2019-07-26 06:44:16] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:44:47] Ep. 111 : Up. 162000 : Sen. 31,302 : Cost 12.40590286 : Time 819.24s : 19500.54 words/s
[2019-07-26 06:52:56] Seen 599177 samples
[2019-07-26 06:52:56] Starting epoch 112
[2019-07-26 06:52:56] [data] Shuffling data
[2019-07-26 06:52:57] [data] Done reading 632833 sentences
[2019-07-26 06:52:59] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 06:56:33] Ep. 112 : Up. 164000 : Sen. 245,628 : Cost 11.95130157 : Time 706.52s : 22617.63 words/s
[2019-07-26 07:01:37] Seen 599177 samples
[2019-07-26 07:01:37] Starting epoch 113
[2019-07-26 07:01:37] [data] Shuffling data
[2019-07-26 07:01:38] [data] Done reading 632833 sentences
[2019-07-26 07:01:40] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:08:23] Ep. 113 : Up. 166000 : Sen. 464,094 : Cost 12.02405834 : Time 709.50s : 22618.65 words/s
[2019-07-26 07:10:19] Seen 599177 samples
[2019-07-26 07:10:19] Starting epoch 114
[2019-07-26 07:10:19] [data] Shuffling data
[2019-07-26 07:10:20] [data] Done reading 632833 sentences
[2019-07-26 07:10:22] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:18:59] Seen 599177 samples
[2019-07-26 07:18:59] Starting epoch 115
[2019-07-26 07:18:59] [data] Shuffling data
[2019-07-26 07:19:00] [data] Done reading 632833 sentences
[2019-07-26 07:19:02] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:20:15] Ep. 115 : Up. 168000 : Sen. 82,936 : Cost 11.94274044 : Time 712.46s : 22533.04 words/s
[2019-07-26 07:27:41] Seen 599177 samples
[2019-07-26 07:27:41] Starting epoch 116
[2019-07-26 07:27:41] [data] Shuffling data
[2019-07-26 07:27:41] [data] Done reading 632833 sentences
[2019-07-26 07:27:45] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:32:02] Ep. 116 : Up. 170000 : Sen. 296,282 : Cost 11.83175278 : Time 706.91s : 22578.18 words/s
[2019-07-26 07:36:22] Seen 599177 samples
[2019-07-26 07:36:22] Starting epoch 117
[2019-07-26 07:36:22] [data] Shuffling data
[2019-07-26 07:36:22] [data] Done reading 632833 sentences
[2019-07-26 07:36:24] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:43:49] Ep. 117 : Up. 172000 : Sen. 514,146 : Cost 11.86543369 : Time 706.87s : 22708.76 words/s
[2019-07-26 07:45:02] Seen 599177 samples
[2019-07-26 07:45:02] Starting epoch 118
[2019-07-26 07:45:02] [data] Shuffling data
[2019-07-26 07:45:03] [data] Done reading 632833 sentences
[2019-07-26 07:45:05] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:53:44] Seen 599177 samples
[2019-07-26 07:53:44] Starting epoch 119
[2019-07-26 07:53:44] [data] Shuffling data
[2019-07-26 07:53:44] [data] Done reading 632833 sentences
[2019-07-26 07:53:46] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 07:55:40] Ep. 119 : Up. 174000 : Sen. 129,684 : Cost 11.77018929 : Time 711.36s : 22491.35 words/s
[2019-07-26 08:02:25] Seen 599177 samples
[2019-07-26 08:02:25] Starting epoch 120
[2019-07-26 08:02:25] [data] Shuffling data
[2019-07-26 08:02:25] [data] Done reading 632833 sentences
[2019-07-26 08:02:27] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 08:07:26] Ep. 120 : Up. 176000 : Sen. 344,528 : Cost 11.56724358 : Time 705.25s : 22647.46 words/s
[2019-07-26 08:11:06] Seen 599177 samples
[2019-07-26 08:11:06] Starting epoch 121
[2019-07-26 08:11:06] [data] Shuffling data
[2019-07-26 08:11:06] [data] Done reading 632833 sentences
[2019-07-26 08:11:08] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 08:19:10] Ep. 121 : Up. 178000 : Sen. 555,992 : Cost 11.56142998 : Time 704.19s : 22617.37 words/s
[2019-07-26 08:19:47] Seen 599177 samples
[2019-07-26 08:19:47] Starting epoch 122
[2019-07-26 08:19:47] [data] Shuffling data
[2019-07-26 08:19:47] [data] Done reading 632833 sentences
[2019-07-26 08:19:49] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 08:28:27] Seen 599177 samples
[2019-07-26 08:28:27] Starting epoch 123
[2019-07-26 08:28:27] [data] Shuffling data
[2019-07-26 08:28:27] [data] Done reading 632833 sentences
[2019-07-26 08:28:29] [data] Done shuffling 632833 sentences to temp files
[2019-07-26 08:31:00] Ep. 123 : Up. 180000 : Sen. 172,800 : Cost 11.59292603 : Time 710.49s : 22539.27 words/s
[2019-07-26 08:31:00] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-26 08:31:10] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.iter180000.npz
[2019-07-26 08:31:17] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-26 08:31:27] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
[2019-07-26 08:31:51] [valid] Ep. 123 : Up. 180000 : cross-entropy : 78.0373 : stalled 5 times (last best: 65.9999)
[2019-07-26 08:31:54] [valid] Ep. 123 : Up. 180000 : perplexity : 21.3094 : stalled 5 times (last best: 13.2934)
[2019-07-26 08:32:45] [valid] Ep. 123 : Up. 180000 : translation : 22.47 : stalled 5 times (last best: 23.8)
[2019-07-26 08:32:48] Training finished
[2019-07-26 08:32:53] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.orig.npz
[2019-07-26 08:33:02] Saving model to ../experiments/10M_bicleaner_st_lm_2/model/model.npz
[2019-07-26 08:33:12] Saving Adam parameters to ../experiments/10M_bicleaner_st_lm_2/model/model.npz.optimizer.npz
