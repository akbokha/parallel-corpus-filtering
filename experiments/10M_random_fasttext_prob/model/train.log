[2019-08-07 09:53:52] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 09:53:52] [marian] Running on zisa as process 28959 with command line:
[2019-08-07 09:53:52] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_random_fasttext_prob/model/model.npz -T . --devices 1 --train-sets ../experiments/10M_random_fasttext_prob/data/train.bpe.de ../experiments/10M_random_fasttext_prob/data/train.bpe.en --vocabs ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json --mini-batch-fit -w 3000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_random_fasttext_prob/data/dev.bpe.de ../experiments/10M_random_fasttext_prob/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_random_fasttext_prob/model/dev.out --valid-script-path ../experiments/10M_random_fasttext_prob/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_random_fasttext_prob/model/train.log --valid-log ../experiments/10M_random_fasttext_prob/model/valid.log
[2019-08-07 09:53:52] [config] after-batches: 0
[2019-08-07 09:53:52] [config] after-epochs: 0
[2019-08-07 09:53:52] [config] allow-unk: false
[2019-08-07 09:53:52] [config] beam-size: 12
[2019-08-07 09:53:52] [config] bert-class-symbol: "[CLS]"
[2019-08-07 09:53:52] [config] bert-mask-symbol: "[MASK]"
[2019-08-07 09:53:52] [config] bert-masking-fraction: 0.15
[2019-08-07 09:53:52] [config] bert-sep-symbol: "[SEP]"
[2019-08-07 09:53:52] [config] bert-train-type-embeddings: true
[2019-08-07 09:53:52] [config] bert-type-vocab-size: 2
[2019-08-07 09:53:52] [config] best-deep: false
[2019-08-07 09:53:52] [config] clip-gemm: 0
[2019-08-07 09:53:52] [config] clip-norm: 1
[2019-08-07 09:53:52] [config] cost-type: ce-mean
[2019-08-07 09:53:52] [config] cpu-threads: 0
[2019-08-07 09:53:52] [config] data-weighting: ""
[2019-08-07 09:53:52] [config] data-weighting-type: sentence
[2019-08-07 09:53:52] [config] dec-cell: gru
[2019-08-07 09:53:52] [config] dec-cell-base-depth: 2
[2019-08-07 09:53:52] [config] dec-cell-high-depth: 1
[2019-08-07 09:53:52] [config] dec-depth: 1
[2019-08-07 09:53:52] [config] devices:
[2019-08-07 09:53:52] [config]   - 1
[2019-08-07 09:53:52] [config] dim-emb: 512
[2019-08-07 09:53:52] [config] dim-rnn: 1024
[2019-08-07 09:53:52] [config] dim-vocabs:
[2019-08-07 09:53:52] [config]   - 50000
[2019-08-07 09:53:52] [config]   - 50000
[2019-08-07 09:53:52] [config] disp-first: 0
[2019-08-07 09:53:52] [config] disp-freq: 2000
[2019-08-07 09:53:52] [config] disp-label-counts: false
[2019-08-07 09:53:52] [config] dropout-rnn: 0.2
[2019-08-07 09:53:52] [config] dropout-src: 0.1
[2019-08-07 09:53:52] [config] dropout-trg: 0.1
[2019-08-07 09:53:52] [config] dump-config: ""
[2019-08-07 09:53:52] [config] early-stopping: 5
[2019-08-07 09:53:52] [config] embedding-fix-src: false
[2019-08-07 09:53:52] [config] embedding-fix-trg: false
[2019-08-07 09:53:52] [config] embedding-normalization: false
[2019-08-07 09:53:52] [config] embedding-vectors:
[2019-08-07 09:53:52] [config]   []
[2019-08-07 09:53:52] [config] enc-cell: gru
[2019-08-07 09:53:52] [config] enc-cell-depth: 1
[2019-08-07 09:53:52] [config] enc-depth: 1
[2019-08-07 09:53:52] [config] enc-type: bidirectional
[2019-08-07 09:53:52] [config] exponential-smoothing: 0.0001
[2019-08-07 09:53:52] [config] grad-dropping-momentum: 0
[2019-08-07 09:53:52] [config] grad-dropping-rate: 0
[2019-08-07 09:53:52] [config] grad-dropping-warmup: 100
[2019-08-07 09:53:52] [config] guided-alignment: none
[2019-08-07 09:53:52] [config] guided-alignment-cost: mse
[2019-08-07 09:53:52] [config] guided-alignment-weight: 0.1
[2019-08-07 09:53:52] [config] ignore-model-config: false
[2019-08-07 09:53:52] [config] input-types:
[2019-08-07 09:53:52] [config]   []
[2019-08-07 09:53:52] [config] interpolate-env-vars: false
[2019-08-07 09:53:52] [config] keep-best: false
[2019-08-07 09:53:52] [config] label-smoothing: 0
[2019-08-07 09:53:52] [config] layer-normalization: true
[2019-08-07 09:53:52] [config] learn-rate: 0.0001
[2019-08-07 09:53:52] [config] log: ../experiments/10M_random_fasttext_prob/model/train.log
[2019-08-07 09:53:52] [config] log-level: info
[2019-08-07 09:53:52] [config] log-time-zone: ""
[2019-08-07 09:53:52] [config] lr-decay: 0
[2019-08-07 09:53:52] [config] lr-decay-freq: 50000
[2019-08-07 09:53:52] [config] lr-decay-inv-sqrt:
[2019-08-07 09:53:52] [config]   - 0
[2019-08-07 09:53:52] [config] lr-decay-repeat-warmup: false
[2019-08-07 09:53:52] [config] lr-decay-reset-optimizer: false
[2019-08-07 09:53:52] [config] lr-decay-start:
[2019-08-07 09:53:52] [config]   - 10
[2019-08-07 09:53:52] [config]   - 1
[2019-08-07 09:53:52] [config] lr-decay-strategy: epoch+stalled
[2019-08-07 09:53:52] [config] lr-report: false
[2019-08-07 09:53:52] [config] lr-warmup: 0
[2019-08-07 09:53:52] [config] lr-warmup-at-reload: false
[2019-08-07 09:53:52] [config] lr-warmup-cycle: false
[2019-08-07 09:53:52] [config] lr-warmup-start-rate: 0
[2019-08-07 09:53:52] [config] max-length: 50
[2019-08-07 09:53:52] [config] max-length-crop: false
[2019-08-07 09:53:52] [config] max-length-factor: 3
[2019-08-07 09:53:52] [config] maxi-batch: 100
[2019-08-07 09:53:52] [config] maxi-batch-sort: trg
[2019-08-07 09:53:52] [config] mini-batch: 64
[2019-08-07 09:53:52] [config] mini-batch-fit: true
[2019-08-07 09:53:52] [config] mini-batch-fit-step: 10
[2019-08-07 09:53:52] [config] mini-batch-overstuff: 1
[2019-08-07 09:53:52] [config] mini-batch-track-lr: false
[2019-08-07 09:53:52] [config] mini-batch-understuff: 1
[2019-08-07 09:53:52] [config] mini-batch-warmup: 0
[2019-08-07 09:53:52] [config] mini-batch-words: 0
[2019-08-07 09:53:52] [config] mini-batch-words-ref: 0
[2019-08-07 09:53:52] [config] model: ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 09:53:52] [config] multi-loss-type: sum
[2019-08-07 09:53:52] [config] multi-node: false
[2019-08-07 09:53:52] [config] multi-node-overlap: true
[2019-08-07 09:53:52] [config] n-best: false
[2019-08-07 09:53:52] [config] no-nccl: false
[2019-08-07 09:53:52] [config] no-reload: false
[2019-08-07 09:53:52] [config] no-restore-corpus: false
[2019-08-07 09:53:52] [config] no-shuffle: false
[2019-08-07 09:53:52] [config] normalize: 1
[2019-08-07 09:53:52] [config] num-devices: 0
[2019-08-07 09:53:52] [config] optimizer: adam
[2019-08-07 09:53:52] [config] optimizer-delay: 1
[2019-08-07 09:53:52] [config] optimizer-params:
[2019-08-07 09:53:52] [config]   []
[2019-08-07 09:53:52] [config] overwrite: false
[2019-08-07 09:53:52] [config] pretrained-model: ""
[2019-08-07 09:53:52] [config] quiet: false
[2019-08-07 09:53:52] [config] quiet-translation: true
[2019-08-07 09:53:52] [config] relative-paths: false
[2019-08-07 09:53:52] [config] right-left: false
[2019-08-07 09:53:52] [config] save-freq: 20000
[2019-08-07 09:53:52] [config] seed: 1111
[2019-08-07 09:53:52] [config] shuffle-in-ram: false
[2019-08-07 09:53:52] [config] skip: false
[2019-08-07 09:53:52] [config] sqlite: ""
[2019-08-07 09:53:52] [config] sqlite-drop: false
[2019-08-07 09:53:52] [config] sync-sgd: true
[2019-08-07 09:53:52] [config] tempdir: .
[2019-08-07 09:53:52] [config] tied-embeddings: false
[2019-08-07 09:53:52] [config] tied-embeddings-all: false
[2019-08-07 09:53:52] [config] tied-embeddings-src: false
[2019-08-07 09:53:52] [config] train-sets:
[2019-08-07 09:53:52] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.de
[2019-08-07 09:53:52] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.en
[2019-08-07 09:53:52] [config] transformer-aan-activation: swish
[2019-08-07 09:53:52] [config] transformer-aan-depth: 2
[2019-08-07 09:53:52] [config] transformer-aan-nogate: false
[2019-08-07 09:53:52] [config] transformer-decoder-autoreg: self-attention
[2019-08-07 09:53:52] [config] transformer-dim-aan: 2048
[2019-08-07 09:53:52] [config] transformer-dim-ffn: 2048
[2019-08-07 09:53:52] [config] transformer-dropout: 0
[2019-08-07 09:53:52] [config] transformer-dropout-attention: 0
[2019-08-07 09:53:52] [config] transformer-dropout-ffn: 0
[2019-08-07 09:53:52] [config] transformer-ffn-activation: swish
[2019-08-07 09:53:52] [config] transformer-ffn-depth: 2
[2019-08-07 09:53:52] [config] transformer-guided-alignment-layer: last
[2019-08-07 09:53:52] [config] transformer-heads: 8
[2019-08-07 09:53:52] [config] transformer-no-projection: false
[2019-08-07 09:53:52] [config] transformer-postprocess: dan
[2019-08-07 09:53:52] [config] transformer-postprocess-emb: d
[2019-08-07 09:53:52] [config] transformer-preprocess: ""
[2019-08-07 09:53:52] [config] transformer-tied-layers:
[2019-08-07 09:53:52] [config]   []
[2019-08-07 09:53:52] [config] transformer-train-position-embeddings: false
[2019-08-07 09:53:52] [config] type: amun
[2019-08-07 09:53:52] [config] ulr: false
[2019-08-07 09:53:52] [config] ulr-dim-emb: 0
[2019-08-07 09:53:52] [config] ulr-dropout: 0
[2019-08-07 09:53:52] [config] ulr-keys-vectors: ""
[2019-08-07 09:53:52] [config] ulr-query-vectors: ""
[2019-08-07 09:53:52] [config] ulr-softmax-temperature: 1
[2019-08-07 09:53:52] [config] ulr-trainable-transformation: false
[2019-08-07 09:53:52] [config] valid-freq: 20000
[2019-08-07 09:53:52] [config] valid-log: ../experiments/10M_random_fasttext_prob/model/valid.log
[2019-08-07 09:53:52] [config] valid-max-length: 1000
[2019-08-07 09:53:52] [config] valid-metrics:
[2019-08-07 09:53:52] [config]   - cross-entropy
[2019-08-07 09:53:52] [config]   - perplexity
[2019-08-07 09:53:52] [config]   - translation
[2019-08-07 09:53:52] [config] valid-mini-batch: 8
[2019-08-07 09:53:52] [config] valid-script-path: ../experiments/10M_random_fasttext_prob/score-dev.sh
[2019-08-07 09:53:52] [config] valid-sets:
[2019-08-07 09:53:52] [config]   - ../experiments/10M_random_fasttext_prob/data/dev.bpe.de
[2019-08-07 09:53:52] [config]   - ../experiments/10M_random_fasttext_prob/data/dev.bpe.en
[2019-08-07 09:53:52] [config] valid-translation-output: ../experiments/10M_random_fasttext_prob/model/dev.out
[2019-08-07 09:53:52] [config] vocabs:
[2019-08-07 09:53:52] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json
[2019-08-07 09:53:52] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json
[2019-08-07 09:53:52] [config] word-penalty: 0
[2019-08-07 09:53:52] [config] workspace: 3000
[2019-08-07 09:53:52] [config] Model is being created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 09:53:52] Using synchronous training
[2019-08-07 09:53:52] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json
[2019-08-07 09:53:53] [data] Using unused word id eos for 0
[2019-08-07 09:53:53] [data] Using unused word id UNK for 1
[2019-08-07 09:53:53] [data] Setting vocabulary size for input 0 to 50000
[2019-08-07 09:53:53] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json
[2019-08-07 09:53:53] [data] Using unused word id eos for 0
[2019-08-07 09:53:53] [data] Using unused word id UNK for 1
[2019-08-07 09:53:53] [data] Setting vocabulary size for input 1 to 50000
[2019-08-07 09:53:53] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-08-07 09:53:53] [batching] Collecting statistics for batch fitting with step size 10
[2019-08-07 09:53:54] [memory] Extending reserved space to 3072 MB (device gpu1)
[2019-08-07 09:53:54] [comm] Using NCCL 2.4.2 for GPU communication
[2019-08-07 09:53:54] [comm] NCCLCommunicator constructed successfully.
[2019-08-07 09:53:54] [training] Using 1 GPUs
[2019-08-07 09:53:54] [memory] Reserving 422 MB, device gpu1
[2019-08-07 09:53:54] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-08-07 09:53:54] [memory] Reserving 422 MB, device gpu1
[2019-08-07 09:54:01] [batching] Done. Typical MB size is 4042 target words
[2019-08-07 09:54:01] [memory] Extending reserved space to 3072 MB (device gpu1)
[2019-08-07 09:54:01] [comm] Using NCCL 2.4.2 for GPU communication
[2019-08-07 09:54:01] [comm] NCCLCommunicator constructed successfully.
[2019-08-07 09:54:01] [training] Using 1 GPUs
[2019-08-07 09:54:01] Training started
[2019-08-07 09:54:01] [data] Shuffling data
[2019-08-07 09:54:01] [data] Done reading 642037 sentences
[2019-08-07 09:54:03] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 09:54:06] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-08-07 09:54:06] [memory] Reserving 422 MB, device gpu1
[2019-08-07 09:54:06] [memory] Reserving 422 MB, device gpu1
[2019-08-07 09:54:06] [memory] Reserving 422 MB, device gpu1
[2019-08-07 09:54:06] [memory] Reserving 844 MB, device gpu1
[2019-08-07 10:04:40] Ep. 1 : Up. 2000 : Sen. 204,644 : Cost 121.20209503 : Time 647.11s : 5719.87 words/s
[2019-08-07 10:17:36] Ep. 1 : Up. 4000 : Sen. 408,078 : Cost 106.19136047 : Time 775.91s : 4746.01 words/s
[2019-08-07 10:25:43] Seen 565767 samples
[2019-08-07 10:25:43] Starting epoch 2
[2019-08-07 10:25:43] [data] Shuffling data
[2019-08-07 10:25:43] [data] Done reading 642037 sentences
[2019-08-07 10:25:45] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 10:28:21] Ep. 2 : Up. 6000 : Sen. 46,363 : Cost 99.08135223 : Time 644.79s : 5742.65 words/s
[2019-08-07 10:38:46] Ep. 2 : Up. 8000 : Sen. 250,225 : Cost 92.81160736 : Time 625.46s : 5892.53 words/s
[2019-08-07 10:49:12] Ep. 2 : Up. 10000 : Sen. 454,215 : Cost 89.66368866 : Time 625.62s : 5908.41 words/s
[2019-08-07 10:54:55] Seen 565767 samples
[2019-08-07 10:54:55] Starting epoch 3
[2019-08-07 10:54:55] [data] Shuffling data
[2019-08-07 10:54:58] [data] Done reading 642037 sentences
[2019-08-07 10:55:05] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 11:00:17] Ep. 3 : Up. 12000 : Sen. 92,534 : Cost 86.02104950 : Time 665.47s : 5552.32 words/s
[2019-08-07 11:10:45] Ep. 3 : Up. 14000 : Sen. 297,168 : Cost 82.88378906 : Time 628.25s : 5891.83 words/s
[2019-08-07 11:21:13] Ep. 3 : Up. 16000 : Sen. 501,320 : Cost 81.39602661 : Time 627.95s : 5886.32 words/s
[2019-08-07 11:24:33] Seen 565767 samples
[2019-08-07 11:24:33] Starting epoch 4
[2019-08-07 11:24:33] [data] Shuffling data
[2019-08-07 11:24:34] [data] Done reading 642037 sentences
[2019-08-07 11:24:36] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 11:32:00] Ep. 4 : Up. 18000 : Sen. 139,818 : Cost 78.42533112 : Time 646.91s : 5723.85 words/s
[2019-08-07 11:42:29] Ep. 4 : Up. 20000 : Sen. 344,036 : Cost 77.10376740 : Time 628.77s : 5888.93 words/s
[2019-08-07 11:42:29] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-07 11:43:12] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter20000.npz
[2019-08-07 11:43:52] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 11:44:34] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-07 11:46:09] [valid] Ep. 4 : Up. 20000 : cross-entropy : 102.325 : new best
[2019-08-07 11:46:18] [valid] Ep. 4 : Up. 20000 : perplexity : 56.3555 : new best
[2019-08-07 11:48:11] [valid] Ep. 4 : Up. 20000 : translation : 8.55 : new best
[2019-08-07 12:01:26] Ep. 4 : Up. 22000 : Sen. 548,135 : Cost 75.92892456 : Time 1137.24s : 3244.92 words/s
[2019-08-07 12:02:20] Seen 565767 samples
[2019-08-07 12:02:20] Starting epoch 5
[2019-08-07 12:02:20] [data] Shuffling data
[2019-08-07 12:02:21] [data] Done reading 642037 sentences
[2019-08-07 12:02:23] [data] Done shuffling 642037 sentences to temp files

[CALL STACK]
[0x727f12]                                                            
[0x728ff8]          marian::data::Corpus::  next  ()                   + 0xd68
[0x716e4f]          marian::data::CorpusIterator::  increment  ()      + 0x2f
[0x681a7d]          marian::data::BatchGenerator<marian::data::CorpusBase>::  fetchBatches  () + 0x10dd
[0x682adb]          std::future<std::result_of<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1} ()>::type> marian::ThreadPool::enqueue<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}>(std::result_of&&,(marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}&&)...)::{lambda()#1}::  operator()  () const + 0x2b
[0x6834be]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<std::deque<std::shared_ptr<marian::data::CorpusBatch>,std::allocator<std::shared_ptr<marian::data::CorpusBatch>>>>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1} ()>::type> marian::ThreadPool::enqueue<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}>(std::result_of&&,(marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}&&)...)::{lambda()#1}> ()>,std::deque<std::shared_ptr<marian::data::CorpusBatch>,std::allocator<std::shared_ptr<marian::data::CorpusBatch>>>>>::  _M_invoke  (std::_Any_data const&) + 0x3e
[0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7f1a992bea99]                                                       + 0xea99
[0x59fac2]                                                            
[0x5a7341]          std::__future_base::_Task_state<std::future<std::result_of<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1} ()>::type> marian::ThreadPool::enqueue<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}>(std::result_of&&,(marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}&&)...)::{lambda()#1},std::allocator<int>,std::deque<std::shared_ptr<marian::data::CorpusBatch>,std::allocator<std::shared_ptr>> ()>::  _M_run  () + 0x51
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7f1a98ddec80]                                                       + 0xb8c80
[0x7f1a992b76ba]                                                       + 0x76ba
[0x7f1a9854441d]    clone                                              + 0x6d

[2019-08-07 15:52:09] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 15:52:09] [marian] Running on zisa as process 45113 with command line:
[2019-08-07 15:52:09] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_random_fasttext_prob/model/model.npz -T . --devices 1 --train-sets ../experiments/10M_random_fasttext_prob/data/train.bpe.de ../experiments/10M_random_fasttext_prob/data/train.bpe.en --vocabs ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json --mini-batch-fit -w 3000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_random_fasttext_prob/data/dev.bpe.de ../experiments/10M_random_fasttext_prob/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_random_fasttext_prob/model/dev.out --valid-script-path ../experiments/10M_random_fasttext_prob/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_random_fasttext_prob/model/train.log --valid-log ../experiments/10M_random_fasttext_prob/model/valid.log
[2019-08-07 15:52:10] [config] after-batches: 0
[2019-08-07 15:52:10] [config] after-epochs: 0
[2019-08-07 15:52:10] [config] allow-unk: false
[2019-08-07 15:52:10] [config] beam-size: 12
[2019-08-07 15:52:10] [config] bert-class-symbol: "[CLS]"
[2019-08-07 15:52:10] [config] bert-mask-symbol: "[MASK]"
[2019-08-07 15:52:10] [config] bert-masking-fraction: 0.15
[2019-08-07 15:52:10] [config] bert-sep-symbol: "[SEP]"
[2019-08-07 15:52:10] [config] bert-train-type-embeddings: true
[2019-08-07 15:52:10] [config] bert-type-vocab-size: 2
[2019-08-07 15:52:10] [config] best-deep: false
[2019-08-07 15:52:10] [config] clip-gemm: 0
[2019-08-07 15:52:10] [config] clip-norm: 1
[2019-08-07 15:52:10] [config] cost-type: ce-mean
[2019-08-07 15:52:10] [config] cpu-threads: 0
[2019-08-07 15:52:10] [config] data-weighting: ""
[2019-08-07 15:52:10] [config] data-weighting-type: sentence
[2019-08-07 15:52:10] [config] dec-cell: gru
[2019-08-07 15:52:10] [config] dec-cell-base-depth: 2
[2019-08-07 15:52:10] [config] dec-cell-high-depth: 1
[2019-08-07 15:52:10] [config] dec-depth: 1
[2019-08-07 15:52:10] [config] devices:
[2019-08-07 15:52:10] [config]   - 1
[2019-08-07 15:52:10] [config] dim-emb: 512
[2019-08-07 15:52:10] [config] dim-rnn: 1024
[2019-08-07 15:52:10] [config] dim-vocabs:
[2019-08-07 15:52:10] [config]   - 50000
[2019-08-07 15:52:10] [config]   - 50000
[2019-08-07 15:52:10] [config] disp-first: 0
[2019-08-07 15:52:10] [config] disp-freq: 2000
[2019-08-07 15:52:10] [config] disp-label-counts: false
[2019-08-07 15:52:10] [config] dropout-rnn: 0.2
[2019-08-07 15:52:10] [config] dropout-src: 0.1
[2019-08-07 15:52:10] [config] dropout-trg: 0.1
[2019-08-07 15:52:10] [config] dump-config: ""
[2019-08-07 15:52:10] [config] early-stopping: 5
[2019-08-07 15:52:10] [config] embedding-fix-src: false
[2019-08-07 15:52:10] [config] embedding-fix-trg: false
[2019-08-07 15:52:10] [config] embedding-normalization: false
[2019-08-07 15:52:10] [config] embedding-vectors:
[2019-08-07 15:52:10] [config]   []
[2019-08-07 15:52:10] [config] enc-cell: gru
[2019-08-07 15:52:10] [config] enc-cell-depth: 1
[2019-08-07 15:52:10] [config] enc-depth: 1
[2019-08-07 15:52:10] [config] enc-type: bidirectional
[2019-08-07 15:52:10] [config] exponential-smoothing: 0.0001
[2019-08-07 15:52:10] [config] grad-dropping-momentum: 0
[2019-08-07 15:52:10] [config] grad-dropping-rate: 0
[2019-08-07 15:52:10] [config] grad-dropping-warmup: 100
[2019-08-07 15:52:10] [config] guided-alignment: none
[2019-08-07 15:52:10] [config] guided-alignment-cost: mse
[2019-08-07 15:52:10] [config] guided-alignment-weight: 0.1
[2019-08-07 15:52:10] [config] ignore-model-config: false
[2019-08-07 15:52:10] [config] input-types:
[2019-08-07 15:52:10] [config]   []
[2019-08-07 15:52:10] [config] interpolate-env-vars: false
[2019-08-07 15:52:10] [config] keep-best: false
[2019-08-07 15:52:10] [config] label-smoothing: 0
[2019-08-07 15:52:10] [config] layer-normalization: true
[2019-08-07 15:52:10] [config] learn-rate: 0.0001
[2019-08-07 15:52:10] [config] log: ../experiments/10M_random_fasttext_prob/model/train.log
[2019-08-07 15:52:10] [config] log-level: info
[2019-08-07 15:52:10] [config] log-time-zone: ""
[2019-08-07 15:52:10] [config] lr-decay: 0
[2019-08-07 15:52:10] [config] lr-decay-freq: 50000
[2019-08-07 15:52:10] [config] lr-decay-inv-sqrt:
[2019-08-07 15:52:10] [config]   - 0
[2019-08-07 15:52:10] [config] lr-decay-repeat-warmup: false
[2019-08-07 15:52:10] [config] lr-decay-reset-optimizer: false
[2019-08-07 15:52:10] [config] lr-decay-start:
[2019-08-07 15:52:10] [config]   - 10
[2019-08-07 15:52:10] [config]   - 1
[2019-08-07 15:52:10] [config] lr-decay-strategy: epoch+stalled
[2019-08-07 15:52:10] [config] lr-report: false
[2019-08-07 15:52:10] [config] lr-warmup: 0
[2019-08-07 15:52:10] [config] lr-warmup-at-reload: false
[2019-08-07 15:52:10] [config] lr-warmup-cycle: false
[2019-08-07 15:52:10] [config] lr-warmup-start-rate: 0
[2019-08-07 15:52:10] [config] max-length: 50
[2019-08-07 15:52:10] [config] max-length-crop: false
[2019-08-07 15:52:10] [config] max-length-factor: 3
[2019-08-07 15:52:10] [config] maxi-batch: 100
[2019-08-07 15:52:10] [config] maxi-batch-sort: trg
[2019-08-07 15:52:10] [config] mini-batch: 64
[2019-08-07 15:52:10] [config] mini-batch-fit: true
[2019-08-07 15:52:10] [config] mini-batch-fit-step: 10
[2019-08-07 15:52:10] [config] mini-batch-overstuff: 1
[2019-08-07 15:52:10] [config] mini-batch-track-lr: false
[2019-08-07 15:52:10] [config] mini-batch-understuff: 1
[2019-08-07 15:52:10] [config] mini-batch-warmup: 0
[2019-08-07 15:52:10] [config] mini-batch-words: 0
[2019-08-07 15:52:10] [config] mini-batch-words-ref: 0
[2019-08-07 15:52:10] [config] model: ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 15:52:10] [config] multi-loss-type: sum
[2019-08-07 15:52:10] [config] multi-node: false
[2019-08-07 15:52:10] [config] multi-node-overlap: true
[2019-08-07 15:52:10] [config] n-best: false
[2019-08-07 15:52:10] [config] no-nccl: false
[2019-08-07 15:52:10] [config] no-reload: false
[2019-08-07 15:52:10] [config] no-restore-corpus: false
[2019-08-07 15:52:10] [config] no-shuffle: false
[2019-08-07 15:52:10] [config] normalize: 1
[2019-08-07 15:52:10] [config] num-devices: 0
[2019-08-07 15:52:10] [config] optimizer: adam
[2019-08-07 15:52:10] [config] optimizer-delay: 1
[2019-08-07 15:52:10] [config] optimizer-params:
[2019-08-07 15:52:10] [config]   []
[2019-08-07 15:52:10] [config] overwrite: false
[2019-08-07 15:52:10] [config] pretrained-model: ""
[2019-08-07 15:52:10] [config] quiet: false
[2019-08-07 15:52:10] [config] quiet-translation: true
[2019-08-07 15:52:10] [config] relative-paths: false
[2019-08-07 15:52:10] [config] right-left: false
[2019-08-07 15:52:10] [config] save-freq: 20000
[2019-08-07 15:52:10] [config] seed: 1111
[2019-08-07 15:52:10] [config] shuffle-in-ram: false
[2019-08-07 15:52:10] [config] skip: false
[2019-08-07 15:52:10] [config] sqlite: ""
[2019-08-07 15:52:10] [config] sqlite-drop: false
[2019-08-07 15:52:10] [config] sync-sgd: true
[2019-08-07 15:52:10] [config] tempdir: .
[2019-08-07 15:52:10] [config] tied-embeddings: false
[2019-08-07 15:52:10] [config] tied-embeddings-all: false
[2019-08-07 15:52:10] [config] tied-embeddings-src: false
[2019-08-07 15:52:10] [config] train-sets:
[2019-08-07 15:52:10] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.de
[2019-08-07 15:52:10] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.en
[2019-08-07 15:52:10] [config] transformer-aan-activation: swish
[2019-08-07 15:52:10] [config] transformer-aan-depth: 2
[2019-08-07 15:52:10] [config] transformer-aan-nogate: false
[2019-08-07 15:52:10] [config] transformer-decoder-autoreg: self-attention
[2019-08-07 15:52:10] [config] transformer-dim-aan: 2048
[2019-08-07 15:52:10] [config] transformer-dim-ffn: 2048
[2019-08-07 15:52:10] [config] transformer-dropout: 0
[2019-08-07 15:52:10] [config] transformer-dropout-attention: 0
[2019-08-07 15:52:10] [config] transformer-dropout-ffn: 0
[2019-08-07 15:52:10] [config] transformer-ffn-activation: swish
[2019-08-07 15:52:10] [config] transformer-ffn-depth: 2
[2019-08-07 15:52:10] [config] transformer-guided-alignment-layer: last
[2019-08-07 15:52:10] [config] transformer-heads: 8
[2019-08-07 15:52:10] [config] transformer-no-projection: false
[2019-08-07 15:52:10] [config] transformer-postprocess: dan
[2019-08-07 15:52:10] [config] transformer-postprocess-emb: d
[2019-08-07 15:52:10] [config] transformer-preprocess: ""
[2019-08-07 15:52:10] [config] transformer-tied-layers:
[2019-08-07 15:52:10] [config]   []
[2019-08-07 15:52:10] [config] transformer-train-position-embeddings: false
[2019-08-07 15:52:10] [config] type: amun
[2019-08-07 15:52:10] [config] ulr: false
[2019-08-07 15:52:10] [config] ulr-dim-emb: 0
[2019-08-07 15:52:10] [config] ulr-dropout: 0
[2019-08-07 15:52:10] [config] ulr-keys-vectors: ""
[2019-08-07 15:52:10] [config] ulr-query-vectors: ""
[2019-08-07 15:52:10] [config] ulr-softmax-temperature: 1
[2019-08-07 15:52:10] [config] ulr-trainable-transformation: false
[2019-08-07 15:52:10] [config] valid-freq: 20000
[2019-08-07 15:52:10] [config] valid-log: ../experiments/10M_random_fasttext_prob/model/valid.log
[2019-08-07 15:52:10] [config] valid-max-length: 1000
[2019-08-07 15:52:10] [config] valid-metrics:
[2019-08-07 15:52:10] [config]   - cross-entropy
[2019-08-07 15:52:10] [config]   - perplexity
[2019-08-07 15:52:10] [config]   - translation
[2019-08-07 15:52:10] [config] valid-mini-batch: 8
[2019-08-07 15:52:10] [config] valid-script-path: ../experiments/10M_random_fasttext_prob/score-dev.sh
[2019-08-07 15:52:10] [config] valid-sets:
[2019-08-07 15:52:10] [config]   - ../experiments/10M_random_fasttext_prob/data/dev.bpe.de
[2019-08-07 15:52:10] [config]   - ../experiments/10M_random_fasttext_prob/data/dev.bpe.en
[2019-08-07 15:52:10] [config] valid-translation-output: ../experiments/10M_random_fasttext_prob/model/dev.out
[2019-08-07 15:52:10] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 15:52:10] [config] vocabs:
[2019-08-07 15:52:10] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json
[2019-08-07 15:52:10] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json
[2019-08-07 15:52:10] [config] word-penalty: 0
[2019-08-07 15:52:10] [config] workspace: 3000
[2019-08-07 15:52:10] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 15:52:10] Using synchronous training
[2019-08-07 15:52:10] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json
[2019-08-07 15:52:10] [data] Using unused word id eos for 0
[2019-08-07 15:52:10] [data] Using unused word id UNK for 1
[2019-08-07 15:52:10] [data] Setting vocabulary size for input 0 to 50000
[2019-08-07 15:52:10] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json
[2019-08-07 15:52:10] [data] Using unused word id eos for 0
[2019-08-07 15:52:10] [data] Using unused word id UNK for 1
[2019-08-07 15:52:10] [data] Setting vocabulary size for input 1 to 50000
[2019-08-07 15:52:10] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-08-07 15:52:10] [batching] Collecting statistics for batch fitting with step size 10
[2019-08-07 15:52:11] [memory] Extending reserved space to 3072 MB (device gpu1)
[2019-08-07 15:52:11] [comm] Using NCCL 2.4.2 for GPU communication
[2019-08-07 15:52:11] [comm] NCCLCommunicator constructed successfully.
[2019-08-07 15:52:11] [training] Using 1 GPUs
[2019-08-07 15:52:11] [memory] Reserving 422 MB, device gpu1
[2019-08-07 15:52:11] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-08-07 15:52:12] [memory] Reserving 422 MB, device gpu1
[2019-08-07 15:52:18] [batching] Done. Typical MB size is 4042 target words
[2019-08-07 15:52:18] [memory] Extending reserved space to 3072 MB (device gpu1)
[2019-08-07 15:52:18] [comm] Using NCCL 2.4.2 for GPU communication
[2019-08-07 15:52:18] [comm] NCCLCommunicator constructed successfully.
[2019-08-07 15:52:18] [training] Using 1 GPUs
[2019-08-07 15:52:18] Loading model from ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-07 15:52:29] Loading Adam parameters from ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-07 15:53:10] [memory] Reserving 844 MB, device gpu1
[2019-08-07 15:53:11] [training] Model reloaded from ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 15:53:11] [data] Restoring the corpus state to epoch 4, batch 20000
[2019-08-07 15:53:11] [data] Shuffling data
[2019-08-07 15:53:12] [data] Done reading 642037 sentences
[2019-08-07 15:53:16] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 15:53:40] Training started
[2019-08-07 15:53:40] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-08-07 15:53:40] [memory] Reserving 422 MB, device gpu1
[2019-08-07 15:53:41] [memory] Reserving 422 MB, device gpu1
[2019-08-07 15:53:41] Loading model from ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 15:54:05] [memory] Reserving 422 MB, device cpu0
[2019-08-07 15:54:06] [memory] Reserving 422 MB, device gpu1
[2019-08-07 16:04:28] Ep. 4 : Up. 22000 : Sen. 548,135 : Cost 76.59602356 : Time 738.07s : 4999.90 words/s
[2019-08-07 16:05:23] Seen 565767 samples
[2019-08-07 16:05:23] Starting epoch 5
[2019-08-07 16:05:23] [data] Shuffling data
[2019-08-07 16:05:23] [data] Done reading 642037 sentences
[2019-08-07 16:05:25] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 16:15:02] Ep. 5 : Up. 24000 : Sen. 186,411 : Cost 73.41340637 : Time 633.18s : 5830.02 words/s
[2019-08-07 16:25:30] Ep. 5 : Up. 26000 : Sen. 390,580 : Cost 72.53470612 : Time 628.29s : 5868.55 words/s
[2019-08-07 16:47:44] Error: Aborted from marian::io::InputFileStream& marian::io::getline(marian::io::InputFileStream&, std::__cxx11::string&) in /fs/bil0/abdel/marian-dev/src/common/file_stream.h:216

[CALL STACK]
[0x727f12]                                                            
[0x728985]          marian::data::Corpus::  next  ()                   + 0x6f5
[0x716e4f]          marian::data::CorpusIterator::  increment  ()      + 0x2f
[0x681a7d]          marian::data::BatchGenerator<marian::data::CorpusBase>::  fetchBatches  () + 0x10dd
[0x682adb]          std::future<std::result_of<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1} ()>::type> marian::ThreadPool::enqueue<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}>(std::result_of&&,(marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}&&)...)::{lambda()#1}::  operator()  () const + 0x2b
[0x6834be]          std::_Function_handler<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> (),std::__future_base::_Task_setter<std::unique_ptr<std::__future_base::_Result<std::deque<std::shared_ptr<marian::data::CorpusBatch>,std::allocator<std::shared_ptr<marian::data::CorpusBatch>>>>,std::__future_base::_Result_base::_Deleter>,std::_Bind_simple<std::reference_wrapper<std::future<std::result_of<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1} ()>::type> marian::ThreadPool::enqueue<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}>(std::result_of&&,(marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}&&)...)::{lambda()#1}> ()>,std::deque<std::shared_ptr<marian::data::CorpusBatch>,std::allocator<std::shared_ptr<marian::data::CorpusBatch>>>>>::  _M_invoke  (std::_Any_data const&) + 0x3e
[0x5a5f19]          std::__future_base::_State_baseV2::  _M_do_set  (std::function<std::unique_ptr<std::__future_base::_Result_base,std::__future_base::_Result_base::_Deleter> ()>*,  bool*) + 0x29
[0x7fda25251a99]                                                       + 0xea99
[0x59fac2]                                                            
[0x5a7341]          std::__future_base::_Task_state<std::future<std::result_of<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1} ()>::type> marian::ThreadPool::enqueue<marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}>(std::result_of&&,(marian::data::BatchGenerator<marian::data::CorpusBase>::fetchBatchesAsync()::{lambda()#1}&&)...)::{lambda()#1},std::allocator<int>,std::deque<std::shared_ptr<marian::data::CorpusBatch>,std::allocator<std::shared_ptr>> ()>::  _M_run  () + 0x51
[0x5d00b4]          std::thread::_Impl<std::_Bind_simple<marian::ThreadPool::reserve(unsigned long)::{lambda()#1} ()>>::  _M_run  () + 0x174
[0x7fda24d71c80]                                                       + 0xb8c80
[0x7fda2524a6ba]                                                       + 0x76ba
[0x7fda244d741d]    clone                                              + 0x6d

[2019-08-07 17:38:53] [marian] Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 17:38:53] [marian] Running on zisa as process 50566 with command line:
[2019-08-07 17:38:53] [marian] /fs/bil0/abdel/marian-dev/build/marian --sync-sgd --model ../experiments/10M_random_fasttext_prob/model/model.npz -T . --devices 1 --train-sets ../experiments/10M_random_fasttext_prob/data/train.bpe.de ../experiments/10M_random_fasttext_prob/data/train.bpe.en --vocabs ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json --mini-batch-fit -w 3000 --dim-vocabs 50000 50000 --layer-normalization --dropout-rnn 0.2 --dropout-src 0.1 --dropout-trg 0.1 --learn-rate 0.0001 --after-epochs 0 --early-stopping 5 --valid-freq 20000 --save-freq 20000 --disp-freq 2000 --valid-mini-batch 8 --valid-sets ../experiments/10M_random_fasttext_prob/data/dev.bpe.de ../experiments/10M_random_fasttext_prob/data/dev.bpe.en --valid-metrics cross-entropy perplexity translation --valid-translation-output ../experiments/10M_random_fasttext_prob/model/dev.out --valid-script-path ../experiments/10M_random_fasttext_prob/score-dev.sh --seed 1111 --exponential-smoothing --normalize=1 --beam-size=12 --quiet-translation --log ../experiments/10M_random_fasttext_prob/model/train.log --valid-log ../experiments/10M_random_fasttext_prob/model/valid.log
[2019-08-07 17:38:53] [config] after-batches: 0
[2019-08-07 17:38:53] [config] after-epochs: 0
[2019-08-07 17:38:53] [config] allow-unk: false
[2019-08-07 17:38:53] [config] beam-size: 12
[2019-08-07 17:38:53] [config] bert-class-symbol: "[CLS]"
[2019-08-07 17:38:53] [config] bert-mask-symbol: "[MASK]"
[2019-08-07 17:38:53] [config] bert-masking-fraction: 0.15
[2019-08-07 17:38:53] [config] bert-sep-symbol: "[SEP]"
[2019-08-07 17:38:53] [config] bert-train-type-embeddings: true
[2019-08-07 17:38:53] [config] bert-type-vocab-size: 2
[2019-08-07 17:38:53] [config] best-deep: false
[2019-08-07 17:38:53] [config] clip-gemm: 0
[2019-08-07 17:38:53] [config] clip-norm: 1
[2019-08-07 17:38:53] [config] cost-type: ce-mean
[2019-08-07 17:38:53] [config] cpu-threads: 0
[2019-08-07 17:38:53] [config] data-weighting: ""
[2019-08-07 17:38:53] [config] data-weighting-type: sentence
[2019-08-07 17:38:53] [config] dec-cell: gru
[2019-08-07 17:38:53] [config] dec-cell-base-depth: 2
[2019-08-07 17:38:53] [config] dec-cell-high-depth: 1
[2019-08-07 17:38:53] [config] dec-depth: 1
[2019-08-07 17:38:53] [config] devices:
[2019-08-07 17:38:53] [config]   - 1
[2019-08-07 17:38:53] [config] dim-emb: 512
[2019-08-07 17:38:53] [config] dim-rnn: 1024
[2019-08-07 17:38:53] [config] dim-vocabs:
[2019-08-07 17:38:53] [config]   - 50000
[2019-08-07 17:38:53] [config]   - 50000
[2019-08-07 17:38:53] [config] disp-first: 0
[2019-08-07 17:38:53] [config] disp-freq: 2000
[2019-08-07 17:38:53] [config] disp-label-counts: false
[2019-08-07 17:38:53] [config] dropout-rnn: 0.2
[2019-08-07 17:38:53] [config] dropout-src: 0.1
[2019-08-07 17:38:53] [config] dropout-trg: 0.1
[2019-08-07 17:38:53] [config] dump-config: ""
[2019-08-07 17:38:53] [config] early-stopping: 5
[2019-08-07 17:38:53] [config] embedding-fix-src: false
[2019-08-07 17:38:53] [config] embedding-fix-trg: false
[2019-08-07 17:38:53] [config] embedding-normalization: false
[2019-08-07 17:38:53] [config] embedding-vectors:
[2019-08-07 17:38:53] [config]   []
[2019-08-07 17:38:53] [config] enc-cell: gru
[2019-08-07 17:38:53] [config] enc-cell-depth: 1
[2019-08-07 17:38:53] [config] enc-depth: 1
[2019-08-07 17:38:53] [config] enc-type: bidirectional
[2019-08-07 17:38:53] [config] exponential-smoothing: 0.0001
[2019-08-07 17:38:53] [config] grad-dropping-momentum: 0
[2019-08-07 17:38:53] [config] grad-dropping-rate: 0
[2019-08-07 17:38:53] [config] grad-dropping-warmup: 100
[2019-08-07 17:38:53] [config] guided-alignment: none
[2019-08-07 17:38:53] [config] guided-alignment-cost: mse
[2019-08-07 17:38:53] [config] guided-alignment-weight: 0.1
[2019-08-07 17:38:53] [config] ignore-model-config: false
[2019-08-07 17:38:53] [config] input-types:
[2019-08-07 17:38:53] [config]   []
[2019-08-07 17:38:53] [config] interpolate-env-vars: false
[2019-08-07 17:38:53] [config] keep-best: false
[2019-08-07 17:38:53] [config] label-smoothing: 0
[2019-08-07 17:38:53] [config] layer-normalization: true
[2019-08-07 17:38:53] [config] learn-rate: 0.0001
[2019-08-07 17:38:53] [config] log: ../experiments/10M_random_fasttext_prob/model/train.log
[2019-08-07 17:38:53] [config] log-level: info
[2019-08-07 17:38:53] [config] log-time-zone: ""
[2019-08-07 17:38:53] [config] lr-decay: 0
[2019-08-07 17:38:53] [config] lr-decay-freq: 50000
[2019-08-07 17:38:53] [config] lr-decay-inv-sqrt:
[2019-08-07 17:38:53] [config]   - 0
[2019-08-07 17:38:53] [config] lr-decay-repeat-warmup: false
[2019-08-07 17:38:53] [config] lr-decay-reset-optimizer: false
[2019-08-07 17:38:53] [config] lr-decay-start:
[2019-08-07 17:38:53] [config]   - 10
[2019-08-07 17:38:53] [config]   - 1
[2019-08-07 17:38:53] [config] lr-decay-strategy: epoch+stalled
[2019-08-07 17:38:53] [config] lr-report: false
[2019-08-07 17:38:53] [config] lr-warmup: 0
[2019-08-07 17:38:53] [config] lr-warmup-at-reload: false
[2019-08-07 17:38:53] [config] lr-warmup-cycle: false
[2019-08-07 17:38:53] [config] lr-warmup-start-rate: 0
[2019-08-07 17:38:53] [config] max-length: 50
[2019-08-07 17:38:53] [config] max-length-crop: false
[2019-08-07 17:38:53] [config] max-length-factor: 3
[2019-08-07 17:38:53] [config] maxi-batch: 100
[2019-08-07 17:38:53] [config] maxi-batch-sort: trg
[2019-08-07 17:38:53] [config] mini-batch: 64
[2019-08-07 17:38:53] [config] mini-batch-fit: true
[2019-08-07 17:38:53] [config] mini-batch-fit-step: 10
[2019-08-07 17:38:53] [config] mini-batch-overstuff: 1
[2019-08-07 17:38:53] [config] mini-batch-track-lr: false
[2019-08-07 17:38:53] [config] mini-batch-understuff: 1
[2019-08-07 17:38:53] [config] mini-batch-warmup: 0
[2019-08-07 17:38:53] [config] mini-batch-words: 0
[2019-08-07 17:38:53] [config] mini-batch-words-ref: 0
[2019-08-07 17:38:53] [config] model: ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 17:38:53] [config] multi-loss-type: sum
[2019-08-07 17:38:53] [config] multi-node: false
[2019-08-07 17:38:53] [config] multi-node-overlap: true
[2019-08-07 17:38:53] [config] n-best: false
[2019-08-07 17:38:53] [config] no-nccl: false
[2019-08-07 17:38:53] [config] no-reload: false
[2019-08-07 17:38:53] [config] no-restore-corpus: false
[2019-08-07 17:38:53] [config] no-shuffle: false
[2019-08-07 17:38:53] [config] normalize: 1
[2019-08-07 17:38:53] [config] num-devices: 0
[2019-08-07 17:38:53] [config] optimizer: adam
[2019-08-07 17:38:53] [config] optimizer-delay: 1
[2019-08-07 17:38:53] [config] optimizer-params:
[2019-08-07 17:38:53] [config]   []
[2019-08-07 17:38:53] [config] overwrite: false
[2019-08-07 17:38:53] [config] pretrained-model: ""
[2019-08-07 17:38:53] [config] quiet: false
[2019-08-07 17:38:53] [config] quiet-translation: true
[2019-08-07 17:38:53] [config] relative-paths: false
[2019-08-07 17:38:53] [config] right-left: false
[2019-08-07 17:38:53] [config] save-freq: 20000
[2019-08-07 17:38:53] [config] seed: 1111
[2019-08-07 17:38:53] [config] shuffle-in-ram: false
[2019-08-07 17:38:53] [config] skip: false
[2019-08-07 17:38:53] [config] sqlite: ""
[2019-08-07 17:38:53] [config] sqlite-drop: false
[2019-08-07 17:38:53] [config] sync-sgd: true
[2019-08-07 17:38:53] [config] tempdir: .
[2019-08-07 17:38:53] [config] tied-embeddings: false
[2019-08-07 17:38:53] [config] tied-embeddings-all: false
[2019-08-07 17:38:53] [config] tied-embeddings-src: false
[2019-08-07 17:38:53] [config] train-sets:
[2019-08-07 17:38:53] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.de
[2019-08-07 17:38:53] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.en
[2019-08-07 17:38:53] [config] transformer-aan-activation: swish
[2019-08-07 17:38:53] [config] transformer-aan-depth: 2
[2019-08-07 17:38:53] [config] transformer-aan-nogate: false
[2019-08-07 17:38:53] [config] transformer-decoder-autoreg: self-attention
[2019-08-07 17:38:53] [config] transformer-dim-aan: 2048
[2019-08-07 17:38:53] [config] transformer-dim-ffn: 2048
[2019-08-07 17:38:53] [config] transformer-dropout: 0
[2019-08-07 17:38:53] [config] transformer-dropout-attention: 0
[2019-08-07 17:38:53] [config] transformer-dropout-ffn: 0
[2019-08-07 17:38:53] [config] transformer-ffn-activation: swish
[2019-08-07 17:38:53] [config] transformer-ffn-depth: 2
[2019-08-07 17:38:53] [config] transformer-guided-alignment-layer: last
[2019-08-07 17:38:53] [config] transformer-heads: 8
[2019-08-07 17:38:53] [config] transformer-no-projection: false
[2019-08-07 17:38:53] [config] transformer-postprocess: dan
[2019-08-07 17:38:53] [config] transformer-postprocess-emb: d
[2019-08-07 17:38:53] [config] transformer-preprocess: ""
[2019-08-07 17:38:53] [config] transformer-tied-layers:
[2019-08-07 17:38:53] [config]   []
[2019-08-07 17:38:53] [config] transformer-train-position-embeddings: false
[2019-08-07 17:38:53] [config] type: amun
[2019-08-07 17:38:53] [config] ulr: false
[2019-08-07 17:38:53] [config] ulr-dim-emb: 0
[2019-08-07 17:38:53] [config] ulr-dropout: 0
[2019-08-07 17:38:53] [config] ulr-keys-vectors: ""
[2019-08-07 17:38:53] [config] ulr-query-vectors: ""
[2019-08-07 17:38:53] [config] ulr-softmax-temperature: 1
[2019-08-07 17:38:53] [config] ulr-trainable-transformation: false
[2019-08-07 17:38:53] [config] valid-freq: 20000
[2019-08-07 17:38:53] [config] valid-log: ../experiments/10M_random_fasttext_prob/model/valid.log
[2019-08-07 17:38:53] [config] valid-max-length: 1000
[2019-08-07 17:38:53] [config] valid-metrics:
[2019-08-07 17:38:53] [config]   - cross-entropy
[2019-08-07 17:38:53] [config]   - perplexity
[2019-08-07 17:38:53] [config]   - translation
[2019-08-07 17:38:53] [config] valid-mini-batch: 8
[2019-08-07 17:38:53] [config] valid-script-path: ../experiments/10M_random_fasttext_prob/score-dev.sh
[2019-08-07 17:38:53] [config] valid-sets:
[2019-08-07 17:38:53] [config]   - ../experiments/10M_random_fasttext_prob/data/dev.bpe.de
[2019-08-07 17:38:53] [config]   - ../experiments/10M_random_fasttext_prob/data/dev.bpe.en
[2019-08-07 17:38:53] [config] valid-translation-output: ../experiments/10M_random_fasttext_prob/model/dev.out
[2019-08-07 17:38:53] [config] version: v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 17:38:53] [config] vocabs:
[2019-08-07 17:38:53] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json
[2019-08-07 17:38:53] [config]   - ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json
[2019-08-07 17:38:53] [config] word-penalty: 0
[2019-08-07 17:38:53] [config] workspace: 3000
[2019-08-07 17:38:53] [config] Loaded model has been created with Marian v1.7.8 ec2d66e 2019-05-27 14:52:11 +0100
[2019-08-07 17:38:53] Using synchronous training
[2019-08-07 17:38:53] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_random_fasttext_prob/data/train.bpe.de.json
[2019-08-07 17:38:53] [data] Using unused word id eos for 0
[2019-08-07 17:38:53] [data] Using unused word id UNK for 1
[2019-08-07 17:38:53] [data] Setting vocabulary size for input 0 to 50000
[2019-08-07 17:38:53] [data] Loading vocabulary from JSON/Yaml file ../experiments/10M_random_fasttext_prob/data/train.bpe.en.json
[2019-08-07 17:38:54] [data] Using unused word id eos for 0
[2019-08-07 17:38:54] [data] Using unused word id UNK for 1
[2019-08-07 17:38:54] [data] Setting vocabulary size for input 1 to 50000
[2019-08-07 17:38:54] Compiled without MPI support. Falling back to FakeMPIWrapper
[2019-08-07 17:38:54] [batching] Collecting statistics for batch fitting with step size 10
[2019-08-07 17:38:55] [memory] Extending reserved space to 3072 MB (device gpu1)
[2019-08-07 17:38:55] [comm] Using NCCL 2.4.2 for GPU communication
[2019-08-07 17:38:55] [comm] NCCLCommunicator constructed successfully.
[2019-08-07 17:38:55] [training] Using 1 GPUs
[2019-08-07 17:38:55] [memory] Reserving 422 MB, device gpu1
[2019-08-07 17:38:55] [gpu] 16-bit TensorCores enabled for float32 matrix operations
[2019-08-07 17:38:55] [memory] Reserving 422 MB, device gpu1
[2019-08-07 17:39:02] [batching] Done. Typical MB size is 4042 target words
[2019-08-07 17:39:02] [memory] Extending reserved space to 3072 MB (device gpu1)
[2019-08-07 17:39:02] [comm] Using NCCL 2.4.2 for GPU communication
[2019-08-07 17:39:02] [comm] NCCLCommunicator constructed successfully.
[2019-08-07 17:39:02] [training] Using 1 GPUs
[2019-08-07 17:39:02] Loading model from ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-07 17:39:04] Loading Adam parameters from ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-07 17:39:07] [memory] Reserving 844 MB, device gpu1
[2019-08-07 17:39:07] [training] Model reloaded from ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 17:39:07] [data] Restoring the corpus state to epoch 4, batch 20000
[2019-08-07 17:39:08] [data] Shuffling data
[2019-08-07 17:39:08] [data] Done reading 642037 sentences
[2019-08-07 17:39:15] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 17:39:27] Training started
[2019-08-07 17:39:27] [training] Batches are processed as 1 process(es) x 1 devices/process
[2019-08-07 17:39:27] [memory] Reserving 422 MB, device gpu1
[2019-08-07 17:39:27] [memory] Reserving 422 MB, device gpu1
[2019-08-07 17:39:27] Loading model from ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 17:39:29] [memory] Reserving 422 MB, device cpu0
[2019-08-07 17:39:30] [memory] Reserving 422 MB, device gpu1
[2019-08-07 17:50:02] Ep. 4 : Up. 22000 : Sen. 548,135 : Cost 76.60310364 : Time 668.08s : 5523.66 words/s
[2019-08-07 17:50:57] Seen 565767 samples
[2019-08-07 17:50:57] Starting epoch 5
[2019-08-07 17:50:57] [data] Shuffling data
[2019-08-07 17:50:57] [data] Done reading 642037 sentences
[2019-08-07 17:50:59] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 18:00:45] Ep. 5 : Up. 24000 : Sen. 186,411 : Cost 73.41408539 : Time 642.97s : 5741.23 words/s
[2019-08-07 18:11:23] Ep. 5 : Up. 26000 : Sen. 390,580 : Cost 72.53258514 : Time 638.34s : 5776.16 words/s
[2019-08-07 18:20:34] Seen 565767 samples
[2019-08-07 18:20:34] Starting epoch 6
[2019-08-07 18:20:34] [data] Shuffling data
[2019-08-07 18:20:34] [data] Done reading 642037 sentences
[2019-08-07 18:20:36] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 18:22:09] Ep. 6 : Up. 28000 : Sen. 28,008 : Cost 72.44913483 : Time 645.73s : 5718.29 words/s
[2019-08-07 18:32:51] Ep. 6 : Up. 30000 : Sen. 231,973 : Cost 70.06925964 : Time 642.05s : 5757.68 words/s
[2019-08-07 18:43:31] Ep. 6 : Up. 32000 : Sen. 436,664 : Cost 69.41104126 : Time 639.80s : 5769.35 words/s
[2019-08-07 18:50:17] Seen 565767 samples
[2019-08-07 18:50:17] Starting epoch 7
[2019-08-07 18:50:17] [data] Shuffling data
[2019-08-07 18:50:18] [data] Done reading 642037 sentences
[2019-08-07 18:50:20] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 18:54:17] Ep. 7 : Up. 34000 : Sen. 74,730 : Cost 68.67761993 : Time 645.85s : 5722.27 words/s
[2019-08-07 19:04:55] Ep. 7 : Up. 36000 : Sen. 278,176 : Cost 67.13311005 : Time 638.73s : 5763.85 words/s
[2019-08-07 19:15:39] Ep. 7 : Up. 38000 : Sen. 482,912 : Cost 67.38898468 : Time 643.21s : 5765.71 words/s
[2019-08-07 19:20:01] Seen 565767 samples
[2019-08-07 19:20:01] Starting epoch 8
[2019-08-07 19:20:01] [data] Shuffling data
[2019-08-07 19:20:01] [data] Done reading 642037 sentences
[2019-08-07 19:20:03] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 19:26:25] Ep. 8 : Up. 40000 : Sen. 121,131 : Cost 65.62346649 : Time 646.52s : 5704.64 words/s
[2019-08-07 19:26:25] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-07 19:26:34] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter40000.npz
[2019-08-07 19:26:41] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 19:26:51] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-07 19:27:23] [valid] Ep. 8 : Up. 40000 : cross-entropy : 85.2921 : new best
[2019-08-07 19:27:33] [valid] Ep. 8 : Up. 40000 : perplexity : 28.8061 : new best
[2019-08-07 19:29:03] [valid] Ep. 8 : Up. 40000 : translation : 15.04 : new best
[2019-08-07 19:39:45] Ep. 8 : Up. 42000 : Sen. 324,312 : Cost 65.15820312 : Time 800.04s : 4602.93 words/s
[2019-08-07 19:50:28] Ep. 8 : Up. 44000 : Sen. 528,561 : Cost 65.11796570 : Time 642.72s : 5742.31 words/s
[2019-08-07 19:52:27] Seen 565767 samples
[2019-08-07 19:52:27] Starting epoch 9
[2019-08-07 19:52:27] [data] Shuffling data
[2019-08-07 19:52:27] [data] Done reading 642037 sentences
[2019-08-07 19:52:29] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 20:01:17] Ep. 9 : Up. 46000 : Sen. 167,092 : Cost 63.64773941 : Time 649.10s : 5705.69 words/s
[2019-08-07 20:11:56] Ep. 9 : Up. 48000 : Sen. 370,463 : Cost 63.31784439 : Time 639.31s : 5757.86 words/s
[2019-08-07 20:22:13] Seen 565767 samples
[2019-08-07 20:22:13] Starting epoch 10
[2019-08-07 20:22:13] [data] Shuffling data
[2019-08-07 20:22:13] [data] Done reading 642037 sentences
[2019-08-07 20:22:15] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 20:22:44] Ep. 10 : Up. 50000 : Sen. 8,826 : Cost 63.34370804 : Time 647.64s : 5701.33 words/s
[2019-08-07 20:33:26] Ep. 10 : Up. 52000 : Sen. 212,840 : Cost 61.65536118 : Time 642.33s : 5767.11 words/s
[2019-08-07 20:44:09] Ep. 10 : Up. 54000 : Sen. 417,354 : Cost 61.74308395 : Time 642.73s : 5754.10 words/s
[2019-08-07 20:51:56] Seen 565767 samples
[2019-08-07 20:51:56] Starting epoch 11
[2019-08-07 20:51:56] [data] Shuffling data
[2019-08-07 20:51:56] [data] Done reading 642037 sentences
[2019-08-07 20:51:58] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 20:54:56] Ep. 11 : Up. 56000 : Sen. 55,611 : Cost 61.39024734 : Time 646.69s : 5708.64 words/s
[2019-08-07 21:05:39] Ep. 11 : Up. 58000 : Sen. 259,425 : Cost 60.24116516 : Time 643.09s : 5759.14 words/s
[2019-08-07 21:16:20] Ep. 11 : Up. 60000 : Sen. 464,220 : Cost 60.02122116 : Time 640.97s : 5755.70 words/s
[2019-08-07 21:16:20] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-07 21:16:29] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter60000.npz
[2019-08-07 21:16:36] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 21:16:47] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-07 21:17:14] [valid] Ep. 11 : Up. 60000 : cross-entropy : 79.9492 : new best
[2019-08-07 21:17:24] [valid] Ep. 11 : Up. 60000 : perplexity : 23.3377 : new best
[2019-08-07 21:18:48] [valid] Ep. 11 : Up. 60000 : translation : 17.08 : new best
[2019-08-07 21:24:11] Seen 565767 samples
[2019-08-07 21:24:11] Starting epoch 12
[2019-08-07 21:24:11] [data] Shuffling data
[2019-08-07 21:24:11] [data] Done reading 642037 sentences
[2019-08-07 21:24:13] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 21:29:36] Ep. 12 : Up. 62000 : Sen. 102,096 : Cost 59.66048431 : Time 796.76s : 4634.75 words/s
[2019-08-07 21:40:19] Ep. 12 : Up. 64000 : Sen. 306,080 : Cost 58.80563736 : Time 642.73s : 5746.97 words/s
[2019-08-07 21:51:01] Ep. 12 : Up. 66000 : Sen. 510,384 : Cost 58.94159317 : Time 641.30s : 5759.88 words/s
[2019-08-07 21:53:56] Seen 565767 samples
[2019-08-07 21:53:56] Starting epoch 13
[2019-08-07 21:53:56] [data] Shuffling data
[2019-08-07 21:53:56] [data] Done reading 642037 sentences
[2019-08-07 21:53:58] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 22:01:47] Ep. 13 : Up. 68000 : Sen. 148,367 : Cost 57.68325043 : Time 646.49s : 5708.94 words/s
[2019-08-07 22:12:33] Ep. 13 : Up. 70000 : Sen. 353,011 : Cost 57.63674927 : Time 646.16s : 5727.74 words/s
[2019-08-07 22:23:17] Ep. 13 : Up. 72000 : Sen. 556,800 : Cost 58.11536026 : Time 644.08s : 5737.53 words/s
[2019-08-07 22:23:47] Seen 565767 samples
[2019-08-07 22:23:47] Starting epoch 14
[2019-08-07 22:23:47] [data] Shuffling data
[2019-08-07 22:23:47] [data] Done reading 642037 sentences
[2019-08-07 22:23:49] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 22:34:04] Ep. 14 : Up. 74000 : Sen. 194,532 : Cost 55.99907684 : Time 646.38s : 5697.71 words/s
[2019-08-07 22:44:46] Ep. 14 : Up. 76000 : Sen. 398,542 : Cost 56.58447266 : Time 642.08s : 5740.51 words/s
[2019-08-07 22:53:36] Seen 565767 samples
[2019-08-07 22:53:36] Starting epoch 15
[2019-08-07 22:53:36] [data] Shuffling data
[2019-08-07 22:53:36] [data] Done reading 642037 sentences
[2019-08-07 22:53:38] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 22:55:33] Ep. 15 : Up. 78000 : Sen. 35,671 : Cost 57.02040100 : Time 647.56s : 5699.00 words/s
[2019-08-07 23:06:16] Ep. 15 : Up. 80000 : Sen. 239,824 : Cost 55.05953217 : Time 642.70s : 5747.09 words/s
[2019-08-07 23:06:16] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-07 23:06:24] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter80000.npz
[2019-08-07 23:06:31] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-07 23:06:42] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-07 23:07:08] [valid] Ep. 15 : Up. 80000 : cross-entropy : 78.0475 : new best
[2019-08-07 23:07:18] [valid] Ep. 15 : Up. 80000 : perplexity : 21.6529 : new best
[2019-08-07 23:08:42] [valid] Ep. 15 : Up. 80000 : translation : 17.35 : new best
[2019-08-07 23:19:27] Ep. 15 : Up. 82000 : Sen. 443,891 : Cost 55.84786987 : Time 791.32s : 4673.11 words/s
[2019-08-07 23:25:52] Seen 565767 samples
[2019-08-07 23:25:52] Starting epoch 16
[2019-08-07 23:25:52] [data] Shuffling data
[2019-08-07 23:25:52] [data] Done reading 642037 sentences
[2019-08-07 23:25:56] [data] Done shuffling 642037 sentences to temp files
[2019-08-07 23:30:14] Ep. 16 : Up. 84000 : Sen. 81,364 : Cost 55.00226974 : Time 646.27s : 5674.46 words/s
[2019-08-07 23:40:57] Ep. 16 : Up. 86000 : Sen. 284,804 : Cost 54.56021881 : Time 643.92s : 5745.28 words/s
[2019-08-07 23:51:39] Ep. 16 : Up. 88000 : Sen. 489,022 : Cost 54.76316071 : Time 641.46s : 5757.07 words/s
[2019-08-07 23:55:40] Seen 565767 samples
[2019-08-07 23:55:40] Starting epoch 17
[2019-08-07 23:55:40] [data] Shuffling data
[2019-08-07 23:55:40] [data] Done reading 642037 sentences
[2019-08-07 23:55:42] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 00:02:26] Ep. 17 : Up. 90000 : Sen. 127,844 : Cost 53.58409119 : Time 647.56s : 5700.68 words/s
[2019-08-08 00:13:12] Ep. 17 : Up. 92000 : Sen. 332,722 : Cost 53.58476639 : Time 645.69s : 5738.15 words/s
[2019-08-08 00:23:55] Ep. 17 : Up. 94000 : Sen. 536,513 : Cost 54.19195557 : Time 643.26s : 5741.56 words/s
[2019-08-08 00:25:29] Seen 565767 samples
[2019-08-08 00:25:29] Starting epoch 18
[2019-08-08 00:25:29] [data] Shuffling data
[2019-08-08 00:25:30] [data] Done reading 642037 sentences
[2019-08-08 00:25:32] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 00:34:46] Ep. 18 : Up. 96000 : Sen. 175,142 : Cost 52.34514236 : Time 650.54s : 5684.13 words/s
[2019-08-08 00:45:30] Ep. 18 : Up. 98000 : Sen. 379,218 : Cost 52.79780197 : Time 644.14s : 5746.57 words/s
[2019-08-08 00:55:19] Seen 565767 samples
[2019-08-08 00:55:19] Starting epoch 19
[2019-08-08 00:55:19] [data] Shuffling data
[2019-08-08 00:55:20] [data] Done reading 642037 sentences
[2019-08-08 00:55:22] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 00:56:17] Ep. 19 : Up. 100000 : Sen. 17,011 : Cost 53.26146698 : Time 646.98s : 5691.77 words/s
[2019-08-08 00:56:17] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 00:56:26] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter100000.npz
[2019-08-08 00:56:33] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 00:56:42] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-08 00:57:08] [valid] Ep. 19 : Up. 100000 : cross-entropy : 77.7169 : new best
[2019-08-08 00:57:18] [valid] Ep. 19 : Up. 100000 : perplexity : 21.3727 : new best
[2019-08-08 00:58:41] [valid] Ep. 19 : Up. 100000 : translation : 17.18 : stalled 1 times (last best: 17.35)
[2019-08-08 01:09:26] Ep. 19 : Up. 102000 : Sen. 221,670 : Cost 51.23420334 : Time 788.88s : 4686.64 words/s
[2019-08-08 01:20:11] Ep. 19 : Up. 104000 : Sen. 425,546 : Cost 52.49320602 : Time 644.79s : 5748.99 words/s
[2019-08-08 01:27:33] Seen 565767 samples
[2019-08-08 01:27:33] Starting epoch 20
[2019-08-08 01:27:33] [data] Shuffling data
[2019-08-08 01:27:34] [data] Done reading 642037 sentences
[2019-08-08 01:27:36] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 01:30:58] Ep. 20 : Up. 106000 : Sen. 63,277 : Cost 51.92898560 : Time 647.40s : 5694.26 words/s
[2019-08-08 01:41:43] Ep. 20 : Up. 108000 : Sen. 267,976 : Cost 50.78851318 : Time 644.90s : 5752.89 words/s
[2019-08-08 01:52:26] Ep. 20 : Up. 110000 : Sen. 472,275 : Cost 51.34870529 : Time 643.44s : 5738.62 words/s
[2019-08-08 01:57:22] Seen 565767 samples
[2019-08-08 01:57:22] Starting epoch 21
[2019-08-08 01:57:22] [data] Shuffling data
[2019-08-08 01:57:23] [data] Done reading 642037 sentences
[2019-08-08 01:57:25] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 02:03:16] Ep. 21 : Up. 112000 : Sen. 110,424 : Cost 50.47277832 : Time 649.22s : 5677.43 words/s
[2019-08-08 02:13:58] Ep. 21 : Up. 114000 : Sen. 313,834 : Cost 50.50571442 : Time 642.40s : 5753.13 words/s
[2019-08-08 02:24:42] Ep. 21 : Up. 116000 : Sen. 518,198 : Cost 50.88486099 : Time 643.74s : 5737.34 words/s
[2019-08-08 02:27:13] Seen 565767 samples
[2019-08-08 02:27:13] Starting epoch 22
[2019-08-08 02:27:13] [data] Shuffling data
[2019-08-08 02:27:13] [data] Done reading 642037 sentences
[2019-08-08 02:27:15] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 02:35:28] Ep. 22 : Up. 118000 : Sen. 155,761 : Cost 49.42475128 : Time 645.86s : 5707.82 words/s
[2019-08-08 02:46:08] Ep. 22 : Up. 120000 : Sen. 360,262 : Cost 49.74898911 : Time 639.93s : 5782.17 words/s
[2019-08-08 02:46:08] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 02:46:16] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter120000.npz
[2019-08-08 02:46:23] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 02:46:32] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-08 02:46:57] [valid] Ep. 22 : Up. 120000 : cross-entropy : 78.3063 : stalled 1 times (last best: 77.7169)
[2019-08-08 02:47:07] [valid] Ep. 22 : Up. 120000 : perplexity : 21.8748 : stalled 1 times (last best: 21.3727)
[2019-08-08 02:48:31] [valid] Ep. 22 : Up. 120000 : translation : 16.51 : stalled 2 times (last best: 17.35)
[2019-08-08 02:59:11] Ep. 22 : Up. 122000 : Sen. 564,430 : Cost 50.12572861 : Time 783.84s : 4709.34 words/s
[2019-08-08 02:59:16] Seen 565767 samples
[2019-08-08 02:59:16] Starting epoch 23
[2019-08-08 02:59:16] [data] Shuffling data
[2019-08-08 02:59:16] [data] Done reading 642037 sentences
[2019-08-08 02:59:18] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 03:09:54] Ep. 23 : Up. 124000 : Sen. 202,302 : Cost 48.31797409 : Time 642.30s : 5726.55 words/s
[2019-08-08 03:20:34] Ep. 23 : Up. 126000 : Sen. 406,586 : Cost 49.22621918 : Time 640.52s : 5780.37 words/s
[2019-08-08 03:28:54] Seen 565767 samples
[2019-08-08 03:28:54] Starting epoch 24
[2019-08-08 03:28:54] [data] Shuffling data
[2019-08-08 03:28:54] [data] Done reading 642037 sentences
[2019-08-08 03:28:56] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 03:31:20] Ep. 24 : Up. 128000 : Sen. 44,878 : Cost 49.47738647 : Time 645.49s : 5734.87 words/s
[2019-08-08 03:42:01] Ep. 24 : Up. 130000 : Sen. 249,315 : Cost 47.75838470 : Time 640.76s : 5774.21 words/s
[2019-08-08 03:52:36] Ep. 24 : Up. 132000 : Sen. 452,104 : Cost 48.82283020 : Time 635.61s : 5791.74 words/s
[2019-08-08 03:58:30] Seen 565767 samples
[2019-08-08 03:58:30] Starting epoch 25
[2019-08-08 03:58:30] [data] Shuffling data
[2019-08-08 03:58:31] [data] Done reading 642037 sentences
[2019-08-08 03:58:33] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 04:03:17] Ep. 25 : Up. 134000 : Sen. 90,229 : Cost 47.71838379 : Time 640.58s : 5738.37 words/s
[2019-08-08 04:13:56] Ep. 25 : Up. 136000 : Sen. 294,478 : Cost 47.46099091 : Time 639.25s : 5783.25 words/s
[2019-08-08 04:24:36] Ep. 25 : Up. 138000 : Sen. 498,659 : Cost 48.31496429 : Time 640.45s : 5781.47 words/s
[2019-08-08 04:28:07] Seen 565767 samples
[2019-08-08 04:28:07] Starting epoch 26
[2019-08-08 04:28:07] [data] Shuffling data
[2019-08-08 04:28:07] [data] Done reading 642037 sentences
[2019-08-08 04:28:09] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 04:35:20] Ep. 26 : Up. 140000 : Sen. 136,295 : Cost 47.04784775 : Time 643.40s : 5729.74 words/s
[2019-08-08 04:35:20] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 04:35:29] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter140000.npz
[2019-08-08 04:35:35] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 04:35:44] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-08 04:36:09] [valid] Ep. 26 : Up. 140000 : cross-entropy : 79.1764 : stalled 2 times (last best: 77.7169)
[2019-08-08 04:36:19] [valid] Ep. 26 : Up. 140000 : perplexity : 22.6378 : stalled 2 times (last best: 21.3727)
[2019-08-08 04:37:40] [valid] Ep. 26 : Up. 140000 : translation : 16.28 : stalled 3 times (last best: 17.35)
[2019-08-08 04:48:19] Ep. 26 : Up. 142000 : Sen. 340,504 : Cost 46.96081543 : Time 779.58s : 4728.15 words/s
[2019-08-08 04:58:59] Ep. 26 : Up. 144000 : Sen. 545,146 : Cost 47.93849564 : Time 639.73s : 5795.02 words/s
[2019-08-08 05:00:05] Seen 565767 samples
[2019-08-08 05:00:05] Starting epoch 27
[2019-08-08 05:00:05] [data] Shuffling data
[2019-08-08 05:00:05] [data] Done reading 642037 sentences
[2019-08-08 05:00:07] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 05:09:43] Ep. 27 : Up. 146000 : Sen. 183,358 : Cost 45.91309357 : Time 644.12s : 5736.45 words/s
[2019-08-08 05:20:21] Ep. 27 : Up. 148000 : Sen. 387,460 : Cost 46.54103851 : Time 638.07s : 5780.78 words/s
[2019-08-08 05:29:40] Seen 565767 samples
[2019-08-08 05:29:40] Starting epoch 28
[2019-08-08 05:29:40] [data] Shuffling data
[2019-08-08 05:29:41] [data] Done reading 642037 sentences
[2019-08-08 05:29:43] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 05:31:05] Ep. 28 : Up. 150000 : Sen. 25,522 : Cost 47.23795319 : Time 643.24s : 5743.57 words/s
[2019-08-08 05:41:42] Ep. 28 : Up. 152000 : Sen. 229,089 : Cost 45.46792984 : Time 637.77s : 5787.86 words/s
[2019-08-08 05:52:20] Ep. 28 : Up. 154000 : Sen. 433,500 : Cost 46.19586945 : Time 637.86s : 5785.41 words/s
[2019-08-08 05:59:17] Seen 565767 samples
[2019-08-08 05:59:17] Starting epoch 29
[2019-08-08 05:59:17] [data] Shuffling data
[2019-08-08 05:59:18] [data] Done reading 642037 sentences
[2019-08-08 05:59:20] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 06:03:04] Ep. 29 : Up. 156000 : Sen. 70,823 : Cost 46.22421646 : Time 644.22s : 5722.95 words/s
[2019-08-08 06:13:45] Ep. 29 : Up. 158000 : Sen. 274,825 : Cost 45.08317184 : Time 640.08s : 5769.15 words/s
[2019-08-08 06:24:24] Ep. 29 : Up. 160000 : Sen. 478,982 : Cost 45.96563339 : Time 639.67s : 5771.80 words/s
[2019-08-08 06:24:24] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 06:24:33] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter160000.npz
[2019-08-08 06:24:39] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 06:24:48] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-08 06:25:14] [valid] Ep. 29 : Up. 160000 : cross-entropy : 80.4242 : stalled 3 times (last best: 77.7169)
[2019-08-08 06:25:24] [valid] Ep. 29 : Up. 160000 : perplexity : 23.7786 : stalled 3 times (last best: 21.3727)
[2019-08-08 06:26:46] [valid] Ep. 29 : Up. 160000 : translation : 15.96 : stalled 4 times (last best: 17.35)
[2019-08-08 06:31:20] Seen 565767 samples
[2019-08-08 06:31:20] Starting epoch 30
[2019-08-08 06:31:20] [data] Shuffling data
[2019-08-08 06:31:21] [data] Done reading 642037 sentences
[2019-08-08 06:31:22] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 06:37:30] Ep. 30 : Up. 162000 : Sen. 116,414 : Cost 45.03442383 : Time 785.62s : 4689.81 words/s
[2019-08-08 06:48:11] Ep. 30 : Up. 164000 : Sen. 321,081 : Cost 44.70922470 : Time 640.85s : 5772.38 words/s
[2019-08-08 06:58:50] Ep. 30 : Up. 166000 : Sen. 524,987 : Cost 45.77494431 : Time 638.91s : 5777.99 words/s
[2019-08-08 07:00:59] Seen 565767 samples
[2019-08-08 07:00:59] Starting epoch 31
[2019-08-08 07:00:59] [data] Shuffling data
[2019-08-08 07:00:59] [data] Done reading 642037 sentences
[2019-08-08 07:01:01] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 07:09:31] Ep. 31 : Up. 168000 : Sen. 162,586 : Cost 43.95584488 : Time 641.46s : 5731.55 words/s
[2019-08-08 07:20:13] Ep. 31 : Up. 170000 : Sen. 366,963 : Cost 44.70231628 : Time 641.94s : 5777.31 words/s
[2019-08-08 07:30:36] Seen 565767 samples
[2019-08-08 07:30:36] Starting epoch 32
[2019-08-08 07:30:36] [data] Shuffling data
[2019-08-08 07:30:37] [data] Done reading 642037 sentences
[2019-08-08 07:30:39] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 07:30:58] Ep. 32 : Up. 172000 : Sen. 4,944 : Cost 45.18987656 : Time 644.83s : 5719.21 words/s
[2019-08-08 07:41:38] Ep. 32 : Up. 174000 : Sen. 208,989 : Cost 43.32064438 : Time 640.46s : 5772.35 words/s
[2019-08-08 07:52:19] Ep. 32 : Up. 176000 : Sen. 414,096 : Cost 44.27125168 : Time 640.78s : 5785.98 words/s
[2019-08-08 08:00:15] Seen 565767 samples
[2019-08-08 08:00:15] Starting epoch 33
[2019-08-08 08:00:15] [data] Shuffling data
[2019-08-08 08:00:16] [data] Done reading 642037 sentences
[2019-08-08 08:00:17] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 08:03:03] Ep. 33 : Up. 178000 : Sen. 51,863 : Cost 44.29283905 : Time 644.32s : 5726.53 words/s
[2019-08-08 08:13:42] Ep. 33 : Up. 180000 : Sen. 255,766 : Cost 43.16672516 : Time 638.59s : 5781.54 words/s
[2019-08-08 08:13:42] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 08:13:51] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter180000.npz
[2019-08-08 08:13:57] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 08:14:06] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-08 08:14:32] [valid] Ep. 33 : Up. 180000 : cross-entropy : 81.7002 : stalled 4 times (last best: 77.7169)
[2019-08-08 08:14:41] [valid] Ep. 33 : Up. 180000 : perplexity : 25.0047 : stalled 4 times (last best: 21.3727)
[2019-08-08 08:16:03] [valid] Ep. 33 : Up. 180000 : translation : 15.91 : stalled 5 times (last best: 17.35)
[2019-08-08 08:26:45] Ep. 33 : Up. 182000 : Sen. 459,850 : Cost 44.15559387 : Time 782.71s : 4722.45 words/s
[2019-08-08 08:32:17] Seen 565767 samples
[2019-08-08 08:32:17] Starting epoch 34
[2019-08-08 08:32:17] [data] Shuffling data
[2019-08-08 08:32:17] [data] Done reading 642037 sentences
[2019-08-08 08:32:20] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 08:37:31] Ep. 34 : Up. 184000 : Sen. 97,634 : Cost 43.38891983 : Time 646.24s : 5693.82 words/s
[2019-08-08 08:48:12] Ep. 34 : Up. 186000 : Sen. 301,959 : Cost 42.68479156 : Time 641.29s : 5766.48 words/s
[2019-08-08 08:58:52] Ep. 34 : Up. 188000 : Sen. 506,206 : Cost 43.67642593 : Time 640.07s : 5783.58 words/s
[2019-08-08 09:01:59] Seen 565767 samples
[2019-08-08 09:01:59] Starting epoch 35
[2019-08-08 09:01:59] [data] Shuffling data
[2019-08-08 09:02:00] [data] Done reading 642037 sentences
[2019-08-08 09:02:06] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 09:09:39] Ep. 35 : Up. 190000 : Sen. 144,412 : Cost 42.54248047 : Time 646.81s : 5702.14 words/s
[2019-08-08 09:20:20] Ep. 35 : Up. 192000 : Sen. 347,853 : Cost 42.86414337 : Time 640.77s : 5756.96 words/s
[2019-08-08 09:31:00] Ep. 35 : Up. 194000 : Sen. 552,141 : Cost 43.64093781 : Time 640.05s : 5786.18 words/s
[2019-08-08 09:31:43] Seen 565767 samples
[2019-08-08 09:31:43] Starting epoch 36
[2019-08-08 09:31:43] [data] Shuffling data
[2019-08-08 09:31:43] [data] Done reading 642037 sentences
[2019-08-08 09:31:45] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 09:41:43] Ep. 36 : Up. 196000 : Sen. 189,492 : Cost 41.45047379 : Time 642.63s : 5705.99 words/s
[2019-08-08 09:52:24] Ep. 36 : Up. 198000 : Sen. 393,266 : Cost 42.51977158 : Time 641.72s : 5760.49 words/s
[2019-08-08 10:01:25] Seen 565767 samples
[2019-08-08 10:01:25] Starting epoch 37
[2019-08-08 10:01:25] [data] Shuffling data
[2019-08-08 10:01:25] [data] Done reading 642037 sentences
[2019-08-08 10:01:28] [data] Done shuffling 642037 sentences to temp files
[2019-08-08 10:03:12] Ep. 37 : Up. 200000 : Sen. 32,236 : Cost 42.90129852 : Time 647.72s : 5720.17 words/s
[2019-08-08 10:03:12] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 10:03:26] Saving model to ../experiments/10M_random_fasttext_prob/model/model.iter200000.npz
[2019-08-08 10:03:34] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 10:03:44] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
[2019-08-08 10:04:13] [valid] Ep. 37 : Up. 200000 : cross-entropy : 83.0728 : stalled 5 times (last best: 77.7169)
[2019-08-08 10:04:23] [valid] Ep. 37 : Up. 200000 : perplexity : 26.3942 : stalled 5 times (last best: 21.3727)
[2019-08-08 10:05:46] [valid] Ep. 37 : Up. 200000 : translation : 15.31 : stalled 6 times (last best: 17.35)
[2019-08-08 10:05:48] Training finished
[2019-08-08 10:05:52] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz.orig.npz
[2019-08-08 10:06:02] Saving model to ../experiments/10M_random_fasttext_prob/model/model.npz
[2019-08-08 10:06:16] Saving Adam parameters to ../experiments/10M_random_fasttext_prob/model/model.npz.optimizer.npz
